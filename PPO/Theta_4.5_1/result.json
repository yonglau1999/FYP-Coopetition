{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.397362381219864, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 1e-07, "total_loss": 2.127071101218462, "policy_loss": -0.002177514415234327, "vf_loss": 9.648358720541001, "vf_explained_var": 6.357915699481965e-05, "kl": 0.00041232236708310666, "entropy": 2.8292355686426163, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "env_runners": {"episode_reward_max": 106.18186139463356, "episode_reward_min": 65.18042179611838, "episode_reward_mean": 78.25367887226913, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 900, "policy_reward_min": {"tplp_policy": 65.18042179611838}, "policy_reward_max": {"tplp_policy": 106.18186139463356}, "policy_reward_mean": {"tplp_policy": 78.25367887226913}, "custom_metrics": {"mean_episode_reward_mean": 78.25367887226913, "mean_episode_reward_min": 65.18042179611838, "mean_episode_reward_max": 106.18186139463356}, "hist_stats": {"episode_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.052553657013549, "mean_inference_ms": 3.073392716499905, "mean_action_processing_ms": 0.5056384919295962, "mean_env_wait_ms": 3.164570729802443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022158357832166884, "StateBufferConnector_ms": 0.005544556511773003, "ViewRequirementAgentConnector_ms": 0.2668367491828071}, "num_episodes": 18, "episode_return_max": 106.18186139463356, "episode_return_min": 65.18042179611838, "episode_return_mean": 78.25367887226913, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 316.65358357635483, "num_env_steps_trained_throughput_per_sec": 316.65358357635483, "timesteps_total": 1024, "num_env_steps_sampled_lifetime": 1024, "num_agent_steps_sampled_lifetime": 1024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 3233.818, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3233.818, "sample_time_ms": 1418.958, "learn_time_ms": 1782.377, "learn_throughput": 574.514, "synch_weights_time_ms": 31.38}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "training_iteration": 1, "trial_id": "374cd_00000", "date": "2025-04-09_10-49-59", "timestamp": 1744166999, "time_this_iter_s": 3.2393786907196045, "time_total_s": 3.2393786907196045, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC16C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3.2393786907196045, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.4, "ram_util_percent": 97.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.243927327543497, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 1e-07, "total_loss": 2.1315026305615903, "policy_loss": -0.0004430020460858941, "vf_loss": 9.66024883389473, "vf_explained_var": 5.309022963047027e-05, "kl": 4.9363733890771255e-06, "entropy": 2.831170681118965, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "env_runners": {"episode_reward_max": 106.18186139463356, "episode_reward_min": 54.81441416201414, "episode_reward_mean": 77.22626292664341, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 1800, "policy_reward_min": {"tplp_policy": 54.81441416201414}, "policy_reward_max": {"tplp_policy": 106.18186139463356}, "policy_reward_mean": {"tplp_policy": 77.22626292664341}, "custom_metrics": {"mean_episode_reward_mean": 77.22626292664341, "mean_episode_reward_min": 54.81441416201414, "mean_episode_reward_max": 106.18186139463356}, "hist_stats": {"episode_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9937906844648321, "mean_inference_ms": 2.941093954551189, "mean_action_processing_ms": 0.5002211106279416, "mean_env_wait_ms": 3.0746017658925258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013849470350477431, "StateBufferConnector_ms": 0.008317497041490342, "ViewRequirementAgentConnector_ms": 0.2625332938300239}, "num_episodes": 18, "episode_return_max": 106.18186139463356, "episode_return_min": 54.81441416201414, "episode_return_mean": 77.22626292664341, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 350.3740380242343, "num_env_steps_trained_throughput_per_sec": 350.3740380242343, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 2048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 3078.204, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3078.204, "sample_time_ms": 1316.156, "learn_time_ms": 1735.398, "learn_throughput": 590.067, "synch_weights_time_ms": 26.1}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "training_iteration": 2, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-02", "timestamp": 1744167002, "time_this_iter_s": 2.927786111831665, "time_total_s": 6.1671648025512695, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC25C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6.1671648025512695, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.599999999999994, "ram_util_percent": 97.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.587346912175417, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 1e-07, "total_loss": 2.1287292666733264, "policy_loss": -0.00020689172088168563, "vf_loss": 9.649031400680542, "vf_explained_var": 2.774558961391449e-05, "kl": 1.2128357884222396e-06, "entropy": 2.833217605948448, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "env_runners": {"episode_reward_max": 106.18186139463356, "episode_reward_min": 54.81441416201414, "episode_reward_mean": 77.23351221414529, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"tplp_policy": 54.81441416201414}, "policy_reward_max": {"tplp_policy": 106.18186139463356}, "policy_reward_mean": {"tplp_policy": 77.23351221414529}, "custom_metrics": {"mean_episode_reward_mean": 77.23351221414529, "mean_episode_reward_min": 54.81441416201414, "mean_episode_reward_max": 106.18186139463356}, "hist_stats": {"episode_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9645338186725522, "mean_inference_ms": 2.847990468933787, "mean_action_processing_ms": 0.492532817662042, "mean_env_wait_ms": 3.0174254873598882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009969472885131836, "StateBufferConnector_ms": 0.0066534678141276045, "ViewRequirementAgentConnector_ms": 0.27477065722147626}, "num_episodes": 24, "episode_return_max": 106.18186139463356, "episode_return_min": 54.81441416201414, "episode_return_mean": 77.23351221414529, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 336.04581587303176, "num_env_steps_trained_throughput_per_sec": 336.04581587303176, "timesteps_total": 3072, "num_env_steps_sampled_lifetime": 3072, "num_agent_steps_sampled_lifetime": 3072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 3067.871, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3067.871, "sample_time_ms": 1275.014, "learn_time_ms": 1766.625, "learn_throughput": 579.636, "synch_weights_time_ms": 25.53}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "training_iteration": 3, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-05", "timestamp": 1744167005, "time_this_iter_s": 3.0569310188293457, "time_total_s": 9.224095821380615, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.224095821380615, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.28, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.400046564824879, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 1e-07, "total_loss": 2.157408868521452, "policy_loss": -0.00013230047770775854, "vf_loss": 9.764148712158203, "vf_explained_var": 3.319494426250458e-05, "kl": 1.292400837427099e-06, "entropy": 2.8349602624773977, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "env_runners": {"episode_reward_max": 106.18186139463356, "episode_reward_min": 54.81441416201414, "episode_reward_mean": 77.37508937788633, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3900, "policy_reward_min": {"tplp_policy": 54.81441416201414}, "policy_reward_max": {"tplp_policy": 106.18186139463356}, "policy_reward_mean": {"tplp_policy": 77.37508937788633}, "custom_metrics": {"mean_episode_reward_mean": 77.37508937788633, "mean_episode_reward_min": 54.81441416201414, "mean_episode_reward_max": 106.18186139463356}, "hist_stats": {"episode_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.396182105102, 75.84998323725792, 85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9414434441333484, "mean_inference_ms": 2.7739774874772523, "mean_action_processing_ms": 0.48460140450258665, "mean_env_wait_ms": 2.952933227804318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007668825296255259, "StateBufferConnector_ms": 0.007994664021027394, "ViewRequirementAgentConnector_ms": 0.2644920960450784}, "num_episodes": 18, "episode_return_max": 106.18186139463356, "episode_return_min": 54.81441416201414, "episode_return_mean": 77.37508937788633, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 412.7346271036773, "num_env_steps_trained_throughput_per_sec": 412.7346271036773, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 4096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 2921.156, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2921.156, "sample_time_ms": 1188.315, "learn_time_ms": 1708.242, "learn_throughput": 599.447, "synch_weights_time_ms": 24.074}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "training_iteration": 4, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-07", "timestamp": 1744167007, "time_this_iter_s": 2.4865784645080566, "time_total_s": 11.710674285888672, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC16C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.710674285888672, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.300000000000004, "ram_util_percent": 97.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.664366849511862, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 1e-07, "total_loss": 2.146013531833887, "policy_loss": -0.00026110235194209963, "vf_loss": 9.719966036081313, "vf_explained_var": 2.120770514011383e-05, "kl": 1.9785664708837913e-06, "entropy": 2.8371686935424805, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "env_runners": {"episode_reward_max": 106.18186139463356, "episode_reward_min": 53.23855017433024, "episode_reward_mean": 77.08554111018307, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.23855017433024}, "policy_reward_max": {"tplp_policy": 106.18186139463356}, "policy_reward_mean": {"tplp_policy": 77.08554111018307}, "custom_metrics": {"mean_episode_reward_mean": 77.08554111018307, "mean_episode_reward_min": 53.23855017433024, "mean_episode_reward_max": 106.18186139463356}, "hist_stats": {"episode_reward": [85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.11490667446118, 74.82055502333031, 65.18042179611838, 71.92163879283571, 80.38478889205842, 71.80132794208373, 76.45403752432502, 94.90649670823208, 81.90907705975606, 90.31705443596006, 78.54991819246182, 106.18186139463356, 71.3209061529914, 72.87311431542597, 68.16142940958146, 77.42252004422919, 79.36129899796471, 68.97560185781883, 66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9123381405648956, "mean_inference_ms": 2.6885938154239857, "mean_action_processing_ms": 0.4732039194527205, "mean_env_wait_ms": 2.869053116848748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006979227066040039, "StateBufferConnector_ms": 0.006235837936401367, "ViewRequirementAgentConnector_ms": 0.24298882484436035}, "num_episodes": 24, "episode_return_max": 106.18186139463356, "episode_return_min": 53.23855017433024, "episode_return_mean": 77.08554111018307, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 414.86205572233877, "num_env_steps_trained_throughput_per_sec": 414.86205572233877, "timesteps_total": 5120, "num_env_steps_sampled_lifetime": 5120, "num_agent_steps_sampled_lifetime": 5120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 2830.583, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2830.583, "sample_time_ms": 1130.609, "learn_time_ms": 1676.173, "learn_throughput": 610.915, "synch_weights_time_ms": 23.38}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "training_iteration": 5, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-10", "timestamp": 1744167010, "time_this_iter_s": 2.4759647846221924, "time_total_s": 14.186639070510864, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC25C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.186639070510864, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.425000000000004, "ram_util_percent": 97.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.855908416211605, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 1e-07, "total_loss": 2.143358553946018, "policy_loss": -0.0002558170759584755, "vf_loss": 9.710408335924148, "vf_explained_var": 6.578490138053894e-05, "kl": 2.5760700401722403e-06, "entropy": 2.839877079427242, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "env_runners": {"episode_reward_max": 103.99264171295812, "episode_reward_min": 53.23855017433024, "episode_reward_mean": 77.49612566375235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.23855017433024}, "policy_reward_max": {"tplp_policy": 103.99264171295812}, "policy_reward_mean": {"tplp_policy": 77.49612566375235}, "custom_metrics": {"mean_episode_reward_mean": 77.49612566375235, "mean_episode_reward_min": 53.23855017433024, "mean_episode_reward_max": 103.99264171295812}, "hist_stats": {"episode_reward": [66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [66.0231590822433, 74.28262888788302, 73.55891201258306, 66.01822184894534, 102.00233810660285, 79.03346159016172, 93.28611625140937, 54.81441416201414, 73.69540465396818, 71.12751122115685, 101.68866007313848, 65.91160356995225, 80.0395047691727, 67.80587577524632, 89.5143948519676, 64.44013794608969, 73.3724649317352, 79.01006624257417, 85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8637930012240511, "mean_inference_ms": 2.5483079464011023, "mean_action_processing_ms": 0.45918791393255487, "mean_env_wait_ms": 2.7537562789290644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00410008430480957, "StateBufferConnector_ms": 0.0047454833984375, "ViewRequirementAgentConnector_ms": 0.22241711616516113}, "num_episodes": 18, "episode_return_max": 103.99264171295812, "episode_return_min": 53.23855017433024, "episode_return_mean": 77.49612566375235, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 386.33607464627494, "num_env_steps_trained_throughput_per_sec": 386.33607464627494, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 6144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 2800.576, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2800.576, "sample_time_ms": 1074.969, "learn_time_ms": 1701.072, "learn_throughput": 601.973, "synch_weights_time_ms": 24.185}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "training_iteration": 6, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-12", "timestamp": 1744167012, "time_this_iter_s": 2.6632699966430664, "time_total_s": 16.84990906715393, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16.84990906715393, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.824999999999996, "ram_util_percent": 97.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8455909989774226, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 1e-07, "total_loss": 2.1261048428714275, "policy_loss": -0.00031481432961300015, "vf_loss": 9.642449969053269, "vf_explained_var": 3.0390545725822447e-05, "kl": 1.722281704710782e-06, "entropy": 2.8419284775853155, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "env_runners": {"episode_reward_max": 103.99264171295812, "episode_reward_min": 53.23855017433024, "episode_reward_mean": 78.33009990869986, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.23855017433024}, "policy_reward_max": {"tplp_policy": 103.99264171295812}, "policy_reward_mean": {"tplp_policy": 78.33009990869986}, "custom_metrics": {"mean_episode_reward_mean": 78.33009990869986, "mean_episode_reward_min": 53.23855017433024, "mean_episode_reward_max": 103.99264171295812}, "hist_stats": {"episode_reward": [85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.23101249490874, 73.61514242867337, 80.51003000304972, 85.905758401614, 88.51899023754163, 67.32292674455859, 74.87003163925145, 76.42641789743581, 85.44749747808662, 76.80280429616893, 87.40512880186473, 76.64013362955217, 81.7346667809439, 61.76507997102077, 77.11157854070774, 76.97349970558075, 66.24352560327652, 86.31727937298103, 65.6116128158708, 80.60343088887339, 82.0069363715149, 64.41925221176876, 75.45786452717499, 69.00516297497542, 78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8408905838210502, "mean_inference_ms": 2.469347755889587, "mean_action_processing_ms": 0.4476017911241675, "mean_env_wait_ms": 2.677277452181552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005268096923828125, "StateBufferConnector_ms": 0.006745338439941406, "ViewRequirementAgentConnector_ms": 0.2348158359527588}, "num_episodes": 18, "episode_return_max": 103.99264171295812, "episode_return_min": 53.23855017433024, "episode_return_mean": 78.33009990869986, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 353.33879286373605, "num_env_steps_trained_throughput_per_sec": 353.33879286373605, "timesteps_total": 7168, "num_env_steps_sampled_lifetime": 7168, "num_agent_steps_sampled_lifetime": 7168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 2814.504, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2814.504, "sample_time_ms": 1119.625, "learn_time_ms": 1671.124, "learn_throughput": 612.761, "synch_weights_time_ms": 23.454}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "training_iteration": 7, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-15", "timestamp": 1744167015, "time_this_iter_s": 2.904057264328003, "time_total_s": 19.753966331481934, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19.753966331481934, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.175000000000004, "ram_util_percent": 97.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5962077282369136, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 1e-07, "total_loss": 2.1020275712013246, "policy_loss": -0.00024518719874322414, "vf_loss": 9.546241986751557, "vf_explained_var": 2.3005902767181398e-05, "kl": 1.5621833985068888e-06, "entropy": 2.842877298593521, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "env_runners": {"episode_reward_max": 103.99264171295812, "episode_reward_min": 53.23855017433024, "episode_reward_mean": 79.64214388033898, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.23855017433024}, "policy_reward_max": {"tplp_policy": 103.99264171295812}, "policy_reward_mean": {"tplp_policy": 79.64214388033898}, "custom_metrics": {"mean_episode_reward_mean": 79.64214388033898, "mean_episode_reward_min": 53.23855017433024, "mean_episode_reward_max": 103.99264171295812}, "hist_stats": {"episode_reward": [78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.91094766476488, 60.893744621303796, 78.63584130199472, 68.42892764521251, 78.11439135831083, 92.99194340611919, 74.05611836226238, 75.97223740871661, 83.92669805656197, 75.84890522561116, 85.16425621551566, 100.24260246271376, 78.99774099225672, 78.98726433609399, 76.65322438742318, 68.95836767940469, 78.4613574672869, 85.5970947446825, 77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8138173114294786, "mean_inference_ms": 2.382949643871182, "mean_action_processing_ms": 0.4343939614242427, "mean_env_wait_ms": 2.585528696301671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005490779876708984, "StateBufferConnector_ms": 0.006253719329833984, "ViewRequirementAgentConnector_ms": 0.2140049934387207}, "num_episodes": 24, "episode_return_max": 103.99264171295812, "episode_return_min": 53.23855017433024, "episode_return_mean": 79.64214388033898, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 398.6899566496793, "num_env_steps_trained_throughput_per_sec": 398.6899566496793, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 8192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 2783.742, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2783.742, "sample_time_ms": 1101.631, "learn_time_ms": 1658.886, "learn_throughput": 617.282, "synch_weights_time_ms": 22.962}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "training_iteration": 8, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-18", "timestamp": 1744167018, "time_this_iter_s": 2.574493646621704, "time_total_s": 22.328459978103638, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.328459978103638, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 46.20000000000001, "ram_util_percent": 97.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6534500062465667, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 1e-07, "total_loss": 2.1023903742432593, "policy_loss": -0.00015323830884881318, "vf_loss": 9.547778898477555, "vf_explained_var": 3.00675630569458e-05, "kl": 9.347860695285704e-07, "entropy": 2.8440109983086588, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "env_runners": {"episode_reward_max": 103.99264171295812, "episode_reward_min": 53.23855017433024, "episode_reward_mean": 79.5065043500104, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.23855017433024}, "policy_reward_max": {"tplp_policy": 103.99264171295812}, "policy_reward_mean": {"tplp_policy": 79.5065043500104}, "custom_metrics": {"mean_episode_reward_mean": 79.5065043500104, "mean_episode_reward_min": 53.23855017433024, "mean_episode_reward_max": 103.99264171295812}, "hist_stats": {"episode_reward": [77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.11473481808355, 74.82629736370535, 92.61732402711769, 66.46869286290973, 53.23855017433024, 89.22007070664407, 79.643958643138, 70.69490147211488, 66.08075052534446, 63.57351643671867, 83.10568153701702, 64.16240169525928, 73.39503133922649, 74.41190877621528, 76.66845009502747, 81.52517312268897, 74.50212581137465, 87.56283444024446, 77.22932941200857, 68.87061112413372, 71.87177823184237, 83.70073005841908, 79.82271462769506, 82.34956580723212, 86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8027115511374546, "mean_inference_ms": 2.3493540059661755, "mean_action_processing_ms": 0.42789451076585955, "mean_env_wait_ms": 2.551223072651733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074977874755859375, "StateBufferConnector_ms": 0.005007028579711914, "ViewRequirementAgentConnector_ms": 0.2229013442993164}, "num_episodes": 18, "episode_return_max": 103.99264171295812, "episode_return_min": 53.23855017433024, "episode_return_mean": 79.5065043500104, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 345.29310430351035, "num_env_steps_trained_throughput_per_sec": 345.29310430351035, "timesteps_total": 9216, "num_env_steps_sampled_lifetime": 9216, "num_agent_steps_sampled_lifetime": 9216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 2803.948, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2803.948, "sample_time_ms": 1095.605, "learn_time_ms": 1684.626, "learn_throughput": 607.85, "synch_weights_time_ms": 23.484}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "training_iteration": 9, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-21", "timestamp": 1744167021, "time_this_iter_s": 2.976727247238159, "time_total_s": 25.305187225341797, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.305187225341797, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.760000000000005, "ram_util_percent": 97.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.35413679741323, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 1e-07, "total_loss": 2.1528905257582664, "policy_loss": -0.00020019130897708237, "vf_loss": 9.750347191095353, "vf_explained_var": 3.617182374000549e-05, "kl": 9.95505831058452e-07, "entropy": 2.844960567355156, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "env_runners": {"episode_reward_max": 103.99264171295812, "episode_reward_min": 62.83173061872464, "episode_reward_mean": 81.11008592084252, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.83173061872464}, "policy_reward_max": {"tplp_policy": 103.99264171295812}, "policy_reward_mean": {"tplp_policy": 81.11008592084252}, "custom_metrics": {"mean_episode_reward_mean": 81.11008592084252, "mean_episode_reward_min": 62.83173061872464, "mean_episode_reward_max": 103.99264171295812}, "hist_stats": {"episode_reward": [86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.60737063211477, 79.18091583972146, 82.7501537027331, 90.33853331889419, 71.32676571193531, 103.99264171295812, 82.04546437446763, 74.88659398869929, 74.85844076998627, 66.03108771584952, 75.89101654740887, 79.73628562438465, 71.75739313465482, 86.12591257483511, 79.88100770766964, 89.13354677995619, 94.29722421018408, 74.92677062639632, 78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8015708556523116, "mean_inference_ms": 2.3454577255330036, "mean_action_processing_ms": 0.4253214674209065, "mean_env_wait_ms": 2.542638519749027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008494853973388672, "StateBufferConnector_ms": 0.00551295280456543, "ViewRequirementAgentConnector_ms": 0.2365102767944336}, "num_episodes": 24, "episode_return_max": 103.99264171295812, "episode_return_min": 62.83173061872464, "episode_return_mean": 81.11008592084252, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 300.6121753547513, "num_env_steps_trained_throughput_per_sec": 300.6121753547513, "timesteps_total": 10240, "num_env_steps_sampled_lifetime": 10240, "num_agent_steps_sampled_lifetime": 10240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 2864.192, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2864.192, "sample_time_ms": 1121.526, "learn_time_ms": 1719.006, "learn_throughput": 595.693, "synch_weights_time_ms": 23.449}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "training_iteration": 10, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-25", "timestamp": 1744167025, "time_this_iter_s": 3.4153635501861572, "time_total_s": 28.720550775527954, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.720550775527954, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.25999999999999, "ram_util_percent": 97.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5606754601001738, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 1e-07, "total_loss": 2.1070495791733266, "policy_loss": -0.0001789539004676044, "vf_loss": 9.567500430345536, "vf_explained_var": 3.0267611145973204e-05, "kl": 1.463936675993871e-06, "entropy": 2.846465553343296, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "env_runners": {"episode_reward_max": 103.72749682119202, "episode_reward_min": 53.73182183843844, "episode_reward_mean": 81.15926527838064, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.73182183843844}, "policy_reward_max": {"tplp_policy": 103.72749682119202}, "policy_reward_mean": {"tplp_policy": 81.15926527838064}, "custom_metrics": {"mean_episode_reward_mean": 81.15926527838064, "mean_episode_reward_min": 53.73182183843844, "mean_episode_reward_max": 103.72749682119202}, "hist_stats": {"episode_reward": [78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.90417955659707, 75.36868762071025, 77.88996250569227, 75.86494851220993, 80.56471046315093, 88.86639989410477, 73.37092023814265, 84.60890548465999, 71.15612308850302, 89.94567141182473, 78.97511225391348, 82.09176388548711, 73.3792891579354, 91.91078907229733, 77.6080777728788, 89.29276471690864, 84.64973485405469, 83.99901429980116, 103.72749682119202, 83.64563561292172, 80.3961632946307, 78.32386886299463, 76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8068881285042657, "mean_inference_ms": 2.355984936073179, "mean_action_processing_ms": 0.42689943979412454, "mean_env_wait_ms": 2.5504923950195297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008694171905517578, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.2540616989135742}, "num_episodes": 18, "episode_return_max": 103.72749682119202, "episode_return_min": 53.73182183843844, "episode_return_mean": 81.15926527838064, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 398.5447111183036, "num_env_steps_trained_throughput_per_sec": 398.5447111183036, "timesteps_total": 11264, "num_env_steps_sampled_lifetime": 11264, "num_agent_steps_sampled_lifetime": 11264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 2797.745, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2797.745, "sample_time_ms": 1075.798, "learn_time_ms": 1699.63, "learn_throughput": 602.484, "synch_weights_time_ms": 22.217}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "training_iteration": 11, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-27", "timestamp": 1744167027, "time_this_iter_s": 2.5754597187042236, "time_total_s": 31.296010494232178, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.296010494232178, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.53333333333333, "ram_util_percent": 97.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.271146248653531, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 1e-07, "total_loss": 2.153968046605587, "policy_loss": -0.00014398139901459218, "vf_loss": 9.755862975120545, "vf_explained_var": 1.1323392391204834e-05, "kl": 1.340138178229644e-06, "entropy": 2.848537203669548, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "env_runners": {"episode_reward_max": 102.1701187087763, "episode_reward_min": 53.73182183843844, "episode_reward_mean": 80.35207575912372, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.73182183843844}, "policy_reward_max": {"tplp_policy": 102.1701187087763}, "policy_reward_mean": {"tplp_policy": 80.35207575912372}, "custom_metrics": {"mean_episode_reward_mean": 80.35207575912372, "mean_episode_reward_min": 53.73182183843844, "mean_episode_reward_max": 102.1701187087763}, "hist_stats": {"episode_reward": [76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [76.39386547015953, 67.44859002381251, 80.70286946613315, 81.50362360858776, 95.1895628561571, 74.24296333482445, 63.05063882009478, 91.31049044580055, 85.47552995714067, 81.20038695371247, 77.35108183993269, 72.98566314836175, 78.48153947506223, 88.27678172953188, 85.8543766875491, 95.3986981831406, 69.57813978909351, 97.9634454466163, 66.24357767219973, 78.55609535222415, 62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8038821770390391, "mean_inference_ms": 2.3452426434923392, "mean_action_processing_ms": 0.4273784487975615, "mean_env_wait_ms": 2.5387120417448408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022600412368774414, "StateBufferConnector_ms": 0.004510641098022461, "ViewRequirementAgentConnector_ms": 0.22074007987976074}, "num_episodes": 22, "episode_return_max": 102.1701187087763, "episode_return_min": 53.73182183843844, "episode_return_mean": 80.35207575912372, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 435.0239260929743, "num_env_steps_trained_throughput_per_sec": 435.0239260929743, "timesteps_total": 12288, "num_env_steps_sampled_lifetime": 12288, "num_agent_steps_sampled_lifetime": 12288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 2740.875, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2740.875, "sample_time_ms": 1039.202, "learn_time_ms": 1678.478, "learn_throughput": 610.076, "synch_weights_time_ms": 23.094}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "training_iteration": 12, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-30", "timestamp": 1744167030, "time_this_iter_s": 2.36411452293396, "time_total_s": 33.66012501716614, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 33.66012501716614, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.400000000000002, "ram_util_percent": 97.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7215934336185454, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 1e-07, "total_loss": 2.0933530166745187, "policy_loss": -0.00023235109983943403, "vf_loss": 9.514411342144012, "vf_explained_var": 2.3348629474639894e-05, "kl": 1.3166808328968215e-06, "entropy": 2.850174751877785, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "env_runners": {"episode_reward_max": 102.1701187087763, "episode_reward_min": 53.73182183843844, "episode_reward_mean": 79.76839642133992, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.73182183843844}, "policy_reward_max": {"tplp_policy": 102.1701187087763}, "policy_reward_mean": {"tplp_policy": 79.76839642133992}, "custom_metrics": {"mean_episode_reward_mean": 79.76839642133992, "mean_episode_reward_min": 53.73182183843844, "mean_episode_reward_max": 102.1701187087763}, "hist_stats": {"episode_reward": [62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [62.83173061872464, 78.66298595126655, 69.65015316212036, 89.43202882433347, 99.34024713041781, 74.88506427131574, 82.85362069669202, 71.42494921603972, 80.91030935266897, 85.35622794057826, 78.37369326852446, 74.50020695118333, 79.91514602807538, 75.97968387224581, 83.0666492511367, 75.2953407436291, 84.27800030729702, 70.61159323146705, 65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7984836826531151, "mean_inference_ms": 2.3269732574167197, "mean_action_processing_ms": 0.4264244607428752, "mean_env_wait_ms": 2.524196228634401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022639036178588867, "StateBufferConnector_ms": 0.007005214691162109, "ViewRequirementAgentConnector_ms": 0.22551608085632324}, "num_episodes": 20, "episode_return_max": 102.1701187087763, "episode_return_min": 53.73182183843844, "episode_return_mean": 79.76839642133992, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.1816396156559, "num_env_steps_trained_throughput_per_sec": 437.1816396156559, "timesteps_total": 13312, "num_env_steps_sampled_lifetime": 13312, "num_agent_steps_sampled_lifetime": 13312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 2670.382, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2670.382, "sample_time_ms": 998.291, "learn_time_ms": 1649.12, "learn_throughput": 620.937, "synch_weights_time_ms": 22.971}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "training_iteration": 13, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-32", "timestamp": 1744167032, "time_this_iter_s": 2.3508121967315674, "time_total_s": 36.010937213897705, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.010937213897705, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.699999999999996, "ram_util_percent": 97.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4755375303328035, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 1e-07, "total_loss": 2.1396705865859986, "policy_loss": -0.00018417376559227706, "vf_loss": 9.699973809719086, "vf_explained_var": 2.045072615146637e-05, "kl": 1.2043886241430712e-06, "entropy": 2.8513868495821955, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "env_runners": {"episode_reward_max": 102.1701187087763, "episode_reward_min": 53.73182183843844, "episode_reward_mean": 79.59560571562174, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.73182183843844}, "policy_reward_max": {"tplp_policy": 102.1701187087763}, "policy_reward_mean": {"tplp_policy": 79.59560571562174}, "custom_metrics": {"mean_episode_reward_mean": 79.59560571562174, "mean_episode_reward_min": 53.73182183843844, "mean_episode_reward_max": 102.1701187087763}, "hist_stats": {"episode_reward": [65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.33957119927425, 88.37901785547758, 81.6453488390934, 97.88560789648244, 83.33497192000682, 82.87180140836044, 78.89942147657392, 90.90375591125955, 65.35317750989414, 101.70352247182113, 82.99600027310758, 93.47173871712077, 92.43101822950524, 83.03015601257754, 97.6112012787251, 78.00239426884825, 65.41661950124993, 80.02216004268718, 89.19810526269714, 77.3382131799403, 68.8902749684364, 73.40161842980126, 81.14166059037511, 92.94569116471337, 90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7936119608005275, "mean_inference_ms": 2.308493491750364, "mean_action_processing_ms": 0.4254413645975077, "mean_env_wait_ms": 2.505978117889185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021923065185546875, "StateBufferConnector_ms": 0.008008480072021484, "ViewRequirementAgentConnector_ms": 0.20270991325378418}, "num_episodes": 18, "episode_return_max": 102.1701187087763, "episode_return_min": 53.73182183843844, "episode_return_mean": 79.59560571562174, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 388.60488661472624, "num_env_steps_trained_throughput_per_sec": 388.60488661472624, "timesteps_total": 14336, "num_env_steps_sampled_lifetime": 14336, "num_agent_steps_sampled_lifetime": 14336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 2685.788, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2685.788, "sample_time_ms": 1000.473, "learn_time_ms": 1661.773, "learn_throughput": 616.209, "synch_weights_time_ms": 23.541}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "training_iteration": 14, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-35", "timestamp": 1744167035, "time_this_iter_s": 2.6428375244140625, "time_total_s": 38.65377473831177, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.65377473831177, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.975, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4900231547653675, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 1e-07, "total_loss": 2.1189993739128115, "policy_loss": -0.00015938803553581238, "vf_loss": 9.617899483442306, "vf_explained_var": 1.512281596660614e-05, "kl": 1.5058839851866957e-06, "entropy": 2.8531612724065782, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "env_runners": {"episode_reward_max": 102.1701187087763, "episode_reward_min": 53.73182183843844, "episode_reward_mean": 78.84825585844487, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.73182183843844}, "policy_reward_max": {"tplp_policy": 102.1701187087763}, "policy_reward_mean": {"tplp_policy": 78.84825585844487}, "custom_metrics": {"mean_episode_reward_mean": 78.84825585844487, "mean_episode_reward_min": 53.73182183843844, "mean_episode_reward_max": 102.1701187087763}, "hist_stats": {"episode_reward": [90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.79980278605248, 81.11943751465562, 77.362991964747, 67.5770554579308, 90.74534044410976, 98.48522015813127, 84.99968298596028, 99.40698846175415, 94.8374186326902, 75.33225812708746, 81.7783941767015, 81.21154884102043, 77.45111420861886, 66.7360579867159, 53.73182183843844, 73.02257538696027, 102.1701187087763, 79.33473597698716, 83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7810010062312205, "mean_inference_ms": 2.266123541086167, "mean_action_processing_ms": 0.42039324142740836, "mean_env_wait_ms": 2.4669228064579904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02412104606628418, "StateBufferConnector_ms": 0.008507966995239258, "ViewRequirementAgentConnector_ms": 0.19274568557739258}, "num_episodes": 24, "episode_return_max": 102.1701187087763, "episode_return_min": 53.73182183843844, "episode_return_mean": 78.84825585844487, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 435.7880712481887, "num_env_steps_trained_throughput_per_sec": 435.7880712481887, "timesteps_total": 15360, "num_env_steps_sampled_lifetime": 15360, "num_agent_steps_sampled_lifetime": 15360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 2673.935, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2673.935, "sample_time_ms": 995.714, "learn_time_ms": 1654.013, "learn_throughput": 619.1, "synch_weights_time_ms": 24.208}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "training_iteration": 15, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-37", "timestamp": 1744167037, "time_this_iter_s": 2.355215072631836, "time_total_s": 41.0089898109436, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.0089898109436, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.738621126115322, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 1e-07, "total_loss": 2.1464120715856554, "policy_loss": -0.00031512248096987605, "vf_loss": 9.728756189346313, "vf_explained_var": 1.2709200382232666e-05, "kl": 1.4865518556561596e-06, "entropy": 2.854618376493454, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "env_runners": {"episode_reward_max": 102.2571881010681, "episode_reward_min": 54.810268713173194, "episode_reward_mean": 78.82731177177676, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.810268713173194}, "policy_reward_max": {"tplp_policy": 102.2571881010681}, "policy_reward_mean": {"tplp_policy": 78.82731177177676}, "custom_metrics": {"mean_episode_reward_mean": 78.82731177177676, "mean_episode_reward_min": 54.810268713173194, "mean_episode_reward_max": 102.2571881010681}, "hist_stats": {"episode_reward": [83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.52608305382813, 61.039545876098074, 95.59075835560348, 85.46787934601181, 80.77411495992278, 78.87013118046032, 60.63791861602022, 59.27256930785595, 90.19905507119103, 73.2472853753846, 79.42912589096846, 80.40871971367265, 91.42844554581099, 57.958911386469865, 75.58562172813859, 97.84280391727363, 86.35450648786987, 60.07083754929228, 85.32457826769716, 59.28752113958432, 84.82363379525376, 82.09377787750013, 75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7710616378076257, "mean_inference_ms": 2.2345760468590368, "mean_action_processing_ms": 0.4162182366089573, "mean_env_wait_ms": 2.4377756853816477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02582097053527832, "StateBufferConnector_ms": 0.008015155792236328, "ViewRequirementAgentConnector_ms": 0.22191476821899414}, "num_episodes": 18, "episode_return_max": 102.2571881010681, "episode_return_min": 54.810268713173194, "episode_return_mean": 78.82731177177676, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 454.40185934827593, "num_env_steps_trained_throughput_per_sec": 454.40185934827593, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 16384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 2634.232, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2634.232, "sample_time_ms": 996.624, "learn_time_ms": 1614.354, "learn_throughput": 634.309, "synch_weights_time_ms": 23.254}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "training_iteration": 16, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-40", "timestamp": 1744167040, "time_this_iter_s": 2.26127290725708, "time_total_s": 43.270262718200684, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43.270262718200684, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 96.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6985197231173514, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 1e-07, "total_loss": 2.1268847920000553, "policy_loss": -0.00026418217166792604, "vf_loss": 9.650536727905273, "vf_explained_var": 1.3056397438049317e-05, "kl": 1.0243515105479161e-06, "entropy": 2.854851947724819, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "env_runners": {"episode_reward_max": 102.2571881010681, "episode_reward_min": 54.810268713173194, "episode_reward_mean": 79.51745884359524, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.810268713173194}, "policy_reward_max": {"tplp_policy": 102.2571881010681}, "policy_reward_mean": {"tplp_policy": 79.51745884359524}, "custom_metrics": {"mean_episode_reward_mean": 79.51745884359524, "mean_episode_reward_min": 54.810268713173194, "mean_episode_reward_max": 102.2571881010681}, "hist_stats": {"episode_reward": [75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [75.26642504225674, 68.14124893504274, 74.0219150958226, 83.36964084970384, 78.4844021582245, 84.64973392022597, 68.76237779907602, 63.746488421832254, 72.5095653353397, 83.55430944977587, 69.72872911030508, 85.47716449050063, 67.67458658615293, 87.01414218590284, 94.65965735093862, 70.65971674647426, 70.15191481661383, 84.05055651481293, 82.61298893445246, 85.15245742875453, 71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7606798333448205, "mean_inference_ms": 2.202381987353922, "mean_action_processing_ms": 0.41070323655092833, "mean_env_wait_ms": 2.409125054124261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010746479034423828, "StateBufferConnector_ms": 0.009513139724731445, "ViewRequirementAgentConnector_ms": 0.22033429145812988}, "num_episodes": 22, "episode_return_max": 102.2571881010681, "episode_return_min": 54.810268713173194, "episode_return_mean": 79.51745884359524, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 409.8307158198819, "num_env_steps_trained_throughput_per_sec": 409.8307158198819, "timesteps_total": 17408, "num_env_steps_sampled_lifetime": 17408, "num_agent_steps_sampled_lifetime": 17408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 2594.285, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2594.285, "sample_time_ms": 943.952, "learn_time_ms": 1626.363, "learn_throughput": 629.626, "synch_weights_time_ms": 23.969}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "training_iteration": 17, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-42", "timestamp": 1744167042, "time_this_iter_s": 2.508358955383301, "time_total_s": 45.778621673583984, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C809A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.778621673583984, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 42.76666666666667, "ram_util_percent": 96.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.381530807167292, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 1e-07, "total_loss": 2.1341547667980194, "policy_loss": -0.00018974045524373652, "vf_loss": 9.679816800355912, "vf_explained_var": 2.4063512682914734e-05, "kl": 1.8062330726389964e-06, "entropy": 2.8560969650745394, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "env_runners": {"episode_reward_max": 102.2571881010681, "episode_reward_min": 54.810268713173194, "episode_reward_mean": 80.2736085193706, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.810268713173194}, "policy_reward_max": {"tplp_policy": 102.2571881010681}, "policy_reward_mean": {"tplp_policy": 80.2736085193706}, "custom_metrics": {"mean_episode_reward_mean": 80.2736085193706, "mean_episode_reward_min": 54.810268713173194, "mean_episode_reward_max": 102.2571881010681}, "hist_stats": {"episode_reward": [71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [71.39039048941386, 88.22711082890635, 66.58713189915038, 78.1909656392421, 60.02080134882788, 82.67037290208063, 87.46061895447517, 82.50951491669798, 65.24030247468741, 75.82684086229416, 91.81283091050466, 98.33265888262255, 81.21105740015518, 67.33409345591079, 67.74629278572897, 67.76213013199207, 82.54606564393757, 100.84023441752693, 63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7541014035206072, "mean_inference_ms": 2.176295911735586, "mean_action_processing_ms": 0.4073359410760037, "mean_env_wait_ms": 2.388300551340068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011785030364990234, "StateBufferConnector_ms": 0.009549140930175781, "ViewRequirementAgentConnector_ms": 0.19989514350891113}, "num_episodes": 20, "episode_return_max": 102.2571881010681, "episode_return_min": 54.810268713173194, "episode_return_mean": 80.2736085193706, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 424.2314656108639, "num_env_steps_trained_throughput_per_sec": 424.2314656108639, "timesteps_total": 18432, "num_env_steps_sampled_lifetime": 18432, "num_agent_steps_sampled_lifetime": 18432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 2578.821, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2578.821, "sample_time_ms": 932.293, "learn_time_ms": 1622.166, "learn_throughput": 631.255, "synch_weights_time_ms": 24.259}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "training_iteration": 18, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-45", "timestamp": 1744167045, "time_this_iter_s": 2.419985294342041, "time_total_s": 48.198606967926025, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C802C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.198606967926025, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.325, "ram_util_percent": 96.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4393132872879506, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 1e-07, "total_loss": 2.138599679619074, "policy_loss": -0.0002086366293951869, "vf_loss": 9.698431539535523, "vf_explained_var": 1.212693750858307e-05, "kl": 1.2719965568841475e-06, "entropy": 2.857995630800724, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "env_runners": {"episode_reward_max": 102.2571881010681, "episode_reward_min": 53.697409703422025, "episode_reward_mean": 80.24477557914372, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.697409703422025}, "policy_reward_max": {"tplp_policy": 102.2571881010681}, "policy_reward_mean": {"tplp_policy": 80.24477557914372}, "custom_metrics": {"mean_episode_reward_mean": 80.24477557914372, "mean_episode_reward_min": 53.697409703422025, "mean_episode_reward_max": 102.2571881010681}, "hist_stats": {"episode_reward": [63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [63.08951083541904, 81.76918241769484, 67.8567181041216, 74.20907470102757, 93.36948755357902, 70.56539632019688, 78.73346466980249, 86.86535283080816, 65.01436170721718, 82.1159715971991, 86.06978598230766, 97.5859637442156, 58.060889259356706, 83.27591305465512, 83.55086676911485, 74.16236411119307, 99.03328382330014, 74.71619079487897, 84.32037187574616, 84.07725029284697, 65.77731308956626, 79.87304909463175, 84.89526533659323, 88.97091674249212, 89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7481159102228411, "mean_inference_ms": 2.1569921065822406, "mean_action_processing_ms": 0.40437367263445084, "mean_env_wait_ms": 2.370874879940611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010493993759155273, "StateBufferConnector_ms": 0.01054072380065918, "ViewRequirementAgentConnector_ms": 0.19638919830322266}, "num_episodes": 18, "episode_return_max": 102.2571881010681, "episode_return_min": 53.697409703422025, "episode_return_mean": 80.24477557914372, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 416.50934350548374, "num_env_steps_trained_throughput_per_sec": 416.50934350548374, "timesteps_total": 19456, "num_env_steps_sampled_lifetime": 19456, "num_agent_steps_sampled_lifetime": 19456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 2528.114, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2528.114, "sample_time_ms": 920.684, "learn_time_ms": 1583.144, "learn_throughput": 646.814, "synch_weights_time_ms": 24.079}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "training_iteration": 19, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-47", "timestamp": 1744167047, "time_this_iter_s": 2.465681791305542, "time_total_s": 50.66428875923157, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.66428875923157, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.333333333333336, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6545801050961018, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 1e-07, "total_loss": 2.1460827857255937, "policy_loss": -0.0002024894522037357, "vf_loss": 9.728912037611007, "vf_explained_var": 1.6259029507637024e-05, "kl": 1.6591283977795968e-06, "entropy": 2.8594274312257766, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "env_runners": {"episode_reward_max": 102.2571881010681, "episode_reward_min": 53.697409703422025, "episode_reward_mean": 80.37289716044471, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.697409703422025}, "policy_reward_max": {"tplp_policy": 102.2571881010681}, "policy_reward_mean": {"tplp_policy": 80.37289716044471}, "custom_metrics": {"mean_episode_reward_mean": 80.37289716044471, "mean_episode_reward_min": 53.697409703422025, "mean_episode_reward_max": 102.2571881010681}, "hist_stats": {"episode_reward": [89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [89.01946535853602, 64.56314489366373, 76.61319656400512, 63.33275018913098, 102.2571881010681, 86.81363272365799, 71.03590374235225, 89.43541993672558, 79.35617551843767, 80.86780383448033, 89.7487197111705, 80.46945320574831, 54.810268713173194, 88.13618566231304, 85.89255174905922, 97.79011300791835, 80.73143026054242, 94.44081594013979, 81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.740916887419683, "mean_inference_ms": 2.132563550336871, "mean_action_processing_ms": 0.40052507328085085, "mean_env_wait_ms": 2.3500695350738723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075054168701171875, "StateBufferConnector_ms": 0.011588096618652344, "ViewRequirementAgentConnector_ms": 0.19232702255249023}, "num_episodes": 24, "episode_return_max": 102.2571881010681, "episode_return_min": 53.697409703422025, "episode_return_mean": 80.37289716044471, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 411.1549037655662, "num_env_steps_trained_throughput_per_sec": 411.1549037655662, "timesteps_total": 20480, "num_env_steps_sampled_lifetime": 20480, "num_agent_steps_sampled_lifetime": 20480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 2436.531, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2436.531, "sample_time_ms": 866.187, "learn_time_ms": 1545.791, "learn_throughput": 662.444, "synch_weights_time_ms": 24.346}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "training_iteration": 20, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-50", "timestamp": 1744167050, "time_this_iter_s": 2.4980902671813965, "time_total_s": 53.162379026412964, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C818A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.162379026412964, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.3, "ram_util_percent": 96.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.369063991308212, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 1e-07, "total_loss": 2.1457855969667436, "policy_loss": -0.00017156725516542792, "vf_loss": 9.728071665763855, "vf_explained_var": 1.7518550157547e-05, "kl": 8.024024817698816e-07, "entropy": 2.8606074795126917, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "env_runners": {"episode_reward_max": 100.90504473588352, "episode_reward_min": 53.697409703422025, "episode_reward_mean": 79.86002794022158, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.697409703422025}, "policy_reward_max": {"tplp_policy": 100.90504473588352}, "policy_reward_mean": {"tplp_policy": 79.86002794022158}, "custom_metrics": {"mean_episode_reward_mean": 79.86002794022158, "mean_episode_reward_min": 53.697409703422025, "mean_episode_reward_max": 100.90504473588352}, "hist_stats": {"episode_reward": [81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [81.46379543405978, 96.29645750407177, 70.1602167209104, 62.40039965610404, 87.73841830721419, 90.53353914160817, 84.35317536104051, 74.64576804788035, 85.99302811828981, 85.0289549090659, 86.0872784116473, 87.6940528244392, 91.18907438095368, 65.69412229493837, 68.11528932924443, 73.24364266706601, 56.93563774715995, 82.03423808853017, 76.14742523676411, 97.32177124208481, 89.36861445591947, 76.194415776192, 77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7375243504586105, "mean_inference_ms": 2.11851579396573, "mean_action_processing_ms": 0.3980335614318538, "mean_env_wait_ms": 2.337211017855539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00449681282043457, "StateBufferConnector_ms": 0.01351475715637207, "ViewRequirementAgentConnector_ms": 0.16029572486877441}, "num_episodes": 18, "episode_return_max": 100.90504473588352, "episode_return_min": 53.697409703422025, "episode_return_mean": 79.86002794022158, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 414.7327817232679, "num_env_steps_trained_throughput_per_sec": 414.7327817232679, "timesteps_total": 21504, "num_env_steps_sampled_lifetime": 21504, "num_agent_steps_sampled_lifetime": 21504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2426.502, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2426.502, "sample_time_ms": 859.897, "learn_time_ms": 1541.89, "learn_throughput": 664.12, "synch_weights_time_ms": 24.509}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "training_iteration": 21, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-52", "timestamp": 1744167052, "time_this_iter_s": 2.4761860370635986, "time_total_s": 55.63856506347656, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 55.63856506347656, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 49.03333333333333, "ram_util_percent": 96.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5631685223430396, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 1e-07, "total_loss": 2.137842880934477, "policy_loss": -0.0001399198081344366, "vf_loss": 9.696582323312759, "vf_explained_var": 1.141577959060669e-05, "kl": 1.2335523079443077e-06, "entropy": 2.8616276144981385, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "env_runners": {"episode_reward_max": 100.90504473588352, "episode_reward_min": 53.697409703422025, "episode_reward_mean": 80.25832213947947, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.697409703422025}, "policy_reward_max": {"tplp_policy": 100.90504473588352}, "policy_reward_mean": {"tplp_policy": 80.25832213947947}, "custom_metrics": {"mean_episode_reward_mean": 80.25832213947947, "mean_episode_reward_min": 53.697409703422025, "mean_episode_reward_max": 100.90504473588352}, "hist_stats": {"episode_reward": [77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.96655863132872, 77.62580743338712, 85.80365564279032, 67.73118382999397, 73.07588839702804, 78.13585344136507, 76.39695453682768, 72.5815576810408, 68.9470320737638, 67.528153727522, 80.66218847125002, 90.37641962487164, 84.9225520845564, 93.56023657574141, 97.14371861265253, 97.85568634187935, 95.07546831806417, 74.35104309357251, 53.697409703422025, 80.24745017350934, 88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7338729111618146, "mean_inference_ms": 2.1032442552882444, "mean_action_processing_ms": 0.3957906514137221, "mean_env_wait_ms": 2.3232371722246863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008628129959106445, "StateBufferConnector_ms": 0.012508869171142578, "ViewRequirementAgentConnector_ms": 0.16178107261657715}, "num_episodes": 22, "episode_return_max": 100.90504473588352, "episode_return_min": 53.697409703422025, "episode_return_mean": 80.25832213947947, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.6004813844792, "num_env_steps_trained_throughput_per_sec": 422.6004813844792, "timesteps_total": 22528, "num_env_steps_sampled_lifetime": 22528, "num_agent_steps_sampled_lifetime": 22528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 2433.422, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2433.422, "sample_time_ms": 865.311, "learn_time_ms": 1544.191, "learn_throughput": 663.13, "synch_weights_time_ms": 23.714}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "training_iteration": 22, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-55", "timestamp": 1744167055, "time_this_iter_s": 2.429931879043579, "time_total_s": 58.06849694252014, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.06849694252014, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 96.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.339547389373183, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 1e-07, "total_loss": 2.1369499795138838, "policy_loss": -0.00016392715042456985, "vf_loss": 9.693707394599915, "vf_explained_var": 1.1265277862548828e-05, "kl": 1.0788976605446976e-06, "entropy": 2.863129477202892, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "env_runners": {"episode_reward_max": 100.90504473588352, "episode_reward_min": 55.89657169474861, "episode_reward_mean": 79.52996307694508, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.89657169474861}, "policy_reward_max": {"tplp_policy": 100.90504473588352}, "policy_reward_mean": {"tplp_policy": 79.52996307694508}, "custom_metrics": {"mean_episode_reward_mean": 79.52996307694508, "mean_episode_reward_min": 55.89657169474861, "mean_episode_reward_max": 100.90504473588352}, "hist_stats": {"episode_reward": [88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.91644369450317, 82.97826632011046, 76.31701012703824, 73.1938362973644, 80.96645258442028, 73.49397935199525, 73.75703686554442, 83.77092051322866, 67.21512823055068, 80.63710581221127, 72.76142329380579, 81.64196813677935, 94.777200694768, 86.5037813291499, 67.51062830675423, 94.44007848630783, 92.83093120373992, 74.93876201871356, 70.7138808234016, 98.94507932271907, 85.53297871650203, 87.56312876484425, 83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7298837762848156, "mean_inference_ms": 2.09252772159812, "mean_action_processing_ms": 0.3931856275523033, "mean_env_wait_ms": 2.3131910962533424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007836580276489258, "StateBufferConnector_ms": 0.01348733901977539, "ViewRequirementAgentConnector_ms": 0.1761643886566162}, "num_episodes": 20, "episode_return_max": 100.90504473588352, "episode_return_min": 55.89657169474861, "episode_return_mean": 79.52996307694508, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 412.83186321137384, "num_env_steps_trained_throughput_per_sec": 412.83186321137384, "timesteps_total": 23552, "num_env_steps_sampled_lifetime": 23552, "num_agent_steps_sampled_lifetime": 23552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 2447.237, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2447.237, "sample_time_ms": 874.674, "learn_time_ms": 1548.656, "learn_throughput": 661.218, "synch_weights_time_ms": 23.646}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "training_iteration": 23, "trial_id": "374cd_00000", "date": "2025-04-09_10-50-57", "timestamp": 1744167057, "time_this_iter_s": 2.4882707595825195, "time_total_s": 60.55676770210266, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BA6B70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.55676770210266, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.699999999999996, "ram_util_percent": 96.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.44042810536921, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 1e-07, "total_loss": 2.1134627416729925, "policy_loss": -0.00018826831365004182, "vf_loss": 9.60026375055313, "vf_explained_var": 6.074085831642151e-06, "kl": 1.2513934504410074e-06, "entropy": 2.8641493394970894, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "env_runners": {"episode_reward_max": 100.90504473588352, "episode_reward_min": 55.89657169474861, "episode_reward_mean": 78.90283589808762, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.89657169474861}, "policy_reward_max": {"tplp_policy": 100.90504473588352}, "policy_reward_mean": {"tplp_policy": 78.90283589808762}, "custom_metrics": {"mean_episode_reward_mean": 78.90283589808762, "mean_episode_reward_min": 55.89657169474861, "mean_episode_reward_max": 100.90504473588352}, "hist_stats": {"episode_reward": [83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.80593810033237, 81.71718508687488, 100.90504473588352, 72.96853582538249, 80.15684838502955, 88.51405415941487, 70.113681528492, 83.46565522119069, 66.7101086981056, 70.02650927402205, 70.39835043254311, 63.96509027897461, 91.43748867750479, 88.2222233454175, 82.22079221223397, 64.02836491453685, 74.14238300458666, 77.44708810761863, 83.95422751893292, 69.46845722549506, 80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7263139341262864, "mean_inference_ms": 2.0806400014997033, "mean_action_processing_ms": 0.3903575833459582, "mean_env_wait_ms": 2.3009506086868985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009864568710327148, "StateBufferConnector_ms": 0.010495424270629883, "ViewRequirementAgentConnector_ms": 0.18080949783325195}, "num_episodes": 22, "episode_return_max": 100.90504473588352, "episode_return_min": 55.89657169474861, "episode_return_mean": 78.90283589808762, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 429.84455981780457, "num_env_steps_trained_throughput_per_sec": 429.84455981780457, "timesteps_total": 24576, "num_env_steps_sampled_lifetime": 24576, "num_agent_steps_sampled_lifetime": 24576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 2421.956, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2421.956, "sample_time_ms": 861.45, "learn_time_ms": 1537.588, "learn_throughput": 665.978, "synch_weights_time_ms": 22.658}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "training_iteration": 24, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-00", "timestamp": 1744167060, "time_this_iter_s": 2.388274908065796, "time_total_s": 62.94504261016846, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.94504261016846, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.65, "ram_util_percent": 96.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.139253423735499, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 1e-07, "total_loss": 2.125954119861126, "policy_loss": -0.00017785681993700563, "vf_loss": 9.65076515674591, "vf_explained_var": 6.6749751567840574e-06, "kl": 1.3102466144498948e-06, "entropy": 2.865593135356903, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "env_runners": {"episode_reward_max": 104.43872896393094, "episode_reward_min": 55.89657169474861, "episode_reward_mean": 79.07060171492732, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.89657169474861}, "policy_reward_max": {"tplp_policy": 104.43872896393094}, "policy_reward_mean": {"tplp_policy": 79.07060171492732}, "custom_metrics": {"mean_episode_reward_mean": 79.07060171492732, "mean_episode_reward_min": 55.89657169474861, "mean_episode_reward_max": 104.43872896393094}, "hist_stats": {"episode_reward": [80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.95482517557866, 94.43390071552402, 61.313401940194886, 83.54312119813318, 80.10971139192193, 67.6583663304742, 81.88414881153744, 80.6736434945722, 82.71665154431844, 87.97732072089823, 66.62557539413747, 85.10129180963561, 91.38497386074962, 89.61562883366182, 76.11966094451606, 60.49239017952846, 76.86175645100653, 72.24542091023261, 78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7233947038020816, "mean_inference_ms": 2.070940056771766, "mean_action_processing_ms": 0.38867606112513636, "mean_env_wait_ms": 2.294679617880516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01065516471862793, "StateBufferConnector_ms": 0.020447492599487305, "ViewRequirementAgentConnector_ms": 0.17838191986083984}, "num_episodes": 20, "episode_return_max": 104.43872896393094, "episode_return_min": 55.89657169474861, "episode_return_mean": 79.07060171492732, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 430.55598343043556, "num_env_steps_trained_throughput_per_sec": 430.55598343043556, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 25600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 2424.811, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2424.811, "sample_time_ms": 870.635, "learn_time_ms": 1531.641, "learn_throughput": 668.564, "synch_weights_time_ms": 22.275}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "training_iteration": 25, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-02", "timestamp": 1744167062, "time_this_iter_s": 2.3860931396484375, "time_total_s": 65.3311357498169, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.3311357498169, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 43.900000000000006, "ram_util_percent": 96.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3782645642757414, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 1e-07, "total_loss": 2.136997803300619, "policy_loss": -0.00016324210446327925, "vf_loss": 9.6956396818161, "vf_explained_var": 5.124881863594055e-06, "kl": 1.7225437720203019e-06, "entropy": 2.8674886584281922, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "env_runners": {"episode_reward_max": 104.43872896393094, "episode_reward_min": 55.89657169474861, "episode_reward_mean": 79.09831848520899, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.89657169474861}, "policy_reward_max": {"tplp_policy": 104.43872896393094}, "policy_reward_mean": {"tplp_policy": 79.09831848520899}, "custom_metrics": {"mean_episode_reward_mean": 79.09831848520899, "mean_episode_reward_min": 55.89657169474861, "mean_episode_reward_max": 104.43872896393094}, "hist_stats": {"episode_reward": [78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.36149049501553, 86.0505712216572, 91.2489357807032, 71.33550035038219, 90.82678394994826, 73.73575447622578, 89.44267685146265, 93.13836686438496, 96.93668562554512, 71.82811590423425, 72.20758093390313, 83.9153394084052, 75.45931485214311, 93.9528984294501, 77.16133055440416, 75.73367005695759, 77.46099381408196, 93.45885628614442, 83.31763995764041, 83.7890524070462, 79.7024169046914, 89.86595106807718, 70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7202055616477113, "mean_inference_ms": 2.0622483215862273, "mean_action_processing_ms": 0.3871289470242106, "mean_env_wait_ms": 2.287540827844612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01463627815246582, "StateBufferConnector_ms": 0.017017841339111328, "ViewRequirementAgentConnector_ms": 0.17078089714050293}, "num_episodes": 18, "episode_return_max": 104.43872896393094, "episode_return_min": 55.89657169474861, "episode_return_mean": 79.09831848520899, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 423.5287019550115, "num_env_steps_trained_throughput_per_sec": 423.5287019550115, "timesteps_total": 26624, "num_env_steps_sampled_lifetime": 26624, "num_agent_steps_sampled_lifetime": 26624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 2441.238, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2441.238, "sample_time_ms": 869.732, "learn_time_ms": 1548.582, "learn_throughput": 661.25, "synch_weights_time_ms": 22.664}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "training_iteration": 26, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-05", "timestamp": 1744167065, "time_this_iter_s": 2.4240784645080566, "time_total_s": 67.75521421432495, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C814E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67.75521421432495, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.575, "ram_util_percent": 96.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.428691589087248, "cur_kl_coeff": 2.980232238769531e-09, "cur_lr": 1e-07, "total_loss": 2.096641182899475, "policy_loss": -0.00023606583126820624, "vf_loss": 9.53494010567665, "vf_explained_var": 3.3389776945114134e-06, "kl": 9.251450379554881e-07, "entropy": 2.8685777977108957, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "env_runners": {"episode_reward_max": 104.43872896393094, "episode_reward_min": 55.89657169474861, "episode_reward_mean": 78.04071573848182, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.89657169474861}, "policy_reward_max": {"tplp_policy": 104.43872896393094}, "policy_reward_mean": {"tplp_policy": 78.04071573848182}, "custom_metrics": {"mean_episode_reward_mean": 78.04071573848182, "mean_episode_reward_min": 55.89657169474861, "mean_episode_reward_max": 104.43872896393094}, "hist_stats": {"episode_reward": [70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [70.05425283811135, 67.20817479871155, 81.42571405616546, 67.04154881717704, 76.31831343371586, 55.89657169474861, 79.73721856255331, 59.9857847301323, 72.00760214257038, 89.82577815311097, 89.3939432953706, 92.0671951468851, 83.01776426118825, 74.41731810682744, 72.04256993781075, 66.01132497358844, 77.81252833274917, 77.01694088694262, 78.02399800089134, 64.49082982330893, 64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7166815250919534, "mean_inference_ms": 2.0527909997599085, "mean_action_processing_ms": 0.38529403294052395, "mean_env_wait_ms": 2.2794639466541766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013840675354003906, "StateBufferConnector_ms": 0.01600170135498047, "ViewRequirementAgentConnector_ms": 0.17629361152648926}, "num_episodes": 22, "episode_return_max": 104.43872896393094, "episode_return_min": 55.89657169474861, "episode_return_mean": 78.04071573848182, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 408.16167012474256, "num_env_steps_trained_throughput_per_sec": 408.16167012474256, "timesteps_total": 27648, "num_env_steps_sampled_lifetime": 27648, "num_agent_steps_sampled_lifetime": 27648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 2442.26, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2442.26, "sample_time_ms": 873.205, "learn_time_ms": 1546.408, "learn_throughput": 662.18, "synch_weights_time_ms": 22.386}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "training_iteration": 27, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-07", "timestamp": 1744167067, "time_this_iter_s": 2.5164942741394043, "time_total_s": 70.27170848846436, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C809A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.27170848846436, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 37.93333333333333, "ram_util_percent": 96.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.611344854533672, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 1e-07, "total_loss": 2.115734625607729, "policy_loss": -0.0002956140087917447, "vf_loss": 9.611459857225418, "vf_explained_var": 2.061575651168823e-06, "kl": 1.1751137451554428e-06, "entropy": 2.8683471471071242, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "env_runners": {"episode_reward_max": 104.43872896393094, "episode_reward_min": 51.930645153679386, "episode_reward_mean": 78.81405368390969, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.930645153679386}, "policy_reward_max": {"tplp_policy": 104.43872896393094}, "policy_reward_mean": {"tplp_policy": 78.81405368390969}, "custom_metrics": {"mean_episode_reward_mean": 78.81405368390969, "mean_episode_reward_min": 51.930645153679386, "mean_episode_reward_max": 104.43872896393094}, "hist_stats": {"episode_reward": [64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [64.49808292761638, 88.3291264176578, 76.00008643268993, 79.84095705920906, 69.70797168811018, 76.13410702494942, 92.03694412722781, 83.8065561069525, 73.79716680351527, 75.88935948116611, 81.65777307720865, 84.93940227303912, 62.781172932697324, 86.59137978340368, 77.01463441161384, 91.19168049715216, 85.40056512859967, 68.50375252778089, 83.0882080253279, 82.96954845858725, 74.40829458244981, 78.03163535316146, 59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7137167080722017, "mean_inference_ms": 2.044820981127967, "mean_action_processing_ms": 0.3836666782759404, "mean_env_wait_ms": 2.2718253847954615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013334274291992188, "StateBufferConnector_ms": 0.014010190963745117, "ViewRequirementAgentConnector_ms": 0.18823528289794922}, "num_episodes": 20, "episode_return_max": 104.43872896393094, "episode_return_min": 51.930645153679386, "episode_return_mean": 78.81405368390969, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 435.9115605336572, "num_env_steps_trained_throughput_per_sec": 435.9115605336572, "timesteps_total": 28672, "num_env_steps_sampled_lifetime": 28672, "num_agent_steps_sampled_lifetime": 28672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 2435.792, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2435.693, "sample_time_ms": 872.824, "learn_time_ms": 1540.674, "learn_throughput": 664.644, "synch_weights_time_ms": 22.037}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "training_iteration": 28, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-10", "timestamp": 1744167070, "time_this_iter_s": 2.355849266052246, "time_total_s": 72.6275577545166, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.6275577545166, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.074999999999996, "ram_util_percent": 96.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5519281651824715, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 1e-07, "total_loss": 2.1379259623587132, "policy_loss": -0.0002829723176546395, "vf_loss": 9.700102031230927, "vf_explained_var": 4.738569259643555e-07, "kl": 1.1302279765201816e-06, "entropy": 2.868165782094002, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "env_runners": {"episode_reward_max": 104.43872896393094, "episode_reward_min": 51.930645153679386, "episode_reward_mean": 79.78395604434775, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.930645153679386}, "policy_reward_max": {"tplp_policy": 104.43872896393094}, "policy_reward_mean": {"tplp_policy": 79.78395604434775}, "custom_metrics": {"mean_episode_reward_mean": 79.78395604434775, "mean_episode_reward_min": 51.930645153679386, "mean_episode_reward_max": 104.43872896393094}, "hist_stats": {"episode_reward": [59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [59.98144115445905, 72.79126429988729, 97.6712695285686, 104.43872896393094, 98.59248486755824, 70.41404560877082, 63.91916247528835, 83.94122401322697, 62.88337684367396, 80.45027814863889, 71.43451383109067, 81.3169536884317, 83.31177365551548, 74.6751796141925, 74.74938278700833, 87.64054243798797, 86.06309489492553, 73.7299616677767, 80.77133057451066, 77.52090965096576, 76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7110877664087323, "mean_inference_ms": 2.0364494954696735, "mean_action_processing_ms": 0.38177065575906305, "mean_env_wait_ms": 2.264083472755663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015315055847167969, "StateBufferConnector_ms": 0.015097856521606445, "ViewRequirementAgentConnector_ms": 0.2022106647491455}, "num_episodes": 22, "episode_return_max": 104.43872896393094, "episode_return_min": 51.930645153679386, "episode_return_mean": 79.78395604434775, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.17652531274365, "num_env_steps_trained_throughput_per_sec": 443.17652531274365, "timesteps_total": 29696, "num_env_steps_sampled_lifetime": 29696, "num_agent_steps_sampled_lifetime": 29696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 2420.999, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2420.899, "sample_time_ms": 864.203, "learn_time_ms": 1534.987, "learn_throughput": 667.107, "synch_weights_time_ms": 21.552}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "training_iteration": 29, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-12", "timestamp": 1744167072, "time_this_iter_s": 2.3179123401641846, "time_total_s": 74.94547009468079, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C814E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.94547009468079, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.96666666666667, "ram_util_percent": 96.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6605535216629503, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 1e-07, "total_loss": 2.1207325622439384, "policy_loss": -0.00027707187982741745, "vf_loss": 9.631501770019531, "vf_explained_var": -6.489455699920654e-07, "kl": 1.6639402273810333e-06, "entropy": 2.868658170104027, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "env_runners": {"episode_reward_max": 100.2955922479566, "episode_reward_min": 51.930645153679386, "episode_reward_mean": 80.21526968611035, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.930645153679386}, "policy_reward_max": {"tplp_policy": 100.2955922479566}, "policy_reward_mean": {"tplp_policy": 80.21526968611035}, "custom_metrics": {"mean_episode_reward_mean": 80.21526968611035, "mean_episode_reward_min": 51.930645153679386, "mean_episode_reward_max": 100.2955922479566}, "hist_stats": {"episode_reward": [76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [76.20502351801234, 70.71415793585412, 59.44676937523273, 89.15918670236947, 71.71396023963902, 78.3691583374864, 85.31968482518178, 85.19529981104148, 79.33612066780714, 77.67250737535502, 75.35634262246067, 76.53935913398408, 90.86980597087403, 100.2955922479566, 84.69885487389645, 63.29940287215902, 74.21111954445566, 69.42278800259494, 83.05047898421188, 75.47035051489112, 79.79645454612319, 70.79078126072655, 88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7081537152618594, "mean_inference_ms": 2.0284892643259593, "mean_action_processing_ms": 0.37999779584335913, "mean_env_wait_ms": 2.2554363346075395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014461040496826172, "StateBufferConnector_ms": 0.0030930042266845703, "ViewRequirementAgentConnector_ms": 0.21027159690856934}, "num_episodes": 20, "episode_return_max": 100.2955922479566, "episode_return_min": 51.930645153679386, "episode_return_mean": 80.21526968611035, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.31010603546747, "num_env_steps_trained_throughput_per_sec": 417.31010603546747, "timesteps_total": 30720, "num_env_steps_sampled_lifetime": 30720, "num_agent_steps_sampled_lifetime": 30720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 2417.325, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2417.125, "sample_time_ms": 868.306, "learn_time_ms": 1525.789, "learn_throughput": 671.128, "synch_weights_time_ms": 22.768}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "training_iteration": 30, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-15", "timestamp": 1744167075, "time_this_iter_s": 2.4735677242279053, "time_total_s": 77.41903781890869, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC39C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.41903781890869, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.750000000000004, "ram_util_percent": 96.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.185883418098092, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 1e-07, "total_loss": 2.133222106844187, "policy_loss": -0.00015931659727357327, "vf_loss": 9.681645601987839, "vf_explained_var": -1.0866671800613403e-06, "kl": 1.4654186995644026e-06, "entropy": 2.870299643278122, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "env_runners": {"episode_reward_max": 99.37527680503305, "episode_reward_min": 51.930645153679386, "episode_reward_mean": 81.19868447434902, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.930645153679386}, "policy_reward_max": {"tplp_policy": 99.37527680503305}, "policy_reward_mean": {"tplp_policy": 81.19868447434902}, "custom_metrics": {"mean_episode_reward_mean": 81.19868447434902, "mean_episode_reward_min": 51.930645153679386, "mean_episode_reward_max": 99.37527680503305}, "hist_stats": {"episode_reward": [88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.91374004837229, 77.31452551730786, 72.33119595792819, 83.36755896227332, 90.72104581278201, 99.37527680503305, 66.50624273794023, 71.32073859854344, 67.53510536536285, 88.48083994664493, 75.4717487095976, 78.2174414326434, 82.88224249688636, 66.07227135044656, 77.17487005461095, 84.74283487041043, 81.54598146183992, 90.84128249723538, 73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7098425470226042, "mean_inference_ms": 2.0314145001401007, "mean_action_processing_ms": 0.38060414242177715, "mean_env_wait_ms": 2.2554305259552536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012008428573608398, "StateBufferConnector_ms": 0.0031065940856933594, "ViewRequirementAgentConnector_ms": 0.25304603576660156}, "num_episodes": 22, "episode_return_max": 99.37527680503305, "episode_return_min": 51.930645153679386, "episode_return_mean": 81.19868447434902, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 306.32282192295315, "num_env_steps_trained_throughput_per_sec": 306.32282192295315, "timesteps_total": 31744, "num_env_steps_sampled_lifetime": 31744, "num_agent_steps_sampled_lifetime": 31744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 2504.707, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2504.507, "sample_time_ms": 924.23, "learn_time_ms": 1556.706, "learn_throughput": 657.799, "synch_weights_time_ms": 23.308}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "training_iteration": 31, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-18", "timestamp": 1744167078, "time_this_iter_s": 3.3526675701141357, "time_total_s": 80.77170538902283, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.77170538902283, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.78000000000001, "ram_util_percent": 96.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.583838597685099, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 1e-07, "total_loss": 2.1353295162320136, "policy_loss": -0.00023871842422522603, "vf_loss": 9.691189557313919, "vf_explained_var": -3.713741898536682e-06, "kl": 1.6781893944717297e-06, "entropy": 2.8722914308309555, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "env_runners": {"episode_reward_max": 98.84055068751113, "episode_reward_min": 51.930645153679386, "episode_reward_mean": 80.6473013247361, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.930645153679386}, "policy_reward_max": {"tplp_policy": 98.84055068751113}, "policy_reward_mean": {"tplp_policy": 80.6473013247361}, "custom_metrics": {"mean_episode_reward_mean": 80.6473013247361, "mean_episode_reward_min": 51.930645153679386, "mean_episode_reward_max": 98.84055068751113}, "hist_stats": {"episode_reward": [73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [73.56482990754355, 94.09821437619549, 57.75019173241176, 76.71955827937278, 68.14499384567127, 81.78300732519608, 85.27681249880838, 83.40057843417922, 90.7241460233244, 81.3060075932463, 70.2958359290134, 80.11253899719597, 97.05689046621742, 78.73931117661391, 78.15008157700638, 75.89244251261788, 73.79581674797917, 51.930645153679386, 75.58958129678808, 78.87337018986734, 88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7124096201621115, "mean_inference_ms": 2.0370867946292064, "mean_action_processing_ms": 0.38206442906402116, "mean_env_wait_ms": 2.261698722644178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009009599685668945, "StateBufferConnector_ms": 0.0031065940856933594, "ViewRequirementAgentConnector_ms": 0.2881901264190674}, "num_episodes": 18, "episode_return_max": 98.84055068751113, "episode_return_min": 51.930645153679386, "episode_return_mean": 80.6473013247361, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 341.2871969920728, "num_env_steps_trained_throughput_per_sec": 341.2871969920728, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 32768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 2562.438, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2562.239, "sample_time_ms": 958.609, "learn_time_ms": 1579.832, "learn_throughput": 648.17, "synch_weights_time_ms": 23.534}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "training_iteration": 32, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-21", "timestamp": 1744167081, "time_this_iter_s": 3.0078978538513184, "time_total_s": 83.77960324287415, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.77960324287415, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 48.5, "ram_util_percent": 96.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3635888498276474, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 1e-07, "total_loss": 2.1174267269670963, "policy_loss": -0.00021733580506406726, "vf_loss": 9.620034682750703, "vf_explained_var": -4.539638757705688e-06, "kl": 1.0778189932558745e-06, "entropy": 2.8736460387706755, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "env_runners": {"episode_reward_max": 102.3663782243648, "episode_reward_min": 55.74615001115453, "episode_reward_mean": 80.96002121336136, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.74615001115453}, "policy_reward_max": {"tplp_policy": 102.3663782243648}, "policy_reward_mean": {"tplp_policy": 80.96002121336136}, "custom_metrics": {"mean_episode_reward_mean": 80.96002121336136, "mean_episode_reward_min": 55.74615001115453, "mean_episode_reward_max": 102.3663782243648}, "hist_stats": {"episode_reward": [88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.3377566527127, 89.24467700234776, 81.4519239352426, 84.22289393261737, 71.84332471124368, 86.66019516400063, 81.11976451052915, 84.56512372076457, 78.30206712611056, 93.09997256621614, 85.19692003770477, 75.75682621688281, 97.1796487528842, 66.43079714609699, 90.21458878341761, 76.73495551295917, 89.34542113079401, 84.18753712995714, 85.32277955827095, 89.92851608651236, 92.08546728211732, 82.05223084407389, 73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7161747769484046, "mean_inference_ms": 2.045679470953897, "mean_action_processing_ms": 0.3839465288618604, "mean_env_wait_ms": 2.2696374827588848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012050867080688477, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.286243200302124}, "num_episodes": 20, "episode_return_max": 102.3663782243648, "episode_return_min": 55.74615001115453, "episode_return_mean": 80.96002121336136, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 393.8778079941572, "num_env_steps_trained_throughput_per_sec": 393.8778079941572, "timesteps_total": 33792, "num_env_steps_sampled_lifetime": 33792, "num_agent_steps_sampled_lifetime": 33792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 2574.375, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2574.175, "sample_time_ms": 968.648, "learn_time_ms": 1581.605, "learn_throughput": 647.443, "synch_weights_time_ms": 23.612}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "training_iteration": 33, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-24", "timestamp": 1744167084, "time_this_iter_s": 2.6078131198883057, "time_total_s": 86.38741636276245, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 86.38741636276245, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.925, "ram_util_percent": 96.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.769236846268177, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 1e-07, "total_loss": 2.1123412281274794, "policy_loss": -0.00030029943445697427, "vf_loss": 9.600266647338866, "vf_explained_var": -3.993883728981018e-06, "kl": 1.303293668797334e-06, "entropy": 2.8742511451244352, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "env_runners": {"episode_reward_max": 104.52751279455354, "episode_reward_min": 55.74615001115453, "episode_reward_mean": 80.48689980873286, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.74615001115453}, "policy_reward_max": {"tplp_policy": 104.52751279455354}, "policy_reward_mean": {"tplp_policy": 80.48689980873286}, "custom_metrics": {"mean_episode_reward_mean": 80.48689980873286, "mean_episode_reward_min": 55.74615001115453, "mean_episode_reward_max": 104.52751279455354}, "hist_stats": {"episode_reward": [73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [73.72431270064361, 82.57172355471855, 74.65183087427583, 69.18917073714992, 92.13580718561344, 66.88566741238515, 68.19696153889366, 87.37511771351731, 90.09226963173867, 87.08316040289715, 96.10405201018399, 86.39149602099695, 61.34108786814216, 86.76425539009433, 87.4206439063956, 74.58557145736879, 84.29070909468817, 86.48674725677397, 92.46960075719832, 86.56926546261116, 93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.721277398900458, "mean_inference_ms": 2.058387943004763, "mean_action_processing_ms": 0.38730086901364785, "mean_env_wait_ms": 2.281399891148419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010035514831542969, "StateBufferConnector_ms": 0.0039141178131103516, "ViewRequirementAgentConnector_ms": 0.3021566867828369}, "num_episodes": 22, "episode_return_max": 104.52751279455354, "episode_return_min": 55.74615001115453, "episode_return_mean": 80.48689980873286, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 357.68126966741465, "num_env_steps_trained_throughput_per_sec": 357.68126966741465, "timesteps_total": 34816, "num_env_steps_sampled_lifetime": 34816, "num_agent_steps_sampled_lifetime": 34816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 2622.437, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2622.238, "sample_time_ms": 993.047, "learn_time_ms": 1604.468, "learn_throughput": 638.218, "synch_weights_time_ms": 24.413}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "training_iteration": 34, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-27", "timestamp": 1744167087, "time_this_iter_s": 2.8692703247070312, "time_total_s": 89.25668668746948, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.25668668746948, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 41.225, "ram_util_percent": 97.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7753452017903326, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 1e-07, "total_loss": 2.126576063036919, "policy_loss": -0.0002611846604850143, "vf_loss": 9.657481378316879, "vf_explained_var": -7.095932960510254e-06, "kl": 1.724168223038447e-06, "entropy": 2.875330902636051, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "env_runners": {"episode_reward_max": 107.48525659867052, "episode_reward_min": 55.74615001115453, "episode_reward_mean": 80.19023340808437, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.74615001115453}, "policy_reward_max": {"tplp_policy": 107.48525659867052}, "policy_reward_mean": {"tplp_policy": 80.19023340808437}, "custom_metrics": {"mean_episode_reward_mean": 80.19023340808437, "mean_episode_reward_min": 55.74615001115453, "mean_episode_reward_max": 107.48525659867052}, "hist_stats": {"episode_reward": [93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [93.68301802961422, 89.94102005722578, 73.07446986832582, 72.95517933706427, 90.21772537318944, 76.51006343972983, 77.7555075695626, 94.16237530827361, 89.75407045948738, 85.95553703346863, 77.20237339894766, 84.04904611314487, 79.27138523421773, 85.04658098512326, 72.56063800091293, 75.44294556568114, 87.7088903120969, 89.95331281685962, 70.97325179304177, 70.01842127040493, 61.28485120171586, 83.11962916197459, 66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7256250496984558, "mean_inference_ms": 2.0695983680295256, "mean_action_processing_ms": 0.3895893164158258, "mean_env_wait_ms": 2.2927993079653466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010833978652954102, "StateBufferConnector_ms": 0.0039141178131103516, "ViewRequirementAgentConnector_ms": 0.3098478317260742}, "num_episodes": 20, "episode_return_max": 107.48525659867052, "episode_return_min": 55.74615001115453, "episode_return_mean": 80.19023340808437, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 405.64983340840354, "num_env_steps_trained_throughput_per_sec": 405.64983340840354, "timesteps_total": 35840, "num_env_steps_sampled_lifetime": 35840, "num_agent_steps_sampled_lifetime": 35840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 2637.04, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2636.84, "sample_time_ms": 989.544, "learn_time_ms": 1622.051, "learn_throughput": 631.3, "synch_weights_time_ms": 24.936}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "training_iteration": 35, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-29", "timestamp": 1744167089, "time_this_iter_s": 2.5316250324249268, "time_total_s": 91.78831171989441, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.78831171989441, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 39.574999999999996, "ram_util_percent": 96.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3628063086420297, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 1e-07, "total_loss": 2.1090800046920775, "policy_loss": -0.00015564499772153796, "vf_loss": 9.587776958942413, "vf_explained_var": -1.0978057980537415e-05, "kl": 1.441250887967982e-06, "entropy": 2.877086102962494, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "env_runners": {"episode_reward_max": 107.48525659867052, "episode_reward_min": 55.74615001115453, "episode_reward_mean": 79.97289733831506, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.74615001115453}, "policy_reward_max": {"tplp_policy": 107.48525659867052}, "policy_reward_mean": {"tplp_policy": 79.97289733831506}, "custom_metrics": {"mean_episode_reward_mean": 79.97289733831506, "mean_episode_reward_min": 55.74615001115453, "mean_episode_reward_max": 107.48525659867052}, "hist_stats": {"episode_reward": [66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [66.59695442842825, 85.01994631955097, 62.114716629995435, 71.11200930935492, 71.31648640987726, 62.21738847833285, 98.84055068751113, 69.81734105019238, 83.85963866851372, 84.30787663858328, 79.5032201005356, 71.59320442327856, 79.72372476912332, 87.2777030412948, 81.13869209468646, 88.832694251617, 60.628427578516494, 89.92820011421784, 61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7272838067339091, "mean_inference_ms": 2.0731013147015727, "mean_action_processing_ms": 0.3902684511895718, "mean_env_wait_ms": 2.2963931654390835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010120630264282227, "StateBufferConnector_ms": 0.00490260124206543, "ViewRequirementAgentConnector_ms": 0.27224278450012207}, "num_episodes": 22, "episode_return_max": 107.48525659867052, "episode_return_min": 55.74615001115453, "episode_return_mean": 79.97289733831506, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 428.9923632784935, "num_env_steps_trained_throughput_per_sec": 428.9923632784935, "timesteps_total": 36864, "num_env_steps_sampled_lifetime": 36864, "num_agent_steps_sampled_lifetime": 36864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 2633.961, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2633.761, "sample_time_ms": 996.968, "learn_time_ms": 1611.851, "learn_throughput": 635.294, "synch_weights_time_ms": 24.633}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "training_iteration": 36, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-32", "timestamp": 1744167092, "time_this_iter_s": 2.3946726322174072, "time_total_s": 94.18298435211182, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC36A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.18298435211182, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.233333333333334, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.710500033199787, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 1e-07, "total_loss": 2.140841671824455, "policy_loss": -0.00026511350879445674, "vf_loss": 9.716141843795777, "vf_explained_var": -1.4056637883186341e-05, "kl": 2.261562903571601e-06, "entropy": 2.879286579787731, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "env_runners": {"episode_reward_max": 107.48525659867052, "episode_reward_min": 55.74615001115453, "episode_reward_mean": 80.39651060746971, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.74615001115453}, "policy_reward_max": {"tplp_policy": 107.48525659867052}, "policy_reward_mean": {"tplp_policy": 80.39651060746971}, "custom_metrics": {"mean_episode_reward_mean": 80.39651060746971, "mean_episode_reward_min": 55.74615001115453, "mean_episode_reward_max": 107.48525659867052}, "hist_stats": {"episode_reward": [61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [61.12965748391862, 80.62861623178162, 101.37662207311087, 71.69665587470544, 60.32011623448696, 101.16478897815826, 75.75078037073605, 86.58147104058689, 78.49996507738209, 75.65252514578171, 81.22701018894155, 80.65444773185767, 93.67459532817013, 55.74615001115453, 102.3663782243648, 84.66978203847357, 74.56083617027524, 68.21981702883286, 91.08339835776428, 87.01870752570501, 79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7270117559492639, "mean_inference_ms": 2.0717291476744895, "mean_action_processing_ms": 0.38995994466976824, "mean_env_wait_ms": 2.2948918651808925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011202573776245117, "StateBufferConnector_ms": 0.00741267204284668, "ViewRequirementAgentConnector_ms": 0.2303011417388916}, "num_episodes": 18, "episode_return_max": 107.48525659867052, "episode_return_min": 55.74615001115453, "episode_return_mean": 80.39651060746971, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 389.7908768274139, "num_env_steps_trained_throughput_per_sec": 389.7908768274139, "timesteps_total": 37888, "num_env_steps_sampled_lifetime": 37888, "num_agent_steps_sampled_lifetime": 37888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 2645.785, "restore_workers_time_ms": 0.2, "training_step_time_ms": 2645.585, "sample_time_ms": 996.087, "learn_time_ms": 1624.351, "learn_throughput": 630.406, "synch_weights_time_ms": 24.837}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "training_iteration": 37, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-35", "timestamp": 1744167095, "time_this_iter_s": 2.635702610015869, "time_total_s": 96.81868696212769, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.81868696212769, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 33.475, "ram_util_percent": 97.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.362487443909049, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 1e-07, "total_loss": 2.1335287027060987, "policy_loss": -0.00016646087169647217, "vf_loss": 9.687405782938004, "vf_explained_var": -1.6289204359054567e-05, "kl": 1.5061772305813292e-06, "entropy": 2.881562688946724, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "env_runners": {"episode_reward_max": 107.48525659867052, "episode_reward_min": 58.2828365390935, "episode_reward_mean": 80.56732475527154, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 58.2828365390935}, "policy_reward_max": {"tplp_policy": 107.48525659867052}, "policy_reward_mean": {"tplp_policy": 80.56732475527154}, "custom_metrics": {"mean_episode_reward_mean": 80.56732475527154, "mean_episode_reward_min": 58.2828365390935, "mean_episode_reward_max": 107.48525659867052}, "hist_stats": {"episode_reward": [79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.66166536147205, 75.79861837251565, 87.76085188678066, 87.29777192598576, 85.50838429522747, 84.10398523904344, 80.88306759331876, 104.52751279455354, 70.17391976967019, 78.1791206570285, 89.47842440944791, 92.73659965080385, 68.98557769228185, 83.56435266631733, 96.31242338953543, 60.65339252908016, 80.88744260867398, 61.99659953092398, 77.89280642964417, 81.46662465483203, 91.9289461118539, 58.2828365390935, 83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7267183756864393, "mean_inference_ms": 2.072286624294695, "mean_action_processing_ms": 0.3898132396133338, "mean_env_wait_ms": 2.2947390853712015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009162187576293945, "StateBufferConnector_ms": 0.0045092105865478516, "ViewRequirementAgentConnector_ms": 0.22863221168518066}, "num_episodes": 20, "episode_return_max": 107.48525659867052, "episode_return_min": 58.2828365390935, "episode_return_mean": 80.56732475527154, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 376.25710215874227, "num_env_steps_trained_throughput_per_sec": 376.25710215874227, "timesteps_total": 38912, "num_env_steps_sampled_lifetime": 38912, "num_agent_steps_sampled_lifetime": 38912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 2683.029, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2682.929, "sample_time_ms": 1023.873, "learn_time_ms": 1633.345, "learn_throughput": 626.934, "synch_weights_time_ms": 25.401}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "training_iteration": 38, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-37", "timestamp": 1744167097, "time_this_iter_s": 2.7285244464874268, "time_total_s": 99.54721140861511, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC1DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 99.54721140861511, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 45.925, "ram_util_percent": 97.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4937670543789863, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 1e-07, "total_loss": 2.127797544002533, "policy_loss": -0.00015546687063761055, "vf_loss": 9.665249508619308, "vf_explained_var": -2.226829528808594e-05, "kl": 1.4439837921376153e-06, "entropy": 2.8835938394069673, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "env_runners": {"episode_reward_max": 107.48525659867052, "episode_reward_min": 59.33109019077075, "episode_reward_mean": 80.96001043977333, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.33109019077075}, "policy_reward_max": {"tplp_policy": 107.48525659867052}, "policy_reward_mean": {"tplp_policy": 80.96001043977333}, "custom_metrics": {"mean_episode_reward_mean": 80.96001043977333, "mean_episode_reward_min": 59.33109019077075, "mean_episode_reward_max": 107.48525659867052}, "hist_stats": {"episode_reward": [83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.55087558538064, 107.48525659867052, 75.7274680482609, 87.3834611496313, 79.94712587192058, 94.6381103746896, 71.38015404752949, 74.79437856269493, 69.57725387832724, 77.60830081691327, 61.98441000492497, 88.18540500023298, 97.05133510635311, 103.46404166196919, 69.64316517372932, 61.676150829904785, 61.82517650251682, 88.52895904684193, 74.97739790362999, 61.06503498346026, 73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7260673266039549, "mean_inference_ms": 2.071559066193128, "mean_action_processing_ms": 0.3894550981089604, "mean_env_wait_ms": 2.293519466468734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009632587432861328, "StateBufferConnector_ms": 0.006502866744995117, "ViewRequirementAgentConnector_ms": 0.2180309295654297}, "num_episodes": 22, "episode_return_max": 107.48525659867052, "episode_return_min": 59.33109019077075, "episode_return_mean": 80.96001043977333, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 406.0455678299795, "num_env_steps_trained_throughput_per_sec": 406.0455678299795, "timesteps_total": 39936, "num_env_steps_sampled_lifetime": 39936, "num_agent_steps_sampled_lifetime": 39936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 2704.158, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2704.058, "sample_time_ms": 1035.503, "learn_time_ms": 1642.525, "learn_throughput": 623.43, "synch_weights_time_ms": 25.824}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "training_iteration": 39, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-40", "timestamp": 1744167100, "time_this_iter_s": 2.5326709747314453, "time_total_s": 102.07988238334656, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.07988238334656, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 43.56666666666666, "ram_util_percent": 96.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1149852737784385, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 1e-07, "total_loss": 2.146079343557358, "policy_loss": -0.00011059602838940919, "vf_loss": 9.738830542564392, "vf_explained_var": -1.1584535241127013e-05, "kl": 8.805269968673035e-07, "entropy": 2.885176981985569, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "env_runners": {"episode_reward_max": 111.8840604311644, "episode_reward_min": 55.134670583839224, "episode_reward_mean": 82.02052187921026, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.134670583839224}, "policy_reward_max": {"tplp_policy": 111.8840604311644}, "policy_reward_mean": {"tplp_policy": 82.02052187921026}, "custom_metrics": {"mean_episode_reward_mean": 82.02052187921026, "mean_episode_reward_min": 55.134670583839224, "mean_episode_reward_max": 111.8840604311644}, "hist_stats": {"episode_reward": [73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [73.36385808289207, 79.77362680107586, 90.7702885642526, 86.0799704916364, 75.48932790162392, 68.60408694893107, 69.56009573051803, 80.60962735739841, 83.4046740740569, 69.5375478692204, 68.06029947239502, 97.8792009855555, 96.21271223072371, 79.09447010268863, 78.48662384843217, 88.4848821599728, 82.44753794497996, 85.5687314821881, 77.56558271796362, 91.87110769953814, 78.37599640753068, 59.33109019077075, 72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7248889197872305, "mean_inference_ms": 2.069793550377278, "mean_action_processing_ms": 0.38886915123808136, "mean_env_wait_ms": 2.2912219926401742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009688615798950195, "StateBufferConnector_ms": 0.00967550277709961, "ViewRequirementAgentConnector_ms": 0.2147974967956543}, "num_episodes": 20, "episode_return_max": 111.8840604311644, "episode_return_min": 55.134670583839224, "episode_return_mean": 82.02052187921026, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 435.4181994027781, "num_env_steps_trained_throughput_per_sec": 435.4181994027781, "timesteps_total": 40960, "num_env_steps_sampled_lifetime": 40960, "num_agent_steps_sampled_lifetime": 40960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 2693.953, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2693.946, "sample_time_ms": 1031.68, "learn_time_ms": 1637.836, "learn_throughput": 625.215, "synch_weights_time_ms": 24.33}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "training_iteration": 40, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-42", "timestamp": 1744167102, "time_this_iter_s": 2.360450029373169, "time_total_s": 104.44033241271973, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.44033241271973, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.75, "ram_util_percent": 96.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.91810604929924, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 1e-07, "total_loss": 2.1436017200350763, "policy_loss": -0.0002379820740316063, "vf_loss": 9.729923647642135, "vf_explained_var": -1.421123743057251e-05, "kl": 1.614969492225171e-06, "entropy": 2.886412250995636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "env_runners": {"episode_reward_max": 111.8840604311644, "episode_reward_min": 55.134670583839224, "episode_reward_mean": 82.25604992777278, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.134670583839224}, "policy_reward_max": {"tplp_policy": 111.8840604311644}, "policy_reward_mean": {"tplp_policy": 82.25604992777278}, "custom_metrics": {"mean_episode_reward_mean": 82.25604992777278, "mean_episode_reward_min": 55.134670583839224, "mean_episode_reward_max": 111.8840604311644}, "hist_stats": {"episode_reward": [72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [72.88867523242573, 82.39756079131581, 74.04146536660765, 81.23997198081418, 89.12652331053407, 71.9411801034548, 80.88544861212655, 71.30379341087173, 91.21034650750231, 81.7865816901026, 84.66962348928911, 80.88694490770932, 87.65246750454132, 90.22163960196205, 80.90050525415901, 77.33028754735524, 82.2364565356096, 84.20539060685827, 65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236412212303598, "mean_inference_ms": 2.067921677118423, "mean_action_processing_ms": 0.3889132227504695, "mean_env_wait_ms": 2.289218668470365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009614944458007812, "StateBufferConnector_ms": 0.008673429489135742, "ViewRequirementAgentConnector_ms": 0.21598052978515625}, "num_episodes": 22, "episode_return_max": 111.8840604311644, "episode_return_min": 55.134670583839224, "episode_return_mean": 82.25604992777278, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 380.75316617063476, "num_env_steps_trained_throughput_per_sec": 380.75316617063476, "timesteps_total": 41984, "num_env_steps_sampled_lifetime": 41984, "num_agent_steps_sampled_lifetime": 41984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 2628.606, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2628.599, "sample_time_ms": 976.036, "learn_time_ms": 1628.358, "learn_throughput": 628.854, "synch_weights_time_ms": 24.105}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "training_iteration": 41, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-45", "timestamp": 1744167105, "time_this_iter_s": 2.696845769882202, "time_total_s": 107.13717818260193, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC32E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 107.13717818260193, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 40.05, "ram_util_percent": 96.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.238322163000703, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 1e-07, "total_loss": 2.157820012420416, "policy_loss": -0.00019943549123127013, "vf_loss": 9.787144201993943, "vf_explained_var": -2.4969875812530518e-05, "kl": 1.2892864555968941e-06, "entropy": 2.887666089832783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "env_runners": {"episode_reward_max": 111.8840604311644, "episode_reward_min": 55.134670583839224, "episode_reward_mean": 82.44329397215077, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.134670583839224}, "policy_reward_max": {"tplp_policy": 111.8840604311644}, "policy_reward_mean": {"tplp_policy": 82.44329397215077}, "custom_metrics": {"mean_episode_reward_mean": 82.44329397215077, "mean_episode_reward_min": 55.134670583839224, "mean_episode_reward_max": 111.8840604311644}, "hist_stats": {"episode_reward": [65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.30188621113909, 78.4923824376171, 67.4919122872891, 71.64969565188579, 101.62525800619923, 82.35963072965188, 84.69145013597645, 79.42861940870856, 78.36026211298062, 75.43554281562193, 70.4516807383969, 84.94688783167008, 100.567923571968, 87.81704794661633, 71.57060780758742, 77.16144664675241, 93.9091496817263, 91.40050473211667, 81.25579910301195, 90.15998979672642, 71.86423386337837, 72.82934116833502, 67.71140073784223, 76.69590595157462, 81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238545822939474, "mean_inference_ms": 2.0699412266172597, "mean_action_processing_ms": 0.3895120476468228, "mean_env_wait_ms": 2.291210006292725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00861811637878418, "StateBufferConnector_ms": 0.006163358688354492, "ViewRequirementAgentConnector_ms": 0.22219324111938477}, "num_episodes": 18, "episode_return_max": 111.8840604311644, "episode_return_min": 55.134670583839224, "episode_return_mean": 82.44329397215077, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 343.50375829563893, "num_env_steps_trained_throughput_per_sec": 343.50375829563893, "timesteps_total": 43008, "num_env_steps_sampled_lifetime": 43008, "num_agent_steps_sampled_lifetime": 43008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 2626.67, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2626.663, "sample_time_ms": 984.286, "learn_time_ms": 1618.21, "learn_throughput": 632.798, "synch_weights_time_ms": 24.067}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "training_iteration": 42, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-48", "timestamp": 1744167108, "time_this_iter_s": 2.9882805347442627, "time_total_s": 110.12545871734619, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.12545871734619, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 52.325, "ram_util_percent": 97.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2969664689153433, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 1e-07, "total_loss": 2.1456001706421377, "policy_loss": -0.0001388699864037335, "vf_loss": 9.738414645195007, "vf_explained_var": -1.6693025827407837e-05, "kl": 1.1430972641376936e-06, "entropy": 2.8886462196707727, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "env_runners": {"episode_reward_max": 111.8840604311644, "episode_reward_min": 55.134670583839224, "episode_reward_mean": 82.82952654584783, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.134670583839224}, "policy_reward_max": {"tplp_policy": 111.8840604311644}, "policy_reward_mean": {"tplp_policy": 82.82952654584783}, "custom_metrics": {"mean_episode_reward_mean": 82.82952654584783, "mean_episode_reward_min": 55.134670583839224, "mean_episode_reward_max": 111.8840604311644}, "hist_stats": {"episode_reward": [81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [81.6633181848934, 86.73913706651788, 105.09393239890692, 70.21851787545816, 71.35640648876144, 84.27769890400185, 84.56976845089707, 94.30074437102704, 87.46702184059477, 84.43314826742083, 90.69085418301474, 87.35501490600534, 79.7518009675754, 84.09831919799727, 75.64491268516596, 89.17222614915654, 96.62040697000812, 74.35611233598421, 86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238644140767829, "mean_inference_ms": 2.0701751502094345, "mean_action_processing_ms": 0.38953523167531856, "mean_env_wait_ms": 2.2910166882350453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006620168685913086, "StateBufferConnector_ms": 0.006163358688354492, "ViewRequirementAgentConnector_ms": 0.21339917182922363}, "num_episodes": 24, "episode_return_max": 111.8840604311644, "episode_return_min": 55.134670583839224, "episode_return_mean": 82.82952654584783, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 413.3779652756015, "num_env_steps_trained_throughput_per_sec": 413.3779652756015, "timesteps_total": 44032, "num_env_steps_sampled_lifetime": 44032, "num_agent_steps_sampled_lifetime": 44032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 2614.406, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2614.399, "sample_time_ms": 979.413, "learn_time_ms": 1611.001, "learn_throughput": 635.63, "synch_weights_time_ms": 23.885}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "training_iteration": 43, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-51", "timestamp": 1744167111, "time_this_iter_s": 2.48386549949646, "time_total_s": 112.60932421684265, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.60932421684265, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.675, "ram_util_percent": 97.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7982057079672815, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 1e-07, "total_loss": 2.1468286015093327, "policy_loss": -0.00030474496306851504, "vf_loss": 9.74466877579689, "vf_explained_var": -1.9169598817825318e-05, "kl": 2.2376147363445396e-06, "entropy": 2.890338470041752, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "env_runners": {"episode_reward_max": 111.8840604311644, "episode_reward_min": 55.134670583839224, "episode_reward_mean": 81.71612231629462, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.134670583839224}, "policy_reward_max": {"tplp_policy": 111.8840604311644}, "policy_reward_mean": {"tplp_policy": 81.71612231629462}, "custom_metrics": {"mean_episode_reward_mean": 81.71612231629462, "mean_episode_reward_min": 55.134670583839224, "mean_episode_reward_max": 111.8840604311644}, "hist_stats": {"episode_reward": [86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.09349519428824, 72.37258235467657, 89.79201600622986, 77.14750694469379, 111.8840604311644, 87.25164028308315, 82.5163004550335, 90.26438561013346, 93.15955724296822, 81.99279948152748, 97.22892072016882, 89.64410361531054, 75.76460094786836, 82.95821451396475, 80.73175944329411, 84.40853120044241, 55.134670583839224, 87.22294075659633, 94.56512938355137, 66.59931569444093, 86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228884968985733, "mean_inference_ms": 2.0692690354207786, "mean_action_processing_ms": 0.3898183065367865, "mean_env_wait_ms": 2.2902227340183487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006159067153930664, "StateBufferConnector_ms": 0.0041332244873046875, "ViewRequirementAgentConnector_ms": 0.21113300323486328}, "num_episodes": 18, "episode_return_max": 111.8840604311644, "episode_return_min": 55.134670583839224, "episode_return_mean": 81.71612231629462, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 387.5548814826492, "num_env_steps_trained_throughput_per_sec": 387.5548814826492, "timesteps_total": 45056, "num_env_steps_sampled_lifetime": 45056, "num_agent_steps_sampled_lifetime": 45056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 2592.338, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2592.331, "sample_time_ms": 958.633, "learn_time_ms": 1609.671, "learn_throughput": 636.155, "synch_weights_time_ms": 23.928}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "training_iteration": 44, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-54", "timestamp": 1744167114, "time_this_iter_s": 2.649073839187622, "time_total_s": 115.25839805603027, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC32E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.25839805603027, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 43.300000000000004, "ram_util_percent": 97.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2808772288262844, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 1e-07, "total_loss": 2.1336959794163706, "policy_loss": -9.779265965335072e-05, "vf_loss": 9.691653084754943, "vf_explained_var": -2.947188913822174e-05, "kl": 4.891382619442996e-07, "entropy": 2.891195107996464, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "env_runners": {"episode_reward_max": 108.84414200760824, "episode_reward_min": 56.03083410761686, "episode_reward_mean": 81.78008989044145, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.03083410761686}, "policy_reward_max": {"tplp_policy": 108.84414200760824}, "policy_reward_mean": {"tplp_policy": 81.78008989044145}, "custom_metrics": {"mean_episode_reward_mean": 81.78008989044145, "mean_episode_reward_min": 56.03083410761686, "mean_episode_reward_max": 108.84414200760824}, "hist_stats": {"episode_reward": [86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.68425290980252, 68.90858408734663, 72.26650909056444, 84.93918380324423, 78.35057136495757, 80.43689317890805, 84.34888009649055, 72.59303481797619, 92.6120476267544, 89.3558096775497, 91.7457988072596, 97.64346555120423, 62.74841613259134, 72.47515324871003, 83.54549113158518, 87.60521570936749, 79.84386664366073, 81.06501261952867, 78.07856059162494, 77.71295175347838, 88.01044716542422, 90.76815713426983, 86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228903171578378, "mean_inference_ms": 2.0707115356888735, "mean_action_processing_ms": 0.39044085051739896, "mean_env_wait_ms": 2.2922982195976793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007170200347900391, "StateBufferConnector_ms": 0.0029914379119873047, "ViewRequirementAgentConnector_ms": 0.20676493644714355}, "num_episodes": 20, "episode_return_max": 108.84414200760824, "episode_return_min": 56.03083410761686, "episode_return_mean": 81.78008989044145, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 372.9192485190131, "num_env_steps_trained_throughput_per_sec": 372.9192485190131, "timesteps_total": 46080, "num_env_steps_sampled_lifetime": 46080, "num_agent_steps_sampled_lifetime": 46080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 2614.494, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2614.487, "sample_time_ms": 972.615, "learn_time_ms": 1618.328, "learn_throughput": 632.752, "synch_weights_time_ms": 23.445}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "training_iteration": 45, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-56", "timestamp": 1744167116, "time_this_iter_s": 2.753073215484619, "time_total_s": 118.01147127151489, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.01147127151489, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 45.574999999999996, "ram_util_percent": 97.17499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489466219767928, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 1e-07, "total_loss": 2.1332362994551657, "policy_loss": -0.00024726042756810783, "vf_loss": 9.690423309803009, "vf_explained_var": -3.643929958343506e-05, "kl": 1.0608068747183786e-06, "entropy": 2.8912226229906084, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "env_runners": {"episode_reward_max": 108.84414200760824, "episode_reward_min": 56.03083410761686, "episode_reward_mean": 81.02141755835619, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.03083410761686}, "policy_reward_max": {"tplp_policy": 108.84414200760824}, "policy_reward_mean": {"tplp_policy": 81.02141755835619}, "custom_metrics": {"mean_episode_reward_mean": 81.02141755835619, "mean_episode_reward_min": 56.03083410761686, "mean_episode_reward_max": 108.84414200760824}, "hist_stats": {"episode_reward": [86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.94463125926976, 93.93365721472017, 83.16078819769471, 66.98252977143784, 90.97958342912656, 77.25511926104437, 84.95843926165634, 70.65290786968572, 68.01607005061285, 76.7111692921357, 70.71962079164142, 80.13494364060561, 97.228204868998, 92.29522204539948, 78.74190918282194, 86.15586645449147, 92.41824348336823, 93.115449889375, 107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7234318081495802, "mean_inference_ms": 2.074403949734685, "mean_action_processing_ms": 0.3912602059433857, "mean_env_wait_ms": 2.295997058626999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009651184082031, "StateBufferConnector_ms": 0.003496408462524414, "ViewRequirementAgentConnector_ms": 0.21468877792358398}, "num_episodes": 22, "episode_return_max": 108.84414200760824, "episode_return_min": 56.03083410761686, "episode_return_mean": 81.02141755835619, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 385.761276350525, "num_env_steps_trained_throughput_per_sec": 385.761276350525, "timesteps_total": 47104, "num_env_steps_sampled_lifetime": 47104, "num_agent_steps_sampled_lifetime": 47104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 2641.244, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2641.1, "sample_time_ms": 994.471, "learn_time_ms": 1622.685, "learn_throughput": 631.053, "synch_weights_time_ms": 23.845}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "training_iteration": 46, "trial_id": "374cd_00000", "date": "2025-04-09_10-51-59", "timestamp": 1744167119, "time_this_iter_s": 2.662808418273926, "time_total_s": 120.67427968978882, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C822A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.67427968978882, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 40.675000000000004, "ram_util_percent": 96.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3754646599292757, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 1e-07, "total_loss": 2.1317926079034804, "policy_loss": -0.00018742535612545908, "vf_loss": 9.684802782535552, "vf_explained_var": -2.7524307370185852e-05, "kl": 1.3175673862608761e-06, "entropy": 2.8922066554427146, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "env_runners": {"episode_reward_max": 108.84414200760824, "episode_reward_min": 56.03083410761686, "episode_reward_mean": 81.12779780053265, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.03083410761686}, "policy_reward_max": {"tplp_policy": 108.84414200760824}, "policy_reward_mean": {"tplp_policy": 81.12779780053265}, "custom_metrics": {"mean_episode_reward_mean": 81.12779780053265, "mean_episode_reward_min": 56.03083410761686, "mean_episode_reward_max": 108.84414200760824}, "hist_stats": {"episode_reward": [107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [107.77164902920376, 92.50050910929728, 89.25471460422003, 56.03083410761686, 81.39943302725656, 75.60110884654075, 90.73876332686275, 82.65085355870322, 108.84414200760824, 92.49979522896166, 88.57297943335435, 62.18301935538461, 75.42021986242408, 82.89496612519389, 68.54093824774053, 77.14690081056291, 59.09067652877007, 75.04516929267783, 74.33828735761836, 86.73196583615356, 78.23076992268555, 70.78042775289974, 100.79390113541339, 74.39493192911031, 59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228331146249907, "mean_inference_ms": 2.0738970442490334, "mean_action_processing_ms": 0.39137911334741454, "mean_env_wait_ms": 2.2960998838005855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007292032241821289, "StateBufferConnector_ms": 0.005494832992553711, "ViewRequirementAgentConnector_ms": 0.20976042747497559}, "num_episodes": 18, "episode_return_max": 108.84414200760824, "episode_return_min": 56.03083410761686, "episode_return_mean": 81.12779780053265, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 397.8464897398824, "num_env_steps_trained_throughput_per_sec": 397.8464897398824, "timesteps_total": 48128, "num_env_steps_sampled_lifetime": 48128, "num_agent_steps_sampled_lifetime": 48128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 2635.925, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2635.781, "sample_time_ms": 997.856, "learn_time_ms": 1613.866, "learn_throughput": 634.501, "synch_weights_time_ms": 23.959}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "training_iteration": 47, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-02", "timestamp": 1744167122, "time_this_iter_s": 2.5827455520629883, "time_total_s": 123.2570252418518, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.2570252418518, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 28.849999999999998, "ram_util_percent": 96.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3992314303293822, "cur_kl_coeff": 1.4210854715202003e-15, "cur_lr": 1e-07, "total_loss": 2.114279005676508, "policy_loss": -0.00015996324364095927, "vf_loss": 9.615320593118668, "vf_explained_var": -3.1642988324165346e-05, "kl": 1.4605339399675899e-06, "entropy": 2.8939117327332498, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "env_runners": {"episode_reward_max": 105.11375165699965, "episode_reward_min": 51.533309618406946, "episode_reward_mean": 80.41315285788669, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.533309618406946}, "policy_reward_max": {"tplp_policy": 105.11375165699965}, "policy_reward_mean": {"tplp_policy": 80.41315285788669}, "custom_metrics": {"mean_episode_reward_mean": 80.41315285788669, "mean_episode_reward_min": 51.533309618406946, "mean_episode_reward_max": 105.11375165699965}, "hist_stats": {"episode_reward": [59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [59.97450148027373, 74.92270251062199, 68.73541029851894, 82.2367012202021, 68.04735709937236, 89.83366229816829, 68.65802306196157, 67.90698215607026, 83.64524242334468, 82.8234207376045, 94.56298634639467, 79.9322673951543, 84.78223795617133, 74.96217194649593, 74.19172522295736, 86.06469307023036, 71.53396997270112, 88.27828896006739, 79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7230189216042611, "mean_inference_ms": 2.076730619840697, "mean_action_processing_ms": 0.3923458411359858, "mean_env_wait_ms": 2.2992038662002336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010355949401855469, "StateBufferConnector_ms": 0.005494832992553711, "ViewRequirementAgentConnector_ms": 0.21686482429504395}, "num_episodes": 24, "episode_return_max": 105.11375165699965, "episode_return_min": 51.533309618406946, "episode_return_mean": 80.41315285788669, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 346.071685488302, "num_env_steps_trained_throughput_per_sec": 346.071685488302, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 49152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 2659.663, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2659.519, "sample_time_ms": 1005.973, "learn_time_ms": 1629.321, "learn_throughput": 628.483, "synch_weights_time_ms": 24.025}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "training_iteration": 48, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-05", "timestamp": 1744167125, "time_this_iter_s": 2.9663188457489014, "time_total_s": 126.22334408760071, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.22334408760071, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 49.050000000000004, "ram_util_percent": 96.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.90882357545197, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 1e-07, "total_loss": 2.0959186874330045, "policy_loss": -0.00041268018539994953, "vf_loss": 9.543279618024826, "vf_explained_var": -1.800432801246643e-05, "kl": 1.6812451937742167e-06, "entropy": 2.8948851078748703, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "env_runners": {"episode_reward_max": 114.19213573177124, "episode_reward_min": 51.533309618406946, "episode_reward_mean": 81.58746611327, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.533309618406946}, "policy_reward_max": {"tplp_policy": 114.19213573177124}, "policy_reward_mean": {"tplp_policy": 81.58746611327}, "custom_metrics": {"mean_episode_reward_mean": 81.58746611327, "mean_episode_reward_min": 51.533309618406946, "mean_episode_reward_max": 114.19213573177124}, "hist_stats": {"episode_reward": [79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.84931201214275, 74.92673808405452, 95.39646529048933, 94.48435664431219, 90.78589000143943, 81.61612264560624, 80.77249331451982, 78.4887416760428, 81.82769095765768, 77.09698525047556, 89.69211463256809, 105.11375165699965, 82.76472752063167, 76.5305386364927, 84.81947910602148, 90.43795640876691, 82.49992702916937, 86.21373847780102, 80.90353484748562, 85.2542012626651, 87.56456495989595, 85.33942995857561, 84.12551912570298, 62.19301604181589, 71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7239048125676463, "mean_inference_ms": 2.0800625493176783, "mean_action_processing_ms": 0.39331600095061203, "mean_env_wait_ms": 2.302988361486603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010358095169067383, "StateBufferConnector_ms": 0.006564140319824219, "ViewRequirementAgentConnector_ms": 0.23340654373168945}, "num_episodes": 18, "episode_return_max": 114.19213573177124, "episode_return_min": 51.533309618406946, "episode_return_mean": 81.58746611327, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 375.96996139078607, "num_env_steps_trained_throughput_per_sec": 375.96996139078607, "timesteps_total": 50176, "num_env_steps_sampled_lifetime": 50176, "num_agent_steps_sampled_lifetime": 50176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 2679.837, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2679.693, "sample_time_ms": 1013.137, "learn_time_ms": 1642.109, "learn_throughput": 623.588, "synch_weights_time_ms": 24.246}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "training_iteration": 49, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-08", "timestamp": 1744167128, "time_this_iter_s": 2.73169207572937, "time_total_s": 128.95503616333008, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.95503616333008, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 38.325, "ram_util_percent": 96.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7727921940386295, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 1e-07, "total_loss": 2.1521920293569563, "policy_loss": -0.00027031616773456337, "vf_loss": 9.767956483364106, "vf_explained_var": -2.7706101536750794e-05, "kl": 1.501373898621372e-06, "entropy": 2.895267550647259, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "env_runners": {"episode_reward_max": 114.19213573177124, "episode_reward_min": 51.533309618406946, "episode_reward_mean": 80.607484109068, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.533309618406946}, "policy_reward_max": {"tplp_policy": 114.19213573177124}, "policy_reward_mean": {"tplp_policy": 80.607484109068}, "custom_metrics": {"mean_episode_reward_mean": 80.607484109068, "mean_episode_reward_min": 51.533309618406946, "mean_episode_reward_max": 114.19213573177124}, "hist_stats": {"episode_reward": [71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [71.64070367594775, 76.7042435145904, 72.52038375508972, 99.28234690189599, 56.18217419662686, 70.99634156303826, 66.60518333129085, 82.31483496282893, 90.90097598744258, 76.61613191461787, 77.55352039942193, 80.15329531325993, 57.808254475977485, 69.47919817280722, 98.41810232558052, 93.31511324721511, 85.90285694588735, 90.67614947114069, 85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.725265437881151, "mean_inference_ms": 2.084180593294947, "mean_action_processing_ms": 0.3941988161311809, "mean_env_wait_ms": 2.306358957434681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008357524871826172, "StateBufferConnector_ms": 0.010155916213989258, "ViewRequirementAgentConnector_ms": 0.24650311470031738}, "num_episodes": 24, "episode_return_max": 114.19213573177124, "episode_return_min": 51.533309618406946, "episode_return_mean": 80.607484109068, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 391.66855778513985, "num_env_steps_trained_throughput_per_sec": 391.66855778513985, "timesteps_total": 51200, "num_env_steps_sampled_lifetime": 51200, "num_agent_steps_sampled_lifetime": 51200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 2706.106, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2705.969, "sample_time_ms": 1030.767, "learn_time_ms": 1650.988, "learn_throughput": 620.235, "synch_weights_time_ms": 24.013}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "training_iteration": 50, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-10", "timestamp": 1744167130, "time_this_iter_s": 2.620490074157715, "time_total_s": 131.5755262374878, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.5755262374878, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.075, "ram_util_percent": 97.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.269012027233839, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 1e-07, "total_loss": 2.1286757990717886, "policy_loss": -0.0001468680100515485, "vf_loss": 9.673758041858672, "vf_explained_var": -2.7984753251075746e-05, "kl": 9.330507800164866e-07, "entropy": 2.8961685046553614, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "env_runners": {"episode_reward_max": 114.19213573177124, "episode_reward_min": 51.533309618406946, "episode_reward_mean": 80.77480884457641, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.533309618406946}, "policy_reward_max": {"tplp_policy": 114.19213573177124}, "policy_reward_mean": {"tplp_policy": 80.77480884457641}, "custom_metrics": {"mean_episode_reward_mean": 80.77480884457641, "mean_episode_reward_min": 51.533309618406946, "mean_episode_reward_max": 114.19213573177124}, "hist_stats": {"episode_reward": [85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.43949073913622, 93.11601022154568, 76.88101866047859, 90.19104639280181, 62.099182558516844, 94.29930935342742, 77.60704370501239, 80.35324798392635, 71.44234214265353, 82.6140231561034, 85.40656976604046, 100.53099618620315, 66.65099647929351, 90.67996699061733, 83.56220314294694, 83.58992628599844, 64.61728175058343, 89.72625646283424, 79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.72525172462969, "mean_inference_ms": 2.085113732221826, "mean_action_processing_ms": 0.3947841834503635, "mean_env_wait_ms": 2.3070294002827096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009943246841430664, "StateBufferConnector_ms": 0.010823488235473633, "ViewRequirementAgentConnector_ms": 0.2446458339691162}, "num_episodes": 18, "episode_return_max": 114.19213573177124, "episode_return_min": 51.533309618406946, "episode_return_mean": 80.77480884457641, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 461.90216912846086, "num_env_steps_trained_throughput_per_sec": 461.90216912846086, "timesteps_total": 52224, "num_env_steps_sampled_lifetime": 52224, "num_agent_steps_sampled_lifetime": 52224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 2658.858, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2658.607, "sample_time_ms": 1024.249, "learn_time_ms": 1610.681, "learn_throughput": 635.756, "synch_weights_time_ms": 23.478}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "training_iteration": 51, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-13", "timestamp": 1744167133, "time_this_iter_s": 2.2234387397766113, "time_total_s": 133.7989649772644, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BA6B70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.7989649772644, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 45.79999999999999, "ram_util_percent": 97.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9388841919600965, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 1e-07, "total_loss": 2.1263383187353613, "policy_loss": -0.00028337811236269774, "vf_loss": 9.66545462012291, "vf_explained_var": -3.425702452659607e-05, "kl": 2.0274524490715428e-06, "entropy": 2.897419552505016, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "env_runners": {"episode_reward_max": 114.19213573177124, "episode_reward_min": 51.533309618406946, "episode_reward_mean": 80.80013120112014, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 51.533309618406946}, "policy_reward_max": {"tplp_policy": 114.19213573177124}, "policy_reward_mean": {"tplp_policy": 80.80013120112014}, "custom_metrics": {"mean_episode_reward_mean": 80.80013120112014, "mean_episode_reward_min": 51.533309618406946, "mean_episode_reward_max": 114.19213573177124}, "hist_stats": {"episode_reward": [79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.4112570991194, 82.39004866651068, 74.00020528482285, 79.39752794060352, 63.42251234384195, 93.05961563110469, 94.98141630042753, 82.68734085008022, 78.10591863895398, 71.10229456020348, 86.65180693943293, 68.42984270197189, 89.16144787443604, 74.1997639196341, 82.35531378013374, 61.14997204471447, 51.533309618406946, 66.3520608612431, 78.53933074057065, 80.86171292705971, 88.10599925214535, 99.75022598282929, 85.9750328419536, 62.5764713548009, 90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7260345580755542, "mean_inference_ms": 2.087360601683017, "mean_action_processing_ms": 0.39557093699258195, "mean_env_wait_ms": 2.3086733722318327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007660865783691406, "StateBufferConnector_ms": 0.008955717086791992, "ViewRequirementAgentConnector_ms": 0.2637789249420166}, "num_episodes": 18, "episode_return_max": 114.19213573177124, "episode_return_min": 51.533309618406946, "episode_return_mean": 80.80013120112014, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 383.35524850802716, "num_env_steps_trained_throughput_per_sec": 383.35524850802716, "timesteps_total": 53248, "num_env_steps_sampled_lifetime": 53248, "num_agent_steps_sampled_lifetime": 53248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 2627.868, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2627.618, "sample_time_ms": 999.614, "learn_time_ms": 1604.587, "learn_throughput": 638.17, "synch_weights_time_ms": 23.216}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "training_iteration": 52, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-15", "timestamp": 1744167135, "time_this_iter_s": 2.6765573024749756, "time_total_s": 136.47552227973938, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.47552227973938, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 45.7, "ram_util_percent": 97.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.097082617878914, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 1e-07, "total_loss": 2.09689656496048, "policy_loss": -0.0004391511611174792, "vf_loss": 9.54943431019783, "vf_explained_var": -4.521869122982025e-05, "kl": 3.934189325915938e-06, "entropy": 2.900228948891163, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "env_runners": {"episode_reward_max": 114.19213573177124, "episode_reward_min": 52.503605324532195, "episode_reward_mean": 81.82971510743525, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 52.503605324532195}, "policy_reward_max": {"tplp_policy": 114.19213573177124}, "policy_reward_mean": {"tplp_policy": 81.82971510743525}, "custom_metrics": {"mean_episode_reward_mean": 81.82971510743525, "mean_episode_reward_min": 52.503605324532195, "mean_episode_reward_max": 114.19213573177124}, "hist_stats": {"episode_reward": [90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.95241743486939, 114.19213573177124, 75.3594205333348, 89.17178603010396, 86.49719325225914, 77.38333069295665, 64.079375717061, 79.21663729541947, 94.06833764523346, 87.42286267467287, 82.00811719184497, 97.03123816176875, 74.87554554133108, 74.96264925518585, 85.6715633343142, 97.0795550057611, 67.62430713530442, 72.5738327008928, 71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7262421312062679, "mean_inference_ms": 2.0870300007212172, "mean_action_processing_ms": 0.39591530907887323, "mean_env_wait_ms": 2.308356505064318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076084136962890625, "StateBufferConnector_ms": 0.009957075119018555, "ViewRequirementAgentConnector_ms": 0.2613484859466553}, "num_episodes": 24, "episode_return_max": 114.19213573177124, "episode_return_min": 52.503605324532195, "episode_return_mean": 81.82971510743525, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 436.3264604196568, "num_env_steps_trained_throughput_per_sec": 436.3264604196568, "timesteps_total": 54272, "num_env_steps_sampled_lifetime": 54272, "num_agent_steps_sampled_lifetime": 54272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 2614.84, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2614.589, "sample_time_ms": 998.545, "learn_time_ms": 1592.76, "learn_throughput": 642.909, "synch_weights_time_ms": 23.183}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "training_iteration": 53, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-18", "timestamp": 1744167138, "time_this_iter_s": 2.3559937477111816, "time_total_s": 138.83151602745056, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.83151602745056, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.450000000000003, "ram_util_percent": 97.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5997710287570954, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 1e-07, "total_loss": 2.102088626474142, "policy_loss": -0.00026887818821705876, "vf_loss": 9.570518970489502, "vf_explained_var": -4.36093658208847e-05, "kl": 1.6102193244549313e-06, "entropy": 2.90272234082222, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "env_runners": {"episode_reward_max": 103.27403534422858, "episode_reward_min": 52.503605324532195, "episode_reward_mean": 81.3169318881647, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 52.503605324532195}, "policy_reward_max": {"tplp_policy": 103.27403534422858}, "policy_reward_mean": {"tplp_policy": 81.3169318881647}, "custom_metrics": {"mean_episode_reward_mean": 81.3169318881647, "mean_episode_reward_min": 52.503605324532195, "mean_episode_reward_max": 103.27403534422858}, "hist_stats": {"episode_reward": [71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [71.97958044709259, 88.70944276229078, 88.68780265355134, 78.16809259008377, 66.52213368750016, 94.93758203982748, 90.46789328206539, 69.66620473529962, 77.81713268564717, 88.81575977312178, 54.5595712008818, 98.96490114851869, 87.67717020285224, 79.36188967607082, 75.29180852012391, 85.17495700643862, 83.15089363498117, 76.90272921121174, 89.68627131151574, 70.62474954137645, 75.94016198950033, 87.39422718498199, 69.26417580354656, 77.67773824740281, 82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.726287886380624, "mean_inference_ms": 2.086644517086738, "mean_action_processing_ms": 0.3962345134303422, "mean_env_wait_ms": 2.3080764541379226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007593870162963867, "StateBufferConnector_ms": 0.00888824462890625, "ViewRequirementAgentConnector_ms": 0.24658727645874023}, "num_episodes": 18, "episode_return_max": 103.27403534422858, "episode_return_min": 52.503605324532195, "episode_return_mean": 81.3169318881647, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 406.7717736312523, "num_env_steps_trained_throughput_per_sec": 406.7717736312523, "timesteps_total": 55296, "num_env_steps_sampled_lifetime": 55296, "num_agent_steps_sampled_lifetime": 55296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 2602.357, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2602.107, "sample_time_ms": 1013.668, "learn_time_ms": 1565.702, "learn_throughput": 654.02, "synch_weights_time_ms": 22.636}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "training_iteration": 54, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-20", "timestamp": 1744167140, "time_this_iter_s": 2.5240542888641357, "time_total_s": 141.3555703163147, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.3555703163147, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 45.56666666666666, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4874431289732457, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 1e-07, "total_loss": 2.0973426066339016, "policy_loss": -0.0001840321347117424, "vf_loss": 9.551551949977874, "vf_explained_var": -3.2551586627960205e-05, "kl": 1.2378074557228836e-06, "entropy": 2.9036134511232374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "env_runners": {"episode_reward_max": 104.0540173817344, "episode_reward_min": 52.503605324532195, "episode_reward_mean": 82.25435628925969, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 52.503605324532195}, "policy_reward_max": {"tplp_policy": 104.0540173817344}, "policy_reward_mean": {"tplp_policy": 82.25435628925969}, "custom_metrics": {"mean_episode_reward_mean": 82.25435628925969, "mean_episode_reward_min": 52.503605324532195, "mean_episode_reward_max": 104.0540173817344}, "hist_stats": {"episode_reward": [82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [82.07951145858225, 103.27403534422858, 99.2997386142194, 77.66043050120606, 67.00835578488963, 74.35296435045397, 74.65332699959791, 76.7100373478726, 81.39455665944955, 63.445558046296235, 85.58779167548694, 95.20026947490584, 80.76654446246083, 84.81867084439197, 80.28433534717867, 60.324242743331446, 94.06952563505702, 88.22053009059108, 72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7266220252098321, "mean_inference_ms": 2.0866641541931865, "mean_action_processing_ms": 0.39669045459355085, "mean_env_wait_ms": 2.3074193891937465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008597850799560547, "StateBufferConnector_ms": 0.005296468734741211, "ViewRequirementAgentConnector_ms": 0.24019074440002441}, "num_episodes": 24, "episode_return_max": 104.0540173817344, "episode_return_min": 52.503605324532195, "episode_return_mean": 82.25435628925969, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.9216375880513, "num_env_steps_trained_throughput_per_sec": 417.9216375880513, "timesteps_total": 56320, "num_env_steps_sampled_lifetime": 56320, "num_agent_steps_sampled_lifetime": 56320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 2572.789, "restore_workers_time_ms": 0.137, "training_step_time_ms": 2572.538, "sample_time_ms": 1008.234, "learn_time_ms": 1541.706, "learn_throughput": 664.199, "synch_weights_time_ms": 22.498}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "training_iteration": 55, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-23", "timestamp": 1744167143, "time_this_iter_s": 2.4588537216186523, "time_total_s": 143.81442403793335, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.81442403793335, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 40.475, "ram_util_percent": 97.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6094244696199893, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 1e-07, "total_loss": 2.153511941432953, "policy_loss": -0.00020380225614644588, "vf_loss": 9.776687133312226, "vf_explained_var": -3.7443265318870546e-05, "kl": 1.3319828713775905e-06, "entropy": 2.9045604839920998, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "env_runners": {"episode_reward_max": 109.17571478197434, "episode_reward_min": 52.503605324532195, "episode_reward_mean": 82.84549663175521, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 52.503605324532195}, "policy_reward_max": {"tplp_policy": 109.17571478197434}, "policy_reward_mean": {"tplp_policy": 82.84549663175521}, "custom_metrics": {"mean_episode_reward_mean": 82.84549663175521, "mean_episode_reward_min": 52.503605324532195, "mean_episode_reward_max": 109.17571478197434}, "hist_stats": {"episode_reward": [72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [72.58257594253755, 79.07894210663463, 78.23711258439135, 78.66334896602103, 81.33239476241923, 69.73945420123385, 91.44471976847244, 98.82200173928132, 81.09008465776162, 93.73481507929864, 79.65234416202601, 87.6269298927063, 80.46325421891548, 81.43783375238604, 92.63967474822695, 52.503605324532195, 80.88515350181227, 92.63793627358915, 77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7271744993329069, "mean_inference_ms": 2.087452386111483, "mean_action_processing_ms": 0.3972458063995959, "mean_env_wait_ms": 2.3078715968517294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007012367248535156, "StateBufferConnector_ms": 0.004209756851196289, "ViewRequirementAgentConnector_ms": 0.2547297477722168}, "num_episodes": 18, "episode_return_max": 109.17571478197434, "episode_return_min": 52.503605324532195, "episode_return_mean": 82.84549663175521, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 386.1692711037719, "num_env_steps_trained_throughput_per_sec": 386.1692711037719, "timesteps_total": 57344, "num_env_steps_sampled_lifetime": 57344, "num_agent_steps_sampled_lifetime": 57344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 2572.509, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2572.395, "sample_time_ms": 996.337, "learn_time_ms": 1553.017, "learn_throughput": 659.362, "synch_weights_time_ms": 22.941}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "training_iteration": 56, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-26", "timestamp": 1744167146, "time_this_iter_s": 2.660531759262085, "time_total_s": 146.47495579719543, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.47495579719543, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 39.224999999999994, "ram_util_percent": 97.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5296768564730883, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 1e-07, "total_loss": 2.1270812794566156, "policy_loss": -0.00021710625442210584, "vf_loss": 9.67147809267044, "vf_explained_var": -4.578046500682831e-05, "kl": 1.431417609465413e-06, "entropy": 2.905711440742016, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "env_runners": {"episode_reward_max": 110.00808364835223, "episode_reward_min": 62.094430535483696, "episode_reward_mean": 83.06211191977206, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.094430535483696}, "policy_reward_max": {"tplp_policy": 110.00808364835223}, "policy_reward_mean": {"tplp_policy": 83.06211191977206}, "custom_metrics": {"mean_episode_reward_mean": 83.06211191977206, "mean_episode_reward_min": 62.094430535483696, "mean_episode_reward_max": 110.00808364835223}, "hist_stats": {"episode_reward": [77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.18993207186925, 92.30564736088235, 92.29737548954557, 77.11310693988146, 81.50219031592547, 85.79568442160793, 80.17312166757863, 78.1580187285008, 83.83339582825431, 73.00009060309816, 71.43155680046685, 99.72344268657544, 85.61249015455773, 67.11479381350584, 79.23792223681357, 81.40257106650603, 84.91977702490634, 78.48461788998497, 88.83383096578417, 71.45350013470122, 72.67250235218414, 101.38016045798113, 78.79003957623347, 98.26064936338017, 76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7275503400946871, "mean_inference_ms": 2.088377753509059, "mean_action_processing_ms": 0.3974957038593081, "mean_env_wait_ms": 2.308490771298832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011002063751220703, "StateBufferConnector_ms": 0.005084514617919922, "ViewRequirementAgentConnector_ms": 0.23490262031555176}, "num_episodes": 18, "episode_return_max": 110.00808364835223, "episode_return_min": 62.094430535483696, "episode_return_mean": 83.06211191977206, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 349.4824159370403, "num_env_steps_trained_throughput_per_sec": 349.4824159370403, "timesteps_total": 58368, "num_env_steps_sampled_lifetime": 58368, "num_agent_steps_sampled_lifetime": 58368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 2608.128, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2608.014, "sample_time_ms": 1013.197, "learn_time_ms": 1571.802, "learn_throughput": 651.482, "synch_weights_time_ms": 22.915}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "training_iteration": 57, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-29", "timestamp": 1744167149, "time_this_iter_s": 2.9377365112304688, "time_total_s": 149.4126923084259, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC39C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.4126923084259, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 48.949999999999996, "ram_util_percent": 97.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7174731604754925, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 1e-07, "total_loss": 2.1168403260409834, "policy_loss": -0.000204180326545611, "vf_loss": 9.63108696937561, "vf_explained_var": -5.513429641723633e-05, "kl": 1.6142127012841456e-06, "entropy": 2.9072721734642983, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "env_runners": {"episode_reward_max": 110.00808364835223, "episode_reward_min": 62.094430535483696, "episode_reward_mean": 83.50326849775705, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.094430535483696}, "policy_reward_max": {"tplp_policy": 110.00808364835223}, "policy_reward_mean": {"tplp_policy": 83.50326849775705}, "custom_metrics": {"mean_episode_reward_mean": 83.50326849775705, "mean_episode_reward_min": 62.094430535483696, "mean_episode_reward_max": 110.00808364835223}, "hist_stats": {"episode_reward": [76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [76.17018895895366, 81.14220647992236, 68.85785007865084, 88.41101007568608, 91.34204670004347, 77.68241506408357, 76.05846155965743, 77.34683797583943, 84.24017545995082, 73.6610930855795, 85.0446870620315, 82.08010290237307, 74.90672547157098, 86.94351275851744, 77.76550381359685, 80.18847702095923, 93.54565217164964, 87.653641634275, 78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7290129682762847, "mean_inference_ms": 2.0933105278680206, "mean_action_processing_ms": 0.3983348129004425, "mean_env_wait_ms": 2.3128870056462927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007997512817382812, "StateBufferConnector_ms": 0.004083156585693359, "ViewRequirementAgentConnector_ms": 0.2675774097442627}, "num_episodes": 24, "episode_return_max": 110.00808364835223, "episode_return_min": 62.094430535483696, "episode_return_mean": 83.50326849775705, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 363.1364793958851, "num_env_steps_trained_throughput_per_sec": 363.1364793958851, "timesteps_total": 59392, "num_env_steps_sampled_lifetime": 59392, "num_agent_steps_sampled_lifetime": 59392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 2594.223, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2594.11, "sample_time_ms": 1022.285, "learn_time_ms": 1549.437, "learn_throughput": 660.885, "synch_weights_time_ms": 22.388}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "training_iteration": 58, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-31", "timestamp": 1744167151, "time_this_iter_s": 2.8278541564941406, "time_total_s": 152.24054646492004, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.24054646492004, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 53.575, "ram_util_percent": 97.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.697223327308893, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 1e-07, "total_loss": 2.1383146576583387, "policy_loss": -0.00021551421086769552, "vf_loss": 9.717351424694062, "vf_explained_var": -3.804415464401245e-05, "kl": 9.003451722389144e-07, "entropy": 2.908076639473438, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "env_runners": {"episode_reward_max": 110.00808364835223, "episode_reward_min": 62.094430535483696, "episode_reward_mean": 83.6592574551199, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.094430535483696}, "policy_reward_max": {"tplp_policy": 110.00808364835223}, "policy_reward_mean": {"tplp_policy": 83.6592574551199}, "custom_metrics": {"mean_episode_reward_mean": 83.6592574551199, "mean_episode_reward_min": 62.094430535483696, "mean_episode_reward_max": 110.00808364835223}, "hist_stats": {"episode_reward": [78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.79935471790569, 89.03295949049874, 78.35531636747251, 76.69267201671987, 82.16121456966786, 63.62441631637664, 84.73989286182041, 72.06044670031426, 88.85306724679869, 73.20747505996877, 79.35005067657532, 97.89256161818409, 80.11753344838714, 92.17932586371641, 80.7329638687415, 78.0461368303936, 86.92790441257374, 92.5096947657971, 83.70920642189586, 90.3721802679793, 86.56762473593453, 104.0540173817344, 76.75419726424376, 95.13708997759969, 74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7298170489391959, "mean_inference_ms": 2.0964417050568995, "mean_action_processing_ms": 0.39883299142559564, "mean_env_wait_ms": 2.316166156988802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007986068725585938, "StateBufferConnector_ms": 0.0030853748321533203, "ViewRequirementAgentConnector_ms": 0.2612450122833252}, "num_episodes": 18, "episode_return_max": 110.00808364835223, "episode_return_min": 62.094430535483696, "episode_return_mean": 83.6592574551199, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 426.24105777659656, "num_env_steps_trained_throughput_per_sec": 426.24105777659656, "timesteps_total": 60416, "num_env_steps_sampled_lifetime": 60416, "num_agent_steps_sampled_lifetime": 60416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 2562.1, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2561.987, "sample_time_ms": 1016.428, "learn_time_ms": 1523.993, "learn_throughput": 671.919, "synch_weights_time_ms": 21.451}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "training_iteration": 59, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-34", "timestamp": 1744167154, "time_this_iter_s": 2.4079885482788086, "time_total_s": 154.64853501319885, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C832E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.64853501319885, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 45.800000000000004, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459873466938734, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 1e-07, "total_loss": 2.146852347999811, "policy_loss": -0.000257890677312389, "vf_loss": 9.751549017429351, "vf_explained_var": -3.237351775169373e-05, "kl": 1.2517719571336627e-06, "entropy": 2.9077702283859255, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "env_runners": {"episode_reward_max": 110.00808364835223, "episode_reward_min": 57.618913183862674, "episode_reward_mean": 83.73338592764358, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.618913183862674}, "policy_reward_max": {"tplp_policy": 110.00808364835223}, "policy_reward_mean": {"tplp_policy": 83.73338592764358}, "custom_metrics": {"mean_episode_reward_mean": 83.73338592764358, "mean_episode_reward_min": 57.618913183862674, "mean_episode_reward_max": 110.00808364835223}, "hist_stats": {"episode_reward": [74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [74.26087625714285, 91.62342569889817, 104.10301415546495, 90.62274189501926, 95.08636240375165, 76.49671796544256, 72.07420623068639, 86.42811821608998, 68.14181523728209, 109.17571478197434, 84.7486384633056, 92.83100137806011, 76.87012374758268, 77.94376421016632, 86.75925703636244, 69.20739471068093, 87.97275659975142, 101.4220084823081, 68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7307498262658398, "mean_inference_ms": 2.1004984486456335, "mean_action_processing_ms": 0.39953933740541503, "mean_env_wait_ms": 2.320783362077092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010990619659423828, "StateBufferConnector_ms": 0.004421234130859375, "ViewRequirementAgentConnector_ms": 0.26122474670410156}, "num_episodes": 24, "episode_return_max": 110.00808364835223, "episode_return_min": 57.618913183862674, "episode_return_mean": 83.73338592764358, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 439.2686561989359, "num_env_steps_trained_throughput_per_sec": 439.2686561989359, "timesteps_total": 61440, "num_env_steps_sampled_lifetime": 61440, "num_agent_steps_sampled_lifetime": 61440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 2533.769, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2533.656, "sample_time_ms": 1018.952, "learn_time_ms": 1493.599, "learn_throughput": 685.593, "synch_weights_time_ms": 20.99}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "training_iteration": 60, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-36", "timestamp": 1744167156, "time_this_iter_s": 2.337047576904297, "time_total_s": 156.98558259010315, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.98558259010315, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.349999999999994, "ram_util_percent": 97.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3287268903106453, "cur_kl_coeff": 1.734723475976807e-19, "cur_lr": 1e-07, "total_loss": 2.149802477657795, "policy_loss": -0.0001627563324291259, "vf_loss": 9.76329944729805, "vf_explained_var": -6.269700825214385e-05, "kl": 1.3823902369036745e-06, "entropy": 2.9085957780480385, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "env_runners": {"episode_reward_max": 110.00808364835223, "episode_reward_min": 54.253434811885334, "episode_reward_mean": 82.61241224084979, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.253434811885334}, "policy_reward_max": {"tplp_policy": 110.00808364835223}, "policy_reward_mean": {"tplp_policy": 82.61241224084979}, "custom_metrics": {"mean_episode_reward_mean": 82.61241224084979, "mean_episode_reward_min": 54.253434811885334, "mean_episode_reward_max": 110.00808364835223}, "hist_stats": {"episode_reward": [68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [68.33804371299932, 62.094430535483696, 77.42561635596205, 82.23285162363172, 99.64518597452518, 79.64629403323862, 96.28634740001614, 88.27697318188838, 71.2677819535041, 88.78139413015094, 80.59169709935645, 110.00808364835223, 63.37615365118054, 85.23675475596602, 79.21813539418031, 72.41320195143582, 95.0264912792645, 78.35291838513207, 96.58085748026083, 86.84999970989416, 75.71466297934762, 79.85044685832138, 74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7312135740786148, "mean_inference_ms": 2.103360800538569, "mean_action_processing_ms": 0.39989606868069383, "mean_env_wait_ms": 2.3236394626686656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012501955032348633, "StateBufferConnector_ms": 0.0056650638580322266, "ViewRequirementAgentConnector_ms": 0.25655460357666016}, "num_episodes": 18, "episode_return_max": 110.00808364835223, "episode_return_min": 54.253434811885334, "episode_return_mean": 82.61241224084979, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 397.2261928599181, "num_env_steps_trained_throughput_per_sec": 397.2261928599181, "timesteps_total": 62464, "num_env_steps_sampled_lifetime": 62464, "num_agent_steps_sampled_lifetime": 62464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 2569.865, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2569.865, "sample_time_ms": 1028.799, "learn_time_ms": 1518.804, "learn_throughput": 674.215, "synch_weights_time_ms": 22.146}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "training_iteration": 61, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-39", "timestamp": 1744167159, "time_this_iter_s": 2.585902452468872, "time_total_s": 159.57148504257202, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.57148504257202, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 47.333333333333336, "ram_util_percent": 97.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7413172014057636, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 1e-07, "total_loss": 2.0914601497352123, "policy_loss": -0.0002704128331970423, "vf_loss": 9.530745476484299, "vf_explained_var": -1.3506785035133361e-05, "kl": 1.2649181971413626e-06, "entropy": 2.909557916224003, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "env_runners": {"episode_reward_max": 104.27667715997796, "episode_reward_min": 54.253434811885334, "episode_reward_mean": 81.96385766938933, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.253434811885334}, "policy_reward_max": {"tplp_policy": 104.27667715997796}, "policy_reward_mean": {"tplp_policy": 81.96385766938933}, "custom_metrics": {"mean_episode_reward_mean": 81.96385766938933, "mean_episode_reward_min": 54.253434811885334, "mean_episode_reward_max": 104.27667715997796}, "hist_stats": {"episode_reward": [74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [74.38791521648783, 92.44422816624432, 92.15929622368013, 90.88570271625133, 66.01884467046197, 84.8385073562691, 66.03978859723648, 98.34564861301962, 73.75617615365658, 83.59095483114424, 80.77595999519075, 84.45898323895857, 86.3754080639434, 102.41988313864448, 93.7261734243426, 77.1114996869196, 86.30811276967475, 78.78361619487681, 82.29207541340718, 79.02082841316218, 80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7319394644437146, "mean_inference_ms": 2.105924630821757, "mean_action_processing_ms": 0.39997492433551984, "mean_env_wait_ms": 2.3261341833138065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011635065078735352, "StateBufferConnector_ms": 0.0046596527099609375, "ViewRequirementAgentConnector_ms": 0.24352431297302246}, "num_episodes": 22, "episode_return_max": 104.27667715997796, "episode_return_min": 54.253434811885334, "episode_return_mean": 81.96385766938933, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 394.02509339704324, "num_env_steps_trained_throughput_per_sec": 394.02509339704324, "timesteps_total": 63488, "num_env_steps_sampled_lifetime": 63488, "num_agent_steps_sampled_lifetime": 63488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 2562.632, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2562.632, "sample_time_ms": 1027.949, "learn_time_ms": 1512.862, "learn_throughput": 676.863, "synch_weights_time_ms": 21.705}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "training_iteration": 62, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-42", "timestamp": 1744167162, "time_this_iter_s": 2.6051688194274902, "time_total_s": 162.1766538619995, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C822A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.1766538619995, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 51.95, "ram_util_percent": 97.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.580544888973236, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 1e-07, "total_loss": 2.112110947817564, "policy_loss": -0.00020920431124977769, "vf_loss": 9.613220846652984, "vf_explained_var": -4.894286394119263e-05, "kl": 1.192827701457233e-06, "entropy": 2.9098505556583403, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "env_runners": {"episode_reward_max": 104.27667715997796, "episode_reward_min": 54.253434811885334, "episode_reward_mean": 81.78975216768941, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.253434811885334}, "policy_reward_max": {"tplp_policy": 104.27667715997796}, "policy_reward_mean": {"tplp_policy": 81.78975216768941}, "custom_metrics": {"mean_episode_reward_mean": 81.78975216768941, "mean_episode_reward_min": 54.253434811885334, "mean_episode_reward_max": 104.27667715997796}, "hist_stats": {"episode_reward": [80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.28366329053276, 81.95398834840032, 90.00014191106462, 70.26316177558563, 88.51710902874673, 86.5990807707154, 70.3175434501606, 86.1783349536051, 77.0551274642728, 88.65190506158925, 75.12097038980014, 92.16490673946156, 88.83908201529665, 86.5115337699328, 73.54990704488016, 81.3201241690111, 87.85209670947783, 85.1808725645557, 85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7314537184960709, "mean_inference_ms": 2.1054303361116258, "mean_action_processing_ms": 0.400056892074454, "mean_env_wait_ms": 2.3259202011117357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01290750503540039, "StateBufferConnector_ms": 0.0076596736907958984, "ViewRequirementAgentConnector_ms": 0.22943711280822754}, "num_episodes": 20, "episode_return_max": 104.27667715997796, "episode_return_min": 54.253434811885334, "episode_return_mean": 81.78975216768941, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.0225886689651, "num_env_steps_trained_throughput_per_sec": 445.0225886689651, "timesteps_total": 64512, "num_env_steps_sampled_lifetime": 64512, "num_agent_steps_sampled_lifetime": 64512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 2558.046, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2558.046, "sample_time_ms": 1027.892, "learn_time_ms": 1508.348, "learn_throughput": 678.889, "synch_weights_time_ms": 21.691}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "training_iteration": 63, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-44", "timestamp": 1744167164, "time_this_iter_s": 2.3068971633911133, "time_total_s": 164.48355102539062, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.48355102539062, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 32.65, "ram_util_percent": 97.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.952366741001606, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 1e-07, "total_loss": 2.1115122005343436, "policy_loss": -0.00034710055915638806, "vf_loss": 9.611713445186615, "vf_explained_var": -3.489479422569275e-05, "kl": 1.876663196220818e-06, "entropy": 2.9106906354427338, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "env_runners": {"episode_reward_max": 104.84048545664524, "episode_reward_min": 54.253434811885334, "episode_reward_mean": 81.4777940077527, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.253434811885334}, "policy_reward_max": {"tplp_policy": 104.84048545664524}, "policy_reward_mean": {"tplp_policy": 81.4777940077527}, "custom_metrics": {"mean_episode_reward_mean": 81.4777940077527, "mean_episode_reward_min": 54.253434811885334, "mean_episode_reward_max": 104.84048545664524}, "hist_stats": {"episode_reward": [85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.26958833402577, 73.99787600903743, 88.44698004570901, 73.40022756488258, 80.17401651168315, 73.50280258523621, 72.11549117284187, 57.618913183862674, 87.04815985018405, 81.11826489398207, 90.87271851348677, 84.12828514966614, 85.76507515312039, 86.95337726775216, 104.27667715997796, 102.1422080287849, 92.021451973893, 69.8140309176857, 90.07699162410589, 93.43893193067291, 91.24435357681111, 82.83075941223164, 70.77716349366386, 90.89626802904446, 84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7312036733674832, "mean_inference_ms": 2.1050175941583746, "mean_action_processing_ms": 0.3997815300627883, "mean_env_wait_ms": 2.3251440592446873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014187335968017578, "StateBufferConnector_ms": 0.010857582092285156, "ViewRequirementAgentConnector_ms": 0.2190101146697998}, "num_episodes": 18, "episode_return_max": 104.84048545664524, "episode_return_min": 54.253434811885334, "episode_return_mean": 81.4777940077527, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.19571045743146, "num_env_steps_trained_throughput_per_sec": 445.19571045743146, "timesteps_total": 65536, "num_env_steps_sampled_lifetime": 65536, "num_agent_steps_sampled_lifetime": 65536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 2536.319, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2536.319, "sample_time_ms": 1018.194, "learn_time_ms": 1495.959, "learn_throughput": 684.511, "synch_weights_time_ms": 22.05}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "training_iteration": 64, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-46", "timestamp": 1744167166, "time_this_iter_s": 2.3070147037506104, "time_total_s": 166.79056572914124, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.79056572914124, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 40.33333333333333, "ram_util_percent": 97.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7364716164767744, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 1e-07, "total_loss": 2.0892187587916853, "policy_loss": -0.0003787990775890648, "vf_loss": 9.523080295324325, "vf_explained_var": -4.2329728603363034e-05, "kl": 2.0613266494939884e-06, "entropy": 2.9117250382900237, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "env_runners": {"episode_reward_max": 104.84048545664524, "episode_reward_min": 54.253434811885334, "episode_reward_mean": 81.72125474320828, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 54.253434811885334}, "policy_reward_max": {"tplp_policy": 104.84048545664524}, "policy_reward_mean": {"tplp_policy": 81.72125474320828}, "custom_metrics": {"mean_episode_reward_mean": 81.72125474320828, "mean_episode_reward_min": 54.253434811885334, "mean_episode_reward_max": 104.84048545664524}, "hist_stats": {"episode_reward": [84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.01482175333712, 73.04096278666687, 77.94266465374504, 84.97168780614275, 77.90615672009145, 84.82539158488261, 75.92719869683398, 82.58781474432799, 88.13546429889406, 68.46233991622915, 54.253434811885334, 88.50318370937056, 98.2499267779573, 60.23665416455513, 80.7549858736976, 92.18444896926648, 65.64798290240209, 99.07399784238588, 71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7306841452777345, "mean_inference_ms": 2.1037327873471248, "mean_action_processing_ms": 0.39941744309928495, "mean_env_wait_ms": 2.323633548633232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01417684555053711, "StateBufferConnector_ms": 0.01043391227722168, "ViewRequirementAgentConnector_ms": 0.21815729141235352}, "num_episodes": 24, "episode_return_max": 104.84048545664524, "episode_return_min": 54.253434811885334, "episode_return_mean": 81.72125474320828, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 412.3518410473797, "num_env_steps_trained_throughput_per_sec": 412.3518410473797, "timesteps_total": 66560, "num_env_steps_sampled_lifetime": 66560, "num_agent_steps_sampled_lifetime": 66560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 2539.629, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2539.629, "sample_time_ms": 1012.318, "learn_time_ms": 1504.348, "learn_throughput": 680.693, "synch_weights_time_ms": 22.847}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "training_iteration": 65, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-49", "timestamp": 1744167169, "time_this_iter_s": 2.4902970790863037, "time_total_s": 169.28086280822754, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.28086280822754, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 43.675, "ram_util_percent": 96.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.457472725212574, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 1e-07, "total_loss": 2.137585665285587, "policy_loss": -0.00015714645851403475, "vf_loss": 9.71613866686821, "vf_explained_var": -2.1068006753921507e-05, "kl": 9.884403203486158e-07, "entropy": 2.912918409705162, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "env_runners": {"episode_reward_max": 104.84048545664524, "episode_reward_min": 61.098215453969715, "episode_reward_mean": 82.52128793875538, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.098215453969715}, "policy_reward_max": {"tplp_policy": 104.84048545664524}, "policy_reward_mean": {"tplp_policy": 82.52128793875538}, "custom_metrics": {"mean_episode_reward_mean": 82.52128793875538, "mean_episode_reward_min": 61.098215453969715, "mean_episode_reward_max": 104.84048545664524}, "hist_stats": {"episode_reward": [71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [71.39449554223478, 88.98110459614583, 89.07791768450197, 61.65239186121337, 76.35055038994211, 77.10341055333068, 88.28066208796443, 85.4806937896951, 80.29164909969295, 67.39394268160729, 81.4278771005045, 81.03275272184757, 91.85969265675405, 91.25693533761651, 80.02271232068352, 66.7745642699374, 70.17577448114795, 64.07660520157782, 88.87926992912023, 86.1238818977407, 87.6911812405855, 87.30209976367249, 75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7301757414410852, "mean_inference_ms": 2.102841522716221, "mean_action_processing_ms": 0.3992154350193355, "mean_env_wait_ms": 2.3228235704932447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011536836624145508, "StateBufferConnector_ms": 0.010187149047851562, "ViewRequirementAgentConnector_ms": 0.22412729263305664}, "num_episodes": 18, "episode_return_max": 104.84048545664524, "episode_return_min": 61.098215453969715, "episode_return_mean": 82.52128793875538, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.3168734360943, "num_env_steps_trained_throughput_per_sec": 464.3168734360943, "timesteps_total": 67584, "num_env_steps_sampled_lifetime": 67584, "num_agent_steps_sampled_lifetime": 67584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 2494.999, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2494.999, "sample_time_ms": 1009.337, "learn_time_ms": 1463.652, "learn_throughput": 699.62, "synch_weights_time_ms": 21.794}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "training_iteration": 66, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-51", "timestamp": 1744167171, "time_this_iter_s": 2.2105209827423096, "time_total_s": 171.49138379096985, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.49138379096985, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 40.26666666666666, "ram_util_percent": 96.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489166233688593, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 1e-07, "total_loss": 2.136539087444544, "policy_loss": -0.00017796704196371138, "vf_loss": 9.71221358180046, "vf_explained_var": -3.875866532325745e-05, "kl": 7.226048235553506e-07, "entropy": 2.913363203406334, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "env_runners": {"episode_reward_max": 104.84048545664524, "episode_reward_min": 61.098215453969715, "episode_reward_mean": 83.47727119194828, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.098215453969715}, "policy_reward_max": {"tplp_policy": 104.84048545664524}, "policy_reward_mean": {"tplp_policy": 83.47727119194828}, "custom_metrics": {"mean_episode_reward_mean": 83.47727119194828, "mean_episode_reward_min": 61.098215453969715, "mean_episode_reward_max": 104.84048545664524}, "hist_stats": {"episode_reward": [75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [75.7902723532661, 82.70862438640135, 79.80675186490124, 81.9006147913277, 79.1360426279946, 82.0703238947081, 73.03539971874626, 76.06374796091556, 87.25656342783756, 91.42427681079417, 82.37673649412564, 77.41943548949904, 94.38537313319715, 61.098215453969715, 84.78324455827432, 96.23571482602019, 83.56561363093206, 92.27882028641221, 85.87215753225586, 76.67813122231432, 77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7287870980385128, "mean_inference_ms": 2.100374186390486, "mean_action_processing_ms": 0.3987977968324445, "mean_env_wait_ms": 2.32018955189259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009552001953125, "StateBufferConnector_ms": 0.011194705963134766, "ViewRequirementAgentConnector_ms": 0.21683120727539062}, "num_episodes": 22, "episode_return_max": 104.84048545664524, "episode_return_min": 61.098215453969715, "episode_return_mean": 83.47727119194828, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.84760099648486, "num_env_steps_trained_throughput_per_sec": 467.84760099648486, "timesteps_total": 68608, "num_env_steps_sampled_lifetime": 68608, "num_agent_steps_sampled_lifetime": 68608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 2420.869, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2420.869, "sample_time_ms": 984.617, "learn_time_ms": 1415.251, "learn_throughput": 723.547, "synch_weights_time_ms": 20.786}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "training_iteration": 67, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-53", "timestamp": 1744167173, "time_this_iter_s": 2.193514347076416, "time_total_s": 173.68489813804626, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.68489813804626, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.36666666666667, "ram_util_percent": 96.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7889293901622296, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 1e-07, "total_loss": 2.120454629510641, "policy_loss": -0.00031854581902734935, "vf_loss": 9.648240810632705, "vf_explained_var": -4.747845232486725e-05, "kl": 1.245425275259171e-06, "entropy": 2.9128703117370605, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "env_runners": {"episode_reward_max": 104.84048545664524, "episode_reward_min": 63.293717372199765, "episode_reward_mean": 83.48838141882705, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.293717372199765}, "policy_reward_max": {"tplp_policy": 104.84048545664524}, "policy_reward_mean": {"tplp_policy": 83.48838141882705}, "custom_metrics": {"mean_episode_reward_mean": 83.48838141882705, "mean_episode_reward_min": 63.293717372199765, "mean_episode_reward_max": 104.84048545664524}, "hist_stats": {"episode_reward": [77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.53720857184491, 90.45565260825036, 91.37854184543271, 65.00231174338845, 92.5112344500867, 69.96805978515042, 104.84048545664524, 85.4042047579106, 77.67203076500151, 71.0607364909314, 72.27984150089553, 73.14162018080881, 82.09536671319019, 90.00384320478463, 85.13867927899852, 68.1236273555277, 72.76116850912675, 91.69631085599954, 86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7276746340656918, "mean_inference_ms": 2.098355125288776, "mean_action_processing_ms": 0.3983177854040095, "mean_env_wait_ms": 2.318064559373728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008275985717773438, "StateBufferConnector_ms": 0.007411479949951172, "ViewRequirementAgentConnector_ms": 0.21913766860961914}, "num_episodes": 20, "episode_return_max": 104.84048545664524, "episode_return_min": 63.293717372199765, "episode_return_mean": 83.48838141882705, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 394.7574430037603, "num_env_steps_trained_throughput_per_sec": 394.7574430037603, "timesteps_total": 69632, "num_env_steps_sampled_lifetime": 69632, "num_agent_steps_sampled_lifetime": 69632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 2398.281, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2398.281, "sample_time_ms": 947.771, "learn_time_ms": 1428.866, "learn_throughput": 716.652, "synch_weights_time_ms": 21.282}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "training_iteration": 68, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-56", "timestamp": 1744167176, "time_this_iter_s": 2.6009838581085205, "time_total_s": 176.28588199615479, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.28588199615479, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.5, "ram_util_percent": 97.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.566725903004408, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 1e-07, "total_loss": 2.148925195634365, "policy_loss": -0.00018367634620517493, "vf_loss": 9.761638259887695, "vf_explained_var": -8.256398141384124e-05, "kl": 1.3421738835783791e-06, "entropy": 2.9130069807171823, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "env_runners": {"episode_reward_max": 114.29119702152049, "episode_reward_min": 63.293717372199765, "episode_reward_mean": 84.88960386717062, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.293717372199765}, "policy_reward_max": {"tplp_policy": 114.29119702152049}, "policy_reward_mean": {"tplp_policy": 84.88960386717062}, "custom_metrics": {"mean_episode_reward_mean": 84.88960386717062, "mean_episode_reward_min": 63.293717372199765, "mean_episode_reward_max": 114.29119702152049}, "hist_stats": {"episode_reward": [86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.89335369096584, 98.63384154935864, 74.6482379974216, 79.48153528994008, 88.27372799641135, 83.25912379042316, 75.83187023362345, 97.64479411282925, 83.98195030919283, 80.61738492810588, 79.76773946698574, 98.63583077139087, 87.69618040644671, 75.67717400212345, 97.88906240443197, 82.66159223702957, 76.95405779244662, 84.31596340364521, 78.66090574070184, 83.77019020185567, 71.42180341803802, 101.10288681940607, 73.78725160200923, 83.09732904116298, 99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7268473237540563, "mean_inference_ms": 2.097263223258994, "mean_action_processing_ms": 0.39791171823657756, "mean_env_wait_ms": 2.317082296272502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069963932037353516, "StateBufferConnector_ms": 0.006887197494506836, "ViewRequirementAgentConnector_ms": 0.23235583305358887}, "num_episodes": 18, "episode_return_max": 114.29119702152049, "episode_return_min": 63.293717372199765, "episode_return_mean": 84.88960386717062, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.0976946902359, "num_env_steps_trained_throughput_per_sec": 422.0976946902359, "timesteps_total": 70656, "num_env_steps_sampled_lifetime": 70656, "num_agent_steps_sampled_lifetime": 70656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 2400.639, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2400.514, "sample_time_ms": 952.352, "learn_time_ms": 1426.815, "learn_throughput": 717.682, "synch_weights_time_ms": 21.1}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "training_iteration": 69, "trial_id": "374cd_00000", "date": "2025-04-09_10-52-59", "timestamp": 1744167179, "time_this_iter_s": 2.4311323165893555, "time_total_s": 178.71701431274414, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C814E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.71701431274414, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 52.73333333333334, "ram_util_percent": 97.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.540806410089135, "cur_kl_coeff": 3.388131789017201e-22, "cur_lr": 1e-07, "total_loss": 2.1407554663717745, "policy_loss": -0.00018857167451642455, "vf_loss": 9.729582518339157, "vf_explained_var": -8.203312754631042e-05, "kl": 1.6795367942634698e-06, "entropy": 2.9145158633589743, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "env_runners": {"episode_reward_max": 114.29119702152049, "episode_reward_min": 63.293717372199765, "episode_reward_mean": 84.67388915211103, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.293717372199765}, "policy_reward_max": {"tplp_policy": 114.29119702152049}, "policy_reward_mean": {"tplp_policy": 84.67388915211103}, "custom_metrics": {"mean_episode_reward_mean": 84.67388915211103, "mean_episode_reward_min": 63.293717372199765, "mean_episode_reward_max": 114.29119702152049}, "hist_stats": {"episode_reward": [99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.14465107126378, 74.4949161175533, 99.66481241220596, 90.43048629466071, 88.0132667098174, 78.07598852076981, 79.59447384519665, 84.4884066660457, 69.22766288748011, 71.37726563303747, 69.48602352974663, 85.87838938581582, 102.33836656815221, 86.57194927867438, 93.29100327532517, 87.76019472846119, 80.60523730492437, 81.82046311268265, 84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7258387958072545, "mean_inference_ms": 2.0953215714244995, "mean_action_processing_ms": 0.3971751000482407, "mean_env_wait_ms": 2.315303834307764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118608474731445, "StateBufferConnector_ms": 0.0048978328704833984, "ViewRequirementAgentConnector_ms": 0.24728608131408691}, "num_episodes": 24, "episode_return_max": 114.29119702152049, "episode_return_min": 63.293717372199765, "episode_return_mean": 84.67388915211103, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.06447465934764, "num_env_steps_trained_throughput_per_sec": 464.06447465934764, "timesteps_total": 71680, "num_env_steps_sampled_lifetime": 71680, "num_agent_steps_sampled_lifetime": 71680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 2388.183, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2388.059, "sample_time_ms": 939.271, "learn_time_ms": 1427.484, "learn_throughput": 717.346, "synch_weights_time_ms": 21.057}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "training_iteration": 70, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-01", "timestamp": 1744167181, "time_this_iter_s": 2.2124249935150146, "time_total_s": 180.92943930625916, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.92943930625916, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 35.83333333333333, "ram_util_percent": 97.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.683915476500988, "cur_kl_coeff": 1.6940658945086005e-22, "cur_lr": 1e-07, "total_loss": 2.1509484708309174, "policy_loss": -0.00019731506472453475, "vf_loss": 9.770808607339859, "vf_explained_var": -8.67992639541626e-05, "kl": 1.1544207825231467e-06, "entropy": 2.915563777089119, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "env_runners": {"episode_reward_max": 114.29119702152049, "episode_reward_min": 63.293717372199765, "episode_reward_mean": 84.74944258533773, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.293717372199765}, "policy_reward_max": {"tplp_policy": 114.29119702152049}, "policy_reward_mean": {"tplp_policy": 84.74944258533773}, "custom_metrics": {"mean_episode_reward_mean": 84.74944258533773, "mean_episode_reward_min": 63.293717372199765, "mean_episode_reward_max": 114.29119702152049}, "hist_stats": {"episode_reward": [84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.62815237014448, 81.43105114428754, 77.95939541827838, 79.1771798555958, 85.52439008970953, 74.30534845010199, 78.09242425634763, 101.78308330224357, 88.3194505421011, 76.23452691850144, 90.21969217714924, 93.61055243335753, 74.03598820520233, 86.68327445485833, 78.05268559273685, 89.83959048509466, 78.33111633151248, 102.13922217714108, 100.45560020683034, 74.98006569800789, 85.5034183063447, 91.41692982362436, 63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7252577485648333, "mean_inference_ms": 2.093266778473912, "mean_action_processing_ms": 0.3965532782051625, "mean_env_wait_ms": 2.3135854745922204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00811004638671875, "StateBufferConnector_ms": 0.00706028938293457, "ViewRequirementAgentConnector_ms": 0.24303650856018066}, "num_episodes": 18, "episode_return_max": 114.29119702152049, "episode_return_min": 63.293717372199765, "episode_return_mean": 84.74944258533773, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 488.1094491776458, "num_env_steps_trained_throughput_per_sec": 488.1094491776458, "timesteps_total": 72704, "num_env_steps_sampled_lifetime": 72704, "num_agent_steps_sampled_lifetime": 72704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 2340.185, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2340.06, "sample_time_ms": 932.624, "learn_time_ms": 1387.558, "learn_throughput": 737.987, "synch_weights_time_ms": 19.632}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "training_iteration": 71, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-03", "timestamp": 1744167183, "time_this_iter_s": 2.1049602031707764, "time_total_s": 183.03439950942993, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C814E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.03439950942993, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.26666666666667, "ram_util_percent": 97.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.163170736283064, "cur_kl_coeff": 8.470329472543003e-23, "cur_lr": 1e-07, "total_loss": 2.1508288413286207, "policy_loss": -9.100303868763149e-05, "vf_loss": 9.770372748374939, "vf_explained_var": -7.5642392039299e-05, "kl": 1.1835002676874318e-06, "entropy": 2.916733455657959, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "env_runners": {"episode_reward_max": 114.29119702152049, "episode_reward_min": 63.293717372199765, "episode_reward_mean": 85.35480532740067, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.293717372199765}, "policy_reward_max": {"tplp_policy": 114.29119702152049}, "policy_reward_mean": {"tplp_policy": 85.35480532740067}, "custom_metrics": {"mean_episode_reward_mean": 85.35480532740067, "mean_episode_reward_min": 63.293717372199765, "mean_episode_reward_max": 114.29119702152049}, "hist_stats": {"episode_reward": [63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [63.293717372199765, 89.97782041762565, 84.91998473127263, 97.63192185160692, 77.40064340673892, 86.22125887130211, 75.63270944955758, 85.96831710472235, 76.0226329423955, 87.30322992337499, 71.2748889930993, 69.41945721453382, 91.95960586677607, 86.33343353539644, 83.52905838818171, 79.62104676877223, 71.94769475657253, 89.61931342767262, 72.6609124271624, 114.29119702152049, 87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.724984312719924, "mean_inference_ms": 2.0917071364360305, "mean_action_processing_ms": 0.3959693272913816, "mean_env_wait_ms": 2.312559526645744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00809931755065918, "StateBufferConnector_ms": 0.00948190689086914, "ViewRequirementAgentConnector_ms": 0.27735042572021484}, "num_episodes": 22, "episode_return_max": 114.29119702152049, "episode_return_min": 63.293717372199765, "episode_return_mean": 85.35480532740067, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 307.0031047935737, "num_env_steps_trained_throughput_per_sec": 307.0031047935737, "timesteps_total": 73728, "num_env_steps_sampled_lifetime": 73728, "num_agent_steps_sampled_lifetime": 73728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 2413.85, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2413.725, "sample_time_ms": 921.059, "learn_time_ms": 1470.304, "learn_throughput": 696.455, "synch_weights_time_ms": 22.115}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "training_iteration": 72, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-06", "timestamp": 1744167186, "time_this_iter_s": 3.351897954940796, "time_total_s": 186.38629746437073, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC39C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.38629746437073, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 54.98, "ram_util_percent": 97.72000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7463578693568707, "cur_kl_coeff": 4.2351647362715013e-23, "cur_lr": 1e-07, "total_loss": 2.115653048455715, "policy_loss": -0.0003527506021782756, "vf_loss": 9.631122756004334, "vf_explained_var": -5.772039294242859e-05, "kl": 1.830808830494135e-06, "entropy": 2.9177488297224046, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "env_runners": {"episode_reward_max": 114.28043120786573, "episode_reward_min": 64.20113021311697, "episode_reward_mean": 85.04874343139699, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.20113021311697}, "policy_reward_max": {"tplp_policy": 114.28043120786573}, "policy_reward_mean": {"tplp_policy": 85.04874343139699}, "custom_metrics": {"mean_episode_reward_mean": 85.04874343139699, "mean_episode_reward_min": 64.20113021311697, "mean_episode_reward_max": 114.28043120786573}, "hist_stats": {"episode_reward": [87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.08202657183726, 64.59354234058718, 101.25432619604388, 85.38920759774052, 93.20109148227604, 113.17730977648722, 66.81600170925307, 94.37098421615407, 71.41969915046182, 88.03899129377045, 107.30337522269883, 100.48779225821171, 70.2396529287232, 100.20511730399177, 98.09500442613637, 72.56693698527326, 100.56326761959828, 80.25581771446716, 90.20597295204564, 83.0604066046562, 68.60865618311648, 71.27872821128196, 75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7252313859635034, "mean_inference_ms": 2.091923420915975, "mean_action_processing_ms": 0.39616501181871144, "mean_env_wait_ms": 2.3133097473255386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008095741271972656, "StateBufferConnector_ms": 0.010200977325439453, "ViewRequirementAgentConnector_ms": 0.2835266590118408}, "num_episodes": 20, "episode_return_max": 114.28043120786573, "episode_return_min": 64.20113021311697, "episode_return_mean": 85.04874343139699, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 252.29717273459204, "num_env_steps_trained_throughput_per_sec": 252.29717273459204, "timesteps_total": 74752, "num_env_steps_sampled_lifetime": 74752, "num_agent_steps_sampled_lifetime": 74752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 2589.62, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2589.495, "sample_time_ms": 956.941, "learn_time_ms": 1610.008, "learn_throughput": 636.022, "synch_weights_time_ms": 22.3}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "training_iteration": 73, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-11", "timestamp": 1744167191, "time_this_iter_s": 4.065752983093262, "time_total_s": 190.452050447464, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.452050447464, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 66.89999999999999, "ram_util_percent": 98.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.661180377751589, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 1e-07, "total_loss": 2.123273978382349, "policy_loss": -0.00016716571990400554, "vf_loss": 9.661162281036377, "vf_explained_var": -4.8920512199401855e-05, "kl": 1.4396290776819143e-06, "entropy": 2.9184940665960313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "env_runners": {"episode_reward_max": 114.28043120786573, "episode_reward_min": 64.20113021311697, "episode_reward_mean": 83.883535199609, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.20113021311697}, "policy_reward_max": {"tplp_policy": 114.28043120786573}, "policy_reward_mean": {"tplp_policy": 83.883535199609}, "custom_metrics": {"mean_episode_reward_mean": 83.883535199609, "mean_episode_reward_min": 64.20113021311697, "mean_episode_reward_max": 114.28043120786573}, "hist_stats": {"episode_reward": [75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [75.25457954010818, 82.32900163518069, 83.35888330232447, 89.98044844007555, 84.76637489123983, 78.10337233203997, 105.31312794317456, 82.66381314590924, 73.68400203607128, 87.75472835686789, 91.00890830388241, 77.36343524871228, 66.44999537034829, 83.06638683528432, 77.06109529175205, 81.41558995332358, 92.41636575636834, 97.16935803215831, 92.97255805022928, 92.7103076230222, 101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7256608988305162, "mean_inference_ms": 2.0921891869165803, "mean_action_processing_ms": 0.39628308910455445, "mean_env_wait_ms": 2.313294711053041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00924539566040039, "StateBufferConnector_ms": 0.009591341018676758, "ViewRequirementAgentConnector_ms": 0.2744748592376709}, "num_episodes": 22, "episode_return_max": 114.28043120786573, "episode_return_min": 64.20113021311697, "episode_return_mean": 83.883535199609, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.61507376017096, "num_env_steps_trained_throughput_per_sec": 467.61507376017096, "timesteps_total": 75776, "num_env_steps_sampled_lifetime": 75776, "num_agent_steps_sampled_lifetime": 75776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 2578.592, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2578.467, "sample_time_ms": 958.321, "learn_time_ms": 1597.277, "learn_throughput": 641.091, "synch_weights_time_ms": 22.623}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "training_iteration": 74, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-13", "timestamp": 1744167193, "time_this_iter_s": 2.199561834335327, "time_total_s": 192.65161228179932, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.65161228179932, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 37.93333333333334, "ram_util_percent": 98.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.652799215912819, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 1e-07, "total_loss": 2.136619947850704, "policy_loss": -0.00023265001364052295, "vf_loss": 9.715259212255479, "vf_explained_var": -4.431754350662231e-05, "kl": 1.2529607962941114e-06, "entropy": 2.9196222871541977, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "env_runners": {"episode_reward_max": 114.28043120786573, "episode_reward_min": 64.20113021311697, "episode_reward_mean": 84.67936438849848, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.20113021311697}, "policy_reward_max": {"tplp_policy": 114.28043120786573}, "policy_reward_mean": {"tplp_policy": 84.67936438849848}, "custom_metrics": {"mean_episode_reward_mean": 84.67936438849848, "mean_episode_reward_min": 64.20113021311697, "mean_episode_reward_max": 114.28043120786573}, "hist_stats": {"episode_reward": [101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.40523614281582, 67.34955466834363, 84.72214156640898, 85.21995662400926, 91.70302216890008, 76.98451574703185, 90.90043293935582, 106.94440853803886, 72.09704115671306, 80.15738532235464, 76.04402681735046, 77.77579636503646, 92.7823180408357, 83.15820129145192, 79.2090793086647, 77.68291829392128, 94.32494582077118, 93.36755457196718, 97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7256308205866907, "mean_inference_ms": 2.092847981444322, "mean_action_processing_ms": 0.3967333208931991, "mean_env_wait_ms": 2.3141990822753007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008129119873046875, "StateBufferConnector_ms": 0.010588407516479492, "ViewRequirementAgentConnector_ms": 0.27089571952819824}, "num_episodes": 20, "episode_return_max": 114.28043120786573, "episode_return_min": 64.20113021311697, "episode_return_mean": 84.67936438849848, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 366.0487338580441, "num_env_steps_trained_throughput_per_sec": 366.0487338580441, "timesteps_total": 76800, "num_env_steps_sampled_lifetime": 76800, "num_agent_steps_sampled_lifetime": 76800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 2610.005, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2609.88, "sample_time_ms": 969.23, "learn_time_ms": 1618.397, "learn_throughput": 632.725, "synch_weights_time_ms": 22.006}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "training_iteration": 75, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-16", "timestamp": 1744167196, "time_this_iter_s": 2.8050856590270996, "time_total_s": 195.45669794082642, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C822A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.45669794082642, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 44.074999999999996, "ram_util_percent": 98.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538481304049492, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 1e-07, "total_loss": 2.1048137068748476, "policy_loss": -0.0002915372315328568, "vf_loss": 9.588474035263062, "vf_explained_var": -8.583590388298035e-05, "kl": 1.5859803521589555e-06, "entropy": 2.920132467150688, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "env_runners": {"episode_reward_max": 114.28043120786573, "episode_reward_min": 63.524370161188116, "episode_reward_mean": 83.55074983893095, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.524370161188116}, "policy_reward_max": {"tplp_policy": 114.28043120786573}, "policy_reward_mean": {"tplp_policy": 83.55074983893095}, "custom_metrics": {"mean_episode_reward_mean": 83.55074983893095, "mean_episode_reward_min": 63.524370161188116, "mean_episode_reward_max": 114.28043120786573}, "hist_stats": {"episode_reward": [97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.23547595979736, 77.83242750962785, 66.16437186757221, 88.13599780961457, 114.28043120786573, 77.42697296884919, 99.02590507060764, 85.14621951060607, 95.26993669938193, 80.5588305594656, 85.88962395339638, 96.72349078841606, 80.47488726920761, 88.79669948454541, 112.12992522755827, 76.05472889517416, 64.20113021311697, 75.90514353816472, 88.85118194815561, 95.4635315716024, 84.98795325381808, 71.57544249276505, 85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7260448862212051, "mean_inference_ms": 2.094834452920636, "mean_action_processing_ms": 0.3972752303198528, "mean_env_wait_ms": 2.3161320586968377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00813603401184082, "StateBufferConnector_ms": 0.009426355361938477, "ViewRequirementAgentConnector_ms": 0.2618246078491211}, "num_episodes": 18, "episode_return_max": 114.28043120786573, "episode_return_min": 63.524370161188116, "episode_return_mean": 83.55074983893095, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 421.80884165204975, "num_env_steps_trained_throughput_per_sec": 421.80884165204975, "timesteps_total": 77824, "num_env_steps_sampled_lifetime": 77824, "num_agent_steps_sampled_lifetime": 77824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 2632.23, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2632.105, "sample_time_ms": 982.286, "learn_time_ms": 1627.623, "learn_throughput": 629.139, "synch_weights_time_ms": 22.05}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "training_iteration": 76, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-18", "timestamp": 1744167198, "time_this_iter_s": 2.4341139793395996, "time_total_s": 197.89081192016602, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.89081192016602, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 45.4, "ram_util_percent": 97.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.744973948597908, "cur_kl_coeff": 2.6469779601696883e-24, "cur_lr": 1e-07, "total_loss": 2.11261018589139, "policy_loss": -0.00033403384732082485, "vf_loss": 9.620399153232574, "vf_explained_var": -6.745047867298126e-05, "kl": 2.506141783413518e-06, "entropy": 2.9215558260679244, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "env_runners": {"episode_reward_max": 103.9681001527293, "episode_reward_min": 61.61947228129388, "episode_reward_mean": 82.52773519413256, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.61947228129388}, "policy_reward_max": {"tplp_policy": 103.9681001527293}, "policy_reward_mean": {"tplp_policy": 82.52773519413256}, "custom_metrics": {"mean_episode_reward_mean": 82.52773519413256, "mean_episode_reward_min": 61.61947228129388, "mean_episode_reward_max": 103.9681001527293}, "hist_stats": {"episode_reward": [85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.8098507065102, 85.20767896982281, 66.37533745725267, 101.35938939854437, 73.90803931950279, 70.58284142902195, 73.66112334249146, 84.02872741951413, 86.51721232316875, 66.72400171887443, 81.10890467752161, 91.94744157371231, 77.40015878249233, 90.4006636044679, 80.68659779554068, 68.6139856804414, 87.05854422443986, 96.4687607002129, 82.89014395590183, 93.80304786074909, 80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7264786025818835, "mean_inference_ms": 2.097041731187642, "mean_action_processing_ms": 0.3977823513207682, "mean_env_wait_ms": 2.3185591543918393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008183002471923828, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.23463845252990723}, "num_episodes": 22, "episode_return_max": 103.9681001527293, "episode_return_min": 61.61947228129388, "episode_return_mean": 82.52773519413256, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 430.7163028114105, "num_env_steps_trained_throughput_per_sec": 430.7163028114105, "timesteps_total": 78848, "num_env_steps_sampled_lifetime": 78848, "num_agent_steps_sampled_lifetime": 78848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 2651.099, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2650.974, "sample_time_ms": 995.398, "learn_time_ms": 1633.307, "learn_throughput": 626.949, "synch_weights_time_ms": 22.069}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "training_iteration": 77, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-21", "timestamp": 1744167201, "time_this_iter_s": 2.3828723430633545, "time_total_s": 200.27368426322937, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC36A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 200.27368426322937, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 39.766666666666666, "ram_util_percent": 97.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3592547096312044, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 1e-07, "total_loss": 2.1103316210210323, "policy_loss": -0.0001241485821083188, "vf_loss": 9.611239749193192, "vf_explained_var": -4.4550001621246335e-05, "kl": 1.5786352611346644e-06, "entropy": 2.923541636765003, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "env_runners": {"episode_reward_max": 105.08006668157978, "episode_reward_min": 59.94203473303631, "episode_reward_mean": 82.95143089455149, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.94203473303631}, "policy_reward_max": {"tplp_policy": 105.08006668157978}, "policy_reward_mean": {"tplp_policy": 82.95143089455149}, "custom_metrics": {"mean_episode_reward_mean": 82.95143089455149, "mean_episode_reward_min": 59.94203473303631, "mean_episode_reward_max": 105.08006668157978}, "hist_stats": {"episode_reward": [80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.58694876059307, 69.86159292951622, 83.2338691090925, 90.76861701200367, 83.32589102268214, 76.20081821702809, 89.09579372161001, 68.15175925722163, 71.49420621194106, 80.71177753612434, 80.72758457429049, 70.75494289939382, 82.75179179812504, 86.2793112969386, 79.48460789483052, 79.3091563517869, 73.73519725942164, 85.2603274134642, 101.14090735864342, 82.12479312465669, 89.52355547729422, 98.35008321971358, 92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7260855162000355, "mean_inference_ms": 2.097024561192934, "mean_action_processing_ms": 0.397846999968978, "mean_env_wait_ms": 2.3187797670177623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007186174392700195, "StateBufferConnector_ms": 0.006501674652099609, "ViewRequirementAgentConnector_ms": 0.2200009822845459}, "num_episodes": 20, "episode_return_max": 105.08006668157978, "episode_return_min": 59.94203473303631, "episode_return_mean": 82.95143089455149, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 439.5305978050524, "num_env_steps_trained_throughput_per_sec": 439.5305978050524, "timesteps_total": 79872, "num_env_steps_sampled_lifetime": 79872, "num_agent_steps_sampled_lifetime": 79872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 2624.675, "restore_workers_time_ms": 0.125, "training_step_time_ms": 2624.55, "sample_time_ms": 990.485, "learn_time_ms": 1612.318, "learn_throughput": 635.111, "synch_weights_time_ms": 21.694}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "training_iteration": 78, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-23", "timestamp": 1744167203, "time_this_iter_s": 2.3369452953338623, "time_total_s": 202.61062955856323, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC1DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.61062955856323, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.325, "ram_util_percent": 97.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6454059034585953, "cur_kl_coeff": 6.617444900424221e-25, "cur_lr": 1e-07, "total_loss": 2.12047228962183, "policy_loss": -0.00024695930478628724, "vf_loss": 9.653142327070237, "vf_explained_var": -8.593276143074036e-05, "kl": 2.63111466562993e-06, "entropy": 2.9256632417440414, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "env_runners": {"episode_reward_max": 110.09052700174094, "episode_reward_min": 59.94203473303631, "episode_reward_mean": 83.57863070023376, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.94203473303631}, "policy_reward_max": {"tplp_policy": 110.09052700174094}, "policy_reward_mean": {"tplp_policy": 83.57863070023376}, "custom_metrics": {"mean_episode_reward_mean": 83.57863070023376, "mean_episode_reward_min": 59.94203473303631, "mean_episode_reward_max": 110.09052700174094}, "hist_stats": {"episode_reward": [92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [92.14968019262827, 89.09224299755724, 87.66917087144654, 75.98408213427817, 77.16509878781474, 98.2951724287006, 91.71198302479999, 88.40135276255903, 90.28013849003729, 81.63591104568223, 98.22575798942319, 90.82639812543344, 80.78030337993326, 99.51651602400275, 92.4435601188817, 85.42958510436411, 79.39996757571005, 87.54469122676221, 73.28807792594193, 85.84839514202194, 80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7257217200609469, "mean_inference_ms": 2.097334658144172, "mean_action_processing_ms": 0.3978378474647723, "mean_env_wait_ms": 2.319650499601897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021870136260986328, "StateBufferConnector_ms": 0.013523340225219727, "ViewRequirementAgentConnector_ms": 0.23732352256774902}, "num_episodes": 22, "episode_return_max": 110.09052700174094, "episode_return_min": 59.94203473303631, "episode_return_mean": 83.57863070023376, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 410.37897865210454, "num_env_steps_trained_throughput_per_sec": 410.37897865210454, "timesteps_total": 80896, "num_env_steps_sampled_lifetime": 80896, "num_agent_steps_sampled_lifetime": 80896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 2631.602, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2631.602, "sample_time_ms": 985.797, "learn_time_ms": 1623.151, "learn_throughput": 630.871, "synch_weights_time_ms": 22.463}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "training_iteration": 79, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-26", "timestamp": 1744167206, "time_this_iter_s": 2.502164840698242, "time_total_s": 205.11279439926147, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.11279439926147, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 49.06666666666666, "ram_util_percent": 97.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6760327354073525, "cur_kl_coeff": 3.3087224502121104e-25, "cur_lr": 1e-07, "total_loss": 2.144807957112789, "policy_loss": -0.00021725327242165803, "vf_loss": 9.751498490571976, "vf_explained_var": -8.11845064163208e-05, "kl": 2.637095536162093e-06, "entropy": 2.928494115173817, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "env_runners": {"episode_reward_max": 110.09052700174094, "episode_reward_min": 59.94203473303631, "episode_reward_mean": 83.39428330961886, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.94203473303631}, "policy_reward_max": {"tplp_policy": 110.09052700174094}, "policy_reward_mean": {"tplp_policy": 83.39428330961886}, "custom_metrics": {"mean_episode_reward_mean": 83.39428330961886, "mean_episode_reward_min": 59.94203473303631, "mean_episode_reward_max": 110.09052700174094}, "hist_stats": {"episode_reward": [80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.04986646906585, 79.34970209172695, 81.69280787616724, 82.6670398257802, 75.75978017316122, 75.09401331439187, 81.00455385603667, 64.5897259612364, 75.79807711091541, 81.801522880175, 81.39156243993506, 103.9681001527293, 69.24769681453334, 76.80912169035456, 63.524370161188116, 87.08266654185576, 69.68120615503527, 77.99736071493594, 83.21648410401409, 72.8142631410669, 80.71513864199423, 82.35864603867483, 80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7252354130949874, "mean_inference_ms": 2.097065326552329, "mean_action_processing_ms": 0.39774056939287356, "mean_env_wait_ms": 2.319861699326333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021877050399780273, "StateBufferConnector_ms": 0.015302896499633789, "ViewRequirementAgentConnector_ms": 0.2278609275817871}, "num_episodes": 20, "episode_return_max": 110.09052700174094, "episode_return_min": 59.94203473303631, "episode_return_mean": 83.39428330961886, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 454.95983039561577, "num_env_steps_trained_throughput_per_sec": 454.95983039561577, "timesteps_total": 81920, "num_env_steps_sampled_lifetime": 81920, "num_agent_steps_sampled_lifetime": 81920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 2636.018, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2636.018, "sample_time_ms": 992.268, "learn_time_ms": 1621.158, "learn_throughput": 631.647, "synch_weights_time_ms": 22.401}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "training_iteration": 80, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-28", "timestamp": 1744167208, "time_this_iter_s": 2.256532669067383, "time_total_s": 207.36932706832886, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.36932706832886, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.225, "ram_util_percent": 97.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.126534311473369, "cur_kl_coeff": 1.6543612251060552e-25, "cur_lr": 1e-07, "total_loss": 2.1383316040039064, "policy_loss": -0.0003300677752122283, "vf_loss": 9.726991486549377, "vf_explained_var": -3.4094229340553285e-05, "kl": 2.414674794248839e-06, "entropy": 2.9308621168136595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "env_runners": {"episode_reward_max": 110.09052700174094, "episode_reward_min": 58.59464916859116, "episode_reward_mean": 84.70832327932165, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 58.59464916859116}, "policy_reward_max": {"tplp_policy": 110.09052700174094}, "policy_reward_mean": {"tplp_policy": 84.70832327932165}, "custom_metrics": {"mean_episode_reward_mean": 84.70832327932165, "mean_episode_reward_min": 58.59464916859116, "mean_episode_reward_max": 110.09052700174094}, "hist_stats": {"episode_reward": [80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.132023626465, 86.50904867663814, 87.27151222708494, 84.31815824979778, 85.97057190044255, 82.48763215070943, 61.61947228129388, 85.20668920681268, 103.70100735860122, 87.37538652166285, 73.85742984506865, 73.91217084958008, 88.24532620922598, 80.56398347285415, 78.42052691679072, 93.45480503072075, 79.48352311836237, 81.78051632222446, 66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7246853561060782, "mean_inference_ms": 2.0959197145398836, "mean_action_processing_ms": 0.3973921453020815, "mean_env_wait_ms": 2.3191213918712323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02187943458557129, "StateBufferConnector_ms": 0.014302730560302734, "ViewRequirementAgentConnector_ms": 0.21878528594970703}, "num_episodes": 22, "episode_return_max": 110.09052700174094, "episode_return_min": 58.59464916859116, "episode_return_mean": 84.70832327932165, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.06092423101677, "num_env_steps_trained_throughput_per_sec": 448.06092423101677, "timesteps_total": 82944, "num_env_steps_sampled_lifetime": 82944, "num_agent_steps_sampled_lifetime": 82944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 2654.769, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2654.769, "sample_time_ms": 996.339, "learn_time_ms": 1635.539, "learn_throughput": 626.093, "synch_weights_time_ms": 22.701}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "training_iteration": 81, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-30", "timestamp": 1744167210, "time_this_iter_s": 2.29185152053833, "time_total_s": 209.6611785888672, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C831A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.6611785888672, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 37.699999999999996, "ram_util_percent": 97.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8671056143939495, "cur_kl_coeff": 8.271806125530276e-26, "cur_lr": 1e-07, "total_loss": 2.132937581837177, "policy_loss": -0.0004139177268370986, "vf_loss": 9.706035578250885, "vf_explained_var": -5.7296082377433774e-05, "kl": 1.8105779121174725e-06, "entropy": 2.9315739631652833, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "env_runners": {"episode_reward_max": 110.09052700174094, "episode_reward_min": 58.59464916859116, "episode_reward_mean": 84.73460921409162, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 58.59464916859116}, "policy_reward_max": {"tplp_policy": 110.09052700174094}, "policy_reward_mean": {"tplp_policy": 84.73460921409162}, "custom_metrics": {"mean_episode_reward_mean": 84.73460921409162, "mean_episode_reward_min": 58.59464916859116, "mean_episode_reward_max": 110.09052700174094}, "hist_stats": {"episode_reward": [66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [66.49389934595852, 59.94203473303631, 89.38090773677035, 94.57095945172831, 92.70777059222675, 90.60745456392745, 90.23882747734444, 87.2613307641121, 78.28918601516648, 90.46853210249814, 84.94365157562, 94.66577030972155, 84.3373934793743, 80.19645805583318, 105.08006668157978, 66.7790649678618, 93.70966589916621, 75.98500778956239, 89.40181031870678, 110.09052700174094, 84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7240269533800117, "mean_inference_ms": 2.0946364405795013, "mean_action_processing_ms": 0.397287037932769, "mean_env_wait_ms": 2.3187087624008664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.013305902481079102, "ViewRequirementAgentConnector_ms": 0.22586321830749512}, "num_episodes": 18, "episode_return_max": 110.09052700174094, "episode_return_min": 58.59464916859116, "episode_return_mean": 84.73460921409162, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 418.6433586623429, "num_env_steps_trained_throughput_per_sec": 418.6433586623429, "timesteps_total": 83968, "num_env_steps_sampled_lifetime": 83968, "num_agent_steps_sampled_lifetime": 83968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 2565.822, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2565.822, "sample_time_ms": 1000.011, "learn_time_ms": 1545.253, "learn_throughput": 662.675, "synch_weights_time_ms": 20.266}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "training_iteration": 82, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-33", "timestamp": 1744167213, "time_this_iter_s": 2.452699899673462, "time_total_s": 212.11387848854065, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.11387848854065, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 38.95, "ram_util_percent": 97.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.90254684612155, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 1e-07, "total_loss": 2.1214915990829466, "policy_loss": -0.0003149126103380695, "vf_loss": 9.660205698013305, "vf_explained_var": -6.599128246307374e-05, "kl": 2.846263856481901e-06, "entropy": 2.932448926568031, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "env_runners": {"episode_reward_max": 113.99420633306879, "episode_reward_min": 58.59464916859116, "episode_reward_mean": 85.154826391968, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 58.59464916859116}, "policy_reward_max": {"tplp_policy": 113.99420633306879}, "policy_reward_mean": {"tplp_policy": 85.154826391968}, "custom_metrics": {"mean_episode_reward_mean": 85.154826391968, "mean_episode_reward_min": 58.59464916859116, "mean_episode_reward_max": 113.99420633306879}, "hist_stats": {"episode_reward": [84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.00233060756457, 81.69271117466612, 69.52504409858524, 87.88783957515317, 89.51131166358942, 89.5008780393272, 80.36792963713178, 77.99196060251141, 90.33482707410562, 66.84558779741344, 76.44736950330976, 85.48275633667659, 93.55837423779991, 76.18018048116807, 72.39736917055254, 78.87431483850226, 104.43053395019557, 90.90423178926568, 89.4699519316761, 80.69567318495605, 93.30610551342477, 72.934067370851, 90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7237068008342479, "mean_inference_ms": 2.094040059531318, "mean_action_processing_ms": 0.3970310797206597, "mean_env_wait_ms": 2.318941335041799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022836923599243164, "StateBufferConnector_ms": 0.012800931930541992, "ViewRequirementAgentConnector_ms": 0.23434162139892578}, "num_episodes": 20, "episode_return_max": 113.99420633306879, "episode_return_min": 58.59464916859116, "episode_return_mean": 85.154826391968, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 394.4975028898655, "num_env_steps_trained_throughput_per_sec": 394.4975028898655, "timesteps_total": 84992, "num_env_steps_sampled_lifetime": 84992, "num_agent_steps_sampled_lifetime": 84992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 2419.522, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2419.522, "sample_time_ms": 971.826, "learn_time_ms": 1427.363, "learn_throughput": 717.407, "synch_weights_time_ms": 19.942}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "training_iteration": 83, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-36", "timestamp": 1744167216, "time_this_iter_s": 2.602619171142578, "time_total_s": 214.71649765968323, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.71649765968323, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 47.699999999999996, "ram_util_percent": 97.53333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8322051845490934, "cur_kl_coeff": 2.067951531382569e-26, "cur_lr": 1e-07, "total_loss": 2.110848696529865, "policy_loss": -0.0002614495751913637, "vf_loss": 9.618394702672958, "vf_explained_var": -7.541812956333161e-05, "kl": 1.949966596931363e-06, "entropy": 2.9348853081464767, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "env_runners": {"episode_reward_max": 113.99420633306879, "episode_reward_min": 55.32127975783227, "episode_reward_mean": 85.58475717346441, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 55.32127975783227}, "policy_reward_max": {"tplp_policy": 113.99420633306879}, "policy_reward_mean": {"tplp_policy": 85.58475717346441}, "custom_metrics": {"mean_episode_reward_mean": 85.58475717346441, "mean_episode_reward_min": 55.32127975783227, "mean_episode_reward_max": 113.99420633306879}, "hist_stats": {"episode_reward": [90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.93659598475436, 80.49257673892389, 77.75686788669637, 95.04808464223048, 74.61940554148892, 75.4797041240827, 84.15134236952089, 93.72490190600521, 100.18965577552622, 74.86850892038309, 80.54167469916044, 96.82990732191698, 86.0136590421097, 79.62633946756313, 106.56337103570351, 93.18883421816672, 77.2945854566304, 93.68715827135206, 89.31044579727158, 94.85632982202517, 65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238863652127661, "mean_inference_ms": 2.0945622713013865, "mean_action_processing_ms": 0.3969867490308956, "mean_env_wait_ms": 2.32056573503516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009162664413452148, "StateBufferConnector_ms": 0.005769491195678711, "ViewRequirementAgentConnector_ms": 0.233473539352417}, "num_episodes": 22, "episode_return_max": 113.99420633306879, "episode_return_min": 55.32127975783227, "episode_return_mean": 85.58475717346441, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.67851851552757, "num_env_steps_trained_throughput_per_sec": 309.67851851552757, "timesteps_total": 86016, "num_env_steps_sampled_lifetime": 86016, "num_agent_steps_sampled_lifetime": 86016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 2531.204, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2531.204, "sample_time_ms": 1006.412, "learn_time_ms": 1503.887, "learn_throughput": 680.902, "synch_weights_time_ms": 20.412}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "training_iteration": 84, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-39", "timestamp": 1744167219, "time_this_iter_s": 3.3158562183380127, "time_total_s": 218.03235387802124, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.03235387802124, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 43.22, "ram_util_percent": 97.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8732774056494237, "cur_kl_coeff": 1.0339757656912845e-26, "cur_lr": 1e-07, "total_loss": 2.132230508327484, "policy_loss": -0.00029042451933491975, "vf_loss": 9.704342013597488, "vf_explained_var": -8.0113485455513e-05, "kl": 1.3628415236999203e-06, "entropy": 2.9356456652283667, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "env_runners": {"episode_reward_max": 113.99420633306879, "episode_reward_min": 53.07061711352252, "episode_reward_mean": 85.01007405371789, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.07061711352252}, "policy_reward_max": {"tplp_policy": 113.99420633306879}, "policy_reward_mean": {"tplp_policy": 85.01007405371789}, "custom_metrics": {"mean_episode_reward_mean": 85.01007405371789, "mean_episode_reward_min": 53.07061711352252, "mean_episode_reward_max": 113.99420633306879}, "hist_stats": {"episode_reward": [65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [65.80085666410754, 92.16059429240804, 79.16798348319675, 78.21041353096936, 91.51835935558545, 88.99121289385612, 72.19298427446023, 87.59402010689534, 79.31307132338058, 58.59464916859116, 77.81377947460709, 73.79425970589091, 85.09111686032313, 83.51738766881596, 92.08358319811096, 85.3886137456467, 109.6993659459847, 81.87037374106802, 104.14073992361965, 86.9075621484379, 98.34431184373294, 90.63821065196767, 83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7243537753706397, "mean_inference_ms": 2.0960374471614416, "mean_action_processing_ms": 0.39713859236535254, "mean_env_wait_ms": 2.323285988863608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008153676986694336, "StateBufferConnector_ms": 0.010914325714111328, "ViewRequirementAgentConnector_ms": 0.23101258277893066}, "num_episodes": 20, "episode_return_max": 113.99420633306879, "episode_return_min": 53.07061711352252, "episode_return_mean": 85.01007405371789, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 378.2037865575929, "num_env_steps_trained_throughput_per_sec": 378.2037865575929, "timesteps_total": 87040, "num_env_steps_sampled_lifetime": 87040, "num_agent_steps_sampled_lifetime": 87040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 2522.213, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2522.213, "sample_time_ms": 1019.991, "learn_time_ms": 1481.45, "learn_throughput": 691.215, "synch_weights_time_ms": 20.28}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "training_iteration": 85, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-42", "timestamp": 1744167222, "time_this_iter_s": 2.715643882751465, "time_total_s": 220.7479977607727, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.7479977607727, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 54.025, "ram_util_percent": 97.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.803209511935711, "cur_kl_coeff": 5.1698788284564225e-27, "cur_lr": 1e-07, "total_loss": 2.105807128548622, "policy_loss": -0.0002400054014287889, "vf_loss": 9.59855768084526, "vf_explained_var": -8.261017501354218e-05, "kl": 1.6692911900539897e-06, "entropy": 2.9359226301312447, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "env_runners": {"episode_reward_max": 113.99420633306879, "episode_reward_min": 53.07061711352252, "episode_reward_mean": 84.64768024196292, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.07061711352252}, "policy_reward_max": {"tplp_policy": 113.99420633306879}, "policy_reward_mean": {"tplp_policy": 84.64768024196292}, "custom_metrics": {"mean_episode_reward_mean": 84.64768024196292, "mean_episode_reward_min": 53.07061711352252, "mean_episode_reward_max": 113.99420633306879}, "hist_stats": {"episode_reward": [83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.5134948593108, 79.41742654103479, 87.34319978324004, 82.27938750740138, 91.66844905323036, 68.18056105424473, 75.70143917575453, 84.41024341799664, 81.8699867840207, 63.16817434624669, 88.66735509754774, 94.05861486115327, 82.99579554192496, 84.95138371274399, 80.8747167937498, 78.85562641603305, 87.41576502662517, 84.0344126925816, 84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7250455999060076, "mean_inference_ms": 2.0980399170368687, "mean_action_processing_ms": 0.39747463312792936, "mean_env_wait_ms": 2.326848425477808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03214383125305176, "StateBufferConnector_ms": 0.01191854476928711, "ViewRequirementAgentConnector_ms": 0.22265195846557617}, "num_episodes": 22, "episode_return_max": 113.99420633306879, "episode_return_min": 53.07061711352252, "episode_return_mean": 84.64768024196292, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.4549131437888, "num_env_steps_trained_throughput_per_sec": 422.4549131437888, "timesteps_total": 88064, "num_env_steps_sampled_lifetime": 88064, "num_agent_steps_sampled_lifetime": 88064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 2521.842, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2521.842, "sample_time_ms": 1012.003, "learn_time_ms": 1489.312, "learn_throughput": 687.566, "synch_weights_time_ms": 20.035}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "done": false, "training_iteration": 86, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-44", "timestamp": 1744167224, "time_this_iter_s": 2.4311728477478027, "time_total_s": 223.1791706085205, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.1791706085205, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 52.86666666666667, "ram_util_percent": 97.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6200588531792164, "cur_kl_coeff": 2.5849394142282113e-27, "cur_lr": 1e-07, "total_loss": 2.1028443217277526, "policy_loss": -0.00024709603167138994, "vf_loss": 9.587450069189071, "vf_explained_var": -7.331371307373047e-05, "kl": 2.098509273285032e-06, "entropy": 2.937710812687874, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "env_runners": {"episode_reward_max": 113.99420633306879, "episode_reward_min": 53.07061711352252, "episode_reward_mean": 85.80071536134345, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.07061711352252}, "policy_reward_max": {"tplp_policy": 113.99420633306879}, "policy_reward_mean": {"tplp_policy": 85.80071536134345}, "custom_metrics": {"mean_episode_reward_mean": 85.80071536134345, "mean_episode_reward_min": 53.07061711352252, "mean_episode_reward_max": 113.99420633306879}, "hist_stats": {"episode_reward": [84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.24404648681455, 87.52458451024413, 95.28368393879587, 86.8968590819959, 79.05224211534181, 113.99420633306879, 83.60193714600537, 91.25251263677524, 90.8283804943915, 90.2190269284661, 108.77312213970404, 94.09504214741038, 68.78069889004608, 83.7733516389221, 91.57722433628231, 87.5621328020636, 78.81718120140805, 79.44562610262919, 81.05538649804775, 86.16387511617934, 76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7254760222674626, "mean_inference_ms": 2.099465088363613, "mean_action_processing_ms": 0.39780727178216346, "mean_env_wait_ms": 2.329511682294049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198575973510742, "StateBufferConnector_ms": 0.012916088104248047, "ViewRequirementAgentConnector_ms": 0.21759343147277832}, "num_episodes": 18, "episode_return_max": 113.99420633306879, "episode_return_min": 53.07061711352252, "episode_return_mean": 85.80071536134345, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 425.366800794407, "num_env_steps_trained_throughput_per_sec": 425.366800794407, "timesteps_total": 89088, "num_env_steps_sampled_lifetime": 89088, "num_agent_steps_sampled_lifetime": 89088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 2524.832, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2524.832, "sample_time_ms": 1009.705, "learn_time_ms": 1494.537, "learn_throughput": 685.162, "synch_weights_time_ms": 20.151}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "done": false, "training_iteration": 87, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-47", "timestamp": 1744167227, "time_this_iter_s": 2.4138808250427246, "time_total_s": 225.59305143356323, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.59305143356323, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.175000000000004, "ram_util_percent": 97.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4382604718208314, "cur_kl_coeff": 1.2924697071141056e-27, "cur_lr": 1e-07, "total_loss": 2.1103698775172233, "policy_loss": -0.00014138134429231286, "vf_loss": 9.618001294136047, "vf_explained_var": -8.932128548622131e-05, "kl": 1.842474813562589e-06, "entropy": 2.9398906975984573, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "env_runners": {"episode_reward_max": 113.73572042387427, "episode_reward_min": 53.07061711352252, "episode_reward_mean": 85.72163646334826, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.07061711352252}, "policy_reward_max": {"tplp_policy": 113.73572042387427}, "policy_reward_mean": {"tplp_policy": 85.72163646334826}, "custom_metrics": {"mean_episode_reward_mean": 85.72163646334826, "mean_episode_reward_min": 53.07061711352252, "mean_episode_reward_max": 113.73572042387427}, "hist_stats": {"episode_reward": [76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [76.1074051141478, 77.16101440178167, 55.32127975783227, 82.85200418320522, 81.87187609278365, 89.93927285395853, 87.55513543912356, 84.40526202145071, 85.06967666241617, 92.34870385830983, 95.15117403616868, 99.1712632672936, 85.50771883546605, 76.3266767394375, 73.62015926180985, 113.73572042387427, 94.04897927289656, 72.13892834126676, 109.44415737890178, 76.3387571717131, 86.0605530874705, 84.62112614217125, 67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7257893285734762, "mean_inference_ms": 2.100889334460561, "mean_action_processing_ms": 0.3982211729121993, "mean_env_wait_ms": 2.3319002752117024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995752334594727, "StateBufferConnector_ms": 0.013920068740844727, "ViewRequirementAgentConnector_ms": 0.21929526329040527}, "num_episodes": 20, "episode_return_max": 113.73572042387427, "episode_return_min": 53.07061711352252, "episode_return_mean": 85.72163646334826, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 379.6910251585454, "num_env_steps_trained_throughput_per_sec": 379.6910251585454, "timesteps_total": 90112, "num_env_steps_sampled_lifetime": 90112, "num_agent_steps_sampled_lifetime": 90112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 2561.549, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2561.549, "sample_time_ms": 1016.721, "learn_time_ms": 1524.232, "learn_throughput": 671.814, "synch_weights_time_ms": 20.159}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "training_iteration": 88, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-50", "timestamp": 1744167230, "time_this_iter_s": 2.7051689624786377, "time_total_s": 228.29822039604187, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 228.29822039604187, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 39.425, "ram_util_percent": 97.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3567954041063786, "cur_kl_coeff": 6.462348535570528e-28, "cur_lr": 1e-07, "total_loss": 2.1192446887493133, "policy_loss": -0.00017462860560044647, "vf_loss": 9.654179745912552, "vf_explained_var": -8.05635005235672e-05, "kl": 1.180699017941378e-06, "entropy": 2.941256272792816, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "env_runners": {"episode_reward_max": 110.8903966067057, "episode_reward_min": 53.07061711352252, "episode_reward_mean": 84.82535995264581, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 53.07061711352252}, "policy_reward_max": {"tplp_policy": 110.8903966067057}, "policy_reward_mean": {"tplp_policy": 84.82535995264581}, "custom_metrics": {"mean_episode_reward_mean": 84.82535995264581, "mean_episode_reward_min": 53.07061711352252, "mean_episode_reward_max": 110.8903966067057}, "hist_stats": {"episode_reward": [67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [67.99420229454252, 93.08854142104397, 90.2388715934859, 106.09703196398584, 79.38023297223077, 86.745126717831, 106.04931289815119, 97.73972385571298, 91.72002000930041, 80.70271851718906, 72.63067782566081, 98.07741724435465, 53.07061711352252, 80.28229787399303, 92.94828872491, 70.56991532900923, 76.42662834431675, 73.26833311798025, 97.472979391144, 90.54137785075388, 91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7258308978908012, "mean_inference_ms": 2.101309825382465, "mean_action_processing_ms": 0.39858259337230956, "mean_env_wait_ms": 2.333312021651089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03305196762084961, "StateBufferConnector_ms": 0.010493040084838867, "ViewRequirementAgentConnector_ms": 0.2046051025390625}, "num_episodes": 22, "episode_return_max": 110.8903966067057, "episode_return_min": 53.07061711352252, "episode_return_mean": 84.82535995264581, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 421.7747923467571, "num_env_steps_trained_throughput_per_sec": 421.7747923467571, "timesteps_total": 91136, "num_env_steps_sampled_lifetime": 91136, "num_agent_steps_sampled_lifetime": 91136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 2554.807, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2554.807, "sample_time_ms": 1020.9, "learn_time_ms": 1513.459, "learn_throughput": 676.596, "synch_weights_time_ms": 20.147}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "done": false, "training_iteration": 89, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-52", "timestamp": 1744167232, "time_this_iter_s": 2.4354100227355957, "time_total_s": 230.73363041877747, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.73363041877747, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 49.76666666666667, "ram_util_percent": 97.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5100342474877833, "cur_kl_coeff": 3.231174267785264e-28, "cur_lr": 1e-07, "total_loss": 2.116257445514202, "policy_loss": -0.0003036285925190896, "vf_loss": 9.642812329530717, "vf_explained_var": -6.285049021244049e-05, "kl": 1.379592581440825e-06, "entropy": 2.9414198085665704, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "env_runners": {"episode_reward_max": 110.8903966067057, "episode_reward_min": 61.29379093392849, "episode_reward_mean": 85.21038626736059, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.29379093392849}, "policy_reward_max": {"tplp_policy": 110.8903966067057}, "policy_reward_mean": {"tplp_policy": 85.21038626736059}, "custom_metrics": {"mean_episode_reward_mean": 85.21038626736059, "mean_episode_reward_min": 61.29379093392849, "mean_episode_reward_max": 110.8903966067057}, "hist_stats": {"episode_reward": [91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [91.18164274607594, 75.37275892604728, 75.92021167543457, 85.56713114686436, 89.90371886120202, 110.8903966067057, 75.28413406898625, 78.29138068842197, 62.49129815553946, 66.89427972679619, 97.19660592739861, 75.02525272028845, 72.78665629709026, 94.88292882620907, 73.25024090768754, 85.1146133847572, 66.81971579052852, 90.56754863090909, 75.6901027460845, 95.44909375123412, 93.22965449090398, 80.23476168577061, 100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7256257523308779, "mean_inference_ms": 2.10081442753991, "mean_action_processing_ms": 0.39878639523936, "mean_env_wait_ms": 2.333584643419377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0320436954498291, "StateBufferConnector_ms": 0.0060100555419921875, "ViewRequirementAgentConnector_ms": 0.2058253288269043}, "num_episodes": 20, "episode_return_max": 110.8903966067057, "episode_return_min": 61.29379093392849, "episode_return_mean": 85.21038626736059, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.5090834236892, "num_env_steps_trained_throughput_per_sec": 445.5090834236892, "timesteps_total": 92160, "num_env_steps_sampled_lifetime": 92160, "num_agent_steps_sampled_lifetime": 92160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 2559.582, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2559.582, "sample_time_ms": 1023.935, "learn_time_ms": 1515.159, "learn_throughput": 675.837, "synch_weights_time_ms": 20.187}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "training_iteration": 90, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-55", "timestamp": 1744167235, "time_this_iter_s": 2.30476713180542, "time_total_s": 233.03839755058289, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.03839755058289, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 39.175000000000004, "ram_util_percent": 97.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.464838247746229, "cur_kl_coeff": 1.615587133892632e-28, "cur_lr": 1e-07, "total_loss": 2.126877553015947, "policy_loss": -0.00021969377994537353, "vf_loss": 9.685039359331132, "vf_explained_var": -8.665584027767181e-05, "kl": 1.5425733504700888e-06, "entropy": 2.9416260570287704, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "env_runners": {"episode_reward_max": 108.52749320550642, "episode_reward_min": 61.29379093392849, "episode_reward_mean": 86.20956712613354, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.29379093392849}, "policy_reward_max": {"tplp_policy": 108.52749320550642}, "policy_reward_mean": {"tplp_policy": 86.20956712613354}, "custom_metrics": {"mean_episode_reward_mean": 86.20956712613354, "mean_episode_reward_min": 61.29379093392849, "mean_episode_reward_max": 108.52749320550642}, "hist_stats": {"episode_reward": [100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [100.25301017673642, 101.90795276417421, 83.87819702459365, 82.91659349368084, 88.92579480808881, 93.53737375100752, 78.13523580907834, 106.97050782689608, 104.73095118486836, 84.96281504588285, 61.63773644867552, 70.23967181860176, 79.17677438092265, 105.22338800641896, 91.13339755884179, 87.61572832775066, 78.68927183672817, 79.35654701516634, 101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7252819696545562, "mean_inference_ms": 2.1000547104841996, "mean_action_processing_ms": 0.39881632973617476, "mean_env_wait_ms": 2.3332552405191134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010063648223876953, "StateBufferConnector_ms": 0.0050144195556640625, "ViewRequirementAgentConnector_ms": 0.19575929641723633}, "num_episodes": 22, "episode_return_max": 108.52749320550642, "episode_return_min": 61.29379093392849, "episode_return_mean": 86.20956712613354, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 460.691288470563, "num_env_steps_trained_throughput_per_sec": 460.691288470563, "timesteps_total": 93184, "num_env_steps_sampled_lifetime": 93184, "num_agent_steps_sampled_lifetime": 93184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 2553.316, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2553.316, "sample_time_ms": 1022.981, "learn_time_ms": 1510.122, "learn_throughput": 678.091, "synch_weights_time_ms": 19.912}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "done": false, "training_iteration": 91, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-57", "timestamp": 1744167237, "time_this_iter_s": 2.228637218475342, "time_total_s": 235.26703476905823, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BA6B70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.26703476905823, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.46666666666667, "ram_util_percent": 97.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.932945788651705, "cur_kl_coeff": 8.07793566946316e-29, "cur_lr": 1e-07, "total_loss": 2.15721180960536, "policy_loss": -0.0002552637131884694, "vf_loss": 9.807058864831925, "vf_explained_var": -9.098649024963379e-05, "kl": 2.767951646531763e-06, "entropy": 2.9429764837026595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "env_runners": {"episode_reward_max": 108.52749320550642, "episode_reward_min": 61.29379093392849, "episode_reward_mean": 86.3576328946131, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.29379093392849}, "policy_reward_max": {"tplp_policy": 108.52749320550642}, "policy_reward_mean": {"tplp_policy": 86.3576328946131}, "custom_metrics": {"mean_episode_reward_mean": 86.3576328946131, "mean_episode_reward_min": 61.29379093392849, "mean_episode_reward_max": 108.52749320550642}, "hist_stats": {"episode_reward": [101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.6023055692503, 87.15449811551254, 87.52820297657058, 94.29413403693819, 96.94690356016999, 97.98890028641621, 101.50447390457077, 67.72004808245977, 83.13113040735676, 92.69486891595577, 97.571462130826, 81.89281829914775, 93.63913280531129, 79.42695018204772, 77.55551647476898, 96.28947353250656, 83.56038478837385, 76.48620782499665, 83.20568304869094, 78.48237517870166, 85.83792114986618, 85.01163179432926, 78.52892153932234, 90.16825906276817, 82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7250210881595617, "mean_inference_ms": 2.0993352425973266, "mean_action_processing_ms": 0.39869507580068797, "mean_env_wait_ms": 2.3328789263608978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009057998657226562, "StateBufferConnector_ms": 0.005013704299926758, "ViewRequirementAgentConnector_ms": 0.2076263427734375}, "num_episodes": 18, "episode_return_max": 108.52749320550642, "episode_return_min": 61.29379093392849, "episode_return_mean": 86.3576328946131, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 413.7587932601599, "num_env_steps_trained_throughput_per_sec": 413.7587932601599, "timesteps_total": 94208, "num_env_steps_sampled_lifetime": 94208, "num_agent_steps_sampled_lifetime": 94208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 2556.204, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2556.204, "sample_time_ms": 1018.431, "learn_time_ms": 1517.422, "learn_throughput": 674.829, "synch_weights_time_ms": 20.15}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "training_iteration": 92, "trial_id": "374cd_00000", "date": "2025-04-09_10-53-59", "timestamp": 1744167239, "time_this_iter_s": 2.4814116954803467, "time_total_s": 237.74844646453857, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC0CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.74844646453857, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 37.225, "ram_util_percent": 96.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6499290257692336, "cur_kl_coeff": 4.03896783473158e-29, "cur_lr": 1e-07, "total_loss": 2.1178619392216205, "policy_loss": -0.00018063189345411955, "vf_loss": 9.65010113120079, "vf_explained_var": -2.9787048697471617e-05, "kl": 1.7428800774169085e-06, "entropy": 2.9448269486427305, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "env_runners": {"episode_reward_max": 108.73200674987852, "episode_reward_min": 61.29379093392849, "episode_reward_mean": 86.18365020714823, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.29379093392849}, "policy_reward_max": {"tplp_policy": 108.73200674987852}, "policy_reward_mean": {"tplp_policy": 86.18365020714823}, "custom_metrics": {"mean_episode_reward_mean": 86.18365020714823, "mean_episode_reward_min": 61.29379093392849, "mean_episode_reward_max": 108.73200674987852}, "hist_stats": {"episode_reward": [82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [82.49510218925138, 72.85591114468967, 75.57543757676767, 65.62010026721799, 76.02829652222256, 97.50168717153633, 72.47358487752535, 66.2697650320386, 92.2807582203651, 79.93159472322756, 61.29379093392849, 76.65057518280621, 94.83451216912167, 106.53363394491055, 88.94820971853126, 78.64144182541433, 93.75710366280136, 79.22998444630564, 66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7249034192280007, "mean_inference_ms": 2.0988769637643494, "mean_action_processing_ms": 0.3985071960918556, "mean_env_wait_ms": 2.3324876882059726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003998756408691406, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.2042548656463623}, "num_episodes": 24, "episode_return_max": 108.73200674987852, "episode_return_min": 61.29379093392849, "episode_return_mean": 86.18365020714823, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 410.03131307441816, "num_env_steps_trained_throughput_per_sec": 410.03131307441816, "timesteps_total": 95232, "num_env_steps_sampled_lifetime": 95232, "num_agent_steps_sampled_lifetime": 95232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 2546.37, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2546.37, "sample_time_ms": 1020.136, "learn_time_ms": 1506.502, "learn_throughput": 679.72, "synch_weights_time_ms": 19.631}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "done": false, "training_iteration": 93, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-02", "timestamp": 1744167242, "time_this_iter_s": 2.5047225952148438, "time_total_s": 240.25316905975342, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.25316905975342, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 47.46666666666666, "ram_util_percent": 96.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.751116028428078, "cur_kl_coeff": 2.01948391736579e-29, "cur_lr": 1e-07, "total_loss": 2.1289338752627374, "policy_loss": -0.00021372350165620445, "vf_loss": 9.694860637187958, "vf_explained_var": -0.00011641457676887512, "kl": 1.211543658174996e-06, "entropy": 2.9456756085157396, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "env_runners": {"episode_reward_max": 108.73200674987852, "episode_reward_min": 64.58529418623866, "episode_reward_mean": 87.3738609924789, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.58529418623866}, "policy_reward_max": {"tplp_policy": 108.73200674987852}, "policy_reward_mean": {"tplp_policy": 87.3738609924789}, "custom_metrics": {"mean_episode_reward_mean": 87.3738609924789, "mean_episode_reward_min": 64.58529418623866, "mean_episode_reward_max": 108.73200674987852}, "hist_stats": {"episode_reward": [66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [66.9579360954623, 94.44199502397181, 99.72659704402331, 90.41850787908902, 81.39408650654268, 91.98865775885453, 87.51400246319186, 81.95321699415507, 80.75558740809531, 80.33985672390526, 73.089465115191, 99.91472394492439, 84.79891421716673, 79.83794267743865, 108.52749320550642, 95.09723224615102, 78.79369269067044, 95.009950427151, 81.24643407488234, 82.1552388394406, 83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.724496082844533, "mean_inference_ms": 2.0979736678230716, "mean_action_processing_ms": 0.39837523044944073, "mean_env_wait_ms": 2.3323142368012357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006029844284057617, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.2162792682647705}, "num_episodes": 18, "episode_return_max": 108.73200674987852, "episode_return_min": 64.58529418623866, "episode_return_mean": 87.3738609924789, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 415.41017071118375, "num_env_steps_trained_throughput_per_sec": 415.41017071118375, "timesteps_total": 96256, "num_env_steps_sampled_lifetime": 96256, "num_agent_steps_sampled_lifetime": 96256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 2462.208, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2462.208, "sample_time_ms": 987.08, "learn_time_ms": 1456.791, "learn_throughput": 702.915, "synch_weights_time_ms": 18.337}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "done": false, "training_iteration": 94, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-04", "timestamp": 1744167244, "time_this_iter_s": 2.470839500427246, "time_total_s": 242.72400856018066, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.72400856018066, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 96.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8924489550292494, "cur_kl_coeff": 1.009741958682895e-29, "cur_lr": 1e-07, "total_loss": 2.1308559499680997, "policy_loss": -0.0003525719861499965, "vf_loss": 9.703513664007186, "vf_explained_var": -8.93283635377884e-05, "kl": 2.882410398186153e-06, "entropy": 2.946698807179928, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "env_runners": {"episode_reward_max": 108.73200674987852, "episode_reward_min": 64.58529418623866, "episode_reward_mean": 86.7878947808641, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.58529418623866}, "policy_reward_max": {"tplp_policy": 108.73200674987852}, "policy_reward_mean": {"tplp_policy": 86.7878947808641}, "custom_metrics": {"mean_episode_reward_mean": 86.7878947808641, "mean_episode_reward_min": 64.58529418623866, "mean_episode_reward_max": 108.73200674987852}, "hist_stats": {"episode_reward": [83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.08177901884854, 76.8970957440258, 89.619851539162, 80.22421064422636, 81.363045182676, 100.40897358751886, 82.99234769354005, 100.631064183934, 94.42716575340741, 96.44184823327991, 78.86770023613141, 80.41903035820198, 89.2856361743262, 81.72385368322831, 79.88554798237914, 83.53516518011472, 73.32588843599652, 102.75465070558826, 90.85825288372331, 101.8174335035966, 97.88193011760269, 99.34566349033435, 84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7241176296704009, "mean_inference_ms": 2.0969568239155807, "mean_action_processing_ms": 0.39823227377240067, "mean_env_wait_ms": 2.331664902143801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006002664566040039, "StateBufferConnector_ms": 0.008044719696044922, "ViewRequirementAgentConnector_ms": 0.21230220794677734}, "num_episodes": 20, "episode_return_max": 108.73200674987852, "episode_return_min": 64.58529418623866, "episode_return_mean": 86.7878947808641, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 449.01087701848655, "num_env_steps_trained_throughput_per_sec": 449.01087701848655, "timesteps_total": 97280, "num_env_steps_sampled_lifetime": 97280, "num_agent_steps_sampled_lifetime": 97280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 2419.511, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2419.511, "sample_time_ms": 961.694, "learn_time_ms": 1439.865, "learn_throughput": 711.178, "synch_weights_time_ms": 17.851}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "training_iteration": 95, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-07", "timestamp": 1744167247, "time_this_iter_s": 2.2860536575317383, "time_total_s": 245.0100622177124, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.0100622177124, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 41.86666666666667, "ram_util_percent": 96.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.863129409402609, "cur_kl_coeff": 5.048709793414475e-30, "cur_lr": 1e-07, "total_loss": 2.1375597774982453, "policy_loss": -0.0002867374976631254, "vf_loss": 9.730863910913467, "vf_explained_var": -0.00011014863848686218, "kl": 2.5792217579923006e-06, "entropy": 2.9486946657299997, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "env_runners": {"episode_reward_max": 108.73200674987852, "episode_reward_min": 63.25481709698363, "episode_reward_mean": 86.32285390350935, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.25481709698363}, "policy_reward_max": {"tplp_policy": 108.73200674987852}, "policy_reward_mean": {"tplp_policy": 86.32285390350935}, "custom_metrics": {"mean_episode_reward_mean": 86.32285390350935, "mean_episode_reward_min": 63.25481709698363, "mean_episode_reward_max": 108.73200674987852}, "hist_stats": {"episode_reward": [84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.69338872309952, 84.51792318433671, 79.49257337669222, 78.78758767884699, 105.30759310281078, 88.69469800171086, 69.76879487998636, 76.80367839086236, 76.60745193799079, 94.69912622420821, 94.84563999195674, 95.5908940721592, 83.35159050084809, 99.53570665199825, 93.65854207495889, 90.51474172566739, 69.4542532855412, 72.5755497141929, 99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7236713755830644, "mean_inference_ms": 2.0962676332245644, "mean_action_processing_ms": 0.39813179077645616, "mean_env_wait_ms": 2.3314345956822415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00699925422668457, "StateBufferConnector_ms": 0.010486364364624023, "ViewRequirementAgentConnector_ms": 0.21028757095336914}, "num_episodes": 22, "episode_return_max": 108.73200674987852, "episode_return_min": 63.25481709698363, "episode_return_mean": 86.32285390350935, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 419.1241610378042, "num_env_steps_trained_throughput_per_sec": 419.1241610378042, "timesteps_total": 98304, "num_env_steps_sampled_lifetime": 98304, "num_agent_steps_sampled_lifetime": 98304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 2421.437, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2421.437, "sample_time_ms": 962.596, "learn_time_ms": 1440.49, "learn_throughput": 710.869, "synch_weights_time_ms": 18.105}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "training_iteration": 96, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-09", "timestamp": 1744167249, "time_this_iter_s": 2.449173927307129, "time_total_s": 247.45923614501953, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.45923614501953, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 43.949999999999996, "ram_util_percent": 96.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5904313825070857, "cur_kl_coeff": 2.5243548967072376e-30, "cur_lr": 1e-07, "total_loss": 2.1141321696341038, "policy_loss": -0.000275616132421419, "vf_loss": 9.63720480799675, "vf_explained_var": -0.00011301338672637939, "kl": 1.3182261752842095e-06, "entropy": 2.9489340871572494, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "env_runners": {"episode_reward_max": 108.73200674987852, "episode_reward_min": 63.25481709698363, "episode_reward_mean": 87.03197949798025, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.25481709698363}, "policy_reward_max": {"tplp_policy": 108.73200674987852}, "policy_reward_mean": {"tplp_policy": 87.03197949798025}, "custom_metrics": {"mean_episode_reward_mean": 87.03197949798025, "mean_episode_reward_min": 63.25481709698363, "mean_episode_reward_max": 108.73200674987852}, "hist_stats": {"episode_reward": [99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.5367121843734, 79.75182946248175, 79.08348609719059, 89.5138737688105, 87.9558224021454, 108.73200674987852, 84.86327874967077, 94.49895305084196, 99.42397021087282, 80.01949182305654, 100.12807640483572, 84.18841349795994, 64.58529418623866, 101.56075917453923, 96.34205284002094, 89.11027816996537, 97.43616793139628, 65.98440937622705, 73.97171243585643, 101.59510389524043, 77.67224513097301, 82.84019437806447, 79.67024759538897, 92.86623632223676, 97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7234264022361835, "mean_inference_ms": 2.0959963832949735, "mean_action_processing_ms": 0.39819955721260536, "mean_env_wait_ms": 2.3313058134736337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008994817733764648, "StateBufferConnector_ms": 0.011498689651489258, "ViewRequirementAgentConnector_ms": 0.20153403282165527}, "num_episodes": 18, "episode_return_max": 108.73200674987852, "episode_return_min": 63.25481709698363, "episode_return_mean": 87.03197949798025, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 461.49781907041705, "num_env_steps_trained_throughput_per_sec": 461.49781907041705, "timesteps_total": 99328, "num_env_steps_sampled_lifetime": 99328, "num_agent_steps_sampled_lifetime": 99328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 2402.59, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2402.59, "sample_time_ms": 969.352, "learn_time_ms": 1414.776, "learn_throughput": 723.79, "synch_weights_time_ms": 18.216}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "done": false, "training_iteration": 97, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-12", "timestamp": 1744167252, "time_this_iter_s": 2.224989652633667, "time_total_s": 249.6842257976532, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.6842257976532, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 43.333333333333336, "ram_util_percent": 95.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.139594180509448, "cur_kl_coeff": 1.2621774483536188e-30, "cur_lr": 1e-07, "total_loss": 2.1087360352277758, "policy_loss": -0.00012206367682665586, "vf_loss": 9.614826792478562, "vf_explained_var": -8.626505732536315e-05, "kl": 7.703335878350703e-07, "entropy": 2.948485906422138, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "env_runners": {"episode_reward_max": 108.71536018577093, "episode_reward_min": 61.30951977086254, "episode_reward_mean": 86.51955659550907, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.30951977086254}, "policy_reward_max": {"tplp_policy": 108.71536018577093}, "policy_reward_mean": {"tplp_policy": 86.51955659550907}, "custom_metrics": {"mean_episode_reward_mean": 86.51955659550907, "mean_episode_reward_min": 61.30951977086254, "mean_episode_reward_max": 108.71536018577093}, "hist_stats": {"episode_reward": [97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.54094741930416, 78.6645409735506, 92.14335704435858, 106.21748834846193, 77.05813636400396, 87.77671403961673, 84.5943526455468, 68.16245297814882, 88.52597711007363, 106.42886354079754, 75.76168027110324, 83.33883779266009, 87.64025876606932, 83.7345786571911, 103.40730106076188, 86.41059721245249, 74.88584655786508, 84.60837734769594, 70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228884643112156, "mean_inference_ms": 2.0946665540084215, "mean_action_processing_ms": 0.3981352716800383, "mean_env_wait_ms": 2.3301380399883134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00910043716430664, "StateBufferConnector_ms": 0.014677047729492188, "ViewRequirementAgentConnector_ms": 0.20501136779785156}, "num_episodes": 24, "episode_return_max": 108.71536018577093, "episode_return_min": 61.30951977086254, "episode_return_mean": 86.51955659550907, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.20084316009024, "num_env_steps_trained_throughput_per_sec": 485.20084316009024, "timesteps_total": 100352, "num_env_steps_sampled_lifetime": 100352, "num_agent_steps_sampled_lifetime": 100352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 2343.944, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2343.944, "sample_time_ms": 958.305, "learn_time_ms": 1367.727, "learn_throughput": 748.687, "synch_weights_time_ms": 17.555}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "done": false, "training_iteration": 98, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-14", "timestamp": 1744167254, "time_this_iter_s": 2.115050792694092, "time_total_s": 251.7992765903473, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 251.7992765903473, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 33.33333333333333, "ram_util_percent": 95.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6280188292264937, "cur_kl_coeff": 6.310887241768094e-31, "cur_lr": 1e-07, "total_loss": 2.1013767801225187, "policy_loss": -0.00027625662041828034, "vf_loss": 9.58649663925171, "vf_explained_var": -8.616186678409577e-05, "kl": 2.489457273874285e-06, "entropy": 2.949711246788502, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "env_runners": {"episode_reward_max": 108.71536018577093, "episode_reward_min": 61.30951977086254, "episode_reward_mean": 85.92415346866984, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.30951977086254}, "policy_reward_max": {"tplp_policy": 108.71536018577093}, "policy_reward_mean": {"tplp_policy": 85.92415346866984}, "custom_metrics": {"mean_episode_reward_mean": 85.92415346866984, "mean_episode_reward_min": 61.30951977086254, "mean_episode_reward_max": 108.71536018577093}, "hist_stats": {"episode_reward": [70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [70.89375326319137, 80.11865436895447, 75.65766238178557, 92.7440371894886, 82.7357062372832, 82.33571227271125, 108.71536018577093, 78.59568926562933, 90.69342981007311, 72.7365543432426, 83.71173751072625, 79.9419824720763, 79.38727949996272, 83.12408028536494, 79.26179623336324, 95.16371814050075, 91.63364066913562, 88.41989213951284, 98.63610617403931, 92.79219917726431, 90.72473390325003, 63.25481709698363, 65.76642604125227, 106.79603540087142, 101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7224960746328741, "mean_inference_ms": 2.093430983755245, "mean_action_processing_ms": 0.39804390817335467, "mean_env_wait_ms": 2.3291503233542223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706934928894043, "StateBufferConnector_ms": 0.016682863235473633, "ViewRequirementAgentConnector_ms": 0.203033447265625}, "num_episodes": 18, "episode_return_max": 108.71536018577093, "episode_return_min": 61.30951977086254, "episode_return_mean": 85.92415346866984, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 449.15573723174896, "num_env_steps_trained_throughput_per_sec": 449.15573723174896, "timesteps_total": 101376, "num_env_steps_sampled_lifetime": 101376, "num_agent_steps_sampled_lifetime": 101376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 101376, "timers": {"training_iteration_time_ms": 2329.144, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2329.144, "sample_time_ms": 946.13, "learn_time_ms": 1365.322, "learn_throughput": 750.006, "synch_weights_time_ms": 17.336}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "done": false, "training_iteration": 99, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-16", "timestamp": 1744167256, "time_this_iter_s": 2.2868239879608154, "time_total_s": 254.0861005783081, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC32E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.0861005783081, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 38.766666666666666, "ram_util_percent": 95.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6764353938400745, "cur_kl_coeff": 3.155443620884047e-31, "cur_lr": 1e-07, "total_loss": 2.1355267323553564, "policy_loss": -0.00018560888711363077, "vf_loss": 9.72324765920639, "vf_explained_var": -0.00011197030544281006, "kl": 1.4435634832832277e-06, "entropy": 2.9509959489107134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "env_runners": {"episode_reward_max": 106.718363147954, "episode_reward_min": 61.30951977086254, "episode_reward_mean": 86.19656183637788, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.30951977086254}, "policy_reward_max": {"tplp_policy": 106.718363147954}, "policy_reward_mean": {"tplp_policy": 86.19656183637788}, "custom_metrics": {"mean_episode_reward_mean": 86.19656183637788, "mean_episode_reward_min": 61.30951977086254, "mean_episode_reward_max": 106.718363147954}, "hist_stats": {"episode_reward": [101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.67698877853297, 86.66462619547008, 83.93373091480034, 72.17127660014579, 103.39217573248523, 78.48719641237028, 73.56983707372275, 99.74743374230792, 91.91287362771644, 76.49601064564665, 88.19127873018743, 86.04393270513646, 82.94197758626743, 78.56916899360485, 90.3330359035017, 87.18218516080815, 94.18289734963159, 90.3381422417515, 94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221291356018245, "mean_inference_ms": 2.092482447972369, "mean_action_processing_ms": 0.3978852123849261, "mean_env_wait_ms": 2.327850077107495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004096508026123047, "StateBufferConnector_ms": 0.011272907257080078, "ViewRequirementAgentConnector_ms": 0.21024537086486816}, "num_episodes": 24, "episode_return_max": 106.718363147954, "episode_return_min": 61.30951977086254, "episode_return_mean": 86.19656183637788, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 427.5211543457682, "num_env_steps_trained_throughput_per_sec": 427.5211543457682, "timesteps_total": 102400, "num_env_steps_sampled_lifetime": 102400, "num_agent_steps_sampled_lifetime": 102400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 2338.814, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2338.814, "sample_time_ms": 948.547, "learn_time_ms": 1372.461, "learn_throughput": 746.105, "synch_weights_time_ms": 17.45}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "training_iteration": 100, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-19", "timestamp": 1744167259, "time_this_iter_s": 2.4020700454711914, "time_total_s": 256.4881706237793, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.4881706237793, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 42.3, "ram_util_percent": 95.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.772394184395671, "cur_kl_coeff": 1.5777218104420235e-31, "cur_lr": 1e-07, "total_loss": 2.1247975870966913, "policy_loss": -0.0003063014766667038, "vf_loss": 9.681059664487838, "vf_explained_var": -0.00010711550712585449, "kl": 1.965247266629e-06, "entropy": 2.9516102761030196, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "env_runners": {"episode_reward_max": 106.718363147954, "episode_reward_min": 61.30951977086254, "episode_reward_mean": 86.0877008400543, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.30951977086254}, "policy_reward_max": {"tplp_policy": 106.718363147954}, "policy_reward_mean": {"tplp_policy": 86.0877008400543}, "custom_metrics": {"mean_episode_reward_mean": 86.0877008400543, "mean_episode_reward_min": 61.30951977086254, "mean_episode_reward_max": 106.718363147954}, "hist_stats": {"episode_reward": [94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [94.94172199053878, 91.70532206576353, 75.71002065451673, 76.15519833495574, 82.68917970198082, 82.27715457016362, 83.84515430545535, 98.15274349368636, 88.81853169763076, 83.54965725724789, 96.56237402321858, 85.40917470322972, 105.63523080980808, 93.1154663317163, 80.00596028570939, 106.718363147954, 89.40746926953166, 71.57291438408355, 93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7216803744860372, "mean_inference_ms": 2.0912271477055344, "mean_action_processing_ms": 0.3977716803652416, "mean_env_wait_ms": 2.3269364608127576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005205631256103516, "StateBufferConnector_ms": 0.009828329086303711, "ViewRequirementAgentConnector_ms": 0.20930171012878418}, "num_episodes": 18, "episode_return_max": 106.718363147954, "episode_return_min": 61.30951977086254, "episode_return_mean": 86.0877008400543, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 459.07674271721845, "num_env_steps_trained_throughput_per_sec": 459.07674271721845, "timesteps_total": 103424, "num_env_steps_sampled_lifetime": 103424, "num_agent_steps_sampled_lifetime": 103424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 103424, "timers": {"training_iteration_time_ms": 2339.596, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2339.596, "sample_time_ms": 949.041, "learn_time_ms": 1372.694, "learn_throughput": 745.978, "synch_weights_time_ms": 17.505}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "done": false, "training_iteration": 101, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-21", "timestamp": 1744167261, "time_this_iter_s": 2.2363672256469727, "time_total_s": 258.72453784942627, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BED72F4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.72453784942627, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 95.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.018900611251593, "cur_kl_coeff": 7.888609052210117e-32, "cur_lr": 1e-07, "total_loss": 2.131840391457081, "policy_loss": -0.00023304216738324613, "vf_loss": 9.709522634744644, "vf_explained_var": -0.00014157593250274658, "kl": 2.3228844564626703e-06, "entropy": 2.9530722215771674, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "env_runners": {"episode_reward_max": 110.94062524236931, "episode_reward_min": 61.30951977086254, "episode_reward_mean": 86.20930043818394, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.30951977086254}, "policy_reward_max": {"tplp_policy": 110.94062524236931}, "policy_reward_mean": {"tplp_policy": 86.20930043818394}, "custom_metrics": {"mean_episode_reward_mean": 86.20930043818394, "mean_episode_reward_min": 61.30951977086254, "mean_episode_reward_max": 110.94062524236931}, "hist_stats": {"episode_reward": [93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [93.08856318240056, 87.73930240818174, 80.03036399869477, 97.30279514532467, 61.30951977086254, 95.5643042429305, 80.02936295583548, 87.78728402994093, 96.0308448424687, 80.61927216041026, 81.9940787869447, 97.98126313560856, 80.1450853402219, 76.36987705264069, 91.70971810513497, 84.04283527700444, 77.08255210412452, 83.08296472294222, 90.1855522627353, 86.46155331593611, 96.58572221186077, 93.96512688532813, 101.64442879458386, 88.77016938880682, 92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7210729552054276, "mean_inference_ms": 2.0894869225917763, "mean_action_processing_ms": 0.3974387673440321, "mean_env_wait_ms": 2.3253521636044825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062143802642822266, "StateBufferConnector_ms": 0.007829904556274414, "ViewRequirementAgentConnector_ms": 0.20389652252197266}, "num_episodes": 18, "episode_return_max": 110.94062524236931, "episode_return_min": 61.30951977086254, "episode_return_mean": 86.20930043818394, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 494.6602540396314, "num_env_steps_trained_throughput_per_sec": 494.6602540396314, "timesteps_total": 104448, "num_env_steps_sampled_lifetime": 104448, "num_agent_steps_sampled_lifetime": 104448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 104448, "timers": {"training_iteration_time_ms": 2299.12, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2299.12, "sample_time_ms": 936.509, "learn_time_ms": 1345.195, "learn_throughput": 761.228, "synch_weights_time_ms": 17.009}, "counters": {"num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "done": false, "training_iteration": 102, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-23", "timestamp": 1744167263, "time_this_iter_s": 2.0750467777252197, "time_total_s": 260.7995846271515, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.7995846271515, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 31.86666666666667, "ram_util_percent": 95.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.750620950013399, "cur_kl_coeff": 3.9443045261050587e-32, "cur_lr": 1e-07, "total_loss": 2.1163656204938888, "policy_loss": -0.0001861712837126106, "vf_loss": 9.648340970277786, "vf_explained_var": -6.895214319229126e-05, "kl": 1.8422658590200313e-06, "entropy": 2.9553345158696174, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "env_runners": {"episode_reward_max": 110.94062524236931, "episode_reward_min": 61.486598767047106, "episode_reward_mean": 86.21367952872552, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.486598767047106}, "policy_reward_max": {"tplp_policy": 110.94062524236931}, "policy_reward_mean": {"tplp_policy": 86.21367952872552}, "custom_metrics": {"mean_episode_reward_mean": 86.21367952872552, "mean_episode_reward_min": 61.486598767047106, "mean_episode_reward_max": 110.94062524236931}, "hist_stats": {"episode_reward": [92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [92.88203910430846, 61.486598767047106, 79.58546279805348, 75.78440703536859, 74.95343104328646, 67.59547746493773, 88.6094788325448, 75.99187220504822, 74.52719498629929, 104.93884288456272, 74.9521280278902, 102.21329595833642, 89.15689733103864, 91.82858997795543, 85.4528860254427, 76.98679482022858, 78.94869481166657, 77.46986545422874, 99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205889648405807, "mean_inference_ms": 2.0877404038840566, "mean_action_processing_ms": 0.397085898369212, "mean_env_wait_ms": 2.3238530498051144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061075687408447266, "StateBufferConnector_ms": 0.004651069641113281, "ViewRequirementAgentConnector_ms": 0.20868372917175293}, "num_episodes": 24, "episode_return_max": 110.94062524236931, "episode_return_min": 61.486598767047106, "episode_return_mean": 86.21367952872552, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.02703734551676, "num_env_steps_trained_throughput_per_sec": 417.02703734551676, "timesteps_total": 105472, "num_env_steps_sampled_lifetime": 105472, "num_agent_steps_sampled_lifetime": 105472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 105472, "timers": {"training_iteration_time_ms": 2294.93, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2294.93, "sample_time_ms": 930.888, "learn_time_ms": 1345.573, "learn_throughput": 761.014, "synch_weights_time_ms": 18.063}, "counters": {"num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "done": false, "training_iteration": 103, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-25", "timestamp": 1744167265, "time_this_iter_s": 2.4613394737243652, "time_total_s": 263.26092410087585, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.26092410087585, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 95.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.491744812577963, "cur_kl_coeff": 1.9721522630525293e-32, "cur_lr": 1e-07, "total_loss": 2.1527161583304406, "policy_loss": -0.0001699584419839084, "vf_loss": 9.794413006305694, "vf_explained_var": -0.00010970421135425568, "kl": 1.643880070641146e-06, "entropy": 2.9571712777018546, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "env_runners": {"episode_reward_max": 110.94062524236931, "episode_reward_min": 64.84761082827967, "episode_reward_mean": 86.51744730307908, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 64.84761082827967}, "policy_reward_max": {"tplp_policy": 110.94062524236931}, "policy_reward_mean": {"tplp_policy": 86.51744730307908}, "custom_metrics": {"mean_episode_reward_mean": 86.51744730307908, "mean_episode_reward_min": 64.84761082827967, "mean_episode_reward_max": 110.94062524236931}, "hist_stats": {"episode_reward": [99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.08277793654344, 96.49400789655229, 82.11423098327232, 67.58330235005248, 94.40041948734657, 81.03164432753202, 87.04346861145939, 86.14534789964691, 90.2297011139728, 84.64052815371942, 95.92872160294561, 89.67562587358314, 79.45254155866675, 81.92184315101369, 83.16319830025495, 88.24518287333447, 78.02618359431627, 85.48351447565092, 85.2694908646257, 94.91828538654725, 87.7609318327416, 86.05233229356487, 82.7883710214788, 86.02235795891168, 87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7202739895285833, "mean_inference_ms": 2.0867339778929717, "mean_action_processing_ms": 0.3968381802241481, "mean_env_wait_ms": 2.322916497731222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007105588912963867, "StateBufferConnector_ms": 0.005751132965087891, "ViewRequirementAgentConnector_ms": 0.2025740146636963}, "num_episodes": 18, "episode_return_max": 110.94062524236931, "episode_return_min": 64.84761082827967, "episode_return_mean": 86.51744730307908, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.3137096453721, "num_env_steps_trained_throughput_per_sec": 443.3137096453721, "timesteps_total": 106496, "num_env_steps_sampled_lifetime": 106496, "num_agent_steps_sampled_lifetime": 106496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 2279.415, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2279.415, "sample_time_ms": 930.639, "learn_time_ms": 1330.098, "learn_throughput": 769.868, "synch_weights_time_ms": 18.158}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "training_iteration": 104, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-28", "timestamp": 1744167268, "time_this_iter_s": 2.316824436187744, "time_total_s": 265.5777485370636, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C831A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.5777485370636, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 45.333333333333336, "ram_util_percent": 95.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.959461714327335, "cur_kl_coeff": 9.860761315262647e-33, "cur_lr": 1e-07, "total_loss": 2.0897545874118806, "policy_loss": -0.00024868167238309977, "vf_loss": 9.543295049667359, "vf_explained_var": -6.7925825715065e-05, "kl": 1.430476922315016e-06, "entropy": 2.9582048028707506, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "env_runners": {"episode_reward_max": 114.14123417456683, "episode_reward_min": 58.29088311338579, "episode_reward_mean": 87.1186627606095, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 58.29088311338579}, "policy_reward_max": {"tplp_policy": 114.14123417456683}, "policy_reward_mean": {"tplp_policy": 87.1186627606095}, "custom_metrics": {"mean_episode_reward_mean": 87.1186627606095, "mean_episode_reward_min": 58.29088311338579, "mean_episode_reward_max": 114.14123417456683}, "hist_stats": {"episode_reward": [87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.60563969357125, 77.97982546408807, 86.8974880356308, 102.31192477716063, 91.98148639268659, 88.10368716402657, 80.70703368462965, 67.54158834222545, 86.89508651208145, 91.84672523549366, 85.18575065278671, 90.38489463718075, 87.22995263335496, 83.02451376912329, 87.36575647830787, 91.07658630898955, 64.84761082827967, 95.14450438002537, 88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7200213757717361, "mean_inference_ms": 2.085172097629424, "mean_action_processing_ms": 0.3964605285855925, "mean_env_wait_ms": 2.3214425898246924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012117385864257812, "StateBufferConnector_ms": 0.007114887237548828, "ViewRequirementAgentConnector_ms": 0.21831989288330078}, "num_episodes": 24, "episode_return_max": 114.14123417456683, "episode_return_min": 58.29088311338579, "episode_return_mean": 87.1186627606095, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 463.00734952955077, "num_env_steps_trained_throughput_per_sec": 463.00734952955077, "timesteps_total": 107520, "num_env_steps_sampled_lifetime": 107520, "num_agent_steps_sampled_lifetime": 107520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 2272.521, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2272.521, "sample_time_ms": 935.315, "learn_time_ms": 1318.928, "learn_throughput": 776.388, "synch_weights_time_ms": 17.859}, "counters": {"num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "done": false, "training_iteration": 105, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-30", "timestamp": 1744167270, "time_this_iter_s": 2.216850519180298, "time_total_s": 267.7945990562439, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.7945990562439, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 41.83333333333333, "ram_util_percent": 95.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.721830826997757, "cur_kl_coeff": 4.9303806576313234e-33, "cur_lr": 1e-07, "total_loss": 2.1281957231462, "policy_loss": -0.00024892950314097105, "vf_loss": 9.697043853998185, "vf_explained_var": -0.0001073937863111496, "kl": 1.242112643362603e-06, "entropy": 2.9581630557775496, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "env_runners": {"episode_reward_max": 114.14123417456683, "episode_reward_min": 57.328030487836386, "episode_reward_mean": 86.32046981466301, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.328030487836386}, "policy_reward_max": {"tplp_policy": 114.14123417456683}, "policy_reward_mean": {"tplp_policy": 86.32046981466301}, "custom_metrics": {"mean_episode_reward_mean": 86.32046981466301, "mean_episode_reward_min": 57.328030487836386, "mean_episode_reward_max": 114.14123417456683}, "hist_stats": {"episode_reward": [88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.2679408280496, 90.91134126039202, 76.99648057375181, 79.97133387633524, 91.72010570118827, 93.48340871524388, 90.68757850818693, 90.82650583237904, 74.04505610140883, 87.94763743378692, 95.23241878538765, 92.16934963108504, 101.99927413818325, 98.22126235867856, 75.01916264542648, 110.94062524236931, 90.38789306816354, 87.73532873725837, 88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.719694709683551, "mean_inference_ms": 2.0837916645381274, "mean_action_processing_ms": 0.39612257954902924, "mean_env_wait_ms": 2.320094909503684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013038158416748047, "StateBufferConnector_ms": 0.0071065425872802734, "ViewRequirementAgentConnector_ms": 0.23102736473083496}, "num_episodes": 18, "episode_return_max": 114.14123417456683, "episode_return_min": 57.328030487836386, "episode_return_mean": 86.32046981466301, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 503.7426541563953, "num_env_steps_trained_throughput_per_sec": 503.7426541563953, "timesteps_total": 108544, "num_env_steps_sampled_lifetime": 108544, "num_agent_steps_sampled_lifetime": 108544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 108544, "timers": {"training_iteration_time_ms": 2231.48, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2231.48, "sample_time_ms": 918.582, "learn_time_ms": 1294.639, "learn_throughput": 790.954, "synch_weights_time_ms": 17.986}, "counters": {"num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "done": false, "training_iteration": 106, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-32", "timestamp": 1744167272, "time_this_iter_s": 2.0386478900909424, "time_total_s": 269.83324694633484, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC0CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.83324694633484, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.46666666666666, "ram_util_percent": 95.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7435033202171324, "cur_kl_coeff": 2.4651903288156617e-33, "cur_lr": 1e-07, "total_loss": 2.141678782552481, "policy_loss": -0.00025413398398086426, "vf_loss": 9.751078939437866, "vf_explained_var": -0.00010931827127933503, "kl": 1.6511097228999461e-06, "entropy": 2.9583680987358094, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "env_runners": {"episode_reward_max": 114.14123417456683, "episode_reward_min": 57.328030487836386, "episode_reward_mean": 86.22151758831083, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.328030487836386}, "policy_reward_max": {"tplp_policy": 114.14123417456683}, "policy_reward_mean": {"tplp_policy": 86.22151758831083}, "custom_metrics": {"mean_episode_reward_mean": 86.22151758831083, "mean_episode_reward_min": 57.328030487836386, "mean_episode_reward_max": 114.14123417456683}, "hist_stats": {"episode_reward": [88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.36263316900023, 89.87439309764267, 98.74476299832924, 92.1194065411912, 86.8415671685005, 83.29886499102882, 97.80217766025824, 79.17701698946323, 86.8029784006029, 95.11190314652913, 83.00236578167664, 72.37651976624915, 86.20216566565621, 82.07857185741655, 77.98321985058043, 99.42168600259699, 67.14470291629664, 95.46607567377504, 88.68505989194622, 85.48305801426439, 89.19010743138708, 86.66799035526529, 66.08115711398818, 82.22206128983987, 88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7195861843063178, "mean_inference_ms": 2.0830242722850096, "mean_action_processing_ms": 0.39593966540520353, "mean_env_wait_ms": 2.319339816610305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013448476791381836, "StateBufferConnector_ms": 0.00809335708618164, "ViewRequirementAgentConnector_ms": 0.2436211109161377}, "num_episodes": 18, "episode_return_max": 114.14123417456683, "episode_return_min": 57.328030487836386, "episode_return_mean": 86.22151758831083, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 386.9041188441577, "num_env_steps_trained_throughput_per_sec": 386.9041188441577, "timesteps_total": 109568, "num_env_steps_sampled_lifetime": 109568, "num_agent_steps_sampled_lifetime": 109568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 109568, "timers": {"training_iteration_time_ms": 2274.259, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2274.259, "sample_time_ms": 917.082, "learn_time_ms": 1338.317, "learn_throughput": 765.14, "synch_weights_time_ms": 18.587}, "counters": {"num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "done": false, "training_iteration": 107, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-35", "timestamp": 1744167275, "time_this_iter_s": 2.6538476943969727, "time_total_s": 272.4870946407318, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C839C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.4870946407318, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 95.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768327738344669, "cur_kl_coeff": 1.2325951644078308e-33, "cur_lr": 1e-07, "total_loss": 2.1168612629175185, "policy_loss": -0.00014230092638172208, "vf_loss": 9.652039557695389, "vf_explained_var": -0.00011780112981796265, "kl": 2.114364587280093e-06, "entropy": 2.9600633189082144, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "env_runners": {"episode_reward_max": 114.14123417456683, "episode_reward_min": 57.328030487836386, "episode_reward_mean": 86.41255135447587, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.328030487836386}, "policy_reward_max": {"tplp_policy": 114.14123417456683}, "policy_reward_mean": {"tplp_policy": 86.41255135447587}, "custom_metrics": {"mean_episode_reward_mean": 86.41255135447587, "mean_episode_reward_min": 57.328030487836386, "mean_episode_reward_max": 114.14123417456683}, "hist_stats": {"episode_reward": [88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.82084226391511, 80.00922075893803, 81.66297395883673, 85.14697930112152, 85.55479672317404, 78.79520086674617, 91.88461318710127, 96.24244154082466, 100.323720084812, 76.32974303430368, 92.96797379640878, 85.56598850683545, 73.87011551437024, 70.86115589242159, 86.2202281273307, 81.18152300263199, 82.9946168430802, 88.2593352175534, 67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7194355670569215, "mean_inference_ms": 2.0826377107755203, "mean_action_processing_ms": 0.3959868883314, "mean_env_wait_ms": 2.319302544084705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01444554328918457, "StateBufferConnector_ms": 0.009979009628295898, "ViewRequirementAgentConnector_ms": 0.24651503562927246}, "num_episodes": 24, "episode_return_max": 114.14123417456683, "episode_return_min": 57.328030487836386, "episode_return_mean": 86.41255135447587, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 426.3123468936432, "num_env_steps_trained_throughput_per_sec": 426.3123468936432, "timesteps_total": 110592, "num_env_steps_sampled_lifetime": 110592, "num_agent_steps_sampled_lifetime": 110592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 2303.412, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2303.412, "sample_time_ms": 944.253, "learn_time_ms": 1340.324, "learn_throughput": 763.994, "synch_weights_time_ms": 18.671}, "counters": {"num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "training_iteration": 108, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-37", "timestamp": 1744167277, "time_this_iter_s": 2.4078972339630127, "time_total_s": 274.8949918746948, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.8949918746948, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 54.333333333333336, "ram_util_percent": 95.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4586795255541802, "cur_kl_coeff": 6.162975822039154e-34, "cur_lr": 1e-07, "total_loss": 2.165717366337776, "policy_loss": -0.00013605024432763457, "vf_loss": 9.848423767089844, "vf_explained_var": -0.0001787375658750534, "kl": 1.8254011892537837e-06, "entropy": 2.96252518594265, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "env_runners": {"episode_reward_max": 114.14123417456683, "episode_reward_min": 57.328030487836386, "episode_reward_mean": 86.66828473345647, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.328030487836386}, "policy_reward_max": {"tplp_policy": 114.14123417456683}, "policy_reward_mean": {"tplp_policy": 86.66828473345647}, "custom_metrics": {"mean_episode_reward_mean": 86.66828473345647, "mean_episode_reward_min": 57.328030487836386, "mean_episode_reward_max": 114.14123417456683}, "hist_stats": {"episode_reward": [67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [67.94310694955173, 89.1231430205269, 114.14123417456683, 97.85292878629274, 81.71920603233822, 92.65720578516965, 89.11509870905441, 89.99517827522526, 93.0582029525145, 83.94787749477905, 90.5386575351231, 108.16851472796766, 99.39226520694204, 82.6088480461306, 90.4664841357458, 110.87073031808323, 76.84359704165288, 95.79249891121246, 82.47386951551138, 73.43434525571685, 93.90772725265029, 58.29088311338579, 57.328030487836386, 79.68248994986998, 72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7193780331645506, "mean_inference_ms": 2.0821832076049036, "mean_action_processing_ms": 0.3960116877422914, "mean_env_wait_ms": 2.3194215928272017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014434814453125, "StateBufferConnector_ms": 0.008977174758911133, "ViewRequirementAgentConnector_ms": 0.26525163650512695}, "num_episodes": 18, "episode_return_max": 114.14123417456683, "episode_return_min": 57.328030487836386, "episode_return_mean": 86.66828473345647, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 455.74804485783363, "num_env_steps_trained_throughput_per_sec": 455.74804485783363, "timesteps_total": 111616, "num_env_steps_sampled_lifetime": 111616, "num_agent_steps_sampled_lifetime": 111616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 111616, "timers": {"training_iteration_time_ms": 2300.114, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2300.114, "sample_time_ms": 948.893, "learn_time_ms": 1333.018, "learn_throughput": 768.182, "synch_weights_time_ms": 18.04}, "counters": {"num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "done": false, "training_iteration": 109, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-40", "timestamp": 1744167280, "time_this_iter_s": 2.252272129058838, "time_total_s": 277.14726400375366, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C831A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.14726400375366, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 41.4, "ram_util_percent": 95.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.779311276972294, "cur_kl_coeff": 3.081487911019577e-34, "cur_lr": 1e-07, "total_loss": 2.1189306072890757, "policy_loss": -0.0002131338231265545, "vf_loss": 9.662211602926254, "vf_explained_var": -8.466616272926331e-05, "kl": 1.6878712742071645e-06, "entropy": 2.964091582596302, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "env_runners": {"episode_reward_max": 113.22628305995133, "episode_reward_min": 62.43842294401488, "episode_reward_mean": 87.24668052998719, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.43842294401488}, "policy_reward_max": {"tplp_policy": 113.22628305995133}, "policy_reward_mean": {"tplp_policy": 87.24668052998719}, "custom_metrics": {"mean_episode_reward_mean": 87.24668052998719, "mean_episode_reward_min": 62.43842294401488, "mean_episode_reward_max": 113.22628305995133}, "hist_stats": {"episode_reward": [72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [72.30733070570113, 84.93398691541583, 85.06438950261109, 83.91874554072754, 71.83537745138779, 89.6142076151539, 83.71834461703283, 83.94401378571985, 95.03375097604903, 95.16589808880424, 86.24508406852595, 62.43842294401488, 76.26210105034104, 70.30602350051778, 113.22628305995133, 75.2862801353333, 83.98143388598197, 95.79130161974109, 97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720013027447709, "mean_inference_ms": 2.080287329702029, "mean_action_processing_ms": 0.3957956013269197, "mean_env_wait_ms": 2.3182471763967234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0134124755859375, "StateBufferConnector_ms": 0.007979393005371094, "ViewRequirementAgentConnector_ms": 0.23692965507507324}, "num_episodes": 24, "episode_return_max": 113.22628305995133, "episode_return_min": 62.43842294401488, "episode_return_mean": 87.24668052998719, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 427.65758814219447, "num_env_steps_trained_throughput_per_sec": 427.65758814219447, "timesteps_total": 112640, "num_env_steps_sampled_lifetime": 112640, "num_agent_steps_sampled_lifetime": 112640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 112640, "timers": {"training_iteration_time_ms": 2300.038, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2300.038, "sample_time_ms": 951.198, "learn_time_ms": 1329.859, "learn_throughput": 770.006, "synch_weights_time_ms": 18.817}, "counters": {"num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "done": false, "training_iteration": 110, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-43", "timestamp": 1744167283, "time_this_iter_s": 2.4005990028381348, "time_total_s": 279.5478630065918, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.5478630065918, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 21.72, "ram_util_percent": 95.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.795461705327034, "cur_kl_coeff": 1.5407439555097886e-34, "cur_lr": 1e-07, "total_loss": 2.145436293631792, "policy_loss": -0.00023941606632433833, "vf_loss": 9.76893898844719, "vf_explained_var": -0.0001405775547027588, "kl": 2.7719750120169808e-06, "entropy": 2.9655902668833733, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "env_runners": {"episode_reward_max": 109.18168668814948, "episode_reward_min": 70.65557346514994, "episode_reward_mean": 88.34915403638098, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.65557346514994}, "policy_reward_max": {"tplp_policy": 109.18168668814948}, "policy_reward_mean": {"tplp_policy": 88.34915403638098}, "custom_metrics": {"mean_episode_reward_mean": 88.34915403638098, "mean_episode_reward_min": 70.65557346514994, "mean_episode_reward_max": 109.18168668814948}, "hist_stats": {"episode_reward": [97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.27799197153547, 81.57318409255997, 77.19695480984504, 72.62325679784306, 84.0273849971198, 99.25772428817159, 93.10937625729902, 88.09407600504355, 96.03665065598679, 100.8834808884468, 81.8997771144168, 101.48659527531247, 89.70896291051156, 94.73544880537722, 90.85314922381298, 78.130731203051, 87.44134626726039, 87.45640126716259, 83.11682724423834, 78.21933525026557, 81.63751275588777, 72.91191307303492, 78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205483044386932, "mean_inference_ms": 2.0785881896469833, "mean_action_processing_ms": 0.3955611353378769, "mean_env_wait_ms": 2.3171662076418134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011383295059204102, "StateBufferConnector_ms": 0.008979558944702148, "ViewRequirementAgentConnector_ms": 0.2640106678009033}, "num_episodes": 18, "episode_return_max": 109.18168668814948, "episode_return_min": 70.65557346514994, "episode_return_mean": 88.34915403638098, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 490.35503641841495, "num_env_steps_trained_throughput_per_sec": 490.35503641841495, "timesteps_total": 113664, "num_env_steps_sampled_lifetime": 113664, "num_agent_steps_sampled_lifetime": 113664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 113664, "timers": {"training_iteration_time_ms": 2285.81, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2285.81, "sample_time_ms": 938.84, "learn_time_ms": 1328.069, "learn_throughput": 771.044, "synch_weights_time_ms": 18.736}, "counters": {"num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "done": false, "training_iteration": 111, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-48", "timestamp": 1744167288, "time_this_iter_s": 2.0939433574676514, "time_total_s": 281.64180636405945, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C831A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.64180636405945, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 19.442857142857143, "ram_util_percent": 95.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.827106908708811, "cur_kl_coeff": 7.703719777548943e-35, "cur_lr": 1e-07, "total_loss": 2.117582294344902, "policy_loss": -0.0001930472091771662, "vf_loss": 9.658131074905395, "vf_explained_var": -9.506046772003173e-05, "kl": 2.4941847487358615e-06, "entropy": 2.9675741717219353, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "env_runners": {"episode_reward_max": 109.18168668814948, "episode_reward_min": 70.65557346514994, "episode_reward_mean": 88.48931093906833, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.65557346514994}, "policy_reward_max": {"tplp_policy": 109.18168668814948}, "policy_reward_mean": {"tplp_policy": 88.48931093906833}, "custom_metrics": {"mean_episode_reward_mean": 88.48931093906833, "mean_episode_reward_min": 70.65557346514994, "mean_episode_reward_max": 109.18168668814948}, "hist_stats": {"episode_reward": [78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.1469151350218, 79.67860468341775, 98.13579712587665, 70.65557346514994, 93.94396293017965, 98.95103665233079, 93.17570203660975, 100.21325515949259, 84.41862050692558, 92.01709591911927, 94.71195908279807, 77.01617588172421, 101.5507173151467, 81.16575082181879, 101.4797603929116, 94.9125549664554, 74.35210960483202, 73.93489485233137, 81.96181224262732, 77.75584385202873, 83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7208956002494543, "mean_inference_ms": 2.0762275946453626, "mean_action_processing_ms": 0.39507393147246994, "mean_env_wait_ms": 2.314885963639661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009963035583496094, "StateBufferConnector_ms": 0.005991935729980469, "ViewRequirementAgentConnector_ms": 0.26941585540771484}, "num_episodes": 22, "episode_return_max": 109.18168668814948, "episode_return_min": 70.65557346514994, "episode_return_mean": 88.48931093906833, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.66673504644973, "num_env_steps_trained_throughput_per_sec": 466.66673504644973, "timesteps_total": 114688, "num_env_steps_sampled_lifetime": 114688, "num_agent_steps_sampled_lifetime": 114688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 2298.227, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2298.227, "sample_time_ms": 946.065, "learn_time_ms": 1332.697, "learn_throughput": 768.367, "synch_weights_time_ms": 19.352}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "training_iteration": 112, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-50", "timestamp": 1744167290, "time_this_iter_s": 2.1997828483581543, "time_total_s": 283.8415892124176, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.8415892124176, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 40.333333333333336, "ram_util_percent": 95.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7900137014687063, "cur_kl_coeff": 3.8518598887744714e-35, "cur_lr": 1e-07, "total_loss": 2.1121273964643477, "policy_loss": -0.000213000422809273, "vf_loss": 9.636774373054504, "vf_explained_var": -0.00010374076664447785, "kl": 1.511152919775327e-06, "entropy": 2.968532106280327, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "env_runners": {"episode_reward_max": 109.18168668814948, "episode_reward_min": 68.97371760248362, "episode_reward_mean": 88.64815792757852, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.97371760248362}, "policy_reward_max": {"tplp_policy": 109.18168668814948}, "policy_reward_mean": {"tplp_policy": 88.64815792757852}, "custom_metrics": {"mean_episode_reward_mean": 88.64815792757852, "mean_episode_reward_min": 68.97371760248362, "mean_episode_reward_max": 109.18168668814948}, "hist_stats": {"episode_reward": [83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.53138094436798, 79.90947076878469, 80.05424199505381, 78.0794223002651, 86.26452591455681, 96.71323556062954, 78.7084070260467, 94.46266666434444, 91.37931127896604, 95.22026952772308, 84.67439458726624, 79.34490771319736, 87.19079850723035, 106.06251880195641, 84.81156270908215, 86.1400361243373, 83.8288150565821, 82.34558928017444, 94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7212400983779804, "mean_inference_ms": 2.073697262504235, "mean_action_processing_ms": 0.39482364502713785, "mean_env_wait_ms": 2.312714272034743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01000213623046875, "StateBufferConnector_ms": 0.00709223747253418, "ViewRequirementAgentConnector_ms": 0.2415001392364502}, "num_episodes": 20, "episode_return_max": 109.18168668814948, "episode_return_min": 68.97371760248362, "episode_return_mean": 88.64815792757852, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 439.0747052196617, "num_env_steps_trained_throughput_per_sec": 439.0747052196617, "timesteps_total": 115712, "num_env_steps_sampled_lifetime": 115712, "num_agent_steps_sampled_lifetime": 115712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 115712, "timers": {"training_iteration_time_ms": 2285.897, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2285.897, "sample_time_ms": 953.519, "learn_time_ms": 1313.909, "learn_throughput": 779.354, "synch_weights_time_ms": 18.356}, "counters": {"num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "done": false, "training_iteration": 113, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-52", "timestamp": 1744167292, "time_this_iter_s": 2.3371634483337402, "time_total_s": 286.17875266075134, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.17875266075134, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 54.06666666666666, "ram_util_percent": 95.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5553387388587, "cur_kl_coeff": 1.9259299443872357e-35, "cur_lr": 1e-07, "total_loss": 2.1351750388741495, "policy_loss": -0.00021083350875414908, "vf_loss": 9.729069572687148, "vf_explained_var": -0.00010206960141658782, "kl": 1.6120740185851524e-06, "entropy": 2.9688152223825455, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "env_runners": {"episode_reward_max": 109.18168668814948, "episode_reward_min": 68.97371760248362, "episode_reward_mean": 88.96546122973078, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.97371760248362}, "policy_reward_max": {"tplp_policy": 109.18168668814948}, "policy_reward_mean": {"tplp_policy": 88.96546122973078}, "custom_metrics": {"mean_episode_reward_mean": 88.96546122973078, "mean_episode_reward_min": 68.97371760248362, "mean_episode_reward_max": 109.18168668814948}, "hist_stats": {"episode_reward": [94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [94.02340647089625, 75.23090032620519, 86.82746660271516, 95.81720976015434, 78.25640046282096, 95.52552453407827, 96.47595136159747, 87.99028336693507, 96.9814602237902, 98.44687378491038, 87.64190785508335, 91.71127747995025, 74.01675746878409, 94.6022096102835, 97.84025031879986, 97.93016124427353, 85.7489444300864, 85.82243957974934, 92.7986936817065, 89.98446534152612, 109.18168668814948, 78.16302840166826, 94.60137333780948, 79.74729702869993, 102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7213460484017773, "mean_inference_ms": 2.0717878302511146, "mean_action_processing_ms": 0.3946346213138834, "mean_env_wait_ms": 2.31058119638808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009014606475830078, "StateBufferConnector_ms": 0.008092641830444336, "ViewRequirementAgentConnector_ms": 0.2311561107635498}, "num_episodes": 18, "episode_return_max": 109.18168668814948, "episode_return_min": 68.97371760248362, "episode_return_mean": 88.96546122973078, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.6495972658363, "num_env_steps_trained_throughput_per_sec": 466.6495972658363, "timesteps_total": 116736, "num_env_steps_sampled_lifetime": 116736, "num_agent_steps_sampled_lifetime": 116736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 116736, "timers": {"training_iteration_time_ms": 2274.346, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2274.346, "sample_time_ms": 955.626, "learn_time_ms": 1300.704, "learn_throughput": 787.266, "synch_weights_time_ms": 18.015}, "counters": {"num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "done": false, "training_iteration": 114, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-54", "timestamp": 1744167294, "time_this_iter_s": 2.199427604675293, "time_total_s": 288.37818026542664, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D193A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.37818026542664, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 45.833333333333336, "ram_util_percent": 95.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.065580821037292, "cur_kl_coeff": 9.629649721936178e-36, "cur_lr": 1e-07, "total_loss": 2.1182091549038886, "policy_loss": -0.0002953802526462823, "vf_loss": 9.66162759065628, "vf_explained_var": -8.575692772865296e-05, "kl": 1.516729481387813e-06, "entropy": 2.9690235629677773, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "env_runners": {"episode_reward_max": 110.36344316644832, "episode_reward_min": 68.97371760248362, "episode_reward_mean": 88.81316700201106, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.97371760248362}, "policy_reward_max": {"tplp_policy": 110.36344316644832}, "policy_reward_mean": {"tplp_policy": 88.81316700201106}, "custom_metrics": {"mean_episode_reward_mean": 88.81316700201106, "mean_episode_reward_min": 68.97371760248362, "mean_episode_reward_max": 110.36344316644832}, "hist_stats": {"episode_reward": [102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.18936935630357, 92.24919184085348, 83.47422138675225, 86.31853944059807, 78.02726929720508, 107.0348142918834, 90.55797764175266, 76.68719321186808, 87.14563862979222, 80.9528810196038, 92.97066788962947, 90.46692437207231, 93.23870986350431, 90.94738277317991, 94.82177716448918, 97.88909755639246, 92.40649318567249, 95.54964927226527, 91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205205898979008, "mean_inference_ms": 2.0701353593568443, "mean_action_processing_ms": 0.3945350584423615, "mean_env_wait_ms": 2.308664920476341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007020235061645508, "StateBufferConnector_ms": 0.00908970832824707, "ViewRequirementAgentConnector_ms": 0.2565627098083496}, "num_episodes": 24, "episode_return_max": 110.36344316644832, "episode_return_min": 68.97371760248362, "episode_return_mean": 88.81316700201106, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 482.51011605046455, "num_env_steps_trained_throughput_per_sec": 482.51011605046455, "timesteps_total": 117760, "num_env_steps_sampled_lifetime": 117760, "num_agent_steps_sampled_lifetime": 117760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 117760, "timers": {"training_iteration_time_ms": 2265.407, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2265.407, "sample_time_ms": 943.678, "learn_time_ms": 1303.503, "learn_throughput": 785.576, "synch_weights_time_ms": 18.125}, "counters": {"num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "done": false, "training_iteration": 115, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-57", "timestamp": 1744167297, "time_this_iter_s": 2.1289188861846924, "time_total_s": 290.5070991516113, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D196C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.5070991516113, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 36.73333333333333, "ram_util_percent": 95.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2242656853049994, "cur_kl_coeff": 4.814824860968089e-36, "cur_lr": 1e-07, "total_loss": 2.134288692474365, "policy_loss": -0.00015715170302428306, "vf_loss": 9.725429672002793, "vf_explained_var": -0.0001239519566297531, "kl": 1.201556487938349e-06, "entropy": 2.969115859270096, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "env_runners": {"episode_reward_max": 110.36344316644832, "episode_reward_min": 67.25546173413296, "episode_reward_mean": 88.19349949171534, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 67.25546173413296}, "policy_reward_max": {"tplp_policy": 110.36344316644832}, "policy_reward_mean": {"tplp_policy": 88.19349949171534}, "custom_metrics": {"mean_episode_reward_mean": 88.19349949171534, "mean_episode_reward_min": 67.25546173413296, "mean_episode_reward_max": 110.36344316644832}, "hist_stats": {"episode_reward": [91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [91.08708685228906, 103.14436593402283, 96.7529544798069, 97.0848674273853, 83.93570618860134, 79.16885968738113, 89.30837526708439, 72.08856503077016, 96.79913077630985, 96.64122622542797, 82.71977937178237, 82.51346788919605, 73.68040944037487, 89.96897816238392, 74.18779546513639, 81.44128103127332, 87.8945134507161, 91.13314480195709, 83.20311437664462, 90.98400710643563, 96.94076171257164, 96.35072705490272, 105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7198539963784875, "mean_inference_ms": 2.069119396994541, "mean_action_processing_ms": 0.39455951404249545, "mean_env_wait_ms": 2.307460472749072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006024360656738281, "StateBufferConnector_ms": 0.008092403411865234, "ViewRequirementAgentConnector_ms": 0.21937203407287598}, "num_episodes": 18, "episode_return_max": 110.36344316644832, "episode_return_min": 67.25546173413296, "episode_return_mean": 88.19349949171534, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.0138353225683, "num_env_steps_trained_throughput_per_sec": 465.0138353225683, "timesteps_total": 118784, "num_env_steps_sampled_lifetime": 118784, "num_agent_steps_sampled_lifetime": 118784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 2282.337, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2282.337, "sample_time_ms": 944.088, "learn_time_ms": 1319.781, "learn_throughput": 775.886, "synch_weights_time_ms": 18.367}, "counters": {"num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "training_iteration": 116, "trial_id": "374cd_00000", "date": "2025-04-09_10-54-59", "timestamp": 1744167299, "time_this_iter_s": 2.209902286529541, "time_total_s": 292.71700143814087, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.71700143814087, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 30.575, "ram_util_percent": 95.12499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.64745387211442, "cur_kl_coeff": 2.4074124304840446e-36, "cur_lr": 1e-07, "total_loss": 2.1176313899457453, "policy_loss": -0.00022725643357262014, "vf_loss": 9.65951782464981, "vf_explained_var": -9.668581187725068e-05, "kl": 2.248956720407591e-06, "entropy": 2.9702081069350244, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "env_runners": {"episode_reward_max": 115.81433039931625, "episode_reward_min": 56.46661315550719, "episode_reward_mean": 88.50742890041694, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.46661315550719}, "policy_reward_max": {"tplp_policy": 115.81433039931625}, "policy_reward_mean": {"tplp_policy": 88.50742890041694}, "custom_metrics": {"mean_episode_reward_mean": 88.50742890041694, "mean_episode_reward_min": 56.46661315550719, "mean_episode_reward_max": 115.81433039931625}, "hist_stats": {"episode_reward": [105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [105.8901524963206, 85.07088843237602, 83.32181385186618, 95.88581199599844, 79.84763136158551, 105.80291190642235, 76.11357521181716, 87.88057214757127, 106.68312556676669, 90.53610268746223, 77.22630016776046, 73.26266525870207, 88.42027204946652, 92.87473716843795, 82.82848002138235, 85.65742611817979, 84.49516866574338, 68.97371760248362, 86.43460560502812, 86.49166883124786, 100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7192519908590478, "mean_inference_ms": 2.068084171069164, "mean_action_processing_ms": 0.39464585731827645, "mean_env_wait_ms": 2.306339113760446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008025407791137695, "StateBufferConnector_ms": 0.01008462905883789, "ViewRequirementAgentConnector_ms": 0.21009564399719238}, "num_episodes": 22, "episode_return_max": 115.81433039931625, "episode_return_min": 56.46661315550719, "episode_return_mean": 88.50742890041694, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.8980180382954, "num_env_steps_trained_throughput_per_sec": 445.8980180382954, "timesteps_total": 119808, "num_env_steps_sampled_lifetime": 119808, "num_agent_steps_sampled_lifetime": 119808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 119808, "timers": {"training_iteration_time_ms": 2247.321, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2247.321, "sample_time_ms": 940.264, "learn_time_ms": 1289.467, "learn_throughput": 794.126, "synch_weights_time_ms": 17.489}, "counters": {"num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "done": false, "training_iteration": 117, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-01", "timestamp": 1744167301, "time_this_iter_s": 2.3024728298187256, "time_total_s": 295.0194742679596, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D193A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.0194742679596, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 49.76666666666667, "ram_util_percent": 95.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.067364925146103, "cur_kl_coeff": 1.2037062152420223e-36, "cur_lr": 1e-07, "total_loss": 2.115270710736513, "policy_loss": -0.000263177789747715, "vf_loss": 9.6506756067276, "vf_explained_var": -0.00010229237377643586, "kl": 1.7068694840000065e-06, "entropy": 2.9713498681783674, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "env_runners": {"episode_reward_max": 115.81433039931625, "episode_reward_min": 56.46661315550719, "episode_reward_mean": 88.38480079484314, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.46661315550719}, "policy_reward_max": {"tplp_policy": 115.81433039931625}, "policy_reward_mean": {"tplp_policy": 88.38480079484314}, "custom_metrics": {"mean_episode_reward_mean": 88.38480079484314, "mean_episode_reward_min": 56.46661315550719, "mean_episode_reward_max": 115.81433039931625}, "hist_stats": {"episode_reward": [100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [100.46974139585438, 95.21016913874921, 71.67250386309077, 91.84250164127046, 99.79702127601675, 92.68739303200174, 91.65716714740591, 89.17965021829413, 98.38882144207457, 87.56667249998561, 74.12138082874934, 84.10634109083797, 99.69071095241615, 83.9842845085361, 78.05512214613643, 79.09612935809355, 95.37142202553255, 89.76551526319916, 88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187222765829822, "mean_inference_ms": 2.066746598877472, "mean_action_processing_ms": 0.3944711913336003, "mean_env_wait_ms": 2.3051781699996754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0110321044921875, "StateBufferConnector_ms": 0.008992910385131836, "ViewRequirementAgentConnector_ms": 0.21608948707580566}, "num_episodes": 20, "episode_return_max": 115.81433039931625, "episode_return_min": 56.46661315550719, "episode_return_mean": 88.38480079484314, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 473.95676532362444, "num_env_steps_trained_throughput_per_sec": 473.95676532362444, "timesteps_total": 120832, "num_env_steps_sampled_lifetime": 120832, "num_agent_steps_sampled_lifetime": 120832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 120832, "timers": {"training_iteration_time_ms": 2223.175, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2223.175, "sample_time_ms": 919.557, "learn_time_ms": 1286.042, "learn_throughput": 796.241, "synch_weights_time_ms": 17.475}, "counters": {"num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "done": false, "training_iteration": 118, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-03", "timestamp": 1744167303, "time_this_iter_s": 2.1664814949035645, "time_total_s": 297.18595576286316, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.18595576286316, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 42.96666666666667, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7209221318364145, "cur_kl_coeff": 6.0185310762101115e-37, "cur_lr": 1e-07, "total_loss": 2.135796856880188, "policy_loss": -0.0003817976044956595, "vf_loss": 9.73320580124855, "vf_explained_var": -0.00012348070740699768, "kl": 2.0079431750419373e-06, "entropy": 2.9712279379367827, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "env_runners": {"episode_reward_max": 115.81433039931625, "episode_reward_min": 56.46661315550719, "episode_reward_mean": 88.3319261347149, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.46661315550719}, "policy_reward_max": {"tplp_policy": 115.81433039931625}, "policy_reward_mean": {"tplp_policy": 88.3319261347149}, "custom_metrics": {"mean_episode_reward_mean": 88.3319261347149, "mean_episode_reward_min": 56.46661315550719, "mean_episode_reward_max": 115.81433039931625}, "hist_stats": {"episode_reward": [88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.66624608513419, 74.98676106545018, 88.20026037419451, 76.92266021853996, 88.90475534350209, 90.78816690024726, 94.6794897749269, 98.66753471904224, 84.55899533151127, 76.39076910839918, 92.41519981429715, 71.97418315203424, 85.69524897808489, 78.03459285170214, 101.33045802578587, 96.64841982163158, 78.74899146453599, 108.3444217170635, 110.36344316644832, 95.80558919956019, 85.16561476173317, 97.70780742614657, 74.88011099982431, 83.9785485742621, 89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7182021834694864, "mean_inference_ms": 2.06541519677414, "mean_action_processing_ms": 0.3943007503703127, "mean_env_wait_ms": 2.303998777515072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010034799575805664, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.21245026588439941}, "num_episodes": 18, "episode_return_max": 115.81433039931625, "episode_return_min": 56.46661315550719, "episode_return_mean": 88.3319261347149, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.04519608033104, "num_env_steps_trained_throughput_per_sec": 481.04519608033104, "timesteps_total": 121856, "num_env_steps_sampled_lifetime": 121856, "num_agent_steps_sampled_lifetime": 121856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 121856, "timers": {"training_iteration_time_ms": 2211.359, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2211.359, "sample_time_ms": 916.039, "learn_time_ms": 1277.8, "learn_throughput": 801.377, "synch_weights_time_ms": 17.419}, "counters": {"num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "done": false, "training_iteration": 119, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-06", "timestamp": 1744167306, "time_this_iter_s": 2.133976697921753, "time_total_s": 299.3199324607849, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C839C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.3199324607849, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 95.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3764042437076567, "cur_kl_coeff": 3.0092655381050558e-37, "cur_lr": 1e-07, "total_loss": 2.1433748550713063, "policy_loss": -9.611836867406964e-05, "vf_loss": 9.762294459342957, "vf_explained_var": -9.036101400852203e-05, "kl": 9.144971265598323e-07, "entropy": 2.971026287972927, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "env_runners": {"episode_reward_max": 115.81433039931625, "episode_reward_min": 56.46661315550719, "episode_reward_mean": 87.92688549744027, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.46661315550719}, "policy_reward_max": {"tplp_policy": 115.81433039931625}, "policy_reward_mean": {"tplp_policy": 87.92688549744027}, "custom_metrics": {"mean_episode_reward_mean": 87.92688549744027, "mean_episode_reward_min": 56.46661315550719, "mean_episode_reward_max": 115.81433039931625}, "hist_stats": {"episode_reward": [89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [89.24376331175284, 103.62453850290981, 96.05113657678092, 91.65377016239707, 83.13661953238035, 94.3367167586226, 67.25546173413296, 69.48607030044724, 75.60846220944785, 89.87475334081583, 93.32195740514895, 88.34522445056074, 102.66075937574101, 88.94383293334545, 91.65179004590149, 86.90753094977207, 66.56570812372583, 81.62807705435318, 96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7175135804703434, "mean_inference_ms": 2.063542451580422, "mean_action_processing_ms": 0.3941011614409946, "mean_env_wait_ms": 2.302397923594845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012038946151733398, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.22057223320007324}, "num_episodes": 24, "episode_return_max": 115.81433039931625, "episode_return_min": 56.46661315550719, "episode_return_mean": 87.92688549744027, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.66790127252995, "num_env_steps_trained_throughput_per_sec": 466.66790127252995, "timesteps_total": 122880, "num_env_steps_sampled_lifetime": 122880, "num_agent_steps_sampled_lifetime": 122880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 2191.343, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.343, "sample_time_ms": 897.828, "learn_time_ms": 1276.666, "learn_throughput": 802.089, "synch_weights_time_ms": 16.748}, "counters": {"num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "training_iteration": 120, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-08", "timestamp": 1744167308, "time_this_iter_s": 2.1998143196105957, "time_total_s": 301.5197467803955, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.5197467803955, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 34.06666666666667, "ram_util_percent": 95.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.787332850694656, "cur_kl_coeff": 1.5046327690525279e-37, "cur_lr": 1e-07, "total_loss": 2.1121075458824636, "policy_loss": -0.00017174463719129562, "vf_loss": 9.637858635187149, "vf_explained_var": -0.00011211298406124114, "kl": 1.4458210026546681e-06, "entropy": 2.971853609383106, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "env_runners": {"episode_reward_max": 115.81433039931625, "episode_reward_min": 56.46661315550719, "episode_reward_mean": 88.20803742603654, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 56.46661315550719}, "policy_reward_max": {"tplp_policy": 115.81433039931625}, "policy_reward_mean": {"tplp_policy": 88.20803742603654}, "custom_metrics": {"mean_episode_reward_mean": 88.20803742603654, "mean_episode_reward_min": 56.46661315550719, "mean_episode_reward_max": 115.81433039931625}, "hist_stats": {"episode_reward": [96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [96.55581421625543, 89.24889932505548, 97.30508698442367, 96.85008898922189, 68.9387554143209, 115.81433039931625, 87.77300665251788, 87.03173899717892, 82.24124699346031, 78.27282088686374, 100.74667034707997, 82.80109981324503, 94.66435596411286, 96.69270752207876, 81.06932170459764, 96.43971962830163, 112.27604386660951, 97.69571291351684, 101.34423965087066, 56.46661315550719, 76.18653449796804, 96.73982411100248, 74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.717197853492345, "mean_inference_ms": 2.062580397440501, "mean_action_processing_ms": 0.39390380869823155, "mean_env_wait_ms": 2.3016799708267843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013028621673583984, "StateBufferConnector_ms": 0.005992412567138672, "ViewRequirementAgentConnector_ms": 0.2177133560180664}, "num_episodes": 18, "episode_return_max": 115.81433039931625, "episode_return_min": 56.46661315550719, "episode_return_mean": 88.20803742603654, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 428.6758154134832, "num_env_steps_trained_throughput_per_sec": 428.6758154134832, "timesteps_total": 123904, "num_env_steps_sampled_lifetime": 123904, "num_agent_steps_sampled_lifetime": 123904, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 123904, "timers": {"training_iteration_time_ms": 2221.39, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2221.39, "sample_time_ms": 915.123, "learn_time_ms": 1289.169, "learn_throughput": 794.31, "synch_weights_time_ms": 16.893}, "counters": {"num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "done": false, "training_iteration": 121, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-10", "timestamp": 1744167310, "time_this_iter_s": 2.395158052444458, "time_total_s": 303.91490483283997, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C822A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.91490483283997, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 43.7, "ram_util_percent": 95.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.607633624598384, "cur_kl_coeff": 7.523163845262639e-38, "cur_lr": 1e-07, "total_loss": 2.1154126904904844, "policy_loss": -0.00018677185289561749, "vf_loss": 9.651649254560471, "vf_explained_var": -0.0001367460936307907, "kl": 1.657089157243441e-06, "entropy": 2.973128353059292, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "env_runners": {"episode_reward_max": 120.30105999873304, "episode_reward_min": 66.30087157788812, "episode_reward_mean": 88.27808323221011, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.30087157788812}, "policy_reward_max": {"tplp_policy": 120.30105999873304}, "policy_reward_mean": {"tplp_policy": 88.27808323221011}, "custom_metrics": {"mean_episode_reward_mean": 88.27808323221011, "mean_episode_reward_min": 66.30087157788812, "mean_episode_reward_max": 120.30105999873304}, "hist_stats": {"episode_reward": [74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [74.02020769642755, 99.10266168773039, 95.4205462449424, 89.75580287863694, 81.04595958998709, 96.93094864426958, 77.00347802356005, 99.9255882005499, 70.24035670826602, 71.20443649093836, 70.09425412021434, 66.30087157788812, 91.99286536137798, 93.29324384820613, 95.53029753940523, 89.27151155891583, 107.1994683465086, 90.17595946244306, 80.25937329967212, 84.3216555229325, 104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7165782000150099, "mean_inference_ms": 2.061038615874294, "mean_action_processing_ms": 0.39357565540376804, "mean_env_wait_ms": 2.300444854121247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011296749114990234, "StateBufferConnector_ms": 0.003996372222900391, "ViewRequirementAgentConnector_ms": 0.20674657821655273}, "num_episodes": 22, "episode_return_max": 120.30105999873304, "episode_return_min": 66.30087157788812, "episode_return_mean": 88.27808323221011, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 478.7032600107422, "num_env_steps_trained_throughput_per_sec": 478.7032600107422, "timesteps_total": 124928, "num_env_steps_sampled_lifetime": 124928, "num_agent_steps_sampled_lifetime": 124928, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 124928, "timers": {"training_iteration_time_ms": 2215.873, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2215.873, "sample_time_ms": 912.342, "learn_time_ms": 1286.854, "learn_throughput": 795.739, "synch_weights_time_ms": 16.472}, "counters": {"num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "done": false, "training_iteration": 122, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-13", "timestamp": 1744167313, "time_this_iter_s": 2.144200563430786, "time_total_s": 306.05910539627075, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.05910539627075, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 34.93333333333334, "ram_util_percent": 95.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.639670844748616, "cur_kl_coeff": 3.7615819226313197e-38, "cur_lr": 1e-07, "total_loss": 2.1431125931441786, "policy_loss": -0.0002868784125894308, "vf_loss": 9.76307487487793, "vf_explained_var": -8.605755865573884e-05, "kl": 1.9489178759504733e-06, "entropy": 2.9736924201250075, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "env_runners": {"episode_reward_max": 120.30105999873304, "episode_reward_min": 70.85325605682351, "episode_reward_mean": 88.8766840688606, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.85325605682351}, "policy_reward_max": {"tplp_policy": 120.30105999873304}, "policy_reward_mean": {"tplp_policy": 88.8766840688606}, "custom_metrics": {"mean_episode_reward_mean": 88.8766840688606, "mean_episode_reward_min": 70.85325605682351, "mean_episode_reward_max": 120.30105999873304}, "hist_stats": {"episode_reward": [104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [104.44975688894282, 75.53788702402468, 81.26318172607586, 77.40426884223724, 78.97197481169347, 106.43874608694377, 99.83835707830185, 82.44026910356484, 83.51500387849777, 95.43185887942549, 97.45576789268108, 108.08948265688176, 86.0279974497814, 73.7602989056609, 95.2642061473787, 86.90499562072722, 83.6877032431957, 96.92139955545251, 78.34477545242278, 100.29418299315343, 98.46537692736601, 74.89892351850202, 78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.715934358338548, "mean_inference_ms": 2.0594675331905576, "mean_action_processing_ms": 0.39320183024070543, "mean_env_wait_ms": 2.299214406638001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007276773452758789, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.19115638732910156}, "num_episodes": 20, "episode_return_max": 120.30105999873304, "episode_return_min": 70.85325605682351, "episode_return_mean": 88.8766840688606, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 479.8734617117278, "num_env_steps_trained_throughput_per_sec": 479.8734617117278, "timesteps_total": 125952, "num_env_steps_sampled_lifetime": 125952, "num_agent_steps_sampled_lifetime": 125952, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 125952, "timers": {"training_iteration_time_ms": 2196.045, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2196.045, "sample_time_ms": 898.424, "learn_time_ms": 1280.998, "learn_throughput": 799.377, "synch_weights_time_ms": 16.419}, "counters": {"num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "done": false, "training_iteration": 123, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-15", "timestamp": 1744167315, "time_this_iter_s": 2.13920521736145, "time_total_s": 308.1983106136322, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.1983106136322, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 36.766666666666666, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.470131116360426, "cur_kl_coeff": 1.8807909613156599e-38, "cur_lr": 1e-07, "total_loss": 2.136733143776655, "policy_loss": -0.0002266961499117315, "vf_loss": 9.737327909469604, "vf_explained_var": -0.00014438480138778687, "kl": 1.4948958436677984e-06, "entropy": 2.9737214386463164, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "env_runners": {"episode_reward_max": 120.30105999873304, "episode_reward_min": 70.85325605682351, "episode_reward_mean": 89.64466765263651, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.85325605682351}, "policy_reward_max": {"tplp_policy": 120.30105999873304}, "policy_reward_mean": {"tplp_policy": 89.64466765263651}, "custom_metrics": {"mean_episode_reward_mean": 89.64466765263651, "mean_episode_reward_min": 70.85325605682351, "mean_episode_reward_max": 120.30105999873304}, "hist_stats": {"episode_reward": [78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.20432111233242, 73.34400245750334, 89.48195820266294, 93.04372448890084, 77.64776885697684, 92.1988366090301, 72.54887276459189, 97.00202908254708, 96.80454651108735, 88.32989513104712, 82.87068623530844, 79.07752364330089, 79.28487267665992, 85.72833020792245, 87.2434996854354, 92.1079561625412, 89.50306448843281, 96.31995514022071, 86.0833538613118, 77.27876565955093, 86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7154601831488674, "mean_inference_ms": 2.0580577920212586, "mean_action_processing_ms": 0.3926505706844555, "mean_env_wait_ms": 2.297742101864458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007285356521606445, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.2069084644317627}, "num_episodes": 22, "episode_return_max": 120.30105999873304, "episode_return_min": 70.85325605682351, "episode_return_mean": 89.64466765263651, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 451.31183489447784, "num_env_steps_trained_throughput_per_sec": 451.31183489447784, "timesteps_total": 126976, "num_env_steps_sampled_lifetime": 126976, "num_agent_steps_sampled_lifetime": 126976, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 126976, "timers": {"training_iteration_time_ms": 2203.502, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2203.502, "sample_time_ms": 893.886, "learn_time_ms": 1292.557, "learn_throughput": 792.228, "synch_weights_time_ms": 16.854}, "counters": {"num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "done": false, "training_iteration": 124, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-17", "timestamp": 1744167317, "time_this_iter_s": 2.274451971054077, "time_total_s": 310.4727625846863, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.4727625846863, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 41.93333333333333, "ram_util_percent": 95.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5592144448310137, "cur_kl_coeff": 9.403954806578299e-39, "cur_lr": 1e-07, "total_loss": 2.1219015538692476, "policy_loss": -0.00013540496584028006, "vf_loss": 9.678099274635315, "vf_explained_var": -0.00010705962777137756, "kl": 1.6353187544115855e-06, "entropy": 2.974878564476967, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 120.30105999873304, "episode_reward_min": 57.14697324191949, "episode_reward_mean": 89.20303978953078, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.14697324191949}, "policy_reward_max": {"tplp_policy": 120.30105999873304}, "policy_reward_mean": {"tplp_policy": 89.20303978953078}, "custom_metrics": {"mean_episode_reward_mean": 89.20303978953078, "mean_episode_reward_min": 57.14697324191949, "mean_episode_reward_max": 120.30105999873304}, "hist_stats": {"episode_reward": [86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.22757226763723, 77.2628305078134, 86.98589679737863, 85.32369357863112, 83.82491202768824, 91.87689567496562, 110.33534691775199, 94.15734879779349, 81.61601861105927, 97.26016590635595, 101.29089918992901, 101.6651247774821, 75.2360173563729, 99.9993419556323, 71.04894398073198, 80.93823775977803, 96.70133507810068, 91.14121459814811, 77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7150332155121825, "mean_inference_ms": 2.05672725781286, "mean_action_processing_ms": 0.39235339493925264, "mean_env_wait_ms": 2.296735811771477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006295442581176758, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.2024083137512207}, "num_episodes": 20, "episode_return_max": 120.30105999873304, "episode_return_min": 57.14697324191949, "episode_return_mean": 89.20303978953078, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 446.34365855146405, "num_env_steps_trained_throughput_per_sec": 446.34365855146405, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 2220.698, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2220.698, "sample_time_ms": 901.047, "learn_time_ms": 1302.033, "learn_throughput": 786.463, "synch_weights_time_ms": 17.515}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 125, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-19", "timestamp": 1744167319, "time_this_iter_s": 2.3014886379241943, "time_total_s": 312.7742512226105, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.7742512226105, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 40.075, "ram_util_percent": 95.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.663278416544199, "cur_kl_coeff": 4.7019774032891496e-39, "cur_lr": 1e-07, "total_loss": 2.121337754279375, "policy_loss": -0.0003058553673326969, "vf_loss": 9.67698912024498, "vf_explained_var": -0.00011175759136676789, "kl": 2.004284995356376e-06, "entropy": 2.976036661863327, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "env_runners": {"episode_reward_max": 120.30105999873304, "episode_reward_min": 57.14697324191949, "episode_reward_mean": 89.28378652169789, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.14697324191949}, "policy_reward_max": {"tplp_policy": 120.30105999873304}, "policy_reward_mean": {"tplp_policy": 89.28378652169789}, "custom_metrics": {"mean_episode_reward_mean": 89.28378652169789, "mean_episode_reward_min": 57.14697324191949, "mean_episode_reward_max": 120.30105999873304}, "hist_stats": {"episode_reward": [77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.76469211547531, 120.30105999873304, 98.71411342222723, 92.55344387119378, 86.1746892839387, 86.40957547829967, 82.92882139104228, 87.42053394134732, 87.38331775089854, 75.27553344381334, 90.09331289835126, 85.03894400891177, 101.46216492691576, 91.75900491209666, 101.37972328864194, 78.20422684166255, 92.60647160984828, 89.29353230470765, 91.91891505965219, 95.63458642685585, 91.00407478722569, 94.77522705354455, 92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7145796647111469, "mean_inference_ms": 2.055431738401349, "mean_action_processing_ms": 0.3920627523711766, "mean_env_wait_ms": 2.2954463414740798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008471965789794922, "StateBufferConnector_ms": 0.006511211395263672, "ViewRequirementAgentConnector_ms": 0.20987653732299805}, "num_episodes": 18, "episode_return_max": 120.30105999873304, "episode_return_min": 57.14697324191949, "episode_return_mean": 89.28378652169789, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.74834519816847, "num_env_steps_trained_throughput_per_sec": 465.74834519816847, "timesteps_total": 129024, "num_env_steps_sampled_lifetime": 129024, "num_agent_steps_sampled_lifetime": 129024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 2220.351, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2220.351, "sample_time_ms": 906.091, "learn_time_ms": 1297.227, "learn_throughput": 789.376, "synch_weights_time_ms": 16.929}, "counters": {"num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "done": false, "training_iteration": 126, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-22", "timestamp": 1744167322, "time_this_iter_s": 2.203770160675049, "time_total_s": 314.9780213832855, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.9780213832855, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 35.43333333333333, "ram_util_percent": 95.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.892864261567593, "cur_kl_coeff": 2.3509887016445748e-39, "cur_lr": 1e-07, "total_loss": 2.103774193674326, "policy_loss": -0.0003765787929296494, "vf_loss": 9.607173997163773, "vf_explained_var": -0.00011181905865669251, "kl": 2.2065613484389957e-06, "entropy": 2.9764273300766946, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "env_runners": {"episode_reward_max": 113.63171747418524, "episode_reward_min": 57.14697324191949, "episode_reward_mean": 88.09525254507787, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.14697324191949}, "policy_reward_max": {"tplp_policy": 113.63171747418524}, "policy_reward_mean": {"tplp_policy": 88.09525254507787}, "custom_metrics": {"mean_episode_reward_mean": 88.09525254507787, "mean_episode_reward_min": 57.14697324191949, "mean_episode_reward_max": 113.63171747418524}, "hist_stats": {"episode_reward": [92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [92.5573816565889, 79.8335655548897, 73.7768991527202, 86.78494239134707, 92.000623103744, 87.11632180859202, 86.39038365100187, 90.1458703326879, 86.23609723470875, 101.69417320542028, 89.0684015311006, 84.02590791423434, 95.78389030446131, 108.5940723355031, 82.33602077223514, 70.85325605682351, 100.49120663105442, 89.48125499003535, 77.86953948934864, 83.91766254402386, 82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7139569922890812, "mean_inference_ms": 2.05378328895899, "mean_action_processing_ms": 0.39172051935717067, "mean_env_wait_ms": 2.2937137274278667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008186578750610352, "StateBufferConnector_ms": 0.0065114498138427734, "ViewRequirementAgentConnector_ms": 0.21485161781311035}, "num_episodes": 22, "episode_return_max": 113.63171747418524, "episode_return_min": 57.14697324191949, "episode_return_mean": 88.09525254507787, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.7363230558735, "num_env_steps_trained_throughput_per_sec": 495.7363230558735, "timesteps_total": 130048, "num_env_steps_sampled_lifetime": 130048, "num_agent_steps_sampled_lifetime": 130048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 130048, "timers": {"training_iteration_time_ms": 2197.264, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2197.264, "sample_time_ms": 891.775, "learn_time_ms": 1288.136, "learn_throughput": 794.947, "synch_weights_time_ms": 17.249}, "counters": {"num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "done": false, "training_iteration": 127, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-24", "timestamp": 1744167324, "time_this_iter_s": 2.0715713500976562, "time_total_s": 317.0495927333832, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.0495927333832, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 95.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.681856116652489, "cur_kl_coeff": 1.1754943508222874e-39, "cur_lr": 1e-07, "total_loss": 2.135467591136694, "policy_loss": -0.00016955618630163372, "vf_loss": 9.733360892534256, "vf_explained_var": -0.00011113509535789489, "kl": 1.6420960108121107e-06, "entropy": 2.977030743658543, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "env_runners": {"episode_reward_max": 117.15567244754146, "episode_reward_min": 57.14697324191949, "episode_reward_mean": 87.97800632317536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.14697324191949}, "policy_reward_max": {"tplp_policy": 117.15567244754146}, "policy_reward_mean": {"tplp_policy": 87.97800632317536}, "custom_metrics": {"mean_episode_reward_mean": 87.97800632317536, "mean_episode_reward_min": 57.14697324191949, "mean_episode_reward_max": 117.15567244754146}, "hist_stats": {"episode_reward": [82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [82.69361546257312, 82.33088287936043, 102.14278133440834, 99.46391279486356, 101.7907318462811, 83.90589089201619, 97.6159477204611, 99.92026533995056, 94.16683181493893, 108.51779516643862, 93.04584499350315, 101.6514847202478, 81.10114950375167, 107.80099911721707, 100.33769568666015, 95.86370348002227, 81.50880065391904, 75.93899378670241, 105.6889775672136, 84.93126626660417, 81.24284389907754, 101.99011283742625, 74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7135040187562006, "mean_inference_ms": 2.052593343753248, "mean_action_processing_ms": 0.3915019565144756, "mean_env_wait_ms": 2.292191861363658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008186578750610352, "StateBufferConnector_ms": 0.00701594352722168, "ViewRequirementAgentConnector_ms": 0.22693896293640137}, "num_episodes": 20, "episode_return_max": 117.15567244754146, "episode_return_min": 57.14697324191949, "episode_return_mean": 87.97800632317536, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 441.6428804260534, "num_env_steps_trained_throughput_per_sec": 441.6428804260534, "timesteps_total": 131072, "num_env_steps_sampled_lifetime": 131072, "num_agent_steps_sampled_lifetime": 131072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 131072, "timers": {"training_iteration_time_ms": 2213.072, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.072, "sample_time_ms": 893.055, "learn_time_ms": 1302.39, "learn_throughput": 786.247, "synch_weights_time_ms": 17.522}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "done": false, "training_iteration": 128, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-26", "timestamp": 1744167326, "time_this_iter_s": 2.324964761734009, "time_total_s": 319.3745574951172, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83F60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.3745574951172, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 47.03333333333333, "ram_util_percent": 95.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0223423972725865, "cur_kl_coeff": 5.877471754111437e-40, "cur_lr": 1e-07, "total_loss": 2.10755635201931, "policy_loss": -0.00025761676952242853, "vf_loss": 9.622567105293275, "vf_explained_var": -0.00010429620742797851, "kl": 1.8758311425726148e-06, "entropy": 2.9782777786254884, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "env_runners": {"episode_reward_max": 117.15567244754146, "episode_reward_min": 57.14697324191949, "episode_reward_mean": 86.59957797794155, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 57.14697324191949}, "policy_reward_max": {"tplp_policy": 117.15567244754146}, "policy_reward_mean": {"tplp_policy": 86.59957797794155}, "custom_metrics": {"mean_episode_reward_mean": 86.59957797794155, "mean_episode_reward_min": 57.14697324191949, "mean_episode_reward_max": 117.15567244754146}, "hist_stats": {"episode_reward": [74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [74.27293980479627, 82.90954333721434, 74.08756224556933, 80.24543622538326, 89.75155694020239, 85.18471269167696, 69.81333633586748, 87.31729905978936, 79.59591813303118, 88.02841656542253, 76.06588386361916, 81.41337269264602, 95.83689458322904, 91.04086788111097, 98.51168672469888, 93.37188959689784, 57.14697324191949, 82.11393000721259, 92.28735171546717, 105.09611180746944, 89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.713061536442339, "mean_inference_ms": 2.051509427952611, "mean_action_processing_ms": 0.3912748311906021, "mean_env_wait_ms": 2.2907363943155685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009168863296508789, "StateBufferConnector_ms": 0.009067296981811523, "ViewRequirementAgentConnector_ms": 0.20579934120178223}, "num_episodes": 22, "episode_return_max": 117.15567244754146, "episode_return_min": 57.14697324191949, "episode_return_mean": 86.59957797794155, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.6662874448149, "num_env_steps_trained_throughput_per_sec": 465.6662874448149, "timesteps_total": 132096, "num_env_steps_sampled_lifetime": 132096, "num_agent_steps_sampled_lifetime": 132096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 132096, "timers": {"training_iteration_time_ms": 2220.102, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2220.102, "sample_time_ms": 896.715, "learn_time_ms": 1305.722, "learn_throughput": 784.24, "synch_weights_time_ms": 17.56}, "counters": {"num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "done": false, "training_iteration": 129, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-28", "timestamp": 1744167328, "time_this_iter_s": 2.2043495178222656, "time_total_s": 321.57890701293945, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.57890701293945, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 44.333333333333336, "ram_util_percent": 95.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9063365161418915, "cur_kl_coeff": 2.9387358770557185e-40, "cur_lr": 1e-07, "total_loss": 2.1321938171982766, "policy_loss": -0.00024221420171670615, "vf_loss": 9.721430575847625, "vf_explained_var": -0.00010251551866531372, "kl": 2.0430551241901185e-06, "entropy": 2.97921604514122, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "env_runners": {"episode_reward_max": 117.15567244754146, "episode_reward_min": 61.22930155047586, "episode_reward_mean": 87.9182503183534, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.22930155047586}, "policy_reward_max": {"tplp_policy": 117.15567244754146}, "policy_reward_mean": {"tplp_policy": 87.9182503183534}, "custom_metrics": {"mean_episode_reward_mean": 87.9182503183534, "mean_episode_reward_min": 61.22930155047586, "mean_episode_reward_max": 117.15567244754146}, "hist_stats": {"episode_reward": [89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [89.17532895904776, 107.6655356907718, 89.36655071443994, 84.77889903645372, 112.56527333953092, 85.31532019148565, 95.98567090312862, 91.53715480539422, 83.69348301914012, 71.42916243409995, 65.65979861064592, 80.95963897140182, 86.70710425068138, 83.73508288399921, 96.36289272113378, 98.64610894567002, 86.17691121646891, 104.44620020083198, 78.96711696595322, 65.67164577976214, 80.93834124367905, 90.17049100506898, 66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7125493035319369, "mean_inference_ms": 2.050427731187308, "mean_action_processing_ms": 0.39103843747007033, "mean_env_wait_ms": 2.289253321866827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0092315673828125, "StateBufferConnector_ms": 0.009067058563232422, "ViewRequirementAgentConnector_ms": 0.19921135902404785}, "num_episodes": 20, "episode_return_max": 117.15567244754146, "episode_return_min": 61.22930155047586, "episode_return_mean": 87.9182503183534, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 456.7975552476654, "num_env_steps_trained_throughput_per_sec": 456.7975552476654, "timesteps_total": 133120, "num_env_steps_sampled_lifetime": 133120, "num_agent_steps_sampled_lifetime": 133120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 133120, "timers": {"training_iteration_time_ms": 2224.843, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2224.843, "sample_time_ms": 903.436, "learn_time_ms": 1303.56, "learn_throughput": 785.541, "synch_weights_time_ms": 17.743}, "counters": {"num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "done": false, "training_iteration": 130, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-31", "timestamp": 1744167331, "time_this_iter_s": 2.2484865188598633, "time_total_s": 323.8273935317993, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 323.8273935317993, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 95.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8585704151540994, "cur_kl_coeff": 1.4693679385278593e-40, "cur_lr": 1e-07, "total_loss": 2.1437835179269316, "policy_loss": -0.0001717716222628951, "vf_loss": 9.767682200670242, "vf_explained_var": -0.00010915473103523254, "kl": 1.3185799745740744e-06, "entropy": 2.9796524181962014, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "env_runners": {"episode_reward_max": 117.15567244754146, "episode_reward_min": 61.22930155047586, "episode_reward_mean": 89.25682457980534, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.22930155047586}, "policy_reward_max": {"tplp_policy": 117.15567244754146}, "policy_reward_mean": {"tplp_policy": 89.25682457980534}, "custom_metrics": {"mean_episode_reward_mean": 89.25682457980534, "mean_episode_reward_min": 61.22930155047586, "mean_episode_reward_max": 117.15567244754146}, "hist_stats": {"episode_reward": [66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [66.81550141143532, 64.72255070212148, 92.53602712780993, 88.65882705846572, 92.5950315051843, 79.77319370408001, 81.92370226963558, 86.84881519596306, 78.03929256089091, 83.51944905137263, 77.88142180138071, 113.63171747418524, 93.04828055620527, 100.70489772535359, 80.16413688306808, 92.00901571446472, 100.59555274703582, 101.31824945969103, 90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.712140485452726, "mean_inference_ms": 2.0495863223044224, "mean_action_processing_ms": 0.39077984530843596, "mean_env_wait_ms": 2.2877990694115495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005061626434326172, "StateBufferConnector_ms": 0.008649110794067383, "ViewRequirementAgentConnector_ms": 0.20787787437438965}, "num_episodes": 22, "episode_return_max": 117.15567244754146, "episode_return_min": 61.22930155047586, "episode_return_mean": 89.25682457980534, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.10571444265895, "num_env_steps_trained_throughput_per_sec": 468.10571444265895, "timesteps_total": 134144, "num_env_steps_sampled_lifetime": 134144, "num_agent_steps_sampled_lifetime": 134144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 134144, "timers": {"training_iteration_time_ms": 2204.722, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2204.722, "sample_time_ms": 898.029, "learn_time_ms": 1288.773, "learn_throughput": 794.554, "synch_weights_time_ms": 17.92}, "counters": {"num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "done": false, "training_iteration": 131, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-33", "timestamp": 1744167333, "time_this_iter_s": 2.1932761669158936, "time_total_s": 326.0206696987152, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.0206696987152, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 38.5, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8020955711603164, "cur_kl_coeff": 7.346839692639296e-41, "cur_lr": 1e-07, "total_loss": 2.104309334605932, "policy_loss": -0.00028523605433292685, "vf_loss": 9.610348463058472, "vf_explained_var": -7.913261651992798e-05, "kl": 2.411533007110056e-06, "entropy": 2.9799252808094026, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "env_runners": {"episode_reward_max": 117.15567244754146, "episode_reward_min": 61.22930155047586, "episode_reward_mean": 89.61962698030207, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 61.22930155047586}, "policy_reward_max": {"tplp_policy": 117.15567244754146}, "policy_reward_mean": {"tplp_policy": 89.61962698030207}, "custom_metrics": {"mean_episode_reward_mean": 89.61962698030207, "mean_episode_reward_min": 61.22930155047586, "mean_episode_reward_max": 117.15567244754146}, "hist_stats": {"episode_reward": [90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.60391187940496, 86.87914449552102, 83.45937143260431, 82.27812823708321, 81.88306199983231, 89.9964231935981, 93.61657871066954, 95.0770203845966, 117.15567244754146, 78.92318291504785, 84.95058443891568, 92.64813155142103, 80.22281972787334, 73.41571625158117, 61.22930155047586, 79.9947089050005, 80.48788715859203, 92.49740098378375, 79.80092393133953, 84.2639198591261, 88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.712023911801629, "mean_inference_ms": 2.049203105144591, "mean_action_processing_ms": 0.39073541752844576, "mean_env_wait_ms": 2.2872344805109877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008054971694946289, "StateBufferConnector_ms": 0.0076503753662109375, "ViewRequirementAgentConnector_ms": 0.21638870239257812}, "num_episodes": 18, "episode_return_max": 117.15567244754146, "episode_return_min": 61.22930155047586, "episode_return_mean": 89.61962698030207, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 426.71806954653385, "num_env_steps_trained_throughput_per_sec": 426.71806954653385, "timesteps_total": 135168, "num_env_steps_sampled_lifetime": 135168, "num_agent_steps_sampled_lifetime": 135168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 135168, "timers": {"training_iteration_time_ms": 2230.782, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2230.782, "sample_time_ms": 913.737, "learn_time_ms": 1299.233, "learn_throughput": 788.157, "synch_weights_time_ms": 17.812}, "counters": {"num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "done": false, "training_iteration": 132, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-35", "timestamp": 1744167335, "time_this_iter_s": 2.4051334857940674, "time_total_s": 328.4258031845093, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC31A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 328.4258031845093, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 49.333333333333336, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.884173058718443, "cur_kl_coeff": 3.673419846319648e-41, "cur_lr": 1e-07, "total_loss": 2.1191143825650216, "policy_loss": -0.0002513746148906648, "vf_loss": 9.669549250602723, "vf_explained_var": -7.784031331539154e-05, "kl": 1.6425536671693663e-06, "entropy": 2.9802156165242195, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "env_runners": {"episode_reward_max": 112.381101401387, "episode_reward_min": 63.932977073422855, "episode_reward_mean": 90.17417160522143, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.932977073422855}, "policy_reward_max": {"tplp_policy": 112.381101401387}, "policy_reward_mean": {"tplp_policy": 90.17417160522143}, "custom_metrics": {"mean_episode_reward_mean": 90.17417160522143, "mean_episode_reward_min": 63.932977073422855, "mean_episode_reward_max": 112.381101401387}, "hist_stats": {"episode_reward": [88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.90199488519303, 81.90896706933462, 103.9345411546209, 85.0453948459543, 72.75524138009352, 85.03950763010333, 88.11583671179982, 78.16638855290364, 88.06284684445805, 78.36868380042712, 102.04797406118259, 86.27253608909719, 99.26030813494768, 86.09984621203519, 84.30353416758238, 84.14288160340958, 96.72516312655003, 95.50122363927088, 86.797827191604, 90.29215234922383, 84.94178261795415, 78.95466964964743, 98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7120558498156905, "mean_inference_ms": 2.049136442812565, "mean_action_processing_ms": 0.3907573499370814, "mean_env_wait_ms": 2.2867140044016256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02898573875427246, "StateBufferConnector_ms": 0.006148815155029297, "ViewRequirementAgentConnector_ms": 0.20561981201171875}, "num_episodes": 20, "episode_return_max": 112.381101401387, "episode_return_min": 63.932977073422855, "episode_return_mean": 90.17417160522143, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 458.88349067797, "num_env_steps_trained_throughput_per_sec": 458.88349067797, "timesteps_total": 136192, "num_env_steps_sampled_lifetime": 136192, "num_agent_steps_sampled_lifetime": 136192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 136192, "timers": {"training_iteration_time_ms": 2240.543, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2240.543, "sample_time_ms": 924.712, "learn_time_ms": 1297.85, "learn_throughput": 788.997, "synch_weights_time_ms": 17.981}, "counters": {"num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "done": false, "training_iteration": 133, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-38", "timestamp": 1744167338, "time_this_iter_s": 2.2373363971710205, "time_total_s": 330.6631395816803, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.6631395816803, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 48.300000000000004, "ram_util_percent": 95.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5385402761399747, "cur_kl_coeff": 1.836709923159824e-41, "cur_lr": 1e-07, "total_loss": 2.1097228907048704, "policy_loss": -0.00022000939352437854, "vf_loss": 9.631702041625976, "vf_explained_var": -0.0001169934868812561, "kl": 1.2665640509279541e-06, "entropy": 2.979826258122921, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "env_runners": {"episode_reward_max": 117.88439029394395, "episode_reward_min": 63.932977073422855, "episode_reward_mean": 91.55097155786137, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.932977073422855}, "policy_reward_max": {"tplp_policy": 117.88439029394395}, "policy_reward_mean": {"tplp_policy": 91.55097155786137}, "custom_metrics": {"mean_episode_reward_mean": 91.55097155786137, "mean_episode_reward_min": 63.932977073422855, "mean_episode_reward_max": 117.88439029394395}, "hist_stats": {"episode_reward": [98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.20663414717544, 106.23776082980261, 101.63809285194328, 85.39779280457114, 94.21162101664981, 92.40156886788247, 99.1251594811162, 88.21123128279301, 85.17821074358586, 99.9990661063204, 91.90082921791006, 79.36532494144319, 79.67566489923183, 89.09268924234753, 100.87753584213411, 85.59951931538434, 92.85895918270117, 82.0848044538134, 92.41244122905326, 97.6729917708712, 95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7120138553788887, "mean_inference_ms": 2.048856419687319, "mean_action_processing_ms": 0.3906108125861699, "mean_env_wait_ms": 2.2860898264684626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028102397918701172, "StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.20827364921569824}, "num_episodes": 22, "episode_return_max": 117.88439029394395, "episode_return_min": 63.932977073422855, "episode_return_mean": 91.55097155786137, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 479.6320971573402, "num_env_steps_trained_throughput_per_sec": 479.6320971573402, "timesteps_total": 137216, "num_env_steps_sampled_lifetime": 137216, "num_agent_steps_sampled_lifetime": 137216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 137216, "timers": {"training_iteration_time_ms": 2227.146, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2227.146, "sample_time_ms": 919.823, "learn_time_ms": 1289.643, "learn_throughput": 794.018, "synch_weights_time_ms": 17.679}, "counters": {"num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "done": false, "training_iteration": 134, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-40", "timestamp": 1744167340, "time_this_iter_s": 2.1415116786956787, "time_total_s": 332.804651260376, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.804651260376, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 33.699999999999996, "ram_util_percent": 95.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.706044706702232, "cur_kl_coeff": 9.18354961579912e-42, "cur_lr": 1e-07, "total_loss": 2.1350290291011333, "policy_loss": -0.0003048004669835791, "vf_loss": 9.733474189043045, "vf_explained_var": -9.334199130535125e-05, "kl": 2.7308832812655836e-06, "entropy": 2.980347080528736, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "env_runners": {"episode_reward_max": 117.88439029394395, "episode_reward_min": 63.932977073422855, "episode_reward_mean": 90.9929170417589, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.932977073422855}, "policy_reward_max": {"tplp_policy": 117.88439029394395}, "policy_reward_mean": {"tplp_policy": 90.9929170417589}, "custom_metrics": {"mean_episode_reward_mean": 90.9929170417589, "mean_episode_reward_min": 63.932977073422855, "mean_episode_reward_max": 117.88439029394395}, "hist_stats": {"episode_reward": [95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.52106558736146, 108.16157786103277, 99.04999731136867, 80.16081854999156, 97.83312970205273, 93.27058140050507, 91.45707358466251, 79.89390238795222, 87.4750444150746, 94.813847900327, 104.94809724513115, 89.61409046004793, 94.8123623381772, 88.00536186220062, 110.73675153545601, 87.94970292477005, 78.89969979098234, 81.5291550909816, 97.2123436845979, 112.381101401387, 73.54083670571653, 79.40994638098886, 85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.711958795967905, "mean_inference_ms": 2.0486973575957, "mean_action_processing_ms": 0.3905549467509257, "mean_env_wait_ms": 2.2856859973601416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02902507781982422, "StateBufferConnector_ms": 0.005626201629638672, "ViewRequirementAgentConnector_ms": 0.1961379051208496}, "num_episodes": 20, "episode_return_max": 117.88439029394395, "episode_return_min": 63.932977073422855, "episode_return_mean": 90.9929170417589, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 353.83128849695197, "num_env_steps_trained_throughput_per_sec": 353.83128849695197, "timesteps_total": 138240, "num_env_steps_sampled_lifetime": 138240, "num_agent_steps_sampled_lifetime": 138240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 138240, "timers": {"training_iteration_time_ms": 2287.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2287.129, "sample_time_ms": 921.54, "learn_time_ms": 1347.812, "learn_throughput": 759.75, "synch_weights_time_ms": 17.777}, "counters": {"num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "done": false, "training_iteration": 135, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-43", "timestamp": 1744167343, "time_this_iter_s": 2.9043383598327637, "time_total_s": 335.70898962020874, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C822A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.70898962020874, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 42.875, "ram_util_percent": 95.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6207939378917215, "cur_kl_coeff": 4.59177480789956e-42, "cur_lr": 1e-07, "total_loss": 2.105658144503832, "policy_loss": -0.00022019172320142388, "vf_loss": 9.616242092847823, "vf_explained_var": -5.185939371585846e-05, "kl": 1.947752087272381e-06, "entropy": 2.9818220019340513, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "env_runners": {"episode_reward_max": 117.88439029394395, "episode_reward_min": 63.932977073422855, "episode_reward_mean": 89.88277908354738, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.932977073422855}, "policy_reward_max": {"tplp_policy": 117.88439029394395}, "policy_reward_mean": {"tplp_policy": 89.88277908354738}, "custom_metrics": {"mean_episode_reward_mean": 89.88277908354738, "mean_episode_reward_min": 63.932977073422855, "mean_episode_reward_max": 117.88439029394395}, "hist_stats": {"episode_reward": [85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.94841697233917, 83.77367682875116, 80.57844976532755, 92.34392446688274, 98.83040473053586, 88.62356650521293, 109.48895601780931, 97.57410043769025, 79.33323398490181, 80.68561195135732, 92.32898797352667, 90.97800258547974, 94.43715910091127, 104.0073152397264, 111.66399436980015, 67.51931898105576, 91.5292651213383, 82.39702236236933, 87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7121703350913947, "mean_inference_ms": 2.049350413814957, "mean_action_processing_ms": 0.3905381509736954, "mean_env_wait_ms": 2.2861174523832988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03469395637512207, "StateBufferConnector_ms": 0.0067293643951416016, "ViewRequirementAgentConnector_ms": 0.1852738857269287}, "num_episodes": 22, "episode_return_max": 117.88439029394395, "episode_return_min": 63.932977073422855, "episode_return_mean": 89.88277908354738, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 348.5470586340146, "num_env_steps_trained_throughput_per_sec": 348.5470586340146, "timesteps_total": 139264, "num_env_steps_sampled_lifetime": 139264, "num_agent_steps_sampled_lifetime": 139264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 139264, "timers": {"training_iteration_time_ms": 2361.059, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2361.059, "sample_time_ms": 944.73, "learn_time_ms": 1398.109, "learn_throughput": 732.418, "synch_weights_time_ms": 18.069}, "counters": {"num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "done": false, "training_iteration": 136, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-46", "timestamp": 1744167346, "time_this_iter_s": 2.9435341358184814, "time_total_s": 338.6525237560272, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 338.6525237560272, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 54.525000000000006, "ram_util_percent": 96.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7552781477570534, "cur_kl_coeff": 2.29588740394978e-42, "cur_lr": 1e-07, "total_loss": 2.1360888324677942, "policy_loss": -0.00020319996401667594, "vf_loss": 9.73808844089508, "vf_explained_var": -0.00016926713287830354, "kl": 1.4089876807288348e-06, "entropy": 2.9823007479310037, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "env_runners": {"episode_reward_max": 117.88439029394395, "episode_reward_min": 63.932977073422855, "episode_reward_mean": 89.80912560253996, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.932977073422855}, "policy_reward_max": {"tplp_policy": 117.88439029394395}, "policy_reward_mean": {"tplp_policy": 89.80912560253996}, "custom_metrics": {"mean_episode_reward_mean": 89.80912560253996, "mean_episode_reward_min": 63.932977073422855, "mean_episode_reward_max": 117.88439029394395}, "hist_stats": {"episode_reward": [87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.46893240721924, 63.932977073422855, 107.96941692294394, 103.99226233251014, 85.76493260587401, 84.73128101793439, 87.7528065225756, 84.75540396983399, 91.82492934959612, 78.84762800495093, 77.13903977255046, 97.1878689815715, 84.31917271985473, 87.0589729674184, 91.18199271592468, 89.94175559955457, 91.56052953132239, 95.48216256718047, 92.37068242181007, 66.92823040985938, 104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7121567096412289, "mean_inference_ms": 2.049759391453291, "mean_action_processing_ms": 0.3904876443832734, "mean_env_wait_ms": 2.2862545821873725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032698869705200195, "StateBufferConnector_ms": 0.01072382926940918, "ViewRequirementAgentConnector_ms": 0.18057632446289062}, "num_episodes": 18, "episode_return_max": 117.88439029394395, "episode_return_min": 63.932977073422855, "episode_return_mean": 89.80912560253996, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 453.5632012660582, "num_env_steps_trained_throughput_per_sec": 453.5632012660582, "timesteps_total": 140288, "num_env_steps_sampled_lifetime": 140288, "num_agent_steps_sampled_lifetime": 140288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 140288, "timers": {"training_iteration_time_ms": 2380.266, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2380.266, "sample_time_ms": 958.279, "learn_time_ms": 1404.161, "learn_throughput": 729.261, "synch_weights_time_ms": 17.675}, "counters": {"num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "done": false, "training_iteration": 137, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-48", "timestamp": 1744167348, "time_this_iter_s": 2.263181209564209, "time_total_s": 340.91570496559143, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.91570496559143, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 38.6, "ram_util_percent": 96.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7769850365817548, "cur_kl_coeff": 1.14794370197489e-42, "cur_lr": 1e-07, "total_loss": 2.1306417398154736, "policy_loss": -0.00018696656043175607, "vf_loss": 9.716135424375533, "vf_explained_var": -9.660869836807251e-05, "kl": 1.1427476445780016e-06, "entropy": 2.9820513993501665, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "env_runners": {"episode_reward_max": 117.88439029394395, "episode_reward_min": 67.49086065011412, "episode_reward_mean": 90.7202913162138, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 67.49086065011412}, "policy_reward_max": {"tplp_policy": 117.88439029394395}, "policy_reward_mean": {"tplp_policy": 90.7202913162138}, "custom_metrics": {"mean_episode_reward_mean": 90.7202913162138, "mean_episode_reward_min": 67.49086065011412, "mean_episode_reward_max": 117.88439029394395}, "hist_stats": {"episode_reward": [104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [104.10085927580282, 107.75624603005275, 82.19141479483045, 99.9939376788872, 94.41609753017693, 104.08492984811342, 85.22579174055844, 93.11264025380623, 92.54268057249597, 76.91301208615097, 117.88439029394395, 94.06937638414618, 93.3043107280378, 117.3871251557385, 87.78981455058134, 90.6041594759066, 95.75354906171361, 88.57898284662177, 91.18871693244056, 87.12234890971274, 90.58080783740095, 99.82052934161742, 95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.711951288002777, "mean_inference_ms": 2.0498857061619185, "mean_action_processing_ms": 0.3903681838109813, "mean_env_wait_ms": 2.2861741010645544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016280651092529297, "StateBufferConnector_ms": 0.011870861053466797, "ViewRequirementAgentConnector_ms": 0.19089293479919434}, "num_episodes": 20, "episode_return_max": 117.88439029394395, "episode_return_min": 67.49086065011412, "episode_return_mean": 90.7202913162138, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.62507078041403, "num_env_steps_trained_throughput_per_sec": 448.62507078041403, "timesteps_total": 141312, "num_env_steps_sampled_lifetime": 141312, "num_agent_steps_sampled_lifetime": 141312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 141312, "timers": {"training_iteration_time_ms": 2376.657, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2376.657, "sample_time_ms": 954.639, "learn_time_ms": 1404.327, "learn_throughput": 729.175, "synch_weights_time_ms": 17.54}, "counters": {"num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "done": false, "training_iteration": 138, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-50", "timestamp": 1744167350, "time_this_iter_s": 2.2883734703063965, "time_total_s": 343.2040784358978, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 343.2040784358978, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 37.9, "ram_util_percent": 96.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.815611142665148, "cur_kl_coeff": 5.73971850987445e-43, "cur_lr": 1e-07, "total_loss": 2.1291461519896986, "policy_loss": -0.0002544559363741428, "vf_loss": 9.710407227277756, "vf_explained_var": -0.0001454230397939682, "kl": 1.401240308163132e-06, "entropy": 2.9820120677351953, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "env_runners": {"episode_reward_max": 107.99401598777916, "episode_reward_min": 66.85521735402638, "episode_reward_mean": 88.99843402528435, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.85521735402638}, "policy_reward_max": {"tplp_policy": 107.99401598777916}, "policy_reward_mean": {"tplp_policy": 88.99843402528435}, "custom_metrics": {"mean_episode_reward_mean": 88.99843402528435, "mean_episode_reward_min": 66.85521735402638, "mean_episode_reward_max": 107.99401598777916}, "hist_stats": {"episode_reward": [95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.16265603227484, 77.3339226958253, 77.33044144686308, 76.96402525061835, 67.49086065011412, 84.37591538226103, 86.36492884158528, 105.89098035198322, 92.61277043765281, 87.38263912219567, 95.57782317017848, 80.67218508428127, 88.2469930601046, 97.5796483059229, 101.90462572548128, 102.44802345022347, 85.55316327224398, 93.04950715765301, 89.61768880633558, 84.15211881352576, 94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7119606574988147, "mean_inference_ms": 2.05032135341751, "mean_action_processing_ms": 0.39034945913850466, "mean_env_wait_ms": 2.2866488333681425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168905258178711, "StateBufferConnector_ms": 0.010496377944946289, "ViewRequirementAgentConnector_ms": 0.2142314910888672}, "num_episodes": 22, "episode_return_max": 107.99401598777916, "episode_return_min": 66.85521735402638, "episode_return_mean": 88.99843402528435, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 370.368987419, "num_env_steps_trained_throughput_per_sec": 370.368987419, "timesteps_total": 142336, "num_env_steps_sampled_lifetime": 142336, "num_agent_steps_sampled_lifetime": 142336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 142336, "timers": {"training_iteration_time_ms": 2433.238, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2433.238, "sample_time_ms": 962.456, "learn_time_ms": 1452.625, "learn_throughput": 704.931, "synch_weights_time_ms": 18.005}, "counters": {"num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "done": false, "training_iteration": 139, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-53", "timestamp": 1744167353, "time_this_iter_s": 2.7735209465026855, "time_total_s": 345.9775993824005, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.9775993824005, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 47.75, "ram_util_percent": 95.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2516040530055763, "cur_kl_coeff": 2.869859254937225e-43, "cur_lr": 1e-07, "total_loss": 2.1418704889714717, "policy_loss": -0.00011287975357845425, "vf_loss": 9.760814559459686, "vf_explained_var": -0.00013392344117164613, "kl": 1.0716741555560905e-06, "entropy": 2.982202705740929, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "env_runners": {"episode_reward_max": 118.2730607633277, "episode_reward_min": 66.85521735402638, "episode_reward_mean": 90.13962735781226, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.85521735402638}, "policy_reward_max": {"tplp_policy": 118.2730607633277}, "policy_reward_mean": {"tplp_policy": 90.13962735781226}, "custom_metrics": {"mean_episode_reward_mean": 90.13962735781226, "mean_episode_reward_min": 66.85521735402638, "mean_episode_reward_max": 118.2730607633277}, "hist_stats": {"episode_reward": [94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [94.36686472265775, 87.27492442978875, 78.50370722855715, 91.41392710947714, 107.72013400706714, 86.88106721099858, 86.84323227955043, 82.13185363383467, 86.06301940430791, 96.51851869421169, 79.7610989762106, 80.74657945279957, 79.61754002243623, 71.07911222547934, 71.3390688372393, 102.05819521144021, 90.21894984751454, 87.12984433393498, 85.43209041216228, 96.79315664008723, 94.00137424914386, 96.55004948522887, 74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.712036071308213, "mean_inference_ms": 2.0507667039681654, "mean_action_processing_ms": 0.3903276000884992, "mean_env_wait_ms": 2.287139060731501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317453384399414, "StateBufferConnector_ms": 0.013558626174926758, "ViewRequirementAgentConnector_ms": 0.21916675567626953}, "num_episodes": 20, "episode_return_max": 118.2730607633277, "episode_return_min": 66.85521735402638, "episode_return_mean": 90.13962735781226, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 447.01120991920743, "num_env_steps_trained_throughput_per_sec": 447.01120991920743, "timesteps_total": 143360, "num_env_steps_sampled_lifetime": 143360, "num_agent_steps_sampled_lifetime": 143360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 143360, "timers": {"training_iteration_time_ms": 2438.146, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2438.146, "sample_time_ms": 966.726, "learn_time_ms": 1453.578, "learn_throughput": 704.469, "synch_weights_time_ms": 17.69}, "counters": {"num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "done": false, "training_iteration": 140, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-56", "timestamp": 1744167356, "time_this_iter_s": 2.2964675426483154, "time_total_s": 348.2740669250488, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC31A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 348.2740669250488, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 47.699999999999996, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8213343203067778, "cur_kl_coeff": 1.4349296274686126e-43, "cur_lr": 1e-07, "total_loss": 2.139713038504124, "policy_loss": -0.00016292990767396986, "vf_loss": 9.752716684341431, "vf_explained_var": -0.00015917085111141204, "kl": 1.6956735436224335e-06, "entropy": 2.9830319941043855, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "env_runners": {"episode_reward_max": 118.2730607633277, "episode_reward_min": 66.85521735402638, "episode_reward_mean": 91.25495142077489, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.85521735402638}, "policy_reward_max": {"tplp_policy": 118.2730607633277}, "policy_reward_mean": {"tplp_policy": 91.25495142077489}, "custom_metrics": {"mean_episode_reward_mean": 91.25495142077489, "mean_episode_reward_min": 66.85521735402638, "mean_episode_reward_max": 118.2730607633277}, "hist_stats": {"episode_reward": [74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [74.99480293306387, 80.53436598259871, 98.42301775320485, 93.00320272509204, 95.90002447270899, 105.79754358859932, 83.60756453885998, 85.45188318546455, 80.04696684781487, 88.21934265436475, 94.2726061186763, 98.20994484577187, 79.7653520199526, 83.28834979576553, 85.27600157867057, 107.3336665192901, 92.3263006286064, 102.0691800475482, 78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7118408535231544, "mean_inference_ms": 2.050345358125977, "mean_action_processing_ms": 0.3901233364622113, "mean_env_wait_ms": 2.28673036207992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011511087417602539, "StateBufferConnector_ms": 0.010360479354858398, "ViewRequirementAgentConnector_ms": 0.21842169761657715}, "num_episodes": 22, "episode_return_max": 118.2730607633277, "episode_return_min": 66.85521735402638, "episode_return_mean": 91.25495142077489, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 484.3383077530467, "num_env_steps_trained_throughput_per_sec": 484.3383077530467, "timesteps_total": 144384, "num_env_steps_sampled_lifetime": 144384, "num_agent_steps_sampled_lifetime": 144384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 144384, "timers": {"training_iteration_time_ms": 2430.814, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2430.814, "sample_time_ms": 963.91, "learn_time_ms": 1449.478, "learn_throughput": 706.461, "synch_weights_time_ms": 17.274}, "counters": {"num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "done": false, "training_iteration": 141, "trial_id": "374cd_00000", "date": "2025-04-09_10-55-58", "timestamp": 1744167358, "time_this_iter_s": 2.1200010776519775, "time_total_s": 350.3940680027008, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.3940680027008, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 33.333333333333336, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0530069202184675, "cur_kl_coeff": 7.174648137343063e-44, "cur_lr": 1e-07, "total_loss": 2.1199913054704664, "policy_loss": -0.0003554320748662576, "vf_loss": 9.675160986185073, "vf_explained_var": -0.00012213736772537231, "kl": 2.6649077449203418e-06, "entropy": 2.9844349414110183, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "env_runners": {"episode_reward_max": 118.2730607633277, "episode_reward_min": 66.85521735402638, "episode_reward_mean": 92.2089871843866, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.85521735402638}, "policy_reward_max": {"tplp_policy": 118.2730607633277}, "policy_reward_mean": {"tplp_policy": 92.2089871843866}, "custom_metrics": {"mean_episode_reward_mean": 92.2089871843866, "mean_episode_reward_min": 66.85521735402638, "mean_episode_reward_max": 118.2730607633277}, "hist_stats": {"episode_reward": [78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [78.3863981453641, 93.42711387756418, 91.83882502594224, 86.73589236989088, 79.28106778255231, 102.771710048583, 94.15862815575814, 90.287454460342, 107.99401598777916, 101.94839488797763, 98.46627560188166, 102.45261411813561, 87.61989926315165, 90.87156087097561, 95.90953157335711, 90.1805280229063, 80.79420572986255, 73.80795266311347, 78.94871686047578, 103.95479871381697, 86.74364346509529, 90.50284313475315, 84.30263115325837, 94.86957496723, 79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.71159881834546, "mean_inference_ms": 2.0495366295130646, "mean_action_processing_ms": 0.3898975514675937, "mean_env_wait_ms": 2.2860216045951085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013520002365112305, "StateBufferConnector_ms": 0.008378744125366211, "ViewRequirementAgentConnector_ms": 0.21677303314208984}, "num_episodes": 18, "episode_return_max": 118.2730607633277, "episode_return_min": 66.85521735402638, "episode_return_mean": 92.2089871843866, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 489.924228962328, "num_env_steps_trained_throughput_per_sec": 489.924228962328, "timesteps_total": 145408, "num_env_steps_sampled_lifetime": 145408, "num_agent_steps_sampled_lifetime": 145408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 145408, "timers": {"training_iteration_time_ms": 2399.855, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2399.855, "sample_time_ms": 945.207, "learn_time_ms": 1437.023, "learn_throughput": 712.584, "synch_weights_time_ms": 17.352}, "counters": {"num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "done": false, "training_iteration": 142, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-00", "timestamp": 1744167360, "time_this_iter_s": 2.095651388168335, "time_total_s": 352.48971939086914, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC16C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 352.48971939086914, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 32.666666666666664, "ram_util_percent": 95.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.734966116771102, "cur_kl_coeff": 3.5873240686715314e-44, "cur_lr": 1e-07, "total_loss": 2.110079077631235, "policy_loss": -0.0001914022082928568, "vf_loss": 9.635300904512405, "vf_explained_var": -2.0172446966171265e-05, "kl": 2.06034033246455e-06, "entropy": 2.985547365248203, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "env_runners": {"episode_reward_max": 118.2730607633277, "episode_reward_min": 66.85521735402638, "episode_reward_mean": 91.54447669099625, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.85521735402638}, "policy_reward_max": {"tplp_policy": 118.2730607633277}, "policy_reward_mean": {"tplp_policy": 91.54447669099625}, "custom_metrics": {"mean_episode_reward_mean": 91.54447669099625, "mean_episode_reward_min": 66.85521735402638, "mean_episode_reward_max": 118.2730607633277}, "hist_stats": {"episode_reward": [79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.22115898243723, 66.85521735402638, 92.64446430777966, 75.99701401541287, 91.49779527001611, 102.3860771671053, 97.28355539646002, 88.31625837506346, 70.88208744448605, 91.15312951941124, 95.7200859190694, 100.43051511917963, 83.86716751960849, 68.39860192851188, 84.38606198633371, 93.87459363625864, 91.14299521470784, 91.351532965929, 102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7114832558984082, "mean_inference_ms": 2.0487829180340413, "mean_action_processing_ms": 0.38955731805580557, "mean_env_wait_ms": 2.2854895310686683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417098999023438, "StateBufferConnector_ms": 0.008398294448852539, "ViewRequirementAgentConnector_ms": 0.23511242866516113}, "num_episodes": 24, "episode_return_max": 118.2730607633277, "episode_return_min": 66.85521735402638, "episode_return_mean": 91.54447669099625, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 429.44412269496985, "num_env_steps_trained_throughput_per_sec": 429.44412269496985, "timesteps_total": 146432, "num_env_steps_sampled_lifetime": 146432, "num_agent_steps_sampled_lifetime": 146432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 146432, "timers": {"training_iteration_time_ms": 2415.153, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2415.153, "sample_time_ms": 946.415, "learn_time_ms": 1450.261, "learn_throughput": 706.08, "synch_weights_time_ms": 18.203}, "counters": {"num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "done": false, "training_iteration": 143, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-02", "timestamp": 1744167362, "time_this_iter_s": 2.3909873962402344, "time_total_s": 354.8807067871094, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 354.8807067871094, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 40.824999999999996, "ram_util_percent": 95.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3287291567772628, "cur_kl_coeff": 1.7936620343357657e-44, "cur_lr": 1e-07, "total_loss": 2.156442817300558, "policy_loss": -0.00013065480743534863, "vf_loss": 9.821049338579178, "vf_explained_var": -0.00012064389884471893, "kl": 1.279639888629447e-06, "entropy": 2.9868887439370155, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "env_runners": {"episode_reward_max": 118.2730607633277, "episode_reward_min": 68.08386226332847, "episode_reward_mean": 91.99796646384856, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.08386226332847}, "policy_reward_max": {"tplp_policy": 118.2730607633277}, "policy_reward_mean": {"tplp_policy": 91.99796646384856}, "custom_metrics": {"mean_episode_reward_mean": 91.99796646384856, "mean_episode_reward_min": 68.08386226332847, "mean_episode_reward_max": 118.2730607633277}, "hist_stats": {"episode_reward": [102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.58733201101796, 80.18367996737771, 86.3423436266982, 114.82899365940321, 101.897330659014, 86.33473400327753, 99.57553606982567, 96.83842402877568, 83.53912292512798, 93.3623052411148, 98.85337276835482, 76.54413349805512, 113.3693763322497, 90.8411440781249, 96.15641496149699, 91.746103283607, 118.2730607633277, 70.06231425263161, 79.83110674922327, 77.70833413536461, 91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7113280742176716, "mean_inference_ms": 2.0479057054115644, "mean_action_processing_ms": 0.38943191303953495, "mean_env_wait_ms": 2.2845570015691266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541590690612793, "StateBufferConnector_ms": 0.008524179458618164, "ViewRequirementAgentConnector_ms": 0.22206354141235352}, "num_episodes": 18, "episode_return_max": 118.2730607633277, "episode_return_min": 68.08386226332847, "episode_return_mean": 91.99796646384856, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.9732567863449, "num_env_steps_trained_throughput_per_sec": 467.9732567863449, "timesteps_total": 147456, "num_env_steps_sampled_lifetime": 147456, "num_agent_steps_sampled_lifetime": 147456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 147456, "timers": {"training_iteration_time_ms": 2420.471, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2420.471, "sample_time_ms": 950.439, "learn_time_ms": 1451.567, "learn_throughput": 705.445, "synch_weights_time_ms": 18.193}, "counters": {"num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "done": false, "training_iteration": 144, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-05", "timestamp": 1744167365, "time_this_iter_s": 2.1936988830566406, "time_total_s": 357.074405670166, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.074405670166, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 40.49999999999999, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.998417590558529, "cur_kl_coeff": 8.968310171678829e-45, "cur_lr": 1e-07, "total_loss": 2.1172623202204703, "policy_loss": -0.00017650659137871116, "vf_loss": 9.664862138032912, "vf_explained_var": -0.00013698525726795195, "kl": 1.4442597799479984e-06, "entropy": 2.987766918540001, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "env_runners": {"episode_reward_max": 111.43555978607101, "episode_reward_min": 68.08386226332847, "episode_reward_mean": 90.96976972806026, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.08386226332847}, "policy_reward_max": {"tplp_policy": 111.43555978607101}, "policy_reward_mean": {"tplp_policy": 90.96976972806026}, "custom_metrics": {"mean_episode_reward_mean": 90.96976972806026, "mean_episode_reward_min": 68.08386226332847, "mean_episode_reward_max": 111.43555978607101}, "hist_stats": {"episode_reward": [91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [91.42584996016173, 93.67518448720898, 108.68695399134879, 111.43555978607101, 91.93678754192686, 92.58391124673881, 86.30389613485673, 94.43484083133924, 89.91851063949586, 95.40982864369002, 99.73064954729354, 98.59370712376818, 102.06399994583377, 95.02851888211164, 98.43295893503237, 91.93831325777585, 92.32521375171004, 85.37807552159619, 78.76087721550998, 88.37363638233259, 100.5678951789685, 103.0739768447416, 85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7110207966173551, "mean_inference_ms": 2.046692429882272, "mean_action_processing_ms": 0.38915726324200167, "mean_env_wait_ms": 2.2833580965453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01541590690612793, "StateBufferConnector_ms": 0.005292177200317383, "ViewRequirementAgentConnector_ms": 0.21959400177001953}, "num_episodes": 20, "episode_return_max": 111.43555978607101, "episode_return_min": 68.08386226332847, "episode_return_mean": 90.96976972806026, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 497.528417081885, "num_env_steps_trained_throughput_per_sec": 497.528417081885, "timesteps_total": 148480, "num_env_steps_sampled_lifetime": 148480, "num_agent_steps_sampled_lifetime": 148480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 148480, "timers": {"training_iteration_time_ms": 2336.885, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2336.885, "sample_time_ms": 939.579, "learn_time_ms": 1379.748, "learn_throughput": 742.164, "synch_weights_time_ms": 17.285}, "counters": {"num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "done": false, "training_iteration": 145, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-07", "timestamp": 1744167367, "time_this_iter_s": 2.064094305038452, "time_total_s": 359.13849997520447, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.13849997520447, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 29.833333333333332, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.626475436612964, "cur_kl_coeff": 4.484155085839414e-45, "cur_lr": 1e-07, "total_loss": 2.1100914895534517, "policy_loss": -0.00043647770653478803, "vf_loss": 9.637222021818161, "vf_explained_var": -0.00014855638146400453, "kl": 2.9468850935909784e-06, "entropy": 2.987775245308876, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "env_runners": {"episode_reward_max": 108.48038856850825, "episode_reward_min": 66.84356961209325, "episode_reward_mean": 89.24324654087513, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.84356961209325}, "policy_reward_max": {"tplp_policy": 108.48038856850825}, "policy_reward_mean": {"tplp_policy": 89.24324654087513}, "custom_metrics": {"mean_episode_reward_mean": 89.24324654087513, "mean_episode_reward_min": 66.84356961209325, "mean_episode_reward_max": 108.48038856850825}, "hist_stats": {"episode_reward": [85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.25342252120612, 104.38020374592548, 83.0482464757175, 97.10727611905254, 108.48038856850825, 78.84320339131573, 95.33747647170793, 96.13491065335938, 101.55285442920625, 93.92680301857276, 94.73489104495093, 98.6986396064985, 106.27169093084278, 103.8967645292981, 87.69592834638759, 84.91912072096788, 78.06599365469059, 92.78274269975218, 68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7106741567291277, "mean_inference_ms": 2.0452468112383317, "mean_action_processing_ms": 0.38893658890381666, "mean_env_wait_ms": 2.282038650685476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012407541275024414, "StateBufferConnector_ms": 0.005292177200317383, "ViewRequirementAgentConnector_ms": 0.22426724433898926}, "num_episodes": 22, "episode_return_max": 108.48038856850825, "episode_return_min": 66.84356961209325, "episode_return_mean": 89.24324654087513, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.98678583325943, "num_env_steps_trained_throughput_per_sec": 486.98678583325943, "timesteps_total": 149504, "num_env_steps_sampled_lifetime": 149504, "num_agent_steps_sampled_lifetime": 149504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 149504, "timers": {"training_iteration_time_ms": 2253.367, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2253.367, "sample_time_ms": 912.594, "learn_time_ms": 1323.421, "learn_throughput": 773.753, "synch_weights_time_ms": 17.231}, "counters": {"num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "done": false, "training_iteration": 146, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-09", "timestamp": 1744167369, "time_this_iter_s": 2.1102824211120605, "time_total_s": 361.2487823963165, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.2487823963165, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6518485795706512, "cur_kl_coeff": 2.242077542919707e-45, "cur_lr": 1e-07, "total_loss": 2.1265131905674934, "policy_loss": -0.0002477061003446579, "vf_loss": 9.70224312543869, "vf_explained_var": -0.00015111416578292847, "kl": 2.0324570203733573e-06, "entropy": 2.9879988729953766, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "env_runners": {"episode_reward_max": 108.1251596033803, "episode_reward_min": 66.84356961209325, "episode_reward_mean": 88.8407018162838, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.84356961209325}, "policy_reward_max": {"tplp_policy": 108.1251596033803}, "policy_reward_mean": {"tplp_policy": 88.8407018162838}, "custom_metrics": {"mean_episode_reward_mean": 88.8407018162838, "mean_episode_reward_min": 66.84356961209325, "mean_episode_reward_max": 108.1251596033803}, "hist_stats": {"episode_reward": [68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [68.08386226332847, 85.86245940815081, 95.1193541528901, 85.69407980497773, 89.0263675450525, 73.76043301459629, 85.48932778238752, 99.05846281813048, 95.77314707678725, 83.651850998003, 102.8481783564821, 82.98164662686189, 94.23459302267091, 82.13891907937672, 72.61506772388026, 95.47193929501412, 80.65470531650308, 91.51234397835624, 99.58498469765983, 99.89502343749466, 79.30284190655922, 106.19490288112053, 94.54437869793946, 95.98267651652012, 94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7104656182524728, "mean_inference_ms": 2.0442040099882752, "mean_action_processing_ms": 0.3888146886312608, "mean_env_wait_ms": 2.2812520729000174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009400367736816406, "StateBufferConnector_ms": 0.003117799758911133, "ViewRequirementAgentConnector_ms": 0.22180485725402832}, "num_episodes": 18, "episode_return_max": 108.1251596033803, "episode_return_min": 66.84356961209325, "episode_return_mean": 88.8407018162838, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 438.3726357041563, "num_env_steps_trained_throughput_per_sec": 438.3726357041563, "timesteps_total": 150528, "num_env_steps_sampled_lifetime": 150528, "num_agent_steps_sampled_lifetime": 150528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 2261.19, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2261.19, "sample_time_ms": 907.875, "learn_time_ms": 1335.889, "learn_throughput": 766.531, "synch_weights_time_ms": 17.305}, "counters": {"num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "done": false, "training_iteration": 147, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-11", "timestamp": 1744167371, "time_this_iter_s": 2.341895818710327, "time_total_s": 363.59067821502686, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C81BC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.59067821502686, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 45.699999999999996, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9941289447247983, "cur_kl_coeff": 1.1210387714598536e-45, "cur_lr": 1e-07, "total_loss": 2.1082062400877475, "policy_loss": -0.000267845974303782, "vf_loss": 9.629429531097411, "vf_explained_var": -0.00013703517615795135, "kl": 2.1189345791011725e-06, "entropy": 2.988833001255989, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "env_runners": {"episode_reward_max": 110.59465843865654, "episode_reward_min": 66.84356961209325, "episode_reward_mean": 89.14902030080344, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.84356961209325}, "policy_reward_max": {"tplp_policy": 110.59465843865654}, "policy_reward_mean": {"tplp_policy": 89.14902030080344}, "custom_metrics": {"mean_episode_reward_mean": 89.14902030080344, "mean_episode_reward_min": 66.84356961209325, "mean_episode_reward_max": 110.59465843865654}, "hist_stats": {"episode_reward": [94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [94.58093468395145, 99.42575414767462, 84.03490725364489, 96.71997439755376, 100.93734923866162, 69.50001916367302, 93.56114881374245, 78.79921961344999, 91.01595543344472, 86.05454364153003, 82.62198871750361, 76.01871327266895, 102.47011683461436, 77.64865216385026, 90.03723490356512, 96.80372191304166, 71.16162783694796, 84.31137867470397, 104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7100724400650751, "mean_inference_ms": 2.042928877302962, "mean_action_processing_ms": 0.38856854371175475, "mean_env_wait_ms": 2.280156930961267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004387617111206055, "StateBufferConnector_ms": 0.003117799758911133, "ViewRequirementAgentConnector_ms": 0.21322917938232422}, "num_episodes": 24, "episode_return_max": 110.59465843865654, "episode_return_min": 66.84356961209325, "episode_return_mean": 89.14902030080344, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 462.0010937515463, "num_env_steps_trained_throughput_per_sec": 462.0010937515463, "timesteps_total": 151552, "num_env_steps_sampled_lifetime": 151552, "num_agent_steps_sampled_lifetime": 151552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 151552, "timers": {"training_iteration_time_ms": 2254.582, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2254.582, "sample_time_ms": 915.643, "learn_time_ms": 1321.599, "learn_throughput": 774.819, "synch_weights_time_ms": 17.219}, "counters": {"num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "done": false, "training_iteration": 148, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-14", "timestamp": 1744167374, "time_this_iter_s": 2.222160577774048, "time_total_s": 365.8128387928009, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 365.8128387928009, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 46.23333333333334, "ram_util_percent": 95.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5747503474354745, "cur_kl_coeff": 5.605193857299268e-46, "cur_lr": 1e-07, "total_loss": 2.134114871174097, "policy_loss": -0.000183824694249779, "vf_loss": 9.733240449428559, "vf_explained_var": -0.00019088350236415864, "kl": 1.931561889900735e-06, "entropy": 2.990113990008831, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "env_runners": {"episode_reward_max": 122.68302322980256, "episode_reward_min": 66.84356961209325, "episode_reward_mean": 89.23244628920038, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.84356961209325}, "policy_reward_max": {"tplp_policy": 122.68302322980256}, "policy_reward_mean": {"tplp_policy": 89.23244628920038}, "custom_metrics": {"mean_episode_reward_mean": 89.23244628920038, "mean_episode_reward_min": 66.84356961209325, "mean_episode_reward_max": 122.68302322980256}, "hist_stats": {"episode_reward": [104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [104.7626172337313, 80.13766335022812, 96.42566475994745, 78.7714474917738, 98.12979051227954, 93.64235999600874, 94.12969179163828, 71.17796698124867, 73.87495028915582, 83.98828745318366, 79.9493389875637, 92.45098825797119, 107.34930558512188, 80.84338797941558, 89.1379938201063, 92.75827657580389, 101.80856196294157, 81.24418989546724, 92.85762940482105, 75.61429123693851, 86.49248333049228, 106.52387733114696, 90.42787174377673, 100.204570048528, 80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7096916437466345, "mean_inference_ms": 2.041835533649338, "mean_action_processing_ms": 0.38836057332671814, "mean_env_wait_ms": 2.2791663043128456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005392789840698242, "StateBufferConnector_ms": 0.001994609832763672, "ViewRequirementAgentConnector_ms": 0.20234036445617676}, "num_episodes": 18, "episode_return_max": 122.68302322980256, "episode_return_min": 66.84356961209325, "episode_return_mean": 89.23244628920038, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 504.6789554675889, "num_env_steps_trained_throughput_per_sec": 504.6789554675889, "timesteps_total": 152576, "num_env_steps_sampled_lifetime": 152576, "num_agent_steps_sampled_lifetime": 152576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 152576, "timers": {"training_iteration_time_ms": 2181.002, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2181.002, "sample_time_ms": 898.085, "learn_time_ms": 1265.995, "learn_throughput": 808.85, "synch_weights_time_ms": 16.701}, "counters": {"num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "done": false, "training_iteration": 149, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-16", "timestamp": 1744167376, "time_this_iter_s": 2.0345048904418945, "time_total_s": 367.8473436832428, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC13A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 367.8473436832428, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 33.4, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9701076220721006, "cur_kl_coeff": 2.802596928649634e-46, "cur_lr": 1e-07, "total_loss": 2.131191640347242, "policy_loss": -0.000292365625500679, "vf_loss": 9.722519040107727, "vf_explained_var": -0.00013969652354717255, "kl": 2.0207805665251043e-06, "entropy": 2.991457575559616, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "env_runners": {"episode_reward_max": 122.68302322980256, "episode_reward_min": 66.52020381048811, "episode_reward_mean": 89.54845016600193, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.52020381048811}, "policy_reward_max": {"tplp_policy": 122.68302322980256}, "policy_reward_mean": {"tplp_policy": 89.54845016600193}, "custom_metrics": {"mean_episode_reward_mean": 89.54845016600193, "mean_episode_reward_min": 66.52020381048811, "mean_episode_reward_max": 122.68302322980256}, "hist_stats": {"episode_reward": [80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.1900396876178, 77.99145312044398, 80.91579533638723, 66.84356961209325, 95.18871512356127, 83.13971272641268, 81.92562771421507, 76.79607926481562, 86.021893559996, 87.16220264855117, 89.89151643436472, 87.48283733096167, 104.35897027286953, 74.0342970900216, 101.99959832768418, 91.36379578530119, 96.26173544969885, 96.71480258481523, 103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7092093307547898, "mean_inference_ms": 2.040597185362583, "mean_action_processing_ms": 0.38802107130215574, "mean_env_wait_ms": 2.2781859952164485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074002742767333984, "StateBufferConnector_ms": 0.0003159046173095703, "ViewRequirementAgentConnector_ms": 0.2029726505279541}, "num_episodes": 24, "episode_return_max": 122.68302322980256, "episode_return_min": 66.52020381048811, "episode_return_mean": 89.54845016600193, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 474.7862584424438, "num_env_steps_trained_throughput_per_sec": 474.7862584424438, "timesteps_total": 153600, "num_env_steps_sampled_lifetime": 153600, "num_agent_steps_sampled_lifetime": 153600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 2167.601, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2167.601, "sample_time_ms": 889.836, "learn_time_ms": 1260.864, "learn_throughput": 812.141, "synch_weights_time_ms": 16.679}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "training_iteration": 150, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-18", "timestamp": 1744167378, "time_this_iter_s": 2.164177656173706, "time_total_s": 370.0115213394165, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 370.0115213394165, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 35.833333333333336, "ram_util_percent": 95.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6864201836287975, "cur_kl_coeff": 1.401298464324817e-46, "cur_lr": 1e-07, "total_loss": 2.1654317677021027, "policy_loss": -0.00014713671989738942, "vf_loss": 9.858981049060821, "vf_explained_var": -0.00020386464893817902, "kl": 1.1483181216853656e-06, "entropy": 2.9916633769869803, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "env_runners": {"episode_reward_max": 122.68302322980256, "episode_reward_min": 66.52020381048811, "episode_reward_mean": 90.4794425302454, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.52020381048811}, "policy_reward_max": {"tplp_policy": 122.68302322980256}, "policy_reward_mean": {"tplp_policy": 90.4794425302454}, "custom_metrics": {"mean_episode_reward_mean": 90.4794425302454, "mean_episode_reward_min": 66.52020381048811, "mean_episode_reward_max": 122.68302322980256}, "hist_stats": {"episode_reward": [103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.1648857493715, 91.5511145136645, 95.97080759359478, 91.92660902488784, 93.40007388964848, 80.69066529139157, 92.63950707588918, 98.15666131994507, 90.43582411438314, 91.39821125663329, 81.47106708965356, 108.1251596033803, 74.48259890234077, 89.9986000736203, 93.66255743781532, 80.82520349809457, 89.92220395813969, 84.77798736767323, 102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7089607934420841, "mean_inference_ms": 2.039977622715255, "mean_action_processing_ms": 0.38795365241831353, "mean_env_wait_ms": 2.277583209934857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007399559020996094, "StateBufferConnector_ms": 0.0023102760314941406, "ViewRequirementAgentConnector_ms": 0.1963193416595459}, "num_episodes": 18, "episode_return_max": 122.68302322980256, "episode_return_min": 66.52020381048811, "episode_return_mean": 90.4794425302454, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 406.1782399344814, "num_env_steps_trained_throughput_per_sec": 406.1782399344814, "timesteps_total": 154624, "num_env_steps_sampled_lifetime": 154624, "num_agent_steps_sampled_lifetime": 154624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 154624, "timers": {"training_iteration_time_ms": 2208.285, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2208.285, "sample_time_ms": 903.465, "learn_time_ms": 1287.604, "learn_throughput": 795.276, "synch_weights_time_ms": 16.995}, "counters": {"num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "done": false, "training_iteration": 151, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-21", "timestamp": 1744167381, "time_this_iter_s": 2.5279884338378906, "time_total_s": 372.5395097732544, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC3BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.5395097732544, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 43.4, "ram_util_percent": 94.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8749974343925713, "cur_kl_coeff": 7.006492321624085e-47, "cur_lr": 1e-07, "total_loss": 2.136399672925472, "policy_loss": -0.00033287755941273643, "vf_loss": 9.743647086620332, "vf_explained_var": -0.00010888427495956421, "kl": 2.084053345097203e-06, "entropy": 2.991792096197605, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "env_runners": {"episode_reward_max": 127.25471451517332, "episode_reward_min": 66.52020381048811, "episode_reward_mean": 91.3503192276167, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.52020381048811}, "policy_reward_max": {"tplp_policy": 127.25471451517332}, "policy_reward_mean": {"tplp_policy": 91.3503192276167}, "custom_metrics": {"mean_episode_reward_mean": 91.3503192276167, "mean_episode_reward_min": 66.52020381048811, "mean_episode_reward_max": 127.25471451517332}, "hist_stats": {"episode_reward": [102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.22592971456882, 80.56850478416193, 94.23184682271665, 86.14154645520836, 81.11879755592868, 103.92940901440512, 75.949335900875, 85.21000872183912, 110.59465843865654, 86.67812390386456, 80.89181984271282, 72.5147971345865, 95.95652257173822, 78.60443026932371, 95.6553990278322, 79.3420657732161, 110.34250952133281, 83.32900874534769, 103.1618378243193, 94.31115873018805, 96.93307383306005, 97.92241894100697, 80.19135071431468, 88.52065096451533, 77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7087478471996295, "mean_inference_ms": 2.039641620942421, "mean_action_processing_ms": 0.38777492174086653, "mean_env_wait_ms": 2.2771604689452603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010400056838989258, "StateBufferConnector_ms": 0.004314422607421875, "ViewRequirementAgentConnector_ms": 0.18547511100769043}, "num_episodes": 18, "episode_return_max": 127.25471451517332, "episode_return_min": 66.52020381048811, "episode_return_mean": 91.3503192276167, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 430.2803992912291, "num_env_steps_trained_throughput_per_sec": 430.2803992912291, "timesteps_total": 155648, "num_env_steps_sampled_lifetime": 155648, "num_agent_steps_sampled_lifetime": 155648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 155648, "timers": {"training_iteration_time_ms": 2237.257, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2237.257, "sample_time_ms": 916.428, "learn_time_ms": 1303.608, "learn_throughput": 785.512, "synch_weights_time_ms": 17.122}, "counters": {"num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "done": false, "training_iteration": 152, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-23", "timestamp": 1744167383, "time_this_iter_s": 2.3865444660186768, "time_total_s": 374.92605423927307, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 374.92605423927307, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 47.666666666666664, "ram_util_percent": 94.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8681347720324992, "cur_kl_coeff": 3.5032461608120424e-47, "cur_lr": 1e-07, "total_loss": 2.117935386300087, "policy_loss": -0.00019818551372736694, "vf_loss": 9.669361048936844, "vf_explained_var": -0.00013710670173168183, "kl": 1.6707231588863892e-06, "entropy": 2.9920668691396712, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "env_runners": {"episode_reward_max": 127.25471451517332, "episode_reward_min": 66.52020381048811, "episode_reward_mean": 92.32910847078378, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.52020381048811}, "policy_reward_max": {"tplp_policy": 127.25471451517332}, "policy_reward_mean": {"tplp_policy": 92.32910847078378}, "custom_metrics": {"mean_episode_reward_mean": 92.32910847078378, "mean_episode_reward_min": 66.52020381048811, "mean_episode_reward_max": 127.25471451517332}, "hist_stats": {"episode_reward": [77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.22472146979547, 77.44132841597335, 80.53177628888581, 83.75550638826601, 84.4180538395703, 100.63505415930219, 122.68302322980256, 88.67482887244593, 95.85258348644075, 78.5731382594067, 85.33650694524204, 100.21734161265634, 73.65719050717571, 79.0483674627925, 95.68830217511767, 91.59611475221675, 102.09638352136898, 97.76180830089723, 84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7083317211962529, "mean_inference_ms": 2.0388342666184376, "mean_action_processing_ms": 0.3875902727422488, "mean_env_wait_ms": 2.276488177092593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010270118713378906, "StateBufferConnector_ms": 0.005319833755493164, "ViewRequirementAgentConnector_ms": 0.1880490779876709}, "num_episodes": 24, "episode_return_max": 127.25471451517332, "episode_return_min": 66.52020381048811, "episode_return_mean": 92.32910847078378, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.1214147163139, "num_env_steps_trained_throughput_per_sec": 477.1214147163139, "timesteps_total": 156672, "num_env_steps_sampled_lifetime": 156672, "num_agent_steps_sampled_lifetime": 156672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 156672, "timers": {"training_iteration_time_ms": 2213.43, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.43, "sample_time_ms": 905.78, "learn_time_ms": 1291.43, "learn_throughput": 792.919, "synch_weights_time_ms": 16.12}, "counters": {"num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "done": false, "training_iteration": 153, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-25", "timestamp": 1744167385, "time_this_iter_s": 2.1513707637786865, "time_total_s": 377.07742500305176, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BA6B70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.07742500305176, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 38.96666666666667, "ram_util_percent": 94.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9369643703103065, "cur_kl_coeff": 1.7516230804060212e-47, "cur_lr": 1e-07, "total_loss": 2.133640433847904, "policy_loss": -0.00024672196013852954, "vf_loss": 9.732699346542358, "vf_explained_var": -0.00013363584876060485, "kl": 1.966605453063153e-06, "entropy": 2.9928766950964927, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "env_runners": {"episode_reward_max": 127.25471451517332, "episode_reward_min": 66.52020381048811, "episode_reward_mean": 92.6047250833092, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 66.52020381048811}, "policy_reward_max": {"tplp_policy": 127.25471451517332}, "policy_reward_mean": {"tplp_policy": 92.6047250833092}, "custom_metrics": {"mean_episode_reward_mean": 92.6047250833092, "mean_episode_reward_min": 66.52020381048811, "mean_episode_reward_max": 127.25471451517332}, "hist_stats": {"episode_reward": [84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.56784564842116, 104.58943878785787, 99.81180017257637, 94.07689083464568, 92.71852312285134, 92.35591635712075, 91.46826602008215, 92.12575946751075, 66.52020381048811, 104.25967727559528, 76.1559307462793, 86.31466164651432, 88.99117768153447, 94.82276895184182, 84.48181809820075, 90.72239928041877, 91.37084221004541, 88.6359880713204, 96.89675205839924, 93.69388824732481, 72.37512166145237, 97.48973172669969, 81.23762478580588, 90.89171844365106, 98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7080215338297273, "mean_inference_ms": 2.0381732792943983, "mean_action_processing_ms": 0.3874555828988111, "mean_env_wait_ms": 2.2758764885109084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010419368743896484, "StateBufferConnector_ms": 0.005319833755493164, "ViewRequirementAgentConnector_ms": 0.18509721755981445}, "num_episodes": 18, "episode_return_max": 127.25471451517332, "episode_return_min": 66.52020381048811, "episode_return_mean": 92.6047250833092, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 463.2373142385351, "num_env_steps_trained_throughput_per_sec": 463.2373142385351, "timesteps_total": 157696, "num_env_steps_sampled_lifetime": 157696, "num_agent_steps_sampled_lifetime": 157696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 157696, "timers": {"training_iteration_time_ms": 2215.667, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2215.667, "sample_time_ms": 897.922, "learn_time_ms": 1301.517, "learn_throughput": 786.774, "synch_weights_time_ms": 16.128}, "counters": {"num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "done": false, "training_iteration": 154, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-27", "timestamp": 1744167387, "time_this_iter_s": 2.2165346145629883, "time_total_s": 379.29395961761475, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D191C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.29395961761475, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 30.275000000000002, "ram_util_percent": 94.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.02885625436902, "cur_kl_coeff": 8.758115402030106e-48, "cur_lr": 1e-07, "total_loss": 2.098433530330658, "policy_loss": -0.00034706699079833925, "vf_loss": 9.59271052479744, "vf_explained_var": -8.100457489490509e-05, "kl": 2.795134325728199e-06, "entropy": 2.993970292806625, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "env_runners": {"episode_reward_max": 127.25471451517332, "episode_reward_min": 60.884472051574946, "episode_reward_mean": 92.59523873538629, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.884472051574946}, "policy_reward_max": {"tplp_policy": 127.25471451517332}, "policy_reward_mean": {"tplp_policy": 92.59523873538629}, "custom_metrics": {"mean_episode_reward_mean": 92.59523873538629, "mean_episode_reward_min": 60.884472051574946, "mean_episode_reward_max": 127.25471451517332}, "hist_stats": {"episode_reward": [98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.68356034765061, 86.3604477123294, 84.80022632320109, 89.99785854710565, 102.75937778903977, 104.13013180750688, 96.19898170216987, 93.61853931604668, 94.66172798099258, 98.70649911917, 89.0192457226879, 75.51879631245552, 88.91502886675283, 96.5234397523258, 84.89167143980599, 94.46700252545833, 92.08640869641032, 85.26300551785275, 101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7077483608252284, "mean_inference_ms": 2.037632230619039, "mean_action_processing_ms": 0.38734951852310173, "mean_env_wait_ms": 2.275412704111635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009409904479980469, "StateBufferConnector_ms": 0.005003929138183594, "ViewRequirementAgentConnector_ms": 0.20103788375854492}, "num_episodes": 24, "episode_return_max": 127.25471451517332, "episode_return_min": 60.884472051574946, "episode_return_mean": 92.59523873538629, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.33205593389476, "num_env_steps_trained_throughput_per_sec": 448.33205593389476, "timesteps_total": 158720, "num_env_steps_sampled_lifetime": 158720, "num_agent_steps_sampled_lifetime": 158720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 158720, "timers": {"training_iteration_time_ms": 2238.252, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2238.252, "sample_time_ms": 910.269, "learn_time_ms": 1311.579, "learn_throughput": 780.738, "synch_weights_time_ms": 16.304}, "counters": {"num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "done": false, "training_iteration": 155, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-30", "timestamp": 1744167390, "time_this_iter_s": 2.2899973392486572, "time_total_s": 381.5839569568634, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.5839569568634, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 48.79999999999999, "ram_util_percent": 94.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6217789947986603, "cur_kl_coeff": 4.379057701015053e-48, "cur_lr": 1e-07, "total_loss": 2.112477322667837, "policy_loss": -0.00013243486610008403, "vf_loss": 9.648476606607437, "vf_explained_var": -0.00017578229308128356, "kl": 1.3194207870617647e-06, "entropy": 2.995093767344952, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "env_runners": {"episode_reward_max": 127.25471451517332, "episode_reward_min": 60.884472051574946, "episode_reward_mean": 93.10748283710416, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.884472051574946}, "policy_reward_max": {"tplp_policy": 127.25471451517332}, "policy_reward_mean": {"tplp_policy": 93.10748283710416}, "custom_metrics": {"mean_episode_reward_mean": 93.10748283710416, "mean_episode_reward_min": 60.884472051574946, "mean_episode_reward_max": 127.25471451517332}, "hist_stats": {"episode_reward": [101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.33615142599567, 95.44418269575813, 98.11489419312097, 94.40201535917646, 93.455911051467, 78.70793372006777, 85.39868425385077, 122.86321481658334, 91.94907222300697, 127.25471451517332, 95.4054838586714, 96.05261045914038, 103.38440029569594, 84.38099022483816, 81.02328586342672, 93.16444832702336, 82.1521209295886, 100.0401606284135, 87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7075367308300199, "mean_inference_ms": 2.0370598072795945, "mean_action_processing_ms": 0.3872157418842698, "mean_env_wait_ms": 2.2747366577024066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009411334991455078, "StateBufferConnector_ms": 0.007039070129394531, "ViewRequirementAgentConnector_ms": 0.211045503616333}, "num_episodes": 18, "episode_return_max": 127.25471451517332, "episode_return_min": 60.884472051574946, "episode_return_mean": 93.10748283710416, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 421.755491897323, "num_env_steps_trained_throughput_per_sec": 421.755491897323, "timesteps_total": 159744, "num_env_steps_sampled_lifetime": 159744, "num_agent_steps_sampled_lifetime": 159744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 159744, "timers": {"training_iteration_time_ms": 2270.774, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2270.774, "sample_time_ms": 919.713, "learn_time_ms": 1334.834, "learn_throughput": 767.137, "synch_weights_time_ms": 16.127}, "counters": {"num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "done": false, "training_iteration": 156, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-32", "timestamp": 1744167392, "time_this_iter_s": 2.434079170227051, "time_total_s": 384.01803612709045, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 384.01803612709045, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 39.166666666666664, "ram_util_percent": 94.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.04297659099102, "cur_kl_coeff": 2.1895288505075265e-48, "cur_lr": 1e-07, "total_loss": 2.092179100960493, "policy_loss": -0.00023140319681260734, "vf_loss": 9.567991203069687, "vf_explained_var": -9.370185434818268e-05, "kl": 1.7455207260264061e-06, "entropy": 2.995873104035854, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "env_runners": {"episode_reward_max": 113.96463891449244, "episode_reward_min": 60.884472051574946, "episode_reward_mean": 91.94990415512021, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.884472051574946}, "policy_reward_max": {"tplp_policy": 113.96463891449244}, "policy_reward_mean": {"tplp_policy": 91.94990415512021}, "custom_metrics": {"mean_episode_reward_mean": 91.94990415512021, "mean_episode_reward_min": 60.884472051574946, "mean_episode_reward_max": 113.96463891449244}, "hist_stats": {"episode_reward": [87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.6900062265806, 104.20518732995808, 96.61784753729872, 101.24422221993667, 81.65344961486373, 94.18533728912422, 95.78147391989748, 90.2693326538763, 92.08389354695778, 76.5622906158399, 103.67471706870667, 100.24154071241223, 90.26521565964687, 88.67389879097534, 109.29949616762468, 100.1995860819015, 108.90295140438391, 87.67854505363454, 103.50166578826503, 81.21219084507239, 94.81600583532294, 91.25299360214639, 86.68897226801177, 99.30490575041689, 90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.707214789493047, "mean_inference_ms": 2.0361015117022534, "mean_action_processing_ms": 0.38712147570517763, "mean_env_wait_ms": 2.2737123007839646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006410837173461914, "StateBufferConnector_ms": 0.005030393600463867, "ViewRequirementAgentConnector_ms": 0.21001291275024414}, "num_episodes": 18, "episode_return_max": 113.96463891449244, "episode_return_min": 60.884472051574946, "episode_return_mean": 91.94990415512021, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.6071533615931, "num_env_steps_trained_throughput_per_sec": 481.6071533615931, "timesteps_total": 160768, "num_env_steps_sampled_lifetime": 160768, "num_agent_steps_sampled_lifetime": 160768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 160768, "timers": {"training_iteration_time_ms": 2249.804, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2249.804, "sample_time_ms": 912.099, "learn_time_ms": 1321.52, "learn_throughput": 774.865, "synch_weights_time_ms": 16.085}, "counters": {"num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "done": false, "training_iteration": 157, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-34", "timestamp": 1744167394, "time_this_iter_s": 2.131730318069458, "time_total_s": 386.1497664451599, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D191C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.1497664451599, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 34.86666666666667, "ram_util_percent": 94.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.124215652048588, "cur_kl_coeff": 1.0947644252537632e-48, "cur_lr": 1e-07, "total_loss": 2.137876735627651, "policy_loss": -0.00025367006892338393, "vf_loss": 9.751514756679535, "vf_explained_var": -0.0001371290534734726, "kl": 3.16288364086148e-06, "entropy": 2.997482842206955, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "env_runners": {"episode_reward_max": 113.96463891449244, "episode_reward_min": 60.884472051574946, "episode_reward_mean": 91.8446126960722, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.884472051574946}, "policy_reward_max": {"tplp_policy": 113.96463891449244}, "policy_reward_mean": {"tplp_policy": 91.8446126960722}, "custom_metrics": {"mean_episode_reward_mean": 91.8446126960722, "mean_episode_reward_min": 60.884472051574946, "mean_episode_reward_max": 113.96463891449244}, "hist_stats": {"episode_reward": [90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.88684469269622, 90.96029999375064, 102.0928686017932, 87.24072334657208, 76.7160248869615, 102.58698789608565, 94.79734235619195, 92.59365643987786, 93.99174032645621, 89.01006455002948, 81.76548582969774, 83.19749341583952, 92.9052207972586, 86.82443973196474, 86.84722646746279, 104.34339358883226, 82.11482053419667, 103.45319731791695, 92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7068855696144685, "mean_inference_ms": 2.0348992590285464, "mean_action_processing_ms": 0.38705545154775933, "mean_env_wait_ms": 2.272211645073411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00522160530090332, "StateBufferConnector_ms": 0.007029533386230469, "ViewRequirementAgentConnector_ms": 0.2126750946044922}, "num_episodes": 24, "episode_return_max": 113.96463891449244, "episode_return_min": 60.884472051574946, "episode_return_mean": 91.8446126960722, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 459.38117472629176, "num_env_steps_trained_throughput_per_sec": 459.38117472629176, "timesteps_total": 161792, "num_env_steps_sampled_lifetime": 161792, "num_agent_steps_sampled_lifetime": 161792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 161792, "timers": {"training_iteration_time_ms": 2251.068, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2251.068, "sample_time_ms": 904.194, "learn_time_ms": 1330.691, "learn_throughput": 769.525, "synch_weights_time_ms": 16.083}, "counters": {"num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "done": false, "training_iteration": 158, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-37", "timestamp": 1744167397, "time_this_iter_s": 2.2363321781158447, "time_total_s": 388.38609862327576, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 388.38609862327576, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 35.275000000000006, "ram_util_percent": 94.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.276759579777718, "cur_kl_coeff": 5.473822126268816e-49, "cur_lr": 1e-07, "total_loss": 2.1239302180707456, "policy_loss": -0.00032260263687931, "vf_loss": 9.697161883115768, "vf_explained_var": -0.00013222843408584596, "kl": 4.247165921711371e-06, "entropy": 3.0003764748573305, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "env_runners": {"episode_reward_max": 113.96463891449244, "episode_reward_min": 60.884472051574946, "episode_reward_mean": 91.64082380013426, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.884472051574946}, "policy_reward_max": {"tplp_policy": 113.96463891449244}, "policy_reward_mean": {"tplp_policy": 91.64082380013426}, "custom_metrics": {"mean_episode_reward_mean": 91.64082380013426, "mean_episode_reward_min": 60.884472051574946, "mean_episode_reward_max": 113.96463891449244}, "hist_stats": {"episode_reward": [92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [92.61215092792385, 74.33193666456523, 89.19621171643901, 95.63383922491523, 92.62953676876265, 97.79972028342733, 98.4520780752803, 110.14576472874498, 87.88479570799808, 102.64972741490867, 77.7306431331208, 98.10353599003899, 89.01091880239623, 85.27061870697871, 98.15130293217636, 98.11529220531884, 60.884472051574946, 70.93725100260805, 92.89651104804258, 91.39607460102546, 81.15322641857672, 85.07248405740795, 87.43246731098097, 83.16839876199563, 97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.706729946470929, "mean_inference_ms": 2.0344143691695873, "mean_action_processing_ms": 0.38710518595016724, "mean_env_wait_ms": 2.2714256682116245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00897526741027832, "StateBufferConnector_ms": 0.008021831512451172, "ViewRequirementAgentConnector_ms": 0.22121453285217285}, "num_episodes": 18, "episode_return_max": 113.96463891449244, "episode_return_min": 60.884472051574946, "episode_return_mean": 91.64082380013426, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 442.5311300095266, "num_env_steps_trained_throughput_per_sec": 442.5311300095266, "timesteps_total": 162816, "num_env_steps_sampled_lifetime": 162816, "num_agent_steps_sampled_lifetime": 162816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 162816, "timers": {"training_iteration_time_ms": 2279.563, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2279.563, "sample_time_ms": 917.907, "learn_time_ms": 1345.337, "learn_throughput": 761.147, "synch_weights_time_ms": 16.318}, "counters": {"num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "done": false, "training_iteration": 159, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-39", "timestamp": 1744167399, "time_this_iter_s": 2.319676399230957, "time_total_s": 390.7057750225067, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.7057750225067, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 47.46666666666667, "ram_util_percent": 94.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.183745715767145, "cur_kl_coeff": 2.736911063134408e-49, "cur_lr": 1e-07, "total_loss": 2.1078738406300546, "policy_loss": -0.00027577003929764033, "vf_loss": 9.633301323652267, "vf_explained_var": -8.12828540802002e-05, "kl": 2.477180343918306e-06, "entropy": 3.0017571479082106, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "env_runners": {"episode_reward_max": 113.96463891449244, "episode_reward_min": 60.996068450100076, "episode_reward_mean": 92.05816531985816, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 60.996068450100076}, "policy_reward_max": {"tplp_policy": 113.96463891449244}, "policy_reward_mean": {"tplp_policy": 92.05816531985816}, "custom_metrics": {"mean_episode_reward_mean": 92.05816531985816, "mean_episode_reward_min": 60.996068450100076, "mean_episode_reward_max": 113.96463891449244}, "hist_stats": {"episode_reward": [97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.02946306956424, 86.14121463082726, 108.37415910880163, 91.07373862503657, 103.04531906362723, 94.19111344772958, 85.40923194395177, 100.30795043186507, 88.37167795557258, 90.91903000591323, 91.73644229559412, 104.18330267541369, 113.96463891449244, 97.28802646336555, 84.88640857148063, 100.30377637453333, 83.62323617277087, 74.22305702095515, 73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7064373846600683, "mean_inference_ms": 2.0333107151613636, "mean_action_processing_ms": 0.38706382328075667, "mean_env_wait_ms": 2.269848343814287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011975288391113281, "StateBufferConnector_ms": 0.010027408599853516, "ViewRequirementAgentConnector_ms": 0.2086772918701172}, "num_episodes": 24, "episode_return_max": 113.96463891449244, "episode_return_min": 60.996068450100076, "episode_return_mean": 92.05816531985816, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 494.4218312557098, "num_env_steps_trained_throughput_per_sec": 494.4218312557098, "timesteps_total": 163840, "num_env_steps_sampled_lifetime": 163840, "num_agent_steps_sampled_lifetime": 163840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 2270.997, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2270.997, "sample_time_ms": 914.144, "learn_time_ms": 1340.562, "learn_throughput": 763.859, "synch_weights_time_ms": 16.192}, "counters": {"num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "training_iteration": 160, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-41", "timestamp": 1744167401, "time_this_iter_s": 2.076479196548462, "time_total_s": 392.7822542190552, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC31A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 392.7822542190552, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 33.06666666666667, "ram_util_percent": 94.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.931001676246524, "cur_kl_coeff": 1.368455531567204e-49, "cur_lr": 1e-07, "total_loss": 2.1286805920302867, "policy_loss": -0.00026687614736147224, "vf_loss": 9.716306775808334, "vf_explained_var": -0.0001031588762998581, "kl": 1.7431055950645201e-06, "entropy": 3.0012922272086144, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "env_runners": {"episode_reward_max": 112.99764589167155, "episode_reward_min": 59.47018322029551, "episode_reward_mean": 91.88173481204157, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.47018322029551}, "policy_reward_max": {"tplp_policy": 112.99764589167155}, "policy_reward_mean": {"tplp_policy": 91.88173481204157}, "custom_metrics": {"mean_episode_reward_mean": 91.88173481204157, "mean_episode_reward_min": 59.47018322029551, "mean_episode_reward_max": 112.99764589167155}, "hist_stats": {"episode_reward": [73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [73.80641780339673, 79.84078606360968, 96.26759568666485, 79.33474476204317, 104.56794033908096, 82.133208288279, 101.7670890058861, 99.57043375553125, 94.7634457047415, 100.03627883040186, 87.41747625324945, 84.24351637234898, 84.34448378269593, 91.63445829781308, 94.13851232434052, 97.0597261787964, 99.459623834653, 95.35322970786935, 94.59391243652526, 90.25784329323277, 110.12378379055514, 75.35395353607274, 79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7062215265591633, "mean_inference_ms": 2.0325364215337434, "mean_action_processing_ms": 0.3870767580082601, "mean_env_wait_ms": 2.2688021145688997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012987375259399414, "StateBufferConnector_ms": 0.009006738662719727, "ViewRequirementAgentConnector_ms": 0.1971912384033203}, "num_episodes": 18, "episode_return_max": 112.99764589167155, "episode_return_min": 59.47018322029551, "episode_return_mean": 91.88173481204157, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 436.82059473754816, "num_env_steps_trained_throughput_per_sec": 436.82059473754816, "timesteps_total": 164864, "num_env_steps_sampled_lifetime": 164864, "num_agent_steps_sampled_lifetime": 164864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 164864, "timers": {"training_iteration_time_ms": 2253.313, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2253.313, "sample_time_ms": 905.825, "learn_time_ms": 1330.633, "learn_throughput": 769.559, "synch_weights_time_ms": 16.755}, "counters": {"num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "done": false, "training_iteration": 161, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-44", "timestamp": 1744167404, "time_this_iter_s": 2.350717544555664, "time_total_s": 395.13297176361084, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.13297176361084, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 41.16666666666667, "ram_util_percent": 94.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9947674751281737, "cur_kl_coeff": 6.84227765783602e-50, "cur_lr": 1e-07, "total_loss": 2.1321220181882383, "policy_loss": -0.0002514506806619465, "vf_loss": 9.729962247610093, "vf_explained_var": -3.581903874874115e-05, "kl": 1.9271435006434913e-06, "entropy": 3.0011708438396454, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "env_runners": {"episode_reward_max": 112.99764589167155, "episode_reward_min": 59.47018322029551, "episode_reward_mean": 92.3316823974951, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.47018322029551}, "policy_reward_max": {"tplp_policy": 112.99764589167155}, "policy_reward_mean": {"tplp_policy": 92.3316823974951}, "custom_metrics": {"mean_episode_reward_mean": 92.3316823974951, "mean_episode_reward_min": 59.47018322029551, "mean_episode_reward_max": 112.99764589167155}, "hist_stats": {"episode_reward": [79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.8582469139401, 100.98601354691243, 103.3509117109573, 109.80100540174108, 68.02949156743054, 83.51090291559237, 99.82210399286774, 100.6352738212863, 99.3936720131479, 106.68203925243422, 90.51999341761334, 90.21443051857332, 111.59177483861235, 99.52439041271607, 60.996068450100076, 98.10493641732769, 93.08642428531572, 94.22655400257801, 95.33904365438687, 85.64815797943072, 87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7059781979450319, "mean_inference_ms": 2.0322623933099995, "mean_action_processing_ms": 0.38693174145225084, "mean_env_wait_ms": 2.2682511550957902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015910625457763672, "StateBufferConnector_ms": 0.007012367248535156, "ViewRequirementAgentConnector_ms": 0.20691609382629395}, "num_episodes": 22, "episode_return_max": 112.99764589167155, "episode_return_min": 59.47018322029551, "episode_return_mean": 92.3316823974951, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.6332357470505, "num_env_steps_trained_throughput_per_sec": 443.6332357470505, "timesteps_total": 165888, "num_env_steps_sampled_lifetime": 165888, "num_agent_steps_sampled_lifetime": 165888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 165888, "timers": {"training_iteration_time_ms": 2246.149, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2246.149, "sample_time_ms": 905.389, "learn_time_ms": 1324.109, "learn_throughput": 773.35, "synch_weights_time_ms": 16.551}, "counters": {"num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "done": false, "training_iteration": 162, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-46", "timestamp": 1744167406, "time_this_iter_s": 2.3134992122650146, "time_total_s": 397.44647097587585, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.44647097587585, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 39.825, "ram_util_percent": 94.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.323925922065973, "cur_kl_coeff": 3.42113882891801e-50, "cur_lr": 1e-07, "total_loss": 2.116542491316795, "policy_loss": -0.00027587098447838797, "vf_loss": 9.66816349029541, "vf_explained_var": -0.00015285685658454894, "kl": 2.299850590103958e-06, "entropy": 3.002225086092949, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "env_runners": {"episode_reward_max": 112.99764589167155, "episode_reward_min": 59.47018322029551, "episode_reward_mean": 92.18416993241982, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.47018322029551}, "policy_reward_max": {"tplp_policy": 112.99764589167155}, "policy_reward_mean": {"tplp_policy": 92.18416993241982}, "custom_metrics": {"mean_episode_reward_mean": 92.18416993241982, "mean_episode_reward_min": 59.47018322029551, "mean_episode_reward_max": 112.99764589167155}, "hist_stats": {"episode_reward": [87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.04522766936482, 87.80855182197196, 90.89402607145443, 91.33605850292271, 80.16492921386765, 85.6494950703549, 96.11550490090184, 75.22190978679836, 90.34388207118425, 85.64188462850024, 97.78528261899899, 90.55344816427105, 79.94386796515387, 94.7511450396121, 100.08688994497761, 107.61963607563648, 83.7874757681742, 101.10708603594736, 101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7059342525749946, "mean_inference_ms": 2.031887128225195, "mean_action_processing_ms": 0.38697632656466696, "mean_env_wait_ms": 2.2675741181077966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01691579818725586, "StateBufferConnector_ms": 0.007013082504272461, "ViewRequirementAgentConnector_ms": 0.20646142959594727}, "num_episodes": 20, "episode_return_max": 112.99764589167155, "episode_return_min": 59.47018322029551, "episode_return_mean": 92.18416993241982, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 463.19884603832554, "num_env_steps_trained_throughput_per_sec": 463.19884603832554, "timesteps_total": 166912, "num_env_steps_sampled_lifetime": 166912, "num_agent_steps_sampled_lifetime": 166912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 166912, "timers": {"training_iteration_time_ms": 2252.6, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2252.6, "sample_time_ms": 909.612, "learn_time_ms": 1326.365, "learn_throughput": 772.035, "synch_weights_time_ms": 16.523}, "counters": {"num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "done": false, "training_iteration": 163, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-48", "timestamp": 1744167408, "time_this_iter_s": 2.216583490371704, "time_total_s": 399.66305446624756, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.66305446624756, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 45.333333333333336, "ram_util_percent": 94.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7762818947434424, "cur_kl_coeff": 1.710569414459005e-50, "cur_lr": 1e-07, "total_loss": 2.1320009507238864, "policy_loss": -0.000277380523039028, "vf_loss": 9.730076777935029, "vf_explained_var": -0.00010079704225063324, "kl": 1.8476939752654076e-06, "entropy": 3.002408441901207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "env_runners": {"episode_reward_max": 112.99764589167155, "episode_reward_min": 59.47018322029551, "episode_reward_mean": 92.44174421312123, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.47018322029551}, "policy_reward_max": {"tplp_policy": 112.99764589167155}, "policy_reward_mean": {"tplp_policy": 92.44174421312123}, "custom_metrics": {"mean_episode_reward_mean": 92.44174421312123, "mean_episode_reward_min": 59.47018322029551, "mean_episode_reward_max": 112.99764589167155}, "hist_stats": {"episode_reward": [101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.20677510075059, 98.78767286202294, 69.24625524234075, 108.72821817375353, 97.48974858108585, 76.95995005370891, 88.95066680566707, 82.20583925137598, 72.85202454424955, 100.32482984268358, 93.59275031495221, 89.67504588167445, 84.78525873984069, 79.13521042543951, 92.42052501429286, 95.22295766394612, 92.91548786470776, 89.3460111439527, 98.28600429814733, 89.49374518167546, 99.91582787255075, 95.95774384465886, 84.18979131183531, 92.97703059597586, 97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7057390114832497, "mean_inference_ms": 2.031472328318988, "mean_action_processing_ms": 0.38682876849091363, "mean_env_wait_ms": 2.2671082096645776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058258056640625, "StateBufferConnector_ms": 0.006020784378051758, "ViewRequirementAgentConnector_ms": 0.1990196704864502}, "num_episodes": 18, "episode_return_max": 112.99764589167155, "episode_return_min": 59.47018322029551, "episode_return_mean": 92.44174421312123, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 487.296640997265, "num_env_steps_trained_throughput_per_sec": 487.296640997265, "timesteps_total": 167936, "num_env_steps_sampled_lifetime": 167936, "num_agent_steps_sampled_lifetime": 167936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 167936, "timers": {"training_iteration_time_ms": 2241.686, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2241.686, "sample_time_ms": 915.657, "learn_time_ms": 1309.552, "learn_throughput": 781.947, "synch_weights_time_ms": 16.378}, "counters": {"num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "done": false, "training_iteration": 164, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-50", "timestamp": 1744167410, "time_this_iter_s": 2.106351375579834, "time_total_s": 401.7694058418274, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.7694058418274, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 38.96666666666667, "ram_util_percent": 94.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4561936516314744, "cur_kl_coeff": 8.552847072295025e-51, "cur_lr": 1e-07, "total_loss": 2.139478141069412, "policy_loss": -0.00010791217209771276, "vf_loss": 9.759402769804002, "vf_explained_var": -0.0001086454838514328, "kl": 1.4819647866648467e-06, "entropy": 3.002646428346634, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "env_runners": {"episode_reward_max": 112.99764589167155, "episode_reward_min": 59.47018322029551, "episode_reward_mean": 92.7348032675011, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 59.47018322029551}, "policy_reward_max": {"tplp_policy": 112.99764589167155}, "policy_reward_mean": {"tplp_policy": 92.7348032675011}, "custom_metrics": {"mean_episode_reward_mean": 92.7348032675011, "mean_episode_reward_min": 59.47018322029551, "mean_episode_reward_max": 112.99764589167155}, "hist_stats": {"episode_reward": [97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.0625459730309, 104.68064363567883, 90.73006821623513, 90.98920384429118, 85.18468191543174, 99.82352742610726, 112.99764589167155, 100.09226143222455, 92.72886065228109, 101.68351042252935, 92.19620798227292, 92.90672857336705, 89.56016186468668, 100.78709912568752, 59.47018322029551, 89.36858390623246, 80.79765406976459, 106.55067560141086, 99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7054932555048063, "mean_inference_ms": 2.0310937174602217, "mean_action_processing_ms": 0.3866642190081345, "mean_env_wait_ms": 2.2667009719721674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010054826736450195, "StateBufferConnector_ms": 0.0030667781829833984, "ViewRequirementAgentConnector_ms": 0.21781110763549805}, "num_episodes": 24, "episode_return_max": 112.99764589167155, "episode_return_min": 59.47018322029551, "episode_return_mean": 92.7348032675011, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 458.49629960244494, "num_env_steps_trained_throughput_per_sec": 458.49629960244494, "timesteps_total": 168960, "num_env_steps_sampled_lifetime": 168960, "num_agent_steps_sampled_lifetime": 168960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 168960, "timers": {"training_iteration_time_ms": 2236.623, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2236.623, "sample_time_ms": 908.574, "learn_time_ms": 1311.223, "learn_throughput": 780.95, "synch_weights_time_ms": 16.726}, "counters": {"num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "done": false, "training_iteration": 165, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-53", "timestamp": 1744167413, "time_this_iter_s": 2.23978590965271, "time_total_s": 404.0091917514801, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 404.0091917514801, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 36.7, "ram_util_percent": 94.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.994772317260504, "cur_kl_coeff": 4.2764235361475127e-51, "cur_lr": 1e-07, "total_loss": 2.1385572485625746, "policy_loss": -0.00028943904326297345, "vf_loss": 9.756787031888962, "vf_explained_var": -0.00012405924499034882, "kl": 1.8554365500023095e-06, "entropy": 3.003500571846962, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "env_runners": {"episode_reward_max": 111.2797003093376, "episode_reward_min": 68.54508128355823, "episode_reward_mean": 92.55857400236165, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.54508128355823}, "policy_reward_max": {"tplp_policy": 111.2797003093376}, "policy_reward_mean": {"tplp_policy": 92.55857400236165}, "custom_metrics": {"mean_episode_reward_mean": 92.55857400236165, "mean_episode_reward_min": 68.54508128355823, "mean_episode_reward_max": 111.2797003093376}, "hist_stats": {"episode_reward": [99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.26616846843456, 93.57990045419972, 91.6537446194152, 100.72159733766361, 96.5989809179109, 93.19213236957276, 91.79315902324477, 109.14737041650957, 97.71499917445263, 99.5802508485632, 84.58234785557951, 91.08571320725395, 101.60560152545746, 94.64929163990867, 99.95995276437532, 91.33404405970623, 70.4583826068745, 79.64035037497646, 87.88408904652653, 99.26681221133934, 78.90576483200434, 91.56073423320959, 82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7052779109210222, "mean_inference_ms": 2.0310499560409414, "mean_action_processing_ms": 0.38650216485376865, "mean_env_wait_ms": 2.26654265093561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008044958114624023, "StateBufferConnector_ms": 0.002053499221801758, "ViewRequirementAgentConnector_ms": 0.21911907196044922}, "num_episodes": 18, "episode_return_max": 111.2797003093376, "episode_return_min": 68.54508128355823, "episode_return_mean": 92.55857400236165, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 440.6672477294178, "num_env_steps_trained_throughput_per_sec": 440.6672477294178, "timesteps_total": 169984, "num_env_steps_sampled_lifetime": 169984, "num_agent_steps_sampled_lifetime": 169984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 169984, "timers": {"training_iteration_time_ms": 2226.203, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2226.203, "sample_time_ms": 912.507, "learn_time_ms": 1296.22, "learn_throughput": 789.99, "synch_weights_time_ms": 17.376}, "counters": {"num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "done": false, "training_iteration": 166, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-55", "timestamp": 1744167415, "time_this_iter_s": 2.3305509090423584, "time_total_s": 406.33974266052246, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.33974266052246, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 50.03333333333333, "ram_util_percent": 94.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.703353130444884, "cur_kl_coeff": 2.1382117680737563e-51, "cur_lr": 1e-07, "total_loss": 2.101957182586193, "policy_loss": -9.972447878681123e-05, "vf_loss": 9.609520745277404, "vf_explained_var": -0.00010496266186237335, "kl": 6.976397518787536e-07, "entropy": 3.003232625126839, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "env_runners": {"episode_reward_max": 117.78259216515013, "episode_reward_min": 68.54508128355823, "episode_reward_mean": 92.93886583054118, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.54508128355823}, "policy_reward_max": {"tplp_policy": 117.78259216515013}, "policy_reward_mean": {"tplp_policy": 92.93886583054118}, "custom_metrics": {"mean_episode_reward_mean": 92.93886583054118, "mean_episode_reward_min": 68.54508128355823, "mean_episode_reward_max": 117.78259216515013}, "hist_stats": {"episode_reward": [82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [82.61503520280289, 85.82528517309349, 95.7578830010876, 94.19967993341587, 94.14913851518591, 99.8515199441652, 105.97210308246821, 95.81710515833623, 98.46849490536792, 97.69330885365628, 81.2469088760253, 99.34966247565815, 97.64690475937864, 95.41780997011642, 80.01790874487153, 81.67530214397685, 100.07550814697379, 100.32413065364214, 89.6663315882327, 102.15743883167218, 97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7050272540854426, "mean_inference_ms": 2.0307623865844135, "mean_action_processing_ms": 0.3863210613511414, "mean_env_wait_ms": 2.2662708056662413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004046916961669922, "StateBufferConnector_ms": 0.004173755645751953, "ViewRequirementAgentConnector_ms": 0.21361684799194336}, "num_episodes": 22, "episode_return_max": 117.78259216515013, "episode_return_min": 68.54508128355823, "episode_return_mean": 92.93886583054118, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 484.56568098073683, "num_env_steps_trained_throughput_per_sec": 484.56568098073683, "timesteps_total": 171008, "num_env_steps_sampled_lifetime": 171008, "num_agent_steps_sampled_lifetime": 171008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 171008, "timers": {"training_iteration_time_ms": 2224.905, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2224.805, "sample_time_ms": 921.851, "learn_time_ms": 1285.309, "learn_throughput": 796.696, "synch_weights_time_ms": 17.443}, "counters": {"num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "done": false, "training_iteration": 167, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-57", "timestamp": 1744167417, "time_this_iter_s": 2.119023561477661, "time_total_s": 408.4587662220001, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.4587662220001, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 35.949999999999996, "ram_util_percent": 94.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6676701713353395, "cur_kl_coeff": 1.0691058840368782e-51, "cur_lr": 1e-07, "total_loss": 2.129292085021734, "policy_loss": -0.00020124641014263034, "vf_loss": 9.71945300102234, "vf_explained_var": -0.00014433190226554872, "kl": 2.1806634677101756e-06, "entropy": 3.003699278831482, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "env_runners": {"episode_reward_max": 117.78259216515013, "episode_reward_min": 68.54508128355823, "episode_reward_mean": 92.9731447107678, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.54508128355823}, "policy_reward_max": {"tplp_policy": 117.78259216515013}, "policy_reward_mean": {"tplp_policy": 92.9731447107678}, "custom_metrics": {"mean_episode_reward_mean": 92.9731447107678, "mean_episode_reward_min": 68.54508128355823, "mean_episode_reward_max": 117.78259216515013}, "hist_stats": {"episode_reward": [97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.903329771943, 106.46135934651653, 88.52536538831278, 110.4556365734299, 68.54508128355823, 89.95856028683508, 96.90845010619059, 89.84990620962091, 95.51391508425529, 87.35130162789454, 89.72259670326629, 83.46489258283377, 91.22363918785828, 101.57974431610859, 80.22808239630014, 82.09809813540411, 84.62426950225165, 108.52902287845946, 88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.704688469108781, "mean_inference_ms": 2.0303305142750303, "mean_action_processing_ms": 0.386076548772746, "mean_env_wait_ms": 2.2657753917452026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989219665527344, "StateBufferConnector_ms": 0.003167390823364258, "ViewRequirementAgentConnector_ms": 0.20683574676513672}, "num_episodes": 20, "episode_return_max": 117.78259216515013, "episode_return_min": 68.54508128355823, "episode_return_mean": 92.9731447107678, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 488.217088774002, "num_env_steps_trained_throughput_per_sec": 488.217088774002, "timesteps_total": 172032, "num_env_steps_sampled_lifetime": 172032, "num_agent_steps_sampled_lifetime": 172032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 2211.739, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2211.639, "sample_time_ms": 918.518, "learn_time_ms": 1275.363, "learn_throughput": 802.908, "synch_weights_time_ms": 17.441}, "counters": {"num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "done": false, "training_iteration": 168, "trial_id": "374cd_00000", "date": "2025-04-09_10-56-59", "timestamp": 1744167419, "time_this_iter_s": 2.1027939319610596, "time_total_s": 410.5615601539612, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D193A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 410.5615601539612, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 34.36666666666667, "ram_util_percent": 94.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8741931788623334, "cur_kl_coeff": 5.345529420184391e-52, "cur_lr": 1e-07, "total_loss": 2.142015068978071, "policy_loss": -0.000258641951950267, "vf_loss": 9.771014672517776, "vf_explained_var": -0.00012106820940971375, "kl": 2.105178198344437e-06, "entropy": 3.004799650609493, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "env_runners": {"episode_reward_max": 117.78259216515013, "episode_reward_min": 68.97334018150354, "episode_reward_mean": 92.65387918568875, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.97334018150354}, "policy_reward_max": {"tplp_policy": 117.78259216515013}, "policy_reward_mean": {"tplp_policy": 92.65387918568875}, "custom_metrics": {"mean_episode_reward_mean": 92.65387918568875, "mean_episode_reward_min": 68.97334018150354, "mean_episode_reward_max": 117.78259216515013}, "hist_stats": {"episode_reward": [88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.52910718186615, 79.8634113606631, 94.78715481362694, 111.2797003093376, 99.33486419627826, 83.44634210719262, 100.73066889908252, 80.40142762829085, 74.14480718810867, 98.06294839680949, 106.67689557476177, 90.60146664314261, 87.27004827607796, 91.9165146409185, 94.55420373826905, 82.42281367068719, 95.50424982625272, 86.98406942772135, 94.61922199268125, 80.030333919347, 97.68800748819376, 91.96972638925851, 97.32570761916564, 99.49811674454699, 95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7044287739628587, "mean_inference_ms": 2.02985356289036, "mean_action_processing_ms": 0.3858617822918622, "mean_env_wait_ms": 2.2652732321448936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989219665527344, "StateBufferConnector_ms": 0.007322549819946289, "ViewRequirementAgentConnector_ms": 0.21821045875549316}, "num_episodes": 18, "episode_return_max": 117.78259216515013, "episode_return_min": 68.97334018150354, "episode_return_mean": 92.65387918568875, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 453.53451228565183, "num_env_steps_trained_throughput_per_sec": 453.53451228565183, "timesteps_total": 173056, "num_env_steps_sampled_lifetime": 173056, "num_agent_steps_sampled_lifetime": 173056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 173056, "timers": {"training_iteration_time_ms": 2206.125, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2206.026, "sample_time_ms": 906.892, "learn_time_ms": 1281.221, "learn_throughput": 799.238, "synch_weights_time_ms": 17.596}, "counters": {"num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "done": false, "training_iteration": 169, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-02", "timestamp": 1744167422, "time_this_iter_s": 2.264896869659424, "time_total_s": 412.8264570236206, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.8264570236206, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 38.06666666666666, "ram_util_percent": 94.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8993158649653195, "cur_kl_coeff": 2.6727647100921954e-52, "cur_lr": 1e-07, "total_loss": 2.1337549068033694, "policy_loss": -0.0001666068972554058, "vf_loss": 9.738149589300155, "vf_explained_var": -0.0002240847796201706, "kl": 2.2863407479256636e-06, "entropy": 3.0061589404940605, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "env_runners": {"episode_reward_max": 117.78259216515013, "episode_reward_min": 68.97334018150354, "episode_reward_mean": 93.01857982410444, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 68.97334018150354}, "policy_reward_max": {"tplp_policy": 117.78259216515013}, "policy_reward_mean": {"tplp_policy": 93.01857982410444}, "custom_metrics": {"mean_episode_reward_mean": 93.01857982410444, "mean_episode_reward_min": 68.97334018150354, "mean_episode_reward_max": 117.78259216515013}, "hist_stats": {"episode_reward": [95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.39400589750755, 93.4206585323339, 101.50462615378822, 89.41515138215114, 93.19927275601977, 107.67213726399858, 91.50704784212597, 86.78296102501344, 96.49350452284465, 80.73433461899172, 86.17451051821233, 99.61577879955476, 68.97334018150354, 86.06980048589446, 97.0277330739767, 99.17862982162369, 100.01952880092973, 95.99237604314713, 100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7041947474707553, "mean_inference_ms": 2.0295010254855965, "mean_action_processing_ms": 0.38566223183609766, "mean_env_wait_ms": 2.265138375393454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001994609832763672, "StateBufferConnector_ms": 0.01041102409362793, "ViewRequirementAgentConnector_ms": 0.20109963417053223}, "num_episodes": 24, "episode_return_max": 117.78259216515013, "episode_return_min": 68.97334018150354, "episode_return_mean": 93.01857982410444, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 360.1274949919258, "num_env_steps_trained_throughput_per_sec": 360.1274949919258, "timesteps_total": 174080, "num_env_steps_sampled_lifetime": 174080, "num_agent_steps_sampled_lifetime": 174080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 174080, "timers": {"training_iteration_time_ms": 2283.358, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2283.259, "sample_time_ms": 928.858, "learn_time_ms": 1336.258, "learn_throughput": 766.319, "synch_weights_time_ms": 17.926}, "counters": {"num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "done": false, "training_iteration": 170, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-05", "timestamp": 1744167425, "time_this_iter_s": 2.8500771522521973, "time_total_s": 415.6765341758728, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.6765341758728, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 53.62499999999999, "ram_util_percent": 94.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5375469133257864, "cur_kl_coeff": 1.3363823550460977e-52, "cur_lr": 1e-07, "total_loss": 2.140776475518942, "policy_loss": -0.0001759400882292539, "vf_loss": 9.766829746961594, "vf_explained_var": -0.00013581588864326478, "kl": 1.6090183939915237e-06, "entropy": 3.0075501814484595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "env_runners": {"episode_reward_max": 119.54592393563814, "episode_reward_min": 70.13885009526845, "episode_reward_mean": 93.50398457568403, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.13885009526845}, "policy_reward_max": {"tplp_policy": 119.54592393563814}, "policy_reward_mean": {"tplp_policy": 93.50398457568403}, "custom_metrics": {"mean_episode_reward_mean": 93.50398457568403, "mean_episode_reward_min": 70.13885009526845, "mean_episode_reward_max": 119.54592393563814}, "hist_stats": {"episode_reward": [100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [100.44037249462964, 100.75353374198521, 96.51438627515557, 106.02131586143778, 88.31484983387583, 77.21450252642491, 101.82270320158196, 104.44309843336579, 88.12718101534811, 84.62875286945373, 102.09171608446913, 86.06595424013278, 117.78259216515013, 94.74924592596503, 93.52312411203488, 83.90692091497506, 86.22702006654927, 92.78100179104986, 83.38280928674182, 97.40758512072551, 80.43065584565099, 92.64905095652254, 99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7040336510199496, "mean_inference_ms": 2.0289935280242455, "mean_action_processing_ms": 0.385566075159389, "mean_env_wait_ms": 2.2649819019910176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002991914749145508, "StateBufferConnector_ms": 0.012556314468383789, "ViewRequirementAgentConnector_ms": 0.19315123558044434}, "num_episodes": 18, "episode_return_max": 119.54592393563814, "episode_return_min": 70.13885009526845, "episode_return_mean": 93.50398457568403, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 475.9361520418703, "num_env_steps_trained_throughput_per_sec": 475.9361520418703, "timesteps_total": 175104, "num_env_steps_sampled_lifetime": 175104, "num_agent_steps_sampled_lifetime": 175104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 175104, "timers": {"training_iteration_time_ms": 2264.092, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2263.992, "sample_time_ms": 930.339, "learn_time_ms": 1316.297, "learn_throughput": 777.94, "synch_weights_time_ms": 17.04}, "counters": {"num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "done": false, "training_iteration": 171, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-07", "timestamp": 1744167427, "time_this_iter_s": 2.1568400859832764, "time_total_s": 417.8333742618561, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.8333742618561, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 39.96666666666667, "ram_util_percent": 94.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.854857821762562, "cur_kl_coeff": 6.681911775230489e-53, "cur_lr": 1e-07, "total_loss": 2.1295531168580055, "policy_loss": -0.00017388937121722847, "vf_loss": 9.721986085176468, "vf_explained_var": -0.00015140734612941741, "kl": 1.5301442861215265e-06, "entropy": 3.00769522190094, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "env_runners": {"episode_reward_max": 119.54592393563814, "episode_reward_min": 70.13885009526845, "episode_reward_mean": 94.2180323825135, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.13885009526845}, "policy_reward_max": {"tplp_policy": 119.54592393563814}, "policy_reward_mean": {"tplp_policy": 94.2180323825135}, "custom_metrics": {"mean_episode_reward_mean": 94.2180323825135, "mean_episode_reward_min": 70.13885009526845, "mean_episode_reward_max": 119.54592393563814}, "hist_stats": {"episode_reward": [99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.72611953256252, 95.60655243094128, 84.69769653791877, 103.87253472973886, 82.0516894639366, 89.45478491891654, 91.95634269565545, 93.49266694651764, 105.644224321206, 97.58369822173067, 89.90222673671656, 84.66658165063633, 93.65711526755105, 97.46094121737211, 100.17636248833247, 103.095789996636, 94.06286191692982, 101.16745210731597, 79.14834633578668, 88.30937102416925, 104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7037409289747957, "mean_inference_ms": 2.028113440665804, "mean_action_processing_ms": 0.3854321771375234, "mean_env_wait_ms": 2.264447992888882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994869232177734, "StateBufferConnector_ms": 0.01243138313293457, "ViewRequirementAgentConnector_ms": 0.19232773780822754}, "num_episodes": 22, "episode_return_max": 119.54592393563814, "episode_return_min": 70.13885009526845, "episode_return_mean": 94.2180323825135, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 497.3193525512735, "num_env_steps_trained_throughput_per_sec": 497.3193525512735, "timesteps_total": 176128, "num_env_steps_sampled_lifetime": 176128, "num_agent_steps_sampled_lifetime": 176128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 176128, "timers": {"training_iteration_time_ms": 2239.175, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2239.075, "sample_time_ms": 917.973, "learn_time_ms": 1303.828, "learn_throughput": 785.379, "synch_weights_time_ms": 16.957}, "counters": {"num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "done": false, "training_iteration": 172, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-09", "timestamp": 1744167429, "time_this_iter_s": 2.064500331878662, "time_total_s": 419.89787459373474, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.89787459373474, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 94.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.882091920822859, "cur_kl_coeff": 3.3409558876152443e-53, "cur_lr": 1e-07, "total_loss": 2.132081964612007, "policy_loss": -0.00018166109221056103, "vf_loss": 9.73258160352707, "vf_explained_var": -7.59553164243698e-05, "kl": 2.2823970971863615e-06, "entropy": 3.0088176146149634, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "env_runners": {"episode_reward_max": 119.54592393563814, "episode_reward_min": 70.13885009526845, "episode_reward_mean": 94.69921670450098, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.13885009526845}, "policy_reward_max": {"tplp_policy": 119.54592393563814}, "policy_reward_mean": {"tplp_policy": 94.69921670450098}, "custom_metrics": {"mean_episode_reward_mean": 94.69921670450098, "mean_episode_reward_min": 70.13885009526845, "mean_episode_reward_max": 119.54592393563814}, "hist_stats": {"episode_reward": [104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [104.19740515120783, 80.7967129662665, 83.75345396195709, 99.59105039533537, 108.30839840075056, 99.27456741791725, 80.93146274999368, 91.36539129935092, 82.78843599258252, 114.84030326218985, 83.82278050757994, 75.00240158685428, 97.76478544765713, 83.7929316863668, 83.85790402077758, 83.470996666394, 85.759303363647, 91.76036393106482, 94.87364792603837, 96.95871089933365, 92.4266104875142, 96.47471044681313, 102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7035423044541683, "mean_inference_ms": 2.0274375882188282, "mean_action_processing_ms": 0.38530403806382824, "mean_env_wait_ms": 2.2641360916994215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004888772964477539, "StateBufferConnector_ms": 0.01243138313293457, "ViewRequirementAgentConnector_ms": 0.20045232772827148}, "num_episodes": 20, "episode_return_max": 119.54592393563814, "episode_return_min": 70.13885009526845, "episode_return_mean": 94.69921670450098, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.1625192622657, "num_env_steps_trained_throughput_per_sec": 448.1625192622657, "timesteps_total": 177152, "num_env_steps_sampled_lifetime": 177152, "num_agent_steps_sampled_lifetime": 177152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 177152, "timers": {"training_iteration_time_ms": 2246.592, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2246.492, "sample_time_ms": 913.492, "learn_time_ms": 1315.154, "learn_throughput": 778.616, "synch_weights_time_ms": 17.529}, "counters": {"num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "done": false, "training_iteration": 173, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-11", "timestamp": 1744167431, "time_this_iter_s": 2.2911248207092285, "time_total_s": 422.18899941444397, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 422.18899941444397, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 43.699999999999996, "ram_util_percent": 94.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.02748427093029, "cur_kl_coeff": 1.6704779438076221e-53, "cur_lr": 1e-07, "total_loss": 2.1184062629938127, "policy_loss": -0.00023536105290986598, "vf_loss": 9.678757745027543, "vf_explained_var": -7.75754451751709e-05, "kl": 2.6246897490089794e-06, "entropy": 3.0104781448841096, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "env_runners": {"episode_reward_max": 119.54592393563814, "episode_reward_min": 70.13885009526845, "episode_reward_mean": 95.10969973567404, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.13885009526845}, "policy_reward_max": {"tplp_policy": 119.54592393563814}, "policy_reward_mean": {"tplp_policy": 95.10969973567404}, "custom_metrics": {"mean_episode_reward_mean": 95.10969973567404, "mean_episode_reward_min": 70.13885009526845, "mean_episode_reward_max": 119.54592393563814}, "hist_stats": {"episode_reward": [102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.5160702989309, 89.92487110132234, 77.11712444553557, 84.18262992081793, 88.65514882772867, 91.55559577580546, 106.72740971363939, 109.81963288780415, 90.720246884585, 102.39082887548096, 90.8823550355818, 86.67161601138528, 88.40577433878376, 90.44029195186438, 87.21821944359323, 95.23775975920955, 94.75645386580514, 108.63649568156238, 119.54592393563814, 98.20006273704469, 84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.703288615416798, "mean_inference_ms": 2.027065593841524, "mean_action_processing_ms": 0.3851572201094281, "mean_env_wait_ms": 2.2640315224512877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005886077880859375, "StateBufferConnector_ms": 0.010230302810668945, "ViewRequirementAgentConnector_ms": 0.2158644199371338}, "num_episodes": 22, "episode_return_max": 119.54592393563814, "episode_return_min": 70.13885009526845, "episode_return_mean": 95.10969973567404, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 444.2238152114149, "num_env_steps_trained_throughput_per_sec": 444.2238152114149, "timesteps_total": 178176, "num_env_steps_sampled_lifetime": 178176, "num_agent_steps_sampled_lifetime": 178176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 178176, "timers": {"training_iteration_time_ms": 2266.967, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2266.868, "sample_time_ms": 919.958, "learn_time_ms": 1328.951, "learn_throughput": 770.533, "synch_weights_time_ms": 17.643}, "counters": {"num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "done": false, "training_iteration": 174, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-14", "timestamp": 1744167434, "time_this_iter_s": 2.311777114868164, "time_total_s": 424.50077652931213, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 424.50077652931213, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 42.05, "ram_util_percent": 94.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6716975044459104, "cur_kl_coeff": 8.352389719038111e-54, "cur_lr": 1e-07, "total_loss": 2.1314248688519, "policy_loss": -0.00014446700806729494, "vf_loss": 9.73082122206688, "vf_explained_var": -0.00014388300478458406, "kl": 1.3733165721951935e-06, "entropy": 3.0113597065210342, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "env_runners": {"episode_reward_max": 115.09237189099225, "episode_reward_min": 70.13885009526845, "episode_reward_mean": 94.46603572735702, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.13885009526845}, "policy_reward_max": {"tplp_policy": 115.09237189099225}, "policy_reward_mean": {"tplp_policy": 94.46603572735702}, "custom_metrics": {"mean_episode_reward_mean": 94.46603572735702, "mean_episode_reward_min": 70.13885009526845, "mean_episode_reward_max": 115.09237189099225}, "hist_stats": {"episode_reward": [84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.70718434049986, 94.31979095264018, 93.57054546833126, 91.34246756649145, 105.89542830814007, 95.6949712094368, 88.04882937145409, 109.82263643858907, 92.51782509503158, 91.76593702669807, 84.44231107438776, 98.59430454528938, 103.95562260317561, 109.36941947102699, 70.13885009526845, 85.78376263843147, 101.94210267072708, 94.72389536786052, 108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7030565432177763, "mean_inference_ms": 2.0262803369205438, "mean_action_processing_ms": 0.3851422407335157, "mean_env_wait_ms": 2.2632563286306744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008015155792236328, "StateBufferConnector_ms": 0.009629487991333008, "ViewRequirementAgentConnector_ms": 0.21790409088134766}, "num_episodes": 20, "episode_return_max": 115.09237189099225, "episode_return_min": 70.13885009526845, "episode_return_mean": 94.46603572735702, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 454.31812792849666, "num_env_steps_trained_throughput_per_sec": 454.31812792849666, "timesteps_total": 179200, "num_env_steps_sampled_lifetime": 179200, "num_agent_steps_sampled_lifetime": 179200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 179200, "timers": {"training_iteration_time_ms": 2269.021, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2268.922, "sample_time_ms": 920.534, "learn_time_ms": 1330.387, "learn_throughput": 769.701, "synch_weights_time_ms": 17.684}, "counters": {"num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "done": false, "training_iteration": 175, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-16", "timestamp": 1744167436, "time_this_iter_s": 2.2606332302093506, "time_total_s": 426.7614097595215, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 426.7614097595215, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 94.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6151808157563208, "cur_kl_coeff": 4.1761948595190553e-54, "cur_lr": 1e-07, "total_loss": 2.1559074349701404, "policy_loss": -9.127479279413819e-05, "vf_loss": 9.828831976652145, "vf_explained_var": -0.00022788271307945253, "kl": 1.139301352459654e-06, "entropy": 3.0120927065610887, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "env_runners": {"episode_reward_max": 115.09237189099225, "episode_reward_min": 74.04217707544585, "episode_reward_mean": 94.2963096146059, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.04217707544585}, "policy_reward_max": {"tplp_policy": 115.09237189099225}, "policy_reward_mean": {"tplp_policy": 94.2963096146059}, "custom_metrics": {"mean_episode_reward_mean": 94.2963096146059, "mean_episode_reward_min": 74.04217707544585, "mean_episode_reward_max": 115.09237189099225}, "hist_stats": {"episode_reward": [108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [108.6487147596091, 95.54330078389512, 87.66552888352766, 86.6187221920763, 88.87746987277612, 112.80721466351349, 96.83609890668035, 94.80494540341095, 88.75439138840315, 97.87061162505671, 110.43063040295506, 104.09359263846088, 90.89344573721434, 90.59454765073909, 95.06102763756267, 89.45080449445042, 112.27057929503717, 80.51983260135044, 111.70901837408054, 90.56667809679152, 97.66205779612956, 94.09379121840584, 98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7027924914735592, "mean_inference_ms": 2.0257085037932865, "mean_action_processing_ms": 0.3850208083348584, "mean_env_wait_ms": 2.2625899099994977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071446895599365234, "StateBufferConnector_ms": 0.009988069534301758, "ViewRequirementAgentConnector_ms": 0.22590351104736328}, "num_episodes": 18, "episode_return_max": 115.09237189099225, "episode_return_min": 74.04217707544585, "episode_return_mean": 94.2963096146059, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.58193697435996, "num_env_steps_trained_throughput_per_sec": 465.58193697435996, "timesteps_total": 180224, "num_env_steps_sampled_lifetime": 180224, "num_agent_steps_sampled_lifetime": 180224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 180224, "timers": {"training_iteration_time_ms": 2256.586, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2256.487, "sample_time_ms": 912.385, "learn_time_ms": 1326.73, "learn_throughput": 771.822, "synch_weights_time_ms": 17.055}, "counters": {"num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "done": false, "training_iteration": 176, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-18", "timestamp": 1744167438, "time_this_iter_s": 2.2056522369384766, "time_total_s": 428.96706199645996, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 428.96706199645996, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 31.566666666666666, "ram_util_percent": 94.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4660411186516287, "cur_kl_coeff": 2.0880974297595277e-54, "cur_lr": 1e-07, "total_loss": 2.1060186207294462, "policy_loss": -0.00019714855588972568, "vf_loss": 9.630052614212037, "vf_explained_var": -0.00023968219757080077, "kl": 1.6731577770157103e-06, "entropy": 3.0129737451672556, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "env_runners": {"episode_reward_max": 115.38088928475123, "episode_reward_min": 67.93617648051023, "episode_reward_mean": 93.44437401138775, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 67.93617648051023}, "policy_reward_max": {"tplp_policy": 115.38088928475123}, "policy_reward_mean": {"tplp_policy": 93.44437401138775}, "custom_metrics": {"mean_episode_reward_mean": 93.44437401138775, "mean_episode_reward_min": 67.93617648051023, "mean_episode_reward_max": 115.38088928475123}, "hist_stats": {"episode_reward": [98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.12145773119666, 110.74152919152812, 93.57216475172562, 92.55697378871751, 97.67371536303729, 87.65233924439677, 90.71094691163721, 87.31162654943924, 94.927483645614, 96.53780341963125, 104.32887790872972, 87.37664928308658, 96.41519990503012, 108.1247444133674, 95.51328234342547, 93.1538425647418, 107.9303644170788, 89.44694029239744, 112.54948513476249, 106.54698661116919, 98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7025893777487294, "mean_inference_ms": 2.025565473547838, "mean_action_processing_ms": 0.3848810059615043, "mean_env_wait_ms": 2.262018880098929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00673365592956543, "StateBufferConnector_ms": 0.009988069534301758, "ViewRequirementAgentConnector_ms": 0.24042630195617676}, "num_episodes": 22, "episode_return_max": 115.38088928475123, "episode_return_min": 67.93617648051023, "episode_return_mean": 93.44437401138775, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.4339689669045, "num_env_steps_trained_throughput_per_sec": 437.4339689669045, "timesteps_total": 181248, "num_env_steps_sampled_lifetime": 181248, "num_agent_steps_sampled_lifetime": 181248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 181248, "timers": {"training_iteration_time_ms": 2279.355, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2279.355, "sample_time_ms": 915.947, "learn_time_ms": 1345.989, "learn_throughput": 760.779, "synch_weights_time_ms": 17.205}, "counters": {"num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "done": false, "training_iteration": 177, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-21", "timestamp": 1744167441, "time_this_iter_s": 2.3465983867645264, "time_total_s": 431.3136603832245, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 431.3136603832245, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 49.96666666666667, "ram_util_percent": 94.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.02876803278923, "cur_kl_coeff": 1.0440487148797638e-54, "cur_lr": 1e-07, "total_loss": 2.130113700032234, "policy_loss": -0.00013266483729239552, "vf_loss": 9.72647396326065, "vf_explained_var": -0.00015379637479782105, "kl": 1.4499192570849307e-06, "entropy": 3.0137211099267005, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "env_runners": {"episode_reward_max": 116.63644452593311, "episode_reward_min": 67.93617648051023, "episode_reward_mean": 92.68126697099946, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 67.93617648051023}, "policy_reward_max": {"tplp_policy": 116.63644452593311}, "policy_reward_mean": {"tplp_policy": 92.68126697099946}, "custom_metrics": {"mean_episode_reward_mean": 92.68126697099946, "mean_episode_reward_min": 67.93617648051023, "mean_episode_reward_max": 116.63644452593311}, "hist_stats": {"episode_reward": [98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.23388625931366, 85.42676898008958, 96.42332347089139, 91.48213904617812, 87.53737402399572, 92.82693973924609, 85.98547644637326, 102.78803210212428, 91.9593498724669, 98.5920813487898, 98.95965106588145, 104.49907307317339, 98.66749303721144, 86.17488886027819, 83.44231945632451, 79.2638557769051, 94.58910971538803, 82.98683915307821, 86.88550110617437, 87.04005740508363, 107.72284114730171, 87.95348816878769, 84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7025017544266561, "mean_inference_ms": 2.025610669906822, "mean_action_processing_ms": 0.38476326989515597, "mean_env_wait_ms": 2.261715913977744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008834600448608398, "StateBufferConnector_ms": 0.01198720932006836, "ViewRequirementAgentConnector_ms": 0.23762226104736328}, "num_episodes": 20, "episode_return_max": 116.63644452593311, "episode_return_min": 67.93617648051023, "episode_return_mean": 92.68126697099946, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.8450371695205, "num_env_steps_trained_throughput_per_sec": 417.8450371695205, "timesteps_total": 182272, "num_env_steps_sampled_lifetime": 182272, "num_agent_steps_sampled_lifetime": 182272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 182272, "timers": {"training_iteration_time_ms": 2314.68, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2314.68, "sample_time_ms": 927.964, "learn_time_ms": 1369.105, "learn_throughput": 747.934, "synch_weights_time_ms": 17.511}, "counters": {"num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "done": false, "training_iteration": 178, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-23", "timestamp": 1744167443, "time_this_iter_s": 2.456934690475464, "time_total_s": 433.77059507369995, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C82DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 433.77059507369995, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 40.2, "ram_util_percent": 94.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.298376345634461, "cur_kl_coeff": 5.220243574398819e-55, "cur_lr": 1e-07, "total_loss": 2.109566210955381, "policy_loss": -0.00035308332880958917, "vf_loss": 9.645824825763702, "vf_explained_var": -0.00010639727115631103, "kl": 4.193424031662119e-06, "entropy": 3.0153689861297606, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "env_runners": {"episode_reward_max": 116.63644452593311, "episode_reward_min": 67.93617648051023, "episode_reward_mean": 93.07748967732223, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 67.93617648051023}, "policy_reward_max": {"tplp_policy": 116.63644452593311}, "policy_reward_mean": {"tplp_policy": 93.07748967732223}, "custom_metrics": {"mean_episode_reward_mean": 93.07748967732223, "mean_episode_reward_min": 67.93617648051023, "mean_episode_reward_max": 116.63644452593311}, "hist_stats": {"episode_reward": [84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [84.84986589955545, 103.80027098193085, 101.01589282004163, 115.09237189099225, 103.92314580333864, 89.13337270733066, 85.00278747013309, 74.04217707544585, 98.50998559085942, 90.62888058686033, 87.31223303269918, 84.46650880940744, 79.79792872297138, 82.90825990974409, 84.1962794504133, 101.35416305416864, 78.53793580892112, 98.98972172951333, 91.96823452858132, 91.96923992611096, 83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.702582366259974, "mean_inference_ms": 2.0258659682037012, "mean_action_processing_ms": 0.38463003606381824, "mean_env_wait_ms": 2.261562982862528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007837295532226562, "StateBufferConnector_ms": 0.011964082717895508, "ViewRequirementAgentConnector_ms": 0.2387232780456543}, "num_episodes": 22, "episode_return_max": 116.63644452593311, "episode_return_min": 67.93617648051023, "episode_return_mean": 93.07748967732223, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 447.8827649854163, "num_env_steps_trained_throughput_per_sec": 447.8827649854163, "timesteps_total": 183296, "num_env_steps_sampled_lifetime": 183296, "num_agent_steps_sampled_lifetime": 183296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 183296, "timers": {"training_iteration_time_ms": 2317.529, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2317.529, "sample_time_ms": 943.81, "learn_time_ms": 1356.417, "learn_throughput": 754.93, "synch_weights_time_ms": 17.101}, "counters": {"num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "done": false, "training_iteration": 179, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-25", "timestamp": 1744167445, "time_this_iter_s": 2.2915995121002197, "time_total_s": 436.06219458580017, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.06219458580017, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 46.23333333333334, "ram_util_percent": 94.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8570265904068948, "cur_kl_coeff": 2.6101217871994096e-55, "cur_lr": 1e-07, "total_loss": 2.1578027732670306, "policy_loss": -0.00020759968319907784, "vf_loss": 9.839278095960617, "vf_explained_var": -0.0002549014985561371, "kl": 2.9439495262920114e-06, "entropy": 3.0180915251374243, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "env_runners": {"episode_reward_max": 121.42851239472861, "episode_reward_min": 62.757318352690454, "episode_reward_mean": 93.81074792710088, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.757318352690454}, "policy_reward_max": {"tplp_policy": 121.42851239472861}, "policy_reward_mean": {"tplp_policy": 93.81074792710088}, "custom_metrics": {"mean_episode_reward_mean": 93.81074792710088, "mean_episode_reward_min": 62.757318352690454, "mean_episode_reward_max": 121.42851239472861}, "hist_stats": {"episode_reward": [83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.63967856351441, 81.4899669556813, 101.7105452715533, 103.2095373126465, 90.54705736772812, 84.63564132693598, 88.24339209576125, 101.35355333937443, 92.4975281185752, 94.68894812529881, 84.91858304046085, 91.51104792466722, 89.76145415741567, 108.07852037376495, 101.31635376205558, 98.12399077824429, 93.37316774716686, 67.93617648051023, 92.9645888518179, 93.12296108240325, 101.47553018222908, 108.12638221449134, 68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7029539368205197, "mean_inference_ms": 2.0267251373431194, "mean_action_processing_ms": 0.38469191678434894, "mean_env_wait_ms": 2.262137741428036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006705522537231445, "StateBufferConnector_ms": 0.00965738296508789, "ViewRequirementAgentConnector_ms": 0.22616958618164062}, "num_episodes": 20, "episode_return_max": 121.42851239472861, "episode_return_min": 62.757318352690454, "episode_return_mean": 93.81074792710088, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 284.0332859125295, "num_env_steps_trained_throughput_per_sec": 284.0332859125295, "timesteps_total": 184320, "num_env_steps_sampled_lifetime": 184320, "num_agent_steps_sampled_lifetime": 184320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 184320, "timers": {"training_iteration_time_ms": 2393.706, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2393.706, "sample_time_ms": 956.423, "learn_time_ms": 1418.155, "learn_throughput": 722.065, "synch_weights_time_ms": 18.928}, "counters": {"num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "done": false, "training_iteration": 180, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-29", "timestamp": 1744167449, "time_this_iter_s": 3.619485378265381, "time_total_s": 439.68167996406555, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A2A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.68167996406555, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 55.660000000000004, "ram_util_percent": 95.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.057585512846709, "cur_kl_coeff": 1.3050608935997048e-55, "cur_lr": 1e-07, "total_loss": 2.1251268424093723, "policy_loss": -0.0001486566965468228, "vf_loss": 9.708987176418304, "vf_explained_var": -0.00011421442031860352, "kl": 1.80860466558741e-06, "entropy": 3.0197128400206568, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "env_runners": {"episode_reward_max": 121.42851239472861, "episode_reward_min": 62.757318352690454, "episode_reward_mean": 94.01695637878406, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.757318352690454}, "policy_reward_max": {"tplp_policy": 121.42851239472861}, "policy_reward_mean": {"tplp_policy": 94.01695637878406}, "custom_metrics": {"mean_episode_reward_mean": 94.01695637878406, "mean_episode_reward_min": 62.757318352690454, "mean_episode_reward_max": 121.42851239472861}, "hist_stats": {"episode_reward": [68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [68.11888344558724, 84.32114152407257, 82.96121047081436, 86.56145504963234, 115.38088928475123, 101.7763425226939, 105.95845103378538, 98.56441061562904, 95.40458828149681, 79.12501372227287, 105.45457473992441, 93.99902584928405, 83.37927241361427, 88.69385918822991, 107.52176318778028, 86.35975621212393, 89.80026506318968, 96.4758637237607, 90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7039345410256881, "mean_inference_ms": 2.0292577524053717, "mean_action_processing_ms": 0.38493095592715837, "mean_env_wait_ms": 2.2644604828013364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007983207702636719, "StateBufferConnector_ms": 0.012175321578979492, "ViewRequirementAgentConnector_ms": 0.26869821548461914}, "num_episodes": 22, "episode_return_max": 121.42851239472861, "episode_return_min": 62.757318352690454, "episode_return_mean": 94.01695637878406, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 234.20674096302727, "num_env_steps_trained_throughput_per_sec": 234.20674096302727, "timesteps_total": 185344, "num_env_steps_sampled_lifetime": 185344, "num_agent_steps_sampled_lifetime": 185344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 185344, "timers": {"training_iteration_time_ms": 2615.772, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2615.772, "sample_time_ms": 1015.757, "learn_time_ms": 1578.655, "learn_throughput": 648.654, "synch_weights_time_ms": 21.26}, "counters": {"num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "done": false, "training_iteration": 181, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-34", "timestamp": 1744167454, "time_this_iter_s": 4.3882834911346436, "time_total_s": 444.0699634552002, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 444.0699634552002, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 74.05714285714286, "ram_util_percent": 96.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8044358476996423, "cur_kl_coeff": 6.525304467998524e-56, "cur_lr": 1e-07, "total_loss": 2.155752620846033, "policy_loss": -0.00011514157522469759, "vf_loss": 9.831761795282365, "vf_explained_var": -0.00012300685048103333, "kl": 1.3310698163127022e-06, "entropy": 3.020726779103279, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "env_runners": {"episode_reward_max": 121.42851239472861, "episode_reward_min": 62.757318352690454, "episode_reward_mean": 94.67968388275794, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.757318352690454}, "policy_reward_max": {"tplp_policy": 121.42851239472861}, "policy_reward_mean": {"tplp_policy": 94.67968388275794}, "custom_metrics": {"mean_episode_reward_mean": 94.67968388275794, "mean_episode_reward_min": 62.757318352690454, "mean_episode_reward_max": 121.42851239472861}, "hist_stats": {"episode_reward": [90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.6299542479983, 99.42714417418554, 93.72506834318102, 100.22301605087421, 87.60854701041676, 92.56912798010679, 86.54393919135974, 86.38570393896975, 94.61284458020631, 93.69155352224158, 94.02193059990503, 89.0247153944733, 101.65065002827158, 90.45357664610893, 116.63644452593311, 99.35972075211833, 85.09211099532587, 86.94953266325528, 94.72079052870357, 87.0965819467842, 98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7053934491518019, "mean_inference_ms": 2.033429389748185, "mean_action_processing_ms": 0.38583996558552547, "mean_env_wait_ms": 2.268211310911333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008980751037597656, "StateBufferConnector_ms": 0.010180473327636719, "ViewRequirementAgentConnector_ms": 0.30052709579467773}, "num_episodes": 18, "episode_return_max": 121.42851239472861, "episode_return_min": 62.757318352690454, "episode_return_mean": 94.67968388275794, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.27262732057912, "num_env_steps_trained_throughput_per_sec": 217.27262732057912, "timesteps_total": 186368, "num_env_steps_sampled_lifetime": 186368, "num_agent_steps_sampled_lifetime": 186368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 186368, "timers": {"training_iteration_time_ms": 2881.165, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2881.165, "sample_time_ms": 1133.915, "learn_time_ms": 1723.254, "learn_throughput": 594.225, "synch_weights_time_ms": 23.896}, "counters": {"num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "done": false, "training_iteration": 182, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-39", "timestamp": 1744167459, "time_this_iter_s": 4.734790563583374, "time_total_s": 448.80475401878357, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 448.80475401878357, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 71.85000000000001, "ram_util_percent": 97.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5074048686772583, "cur_kl_coeff": 3.262652233999262e-56, "cur_lr": 1e-07, "total_loss": 2.1356985650956632, "policy_loss": -0.00014680863823741676, "vf_loss": 9.752222567796707, "vf_explained_var": -0.00012051723897457122, "kl": 1.9787639626622776e-06, "entropy": 3.0221029311418532, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "env_runners": {"episode_reward_max": 121.42851239472861, "episode_reward_min": 62.757318352690454, "episode_reward_mean": 94.94632468298583, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 62.757318352690454}, "policy_reward_max": {"tplp_policy": 121.42851239472861}, "policy_reward_mean": {"tplp_policy": 94.94632468298583}, "custom_metrics": {"mean_episode_reward_mean": 94.94632468298583, "mean_episode_reward_min": 62.757318352690454, "mean_episode_reward_max": 121.42851239472861}, "hist_stats": {"episode_reward": [98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.9370414534971, 91.12322741755392, 95.36385563898894, 85.82959836834641, 82.70299304956635, 109.24126088975734, 80.10472021990032, 90.91422393864492, 91.76488933713416, 111.0199338657182, 108.66607720107521, 96.7869651682021, 97.293676680118, 103.18259578572426, 102.21957922620618, 90.48462966507121, 74.83873223223031, 98.43005210903382, 91.33557220661856, 87.00576295845768, 62.757318352690454, 95.24093188876938, 103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7072286183599039, "mean_inference_ms": 2.0389740299452708, "mean_action_processing_ms": 0.3869281090272253, "mean_env_wait_ms": 2.273190368717635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008997917175292969, "StateBufferConnector_ms": 0.010175704956054688, "ViewRequirementAgentConnector_ms": 0.33631324768066406}, "num_episodes": 20, "episode_return_max": 121.42851239472861, "episode_return_min": 62.757318352690454, "episode_return_mean": 94.94632468298583, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 307.875081333044, "num_env_steps_trained_throughput_per_sec": 307.875081333044, "timesteps_total": 187392, "num_env_steps_sampled_lifetime": 187392, "num_agent_steps_sampled_lifetime": 187392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 187392, "timers": {"training_iteration_time_ms": 2985.279, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2985.279, "sample_time_ms": 1178.445, "learn_time_ms": 1782.286, "learn_throughput": 574.543, "synch_weights_time_ms": 24.347}, "counters": {"num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "done": false, "training_iteration": 183, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-42", "timestamp": 1744167462, "time_this_iter_s": 3.3325109481811523, "time_total_s": 452.1372649669647, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.1372649669647, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 69.125, "ram_util_percent": 97.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4791613958775995, "cur_kl_coeff": 1.631326116999631e-56, "cur_lr": 1e-07, "total_loss": 2.1094170294702055, "policy_loss": -0.0001332285290118307, "vf_loss": 9.647682040929794, "vf_explained_var": -0.00017924904823303224, "kl": 1.6630985042453972e-06, "entropy": 3.0237023040652273, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "env_runners": {"episode_reward_max": 121.42851239472861, "episode_reward_min": 71.65198561843886, "episode_reward_mean": 95.80000835054483, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.65198561843886}, "policy_reward_max": {"tplp_policy": 121.42851239472861}, "policy_reward_mean": {"tplp_policy": 95.80000835054483}, "custom_metrics": {"mean_episode_reward_mean": 95.80000835054483, "mean_episode_reward_min": 71.65198561843886, "mean_episode_reward_max": 121.42851239472861}, "hist_stats": {"episode_reward": [103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.427000853701, 101.91032068545279, 80.60321836408987, 80.76975228058618, 85.63401869379001, 91.76075718335255, 105.91966055440523, 94.10217734042747, 81.35058237440464, 100.68939920055047, 104.747644663732, 89.19720682213475, 93.72169930363376, 121.42851239472861, 105.18972546384452, 102.786618837679, 104.30203941662425, 95.2864961022865, 78.78480798210826, 71.65198561843886, 96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7094326274888106, "mean_inference_ms": 2.0457762342695442, "mean_action_processing_ms": 0.3883165849365702, "mean_env_wait_ms": 2.2792814250159013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012991189956665039, "StateBufferConnector_ms": 0.0070116519927978516, "ViewRequirementAgentConnector_ms": 0.3320646286010742}, "num_episodes": 22, "episode_return_max": 121.42851239472861, "episode_return_min": 71.65198561843886, "episode_return_mean": 95.80000835054483, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 325.2134818256526, "num_env_steps_trained_throughput_per_sec": 325.2134818256526, "timesteps_total": 188416, "num_env_steps_sampled_lifetime": 188416, "num_agent_steps_sampled_lifetime": 188416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 188416, "timers": {"training_iteration_time_ms": 3069.635, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3069.635, "sample_time_ms": 1216.438, "learn_time_ms": 1828.223, "learn_throughput": 560.107, "synch_weights_time_ms": 24.571}, "counters": {"num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "done": false, "training_iteration": 184, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-45", "timestamp": 1744167465, "time_this_iter_s": 3.1552720069885254, "time_total_s": 455.29253697395325, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.29253697395325, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 47.2, "ram_util_percent": 98.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.892657191306353, "cur_kl_coeff": 8.156630584998155e-57, "cur_lr": 1e-07, "total_loss": 2.1393099933862687, "policy_loss": -0.00022114469320513308, "vf_loss": 9.768365150690078, "vf_explained_var": -0.00012502893805503844, "kl": 2.939379567967748e-06, "entropy": 3.025601217150688, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "env_runners": {"episode_reward_max": 115.40262447067403, "episode_reward_min": 72.51341242694654, "episode_reward_mean": 95.81683908927525, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.51341242694654}, "policy_reward_max": {"tplp_policy": 115.40262447067403}, "policy_reward_mean": {"tplp_policy": 95.81683908927525}, "custom_metrics": {"mean_episode_reward_mean": 95.81683908927525, "mean_episode_reward_min": 72.51341242694654, "mean_episode_reward_max": 115.40262447067403}, "hist_stats": {"episode_reward": [96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [96.92397557899712, 93.19398450472549, 106.35613403678748, 106.400914871898, 95.17384288714179, 103.29907122667498, 72.51341242694654, 101.60146594373114, 83.48673043555809, 104.34842402385863, 102.21905323716771, 90.09221844660027, 100.94166135680865, 87.61582601292415, 83.8419396457446, 115.40262447067403, 92.6251290833541, 102.61074976087961, 95.48639228486017, 88.77510640473766, 105.43538736803619, 100.33168689816746, 109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7112562031151358, "mean_inference_ms": 2.0514958496283144, "mean_action_processing_ms": 0.3894295121202569, "mean_env_wait_ms": 2.2842851372674495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012990474700927734, "StateBufferConnector_ms": 0.006014347076416016, "ViewRequirementAgentConnector_ms": 0.33567023277282715}, "num_episodes": 20, "episode_return_max": 115.40262447067403, "episode_return_min": 72.51341242694654, "episode_return_mean": 95.81683908927525, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 410.5665724188549, "num_env_steps_trained_throughput_per_sec": 410.5665724188549, "timesteps_total": 189440, "num_env_steps_sampled_lifetime": 189440, "num_agent_steps_sampled_lifetime": 189440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 189440, "timers": {"training_iteration_time_ms": 3093.653, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3093.653, "sample_time_ms": 1228.434, "learn_time_ms": 1840.195, "learn_throughput": 556.463, "synch_weights_time_ms": 24.508}, "counters": {"num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "done": false, "training_iteration": 185, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-48", "timestamp": 1744167468, "time_this_iter_s": 2.501207113265991, "time_total_s": 457.79374408721924, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.79374408721924, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 44.56666666666666, "ram_util_percent": 97.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.838954500108957, "cur_kl_coeff": 4.0783152924990775e-57, "cur_lr": 1e-07, "total_loss": 2.1235284358263016, "policy_loss": -0.00014088823227211832, "vf_loss": 9.705810844898224, "vf_explained_var": -7.90335237979889e-05, "kl": 2.216464935522744e-06, "entropy": 3.0278337046504022, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "env_runners": {"episode_reward_max": 113.88560232894388, "episode_reward_min": 75.66317453574459, "episode_reward_mean": 95.4600590930671, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 75.66317453574459}, "policy_reward_max": {"tplp_policy": 113.88560232894388}, "policy_reward_mean": {"tplp_policy": 95.4600590930671}, "custom_metrics": {"mean_episode_reward_mean": 95.4600590930671, "mean_episode_reward_min": 75.66317453574459, "mean_episode_reward_max": 113.88560232894388}, "hist_stats": {"episode_reward": [109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [109.46741628191872, 104.8068189698139, 92.49415612021674, 92.90806690583355, 88.44708308619123, 103.18484217185258, 81.23190414236876, 100.3962780775879, 86.39999235716903, 103.41695911700968, 86.34978275954758, 97.70698948183707, 75.66317453574459, 109.43496622767044, 99.21915483722579, 99.2348573878374, 98.69662384286396, 85.6794433040581, 112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7128498159880016, "mean_inference_ms": 2.0565257246440805, "mean_action_processing_ms": 0.39044531751109773, "mean_env_wait_ms": 2.2887628029032943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011989355087280273, "StateBufferConnector_ms": 0.003988981246948242, "ViewRequirementAgentConnector_ms": 0.2984280586242676}, "num_episodes": 22, "episode_return_max": 113.88560232894388, "episode_return_min": 75.66317453574459, "episode_return_mean": 95.4600590930671, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 370.50960045562243, "num_env_steps_trained_throughput_per_sec": 370.50960045562243, "timesteps_total": 190464, "num_env_steps_sampled_lifetime": 190464, "num_agent_steps_sampled_lifetime": 190464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 190464, "timers": {"training_iteration_time_ms": 3150.09, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3150.09, "sample_time_ms": 1244.498, "learn_time_ms": 1879.569, "learn_throughput": 544.806, "synch_weights_time_ms": 25.405}, "counters": {"num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "done": false, "training_iteration": 186, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-51", "timestamp": 1744167471, "time_this_iter_s": 2.773038387298584, "time_total_s": 460.5667824745178, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.5667824745178, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 46.525, "ram_util_percent": 97.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.845255209505558, "cur_kl_coeff": 2.0391576462495387e-57, "cur_lr": 1e-07, "total_loss": 2.1389836825430395, "policy_loss": -0.00021164534264244138, "vf_loss": 9.768699437379837, "vf_explained_var": -0.00014456696808338166, "kl": 2.3916909609678073e-06, "entropy": 3.0297951102256775, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "env_runners": {"episode_reward_max": 116.57724592487287, "episode_reward_min": 75.88254408547141, "episode_reward_mean": 95.8215006950049, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 75.88254408547141}, "policy_reward_max": {"tplp_policy": 116.57724592487287}, "policy_reward_mean": {"tplp_policy": 95.8215006950049}, "custom_metrics": {"mean_episode_reward_mean": 95.8215006950049, "mean_episode_reward_min": 75.88254408547141, "mean_episode_reward_max": 116.57724592487287}, "hist_stats": {"episode_reward": [112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [112.39483029044062, 92.7196876017616, 102.26571852263777, 89.60983578966827, 88.2295395655379, 95.23048281840114, 94.12907295496132, 89.26335152444686, 89.47290264821412, 99.19424458205057, 87.83470613148808, 90.41234527913272, 100.68969884246084, 79.63743164269718, 101.4580025586133, 113.88560232894388, 89.29595258891018, 96.98756032592124, 97.09894586916373, 106.24591223712154, 106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7136840413805302, "mean_inference_ms": 2.058650232552523, "mean_action_processing_ms": 0.3908924704730379, "mean_env_wait_ms": 2.2909541350256637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991811752319336, "StateBufferConnector_ms": 0.003987550735473633, "ViewRequirementAgentConnector_ms": 0.2798013687133789}, "num_episodes": 18, "episode_return_max": 116.57724592487287, "episode_return_min": 75.88254408547141, "episode_return_mean": 95.8215006950049, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 344.62063125833225, "num_env_steps_trained_throughput_per_sec": 344.62063125833225, "timesteps_total": 191488, "num_env_steps_sampled_lifetime": 191488, "num_agent_steps_sampled_lifetime": 191488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 191488, "timers": {"training_iteration_time_ms": 3213.136, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3213.136, "sample_time_ms": 1267.939, "learn_time_ms": 1918.976, "learn_throughput": 533.618, "synch_weights_time_ms": 25.603}, "counters": {"num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "done": false, "training_iteration": 187, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-54", "timestamp": 1744167474, "time_this_iter_s": 2.978334903717041, "time_total_s": 463.54511737823486, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C80860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.54511737823486, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 49.34, "ram_util_percent": 97.55999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.413205887377262, "cur_kl_coeff": 1.0195788231247694e-57, "cur_lr": 1e-07, "total_loss": 2.123645041882992, "policy_loss": -0.0004498830530792475, "vf_loss": 9.708931517601012, "vf_explained_var": -0.00013135820627212523, "kl": 4.3206156810526865e-06, "entropy": 3.031379634141922, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "env_runners": {"episode_reward_max": 116.57724592487287, "episode_reward_min": 75.88254408547141, "episode_reward_mean": 95.27065367428094, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 75.88254408547141}, "policy_reward_max": {"tplp_policy": 116.57724592487287}, "policy_reward_mean": {"tplp_policy": 95.27065367428094}, "custom_metrics": {"mean_episode_reward_mean": 95.27065367428094, "mean_episode_reward_min": 75.88254408547141, "mean_episode_reward_max": 116.57724592487287}, "hist_stats": {"episode_reward": [106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [106.29999006360912, 98.93510163495603, 86.51850169807001, 106.29633093303072, 111.68831896288822, 112.27547998058418, 90.43832160812988, 92.4004182600094, 95.58373716027756, 95.58001888274407, 85.88477760760378, 92.61783326234466, 95.52591105756706, 99.22196171631184, 84.67330336733346, 92.77453265927846, 99.83857591792055, 92.66374041511355, 91.22015623228468, 96.8301348828627, 99.88235463099379, 96.70364880427232, 88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7144300313585206, "mean_inference_ms": 2.0604842078292083, "mean_action_processing_ms": 0.3912323297112627, "mean_env_wait_ms": 2.292953057989254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007982969284057617, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.2522909641265869}, "num_episodes": 20, "episode_return_max": 116.57724592487287, "episode_return_min": 75.88254408547141, "episode_return_mean": 95.27065367428094, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 412.8593245396992, "num_env_steps_trained_throughput_per_sec": 412.8593245396992, "timesteps_total": 192512, "num_env_steps_sampled_lifetime": 192512, "num_agent_steps_sampled_lifetime": 192512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 192512, "timers": {"training_iteration_time_ms": 3216.095, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3216.095, "sample_time_ms": 1282.761, "learn_time_ms": 1906.914, "learn_throughput": 536.993, "synch_weights_time_ms": 25.803}, "counters": {"num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "done": false, "training_iteration": 188, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-56", "timestamp": 1744167476, "time_this_iter_s": 2.488053560256958, "time_total_s": 466.0331709384918, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 466.0331709384918, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 54.23333333333334, "ram_util_percent": 97.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9069522760808466, "cur_kl_coeff": 5.097894115623847e-58, "cur_lr": 1e-07, "total_loss": 2.0832339458167555, "policy_loss": -0.0002647702785907313, "vf_loss": 9.54690778851509, "vf_explained_var": -0.00014460720121860503, "kl": 2.277661362247441e-06, "entropy": 3.032282118499279, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "env_runners": {"episode_reward_max": 116.57724592487287, "episode_reward_min": 75.88254408547141, "episode_reward_mean": 94.8363178893099, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 75.88254408547141}, "policy_reward_max": {"tplp_policy": 116.57724592487287}, "policy_reward_mean": {"tplp_policy": 94.8363178893099}, "custom_metrics": {"mean_episode_reward_mean": 94.8363178893099, "mean_episode_reward_min": 75.88254408547141, "mean_episode_reward_max": 116.57724592487287}, "hist_stats": {"episode_reward": [88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.03518749521157, 93.36630004936222, 83.33535250331626, 75.88254408547141, 92.58920632335335, 90.03329792425954, 104.47925260332255, 90.27835922696728, 88.36072326956408, 111.634220661648, 90.31966789478876, 91.3228639446946, 102.19694950110231, 94.81577721385882, 100.13274388153704, 96.24938566472657, 101.66786517559107, 103.66099715496878, 86.40258481095383, 86.32364159490368, 90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7149536247870956, "mean_inference_ms": 2.06181613465402, "mean_action_processing_ms": 0.3914151466175011, "mean_env_wait_ms": 2.294696961761106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005988359451293945, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.24691987037658691}, "num_episodes": 22, "episode_return_max": 116.57724592487287, "episode_return_min": 75.88254408547141, "episode_return_mean": 94.8363178893099, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 419.0473236331514, "num_env_steps_trained_throughput_per_sec": 419.0473236331514, "timesteps_total": 193536, "num_env_steps_sampled_lifetime": 193536, "num_agent_steps_sampled_lifetime": 193536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 3231.828, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3231.828, "sample_time_ms": 1284.038, "learn_time_ms": 1920.401, "learn_throughput": 533.222, "synch_weights_time_ms": 26.872}, "counters": {"num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "done": false, "training_iteration": 189, "trial_id": "374cd_00000", "date": "2025-04-09_10-57-59", "timestamp": 1744167479, "time_this_iter_s": 2.45208740234375, "time_total_s": 468.48525834083557, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.48525834083557, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 38.35, "ram_util_percent": 97.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4680594488978387, "cur_kl_coeff": 2.5489470578119234e-58, "cur_lr": 1e-07, "total_loss": 2.141513381153345, "policy_loss": -3.50570073351264e-05, "vf_loss": 9.779485017061234, "vf_explained_var": -0.00019682757556438446, "kl": 1.2196114972273797e-06, "entropy": 3.033227966725826, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "env_runners": {"episode_reward_max": 122.38817916279888, "episode_reward_min": 77.59879990755623, "episode_reward_mean": 94.97388010350498, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 77.59879990755623}, "policy_reward_max": {"tplp_policy": 122.38817916279888}, "policy_reward_mean": {"tplp_policy": 94.97388010350498}, "custom_metrics": {"mean_episode_reward_mean": 94.97388010350498, "mean_episode_reward_min": 77.59879990755623, "mean_episode_reward_max": 122.38817916279888}, "hist_stats": {"episode_reward": [90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [90.8169257262763, 77.59879990755623, 93.79313102839576, 86.36393906370284, 94.1624102234953, 83.66830822535307, 98.32349818654154, 103.92835889395948, 103.50287224585341, 95.64795336135873, 94.13730751263786, 98.0041644543305, 100.95998825104682, 103.7527878584877, 100.5912189180197, 100.77472698306173, 89.04605810459805, 97.77549803482414, 107.86513440749569, 99.55842349260814, 103.80151180617577, 101.01776642047588, 88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7154453862915191, "mean_inference_ms": 2.062956271206483, "mean_action_processing_ms": 0.39164307446739566, "mean_env_wait_ms": 2.296166184674436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006986379623413086, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.2300562858581543}, "num_episodes": 20, "episode_return_max": 122.38817916279888, "episode_return_min": 77.59879990755623, "episode_return_mean": 94.97388010350498, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 387.16569709241304, "num_env_steps_trained_throughput_per_sec": 387.16569709241304, "timesteps_total": 194560, "num_env_steps_sampled_lifetime": 194560, "num_agent_steps_sampled_lifetime": 194560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 194560, "timers": {"training_iteration_time_ms": 3135.793, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3135.793, "sample_time_ms": 1267.34, "learn_time_ms": 1842.49, "learn_throughput": 555.77, "synch_weights_time_ms": 25.445}, "counters": {"num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "done": false, "training_iteration": 190, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-01", "timestamp": 1744167481, "time_this_iter_s": 2.6509790420532227, "time_total_s": 471.1362373828888, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 471.1362373828888, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 49.15, "ram_util_percent": 97.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.101455145329237, "cur_kl_coeff": 1.2744735289059617e-58, "cur_lr": 1e-07, "total_loss": 2.122975542396307, "policy_loss": -0.0002440036158077419, "vf_loss": 9.706692487001419, "vf_explained_var": -0.00015294887125492096, "kl": 2.050644166202986e-06, "entropy": 3.0345360189676285, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "env_runners": {"episode_reward_max": 122.38817916279888, "episode_reward_min": 72.98575963914149, "episode_reward_mean": 94.4012295950345, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.98575963914149}, "policy_reward_max": {"tplp_policy": 122.38817916279888}, "policy_reward_mean": {"tplp_policy": 94.4012295950345}, "custom_metrics": {"mean_episode_reward_mean": 94.4012295950345, "mean_episode_reward_min": 72.98575963914149, "mean_episode_reward_max": 122.38817916279888}, "hist_stats": {"episode_reward": [88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [88.67202527261287, 99.73797703487477, 92.87543317012313, 102.73664450574888, 116.57724592487287, 99.6774341232169, 89.90247244131453, 103.15402709981132, 90.65720003853954, 94.72727345225849, 97.99227465811236, 107.75784808540743, 83.79352153669441, 88.17948516198791, 80.14908497352795, 109.47344409477257, 98.75277456186865, 95.96334867900151, 115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7160526062102232, "mean_inference_ms": 2.0646779966236766, "mean_action_processing_ms": 0.3920102123972017, "mean_env_wait_ms": 2.298303760459672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02160954475402832, "StateBufferConnector_ms": 0.0039865970611572266, "ViewRequirementAgentConnector_ms": 0.21984505653381348}, "num_episodes": 22, "episode_return_max": 122.38817916279888, "episode_return_min": 72.98575963914149, "episode_return_mean": 94.4012295950345, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 348.60414800700397, "num_env_steps_trained_throughput_per_sec": 348.60414800700397, "timesteps_total": 195584, "num_env_steps_sampled_lifetime": 195584, "num_agent_steps_sampled_lifetime": 195584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 195584, "timers": {"training_iteration_time_ms": 2992.315, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2992.315, "sample_time_ms": 1246.817, "learn_time_ms": 1721.639, "learn_throughput": 594.782, "synch_weights_time_ms": 23.342}, "counters": {"num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "done": false, "training_iteration": 191, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-05", "timestamp": 1744167485, "time_this_iter_s": 2.9436442852020264, "time_total_s": 474.0798816680908, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC31A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.0798816680908, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 48.599999999999994, "ram_util_percent": 97.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.687296935915947, "cur_kl_coeff": 6.372367644529809e-59, "cur_lr": 1e-07, "total_loss": 2.1465835720300674, "policy_loss": -0.00010462623904459179, "vf_loss": 9.800969278812408, "vf_explained_var": -8.751489222049713e-05, "kl": 1.3771663100597964e-06, "entropy": 3.0355411753058434, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "env_runners": {"episode_reward_max": 122.38817916279888, "episode_reward_min": 72.98575963914149, "episode_reward_mean": 94.05205814692518, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.98575963914149}, "policy_reward_max": {"tplp_policy": 122.38817916279888}, "policy_reward_mean": {"tplp_policy": 94.05205814692518}, "custom_metrics": {"mean_episode_reward_mean": 94.05205814692518, "mean_episode_reward_min": 72.98575963914149, "mean_episode_reward_max": 122.38817916279888}, "hist_stats": {"episode_reward": [115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [115.97351694555154, 91.64437916809477, 100.86860828852943, 81.10305265644297, 95.49423468602532, 86.90601796312295, 82.13270511232194, 79.82210965028995, 77.8942788183446, 94.62082403102612, 92.3395783471096, 89.61948426381058, 102.03639232512587, 84.4287346761736, 92.83748858127161, 103.94413274269972, 92.95446373760015, 101.63499679576356, 100.73335277151396, 90.86772620077232, 83.65509538762811, 97.78994514214995, 88.9956967899924, 103.49002896620118, 91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7164301995592597, "mean_inference_ms": 2.065707731139248, "mean_action_processing_ms": 0.39220244605720966, "mean_env_wait_ms": 2.299417361522897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.004990577697753906, "ViewRequirementAgentConnector_ms": 0.20692062377929688}, "num_episodes": 18, "episode_return_max": 122.38817916279888, "episode_return_min": 72.98575963914149, "episode_return_mean": 94.05205814692518, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 419.47988551774466, "num_env_steps_trained_throughput_per_sec": 419.47988551774466, "timesteps_total": 196608, "num_env_steps_sampled_lifetime": 196608, "num_agent_steps_sampled_lifetime": 196608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 196608, "timers": {"training_iteration_time_ms": 2765.13, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2765.13, "sample_time_ms": 1137.951, "learn_time_ms": 1605.447, "learn_throughput": 637.829, "synch_weights_time_ms": 21.215}, "counters": {"num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "done": false, "training_iteration": 192, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-07", "timestamp": 1744167487, "time_this_iter_s": 2.4474997520446777, "time_total_s": 476.5273814201355, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 476.5273814201355, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 37.9, "ram_util_percent": 97.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5271059613674876, "cur_kl_coeff": 3.1861838222649043e-59, "cur_lr": 1e-07, "total_loss": 2.1119386948645116, "policy_loss": -0.00033415156649425627, "vf_loss": 9.663297486305236, "vf_explained_var": -9.092390537261963e-05, "kl": 2.2187389540906377e-06, "entropy": 3.035515142977238, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "env_runners": {"episode_reward_max": 122.38817916279888, "episode_reward_min": 72.98575963914149, "episode_reward_mean": 94.1134293927153, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.98575963914149}, "policy_reward_max": {"tplp_policy": 122.38817916279888}, "policy_reward_mean": {"tplp_policy": 94.1134293927153}, "custom_metrics": {"mean_episode_reward_mean": 94.1134293927153, "mean_episode_reward_min": 72.98575963914149, "mean_episode_reward_max": 122.38817916279888}, "hist_stats": {"episode_reward": [91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [91.64310425023089, 85.6387029449656, 94.12164413717328, 97.75891999592442, 91.18842317066049, 91.46897514300234, 104.11916263594628, 97.41708730671999, 95.79349686559564, 88.8428898064017, 92.11155410475324, 96.65725780369407, 104.20084253042604, 95.16378414068512, 88.1129247605339, 100.6489563861129, 106.81696490004755, 87.03640561938217, 87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7168596118178676, "mean_inference_ms": 2.0669099007489358, "mean_action_processing_ms": 0.3923214655330557, "mean_env_wait_ms": 2.3006775556614074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02561044692993164, "StateBufferConnector_ms": 0.008980989456176758, "ViewRequirementAgentConnector_ms": 0.21737194061279297}, "num_episodes": 24, "episode_return_max": 122.38817916279888, "episode_return_min": 72.98575963914149, "episode_return_mean": 94.1134293927153, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 404.3847595403518, "num_env_steps_trained_throughput_per_sec": 404.3847595403518, "timesteps_total": 197632, "num_env_steps_sampled_lifetime": 197632, "num_agent_steps_sampled_lifetime": 197632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 197632, "timers": {"training_iteration_time_ms": 2685.751, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2685.751, "sample_time_ms": 1103.521, "learn_time_ms": 1560.819, "learn_throughput": 656.066, "synch_weights_time_ms": 20.995}, "counters": {"num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "done": false, "training_iteration": 193, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-10", "timestamp": 1744167490, "time_this_iter_s": 2.5391685962677, "time_total_s": 479.0665500164032, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A8E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.0665500164032, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 34.15, "ram_util_percent": 97.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.822752019390464, "cur_kl_coeff": 1.5930919111324521e-59, "cur_lr": 1e-07, "total_loss": 2.1508708491921427, "policy_loss": -0.00020106604788452386, "vf_loss": 9.818195140361786, "vf_explained_var": -0.00018187761306762696, "kl": 1.507657469046464e-06, "entropy": 3.0347684532403947, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "env_runners": {"episode_reward_max": 122.38817916279888, "episode_reward_min": 72.98575963914149, "episode_reward_mean": 95.11985668383566, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.98575963914149}, "policy_reward_max": {"tplp_policy": 122.38817916279888}, "policy_reward_mean": {"tplp_policy": 95.11985668383566}, "custom_metrics": {"mean_episode_reward_mean": 95.11985668383566, "mean_episode_reward_min": 72.98575963914149, "mean_episode_reward_max": 122.38817916279888}, "hist_stats": {"episode_reward": [87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.81399598620314, 98.07899865870563, 91.6889362666172, 91.1422531883016, 85.63537668096957, 87.56591207342831, 90.40701446331893, 92.91458161941213, 78.96296627296957, 109.89210588387816, 105.57903448729368, 95.44254190710792, 92.5892443177972, 99.81546806968569, 85.07071187182116, 122.38817916279888, 83.19682633315819, 92.8056246362114, 95.49730999755819, 81.15219722468998, 83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.717283357889131, "mean_inference_ms": 2.0677674199417124, "mean_action_processing_ms": 0.39256319572252046, "mean_env_wait_ms": 2.301284894904125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026604175567626953, "StateBufferConnector_ms": 0.011184930801391602, "ViewRequirementAgentConnector_ms": 0.2258296012878418}, "num_episodes": 18, "episode_return_max": 122.38817916279888, "episode_return_min": 72.98575963914149, "episode_return_mean": 95.11985668383566, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 410.89442936757075, "num_env_steps_trained_throughput_per_sec": 410.89442936757075, "timesteps_total": 198656, "num_env_steps_sampled_lifetime": 198656, "num_agent_steps_sampled_lifetime": 198656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 198656, "timers": {"training_iteration_time_ms": 2620.094, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2620.094, "sample_time_ms": 1073.593, "learn_time_ms": 1525.357, "learn_throughput": 671.318, "synch_weights_time_ms": 20.928}, "counters": {"num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "done": false, "training_iteration": 194, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-12", "timestamp": 1744167492, "time_this_iter_s": 2.4984898567199707, "time_total_s": 481.56503987312317, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 481.56503987312317, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 51.86666666666667, "ram_util_percent": 97.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.034964326024055, "cur_kl_coeff": 7.965459555662261e-60, "cur_lr": 1e-07, "total_loss": 2.1323264919221403, "policy_loss": -0.0003409824799746275, "vf_loss": 9.744834280014038, "vf_explained_var": -0.00014678426086902618, "kl": 2.922822622017374e-06, "entropy": 3.035410888493061, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "env_runners": {"episode_reward_max": 116.0087348841481, "episode_reward_min": 72.98575963914149, "episode_reward_mean": 96.9806275365296, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 72.98575963914149}, "policy_reward_max": {"tplp_policy": 116.0087348841481}, "policy_reward_mean": {"tplp_policy": 96.9806275365296}, "custom_metrics": {"mean_episode_reward_mean": 96.9806275365296, "mean_episode_reward_min": 72.98575963914149, "mean_episode_reward_max": 116.0087348841481}, "hist_stats": {"episode_reward": [83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.10712527217383, 111.5749073470909, 97.23243236288268, 94.55430354203523, 104.98334943890744, 93.26358500164677, 94.25412653041376, 72.98575963914149, 96.72808437077231, 84.82173222162706, 90.53302741505185, 104.45041092194795, 90.89808394385425, 103.1092802482655, 110.63840161049778, 110.78134347399197, 88.0844657731025, 88.6131599814234, 78.52731731618012, 92.03532862595107, 98.76302416897082, 90.98688440525538, 108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7177336675697229, "mean_inference_ms": 2.0688448336229834, "mean_action_processing_ms": 0.3927018618242255, "mean_env_wait_ms": 2.302085815484462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027606725692749023, "StateBufferConnector_ms": 0.012181997299194336, "ViewRequirementAgentConnector_ms": 0.24863672256469727}, "num_episodes": 20, "episode_return_max": 116.0087348841481, "episode_return_min": 72.98575963914149, "episode_return_mean": 96.9806275365296, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 416.74936667198403, "num_env_steps_trained_throughput_per_sec": 416.74936667198403, "timesteps_total": 199680, "num_env_steps_sampled_lifetime": 199680, "num_agent_steps_sampled_lifetime": 199680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 199680, "timers": {"training_iteration_time_ms": 2616.393, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2616.393, "sample_time_ms": 1075.694, "learn_time_ms": 1519.493, "learn_throughput": 673.909, "synch_weights_time_ms": 21.106}, "counters": {"num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "done": false, "training_iteration": 195, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-15", "timestamp": 1744167495, "time_this_iter_s": 2.463653087615967, "time_total_s": 484.02869296073914, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 484.02869296073914, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 37.224999999999994, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950932531803846, "cur_kl_coeff": 3.9827297778311304e-60, "cur_lr": 1e-07, "total_loss": 2.13223283290863, "policy_loss": -0.00017605425673536957, "vf_loss": 9.74442201256752, "vf_explained_var": -0.00018105730414390563, "kl": 1.9931836773914857e-06, "entropy": 3.03696601241827, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "env_runners": {"episode_reward_max": 122.80285286719787, "episode_reward_min": 73.0089387799107, "episode_reward_mean": 97.1542316215766, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.0089387799107}, "policy_reward_max": {"tplp_policy": 122.80285286719787}, "policy_reward_mean": {"tplp_policy": 97.1542316215766}, "custom_metrics": {"mean_episode_reward_mean": 97.1542316215766, "mean_episode_reward_min": 73.0089387799107, "mean_episode_reward_max": 122.80285286719787}, "hist_stats": {"episode_reward": [108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [108.23763887134578, 104.2530322504658, 112.46907160225506, 101.67472828372816, 91.00822429296521, 93.97581721238272, 99.53085149878271, 86.2566687765009, 90.34496457273279, 87.73536310155495, 90.69510112282457, 99.58290452251566, 86.13570056442735, 94.56325294490165, 87.16666342388801, 82.48247838831779, 78.15944938244482, 109.03616896680188, 85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7179447563273897, "mean_inference_ms": 2.0692646733910927, "mean_action_processing_ms": 0.3926677101144183, "mean_env_wait_ms": 2.3022031380417314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011985540390014648, "StateBufferConnector_ms": 0.011185407638549805, "ViewRequirementAgentConnector_ms": 0.24697375297546387}, "num_episodes": 22, "episode_return_max": 122.80285286719787, "episode_return_min": 73.0089387799107, "episode_return_mean": 97.1542316215766, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 449.3739316563484, "num_env_steps_trained_throughput_per_sec": 449.3739316563484, "timesteps_total": 200704, "num_env_steps_sampled_lifetime": 200704, "num_agent_steps_sampled_lifetime": 200704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 200704, "timers": {"training_iteration_time_ms": 2567.89, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2567.89, "sample_time_ms": 1061.025, "learn_time_ms": 1485.911, "learn_throughput": 689.14, "synch_weights_time_ms": 20.955}, "counters": {"num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "done": false, "training_iteration": 196, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-17", "timestamp": 1744167497, "time_this_iter_s": 2.2878522872924805, "time_total_s": 486.3165452480316, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 486.3165452480316, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 37.199999999999996, "ram_util_percent": 97.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.634924355894327, "cur_kl_coeff": 1.9913648889155652e-60, "cur_lr": 1e-07, "total_loss": 2.094596993178129, "policy_loss": -0.00042349203140474857, "vf_loss": 9.595274144411087, "vf_explained_var": -0.00019368380308151245, "kl": 2.9872477854464562e-06, "entropy": 3.0379804939031603, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "env_runners": {"episode_reward_max": 122.80285286719787, "episode_reward_min": 73.0089387799107, "episode_reward_mean": 96.67333570544658, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.0089387799107}, "policy_reward_max": {"tplp_policy": 122.80285286719787}, "policy_reward_mean": {"tplp_policy": 96.67333570544658}, "custom_metrics": {"mean_episode_reward_mean": 96.67333570544658, "mean_episode_reward_min": 73.0089387799107, "mean_episode_reward_max": 122.80285286719787}, "hist_stats": {"episode_reward": [85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.87067303643023, 88.1070607478472, 102.53880744756911, 87.80200514921965, 101.06643938441054, 105.53958765596155, 111.0967597249099, 93.93024538637941, 79.09249768368548, 101.47706200442576, 79.59662022545696, 90.51770389610547, 89.74485942216207, 78.5362842720619, 114.22774786771723, 73.0089387799107, 97.37250043025061, 89.62959724275262, 85.1958118935996, 103.79227674050532, 103.18630230656741, 89.39856897939896, 100.40996480393882, 88.80636363158132, 107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7181351358998085, "mean_inference_ms": 2.0697087518825943, "mean_action_processing_ms": 0.39270734709933414, "mean_env_wait_ms": 2.302531877905311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012983083724975586, "StateBufferConnector_ms": 0.011461019515991211, "ViewRequirementAgentConnector_ms": 0.23672199249267578}, "num_episodes": 18, "episode_return_max": 122.80285286719787, "episode_return_min": 73.0089387799107, "episode_return_mean": 96.67333570544658, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 393.0830489675382, "num_env_steps_trained_throughput_per_sec": 393.0830489675382, "timesteps_total": 201728, "num_env_steps_sampled_lifetime": 201728, "num_agent_steps_sampled_lifetime": 201728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 201728, "timers": {"training_iteration_time_ms": 2531.256, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2531.256, "sample_time_ms": 1042.998, "learn_time_ms": 1466.893, "learn_throughput": 698.074, "synch_weights_time_ms": 21.365}, "counters": {"num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "done": false, "training_iteration": 197, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-20", "timestamp": 1744167500, "time_this_iter_s": 2.613093614578247, "time_total_s": 488.92963886260986, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AC00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.92963886260986, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 40.324999999999996, "ram_util_percent": 97.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2199600234627725, "cur_kl_coeff": 9.956824444577826e-61, "cur_lr": 1e-07, "total_loss": 2.092604488134384, "policy_loss": -0.00033841898548416796, "vf_loss": 9.587255305051803, "vf_explained_var": -0.00013925619423389436, "kl": 3.1619558518602988e-06, "entropy": 3.038709169626236, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "env_runners": {"episode_reward_max": 122.80285286719787, "episode_reward_min": 73.5816138540364, "episode_reward_mean": 97.20011024459042, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.5816138540364}, "policy_reward_max": {"tplp_policy": 122.80285286719787}, "policy_reward_mean": {"tplp_policy": 97.20011024459042}, "custom_metrics": {"mean_episode_reward_mean": 97.20011024459042, "mean_episode_reward_min": 73.5816138540364, "mean_episode_reward_max": 122.80285286719787}, "hist_stats": {"episode_reward": [107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [107.55799194661569, 91.88697415263911, 97.98718819241478, 116.0087348841481, 104.98089046951787, 105.08612563503335, 104.95050474860581, 105.98105417644129, 87.81782990783312, 101.12073245214079, 108.50715230478397, 97.80948083248364, 106.50017777392739, 105.04818838725826, 85.32299256680123, 93.60147874812682, 95.62755221008143, 100.73211526937511, 110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7183588047841484, "mean_inference_ms": 2.0703511922060485, "mean_action_processing_ms": 0.3927729894804132, "mean_env_wait_ms": 2.3029571912455338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008877277374267578, "StateBufferConnector_ms": 0.007471561431884766, "ViewRequirementAgentConnector_ms": 0.21924972534179688}, "num_episodes": 24, "episode_return_max": 122.80285286719787, "episode_return_min": 73.5816138540364, "episode_return_mean": 97.20011024459042, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.46052344510883, "num_env_steps_trained_throughput_per_sec": 437.46052344510883, "timesteps_total": 202752, "num_env_steps_sampled_lifetime": 202752, "num_agent_steps_sampled_lifetime": 202752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 202752, "timers": {"training_iteration_time_ms": 2517.308, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2517.308, "sample_time_ms": 1031.808, "learn_time_ms": 1464.474, "learn_throughput": 699.227, "synch_weights_time_ms": 21.026}, "counters": {"num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "done": false, "training_iteration": 198, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-22", "timestamp": 1744167502, "time_this_iter_s": 2.3463497161865234, "time_total_s": 491.2759885787964, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 491.2759885787964, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 48.73333333333333, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8317764550447464, "cur_kl_coeff": 4.978412222288913e-61, "cur_lr": 1e-07, "total_loss": 2.1387324117124082, "policy_loss": -0.00017975205555558204, "vf_loss": 9.771840661764145, "vf_explained_var": -0.00010979212820529937, "kl": 2.125855351486905e-06, "entropy": 3.040480023622513, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "env_runners": {"episode_reward_max": 122.80285286719787, "episode_reward_min": 73.5816138540364, "episode_reward_mean": 96.56916740821434, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.5816138540364}, "policy_reward_max": {"tplp_policy": 122.80285286719787}, "policy_reward_mean": {"tplp_policy": 96.56916740821434}, "custom_metrics": {"mean_episode_reward_mean": 96.56916740821434, "mean_episode_reward_min": 73.5816138540364, "mean_episode_reward_max": 122.80285286719787}, "hist_stats": {"episode_reward": [110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [110.54980494527399, 106.10118165233318, 111.78854602382229, 102.89632952260618, 101.96877182708202, 86.30508294460748, 85.44888581411534, 93.41645367479357, 115.4509029296535, 96.33979333799884, 101.16150044958988, 105.00327853000047, 114.71263035596004, 103.12352498365284, 93.21561311415009, 110.4790476232025, 108.41491321652309, 110.98043594649563, 104.22061750607654, 87.1452732703046, 122.80285286719787, 100.39468746051725, 95.6210408029384, 104.2074025810361, 80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.718451509533945, "mean_inference_ms": 2.0707724678311474, "mean_action_processing_ms": 0.3928166292113813, "mean_env_wait_ms": 2.303116780178895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008875846862792969, "StateBufferConnector_ms": 0.0064580440521240234, "ViewRequirementAgentConnector_ms": 0.21980619430541992}, "num_episodes": 18, "episode_return_max": 122.80285286719787, "episode_return_min": 73.5816138540364, "episode_return_mean": 96.56916740821434, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 413.9383596273736, "num_env_steps_trained_throughput_per_sec": 413.9383596273736, "timesteps_total": 203776, "num_env_steps_sampled_lifetime": 203776, "num_agent_steps_sampled_lifetime": 203776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 203776, "timers": {"training_iteration_time_ms": 2520.324, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2520.324, "sample_time_ms": 1027.161, "learn_time_ms": 1472.649, "learn_throughput": 695.346, "synch_weights_time_ms": 20.514}, "counters": {"num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "done": false, "training_iteration": 199, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-25", "timestamp": 1744167505, "time_this_iter_s": 2.4799177646636963, "time_total_s": 493.7559063434601, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.7559063434601, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 97.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5794835463166237, "cur_kl_coeff": 2.4892061111444565e-61, "cur_lr": 1e-07, "total_loss": 2.1268688432872294, "policy_loss": -9.18747071409598e-05, "vf_loss": 9.724540543556213, "vf_explained_var": -0.00017661787569522858, "kl": 1.0065634830525027e-06, "entropy": 3.0417441233992575, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "env_runners": {"episode_reward_max": 124.76811262334442, "episode_reward_min": 73.5816138540364, "episode_reward_mean": 95.63491358954745, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.5816138540364}, "policy_reward_max": {"tplp_policy": 124.76811262334442}, "policy_reward_mean": {"tplp_policy": 95.63491358954745}, "custom_metrics": {"mean_episode_reward_mean": 95.63491358954745, "mean_episode_reward_min": 73.5816138540364, "mean_episode_reward_max": 124.76811262334442}, "hist_stats": {"episode_reward": [80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [80.40604843256969, 107.41771164022585, 79.47382565633376, 94.03309445603875, 92.70035213821009, 89.1193186525369, 104.35628958883129, 92.66022180980673, 94.09605465249255, 76.32872266789623, 92.46106316082322, 94.21298074786104, 98.19888905509862, 97.17774518087833, 97.05919719003656, 94.19315259817998, 80.63665854304234, 73.5816138540364, 97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7184992385336586, "mean_inference_ms": 2.0713116140361048, "mean_action_processing_ms": 0.3927776478674353, "mean_env_wait_ms": 2.303733142673237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009882926940917969, "StateBufferConnector_ms": 0.009170770645141602, "ViewRequirementAgentConnector_ms": 0.21565985679626465}, "num_episodes": 24, "episode_return_max": 124.76811262334442, "episode_return_min": 73.5816138540364, "episode_return_mean": 95.63491358954745, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 402.7174300150071, "num_env_steps_trained_throughput_per_sec": 402.7174300150071, "timesteps_total": 204800, "num_env_steps_sampled_lifetime": 204800, "num_agent_steps_sampled_lifetime": 204800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 2510.111, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2510.111, "sample_time_ms": 1030.61, "learn_time_ms": 1458.813, "learn_throughput": 701.94, "synch_weights_time_ms": 20.687}, "counters": {"num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "training_iteration": 200, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-27", "timestamp": 1744167507, "time_this_iter_s": 2.5516741275787354, "time_total_s": 496.3075804710388, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1A340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.3075804710388, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 41.25, "ram_util_percent": 97.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8359136074781417, "cur_kl_coeff": 1.2446030555722282e-61, "cur_lr": 1e-07, "total_loss": 2.132142248004675, "policy_loss": -0.00020581285934895277, "vf_loss": 9.746650230884551, "vf_explained_var": -0.00018167681992053986, "kl": 2.8205722230556508e-06, "entropy": 3.0431448370218277, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "env_runners": {"episode_reward_max": 124.76811262334442, "episode_reward_min": 81.1066987839765, "episode_reward_mean": 97.06686221190914, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 81.1066987839765}, "policy_reward_max": {"tplp_policy": 124.76811262334442}, "policy_reward_mean": {"tplp_policy": 97.06686221190914}, "custom_metrics": {"mean_episode_reward_mean": 97.06686221190914, "mean_episode_reward_min": 81.1066987839765, "mean_episode_reward_max": 124.76811262334442}, "hist_stats": {"episode_reward": [97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.92962599298745, 92.42728648215464, 84.43756755512977, 105.29808936409009, 93.6986672651785, 97.60761980709773, 100.20600760628679, 88.49939587335959, 100.71303829218506, 86.51901164453731, 82.63830776709412, 104.25915805120951, 82.4423631721843, 94.52744709466045, 106.97072200166593, 82.82590779892955, 99.39068180742281, 102.79525792797494, 96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7186430748333215, "mean_inference_ms": 2.0718343928696474, "mean_action_processing_ms": 0.3929667720928996, "mean_env_wait_ms": 2.303959689743103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009427070617675781, "StateBufferConnector_ms": 0.009232759475708008, "ViewRequirementAgentConnector_ms": 0.2062234878540039}, "num_episodes": 18, "episode_return_max": 124.76811262334442, "episode_return_min": 81.1066987839765, "episode_return_mean": 97.06686221190914, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 384.95583783475166, "num_env_steps_trained_throughput_per_sec": 384.95583783475166, "timesteps_total": 205824, "num_env_steps_sampled_lifetime": 205824, "num_agent_steps_sampled_lifetime": 205824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 205824, "timers": {"training_iteration_time_ms": 2482.372, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2482.372, "sample_time_ms": 997.035, "learn_time_ms": 1464.595, "learn_throughput": 699.17, "synch_weights_time_ms": 20.743}, "counters": {"num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "done": false, "training_iteration": 201, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-30", "timestamp": 1744167510, "time_this_iter_s": 2.666764974594116, "time_total_s": 498.97434544563293, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.97434544563293, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 43.699999999999996, "ram_util_percent": 97.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.769480164349079, "cur_kl_coeff": 6.223015277861141e-62, "cur_lr": 1e-07, "total_loss": 2.126407965272665, "policy_loss": -0.00020465964335016906, "vf_loss": 9.724153155088425, "vf_explained_var": -0.0001474078744649887, "kl": 1.4923659231280695e-06, "entropy": 3.0442567959427835, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "env_runners": {"episode_reward_max": 124.76811262334442, "episode_reward_min": 73.88417954382828, "episode_reward_mean": 97.13936328065228, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.88417954382828}, "policy_reward_max": {"tplp_policy": 124.76811262334442}, "policy_reward_mean": {"tplp_policy": 97.13936328065228}, "custom_metrics": {"mean_episode_reward_mean": 97.13936328065228, "mean_episode_reward_min": 73.88417954382828, "mean_episode_reward_max": 124.76811262334442}, "hist_stats": {"episode_reward": [96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [96.28759498352689, 99.35194923793593, 97.52887370679122, 104.40345339330261, 98.40228889415381, 102.27269787714312, 106.42696426291843, 91.91449818190702, 96.38619480935054, 88.6949846686306, 95.18603373379139, 88.06897719030958, 88.41584729710995, 89.16490879367836, 88.20574261881214, 101.16233794263691, 101.93352721724519, 97.43369183194623, 84.01893559557118, 100.19063455042918, 83.02747223953281, 91.95858386511034, 93.56670942800226, 105.53058849300375, 102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187593248932745, "mean_inference_ms": 2.072469792731244, "mean_action_processing_ms": 0.3930644015513209, "mean_env_wait_ms": 2.304490870071395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011743307113647461, "StateBufferConnector_ms": 0.013207197189331055, "ViewRequirementAgentConnector_ms": 0.2160933017730713}, "num_episodes": 18, "episode_return_max": 124.76811262334442, "episode_return_min": 73.88417954382828, "episode_return_mean": 97.13936328065228, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.7692864978175, "num_env_steps_trained_throughput_per_sec": 422.7692864978175, "timesteps_total": 206848, "num_env_steps_sampled_lifetime": 206848, "num_agent_steps_sampled_lifetime": 206848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 206848, "timers": {"training_iteration_time_ms": 2480.473, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2480.473, "sample_time_ms": 1009.708, "learn_time_ms": 1449.988, "learn_throughput": 706.213, "synch_weights_time_ms": 20.776}, "counters": {"num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "done": false, "training_iteration": 202, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-32", "timestamp": 1744167512, "time_this_iter_s": 2.428243398666382, "time_total_s": 501.4025888442993, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 501.4025888442993, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 43.53333333333333, "ram_util_percent": 97.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.737093637138605, "cur_kl_coeff": 3.1115076389305706e-62, "cur_lr": 1e-07, "total_loss": 2.1270265989005566, "policy_loss": -0.00013315054820850492, "vf_loss": 9.726444053649903, "vf_explained_var": -0.00011089406907558442, "kl": 1.9860740978039358e-06, "entropy": 3.044512589275837, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "env_runners": {"episode_reward_max": 124.76811262334442, "episode_reward_min": 73.88417954382828, "episode_reward_mean": 97.71168849183522, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.88417954382828}, "policy_reward_max": {"tplp_policy": 124.76811262334442}, "policy_reward_mean": {"tplp_policy": 97.71168849183522}, "custom_metrics": {"mean_episode_reward_mean": 97.71168849183522, "mean_episode_reward_min": 73.88417954382828, "mean_episode_reward_max": 124.76811262334442}, "hist_stats": {"episode_reward": [102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.68240191304585, 94.25752612349733, 102.17094416104112, 81.1066987839765, 107.95292409723842, 89.82418027933952, 99.29450185793743, 89.34367690877795, 100.2612800722101, 96.47204465338913, 88.64475836593243, 104.27129445997363, 92.42861816327421, 117.74858011143046, 89.11873910543487, 98.75741404311762, 89.04823130815845, 98.34883233100963, 85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7189177453806554, "mean_inference_ms": 2.0734581950382465, "mean_action_processing_ms": 0.3932334175378074, "mean_env_wait_ms": 2.3055852048718015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009853363037109375, "StateBufferConnector_ms": 0.014208078384399414, "ViewRequirementAgentConnector_ms": 0.21465611457824707}, "num_episodes": 24, "episode_return_max": 124.76811262334442, "episode_return_min": 73.88417954382828, "episode_return_mean": 97.71168849183522, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 349.10420933471937, "num_env_steps_trained_throughput_per_sec": 349.10420933471937, "timesteps_total": 207872, "num_env_steps_sampled_lifetime": 207872, "num_agent_steps_sampled_lifetime": 207872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 207872, "timers": {"training_iteration_time_ms": 2520.571, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2520.571, "sample_time_ms": 1017.911, "learn_time_ms": 1481.773, "learn_throughput": 691.064, "synch_weights_time_ms": 20.887}, "counters": {"num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "done": false, "training_iteration": 203, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-35", "timestamp": 1744167515, "time_this_iter_s": 2.941581964492798, "time_total_s": 504.3441708087921, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2C83D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 504.3441708087921, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 41.175, "ram_util_percent": 97.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5780279241502284, "cur_kl_coeff": 1.5557538194652853e-62, "cur_lr": 1e-07, "total_loss": 2.139630617201328, "policy_loss": -0.00012667914852499963, "vf_loss": 9.777633136510849, "vf_explained_var": -0.00013925731182098388, "kl": 2.570064409535e-06, "entropy": 3.0465098187327384, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "env_runners": {"episode_reward_max": 124.76811262334442, "episode_reward_min": 73.88417954382828, "episode_reward_mean": 98.08403525318948, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.88417954382828}, "policy_reward_max": {"tplp_policy": 124.76811262334442}, "policy_reward_mean": {"tplp_policy": 98.08403525318948}, "custom_metrics": {"mean_episode_reward_mean": 98.08403525318948, "mean_episode_reward_min": 73.88417954382828, "mean_episode_reward_max": 124.76811262334442}, "hist_stats": {"episode_reward": [85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.92860171251495, 102.23672060619809, 87.65813864072551, 98.85666497979354, 96.76384581912866, 82.28536649266786, 110.25147020614297, 90.1858404590996, 99.12329064141339, 85.25729931249245, 96.64311817643109, 88.06631571501651, 104.36632088934573, 88.32666414656524, 108.2450960926302, 110.31856217239189, 102.52496764107161, 99.84142079464227, 117.65547922613894, 124.76811262334442, 100.46670621608976, 111.1561233102307, 90.86124282202424, 92.54246344497528, 95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190852776092682, "mean_inference_ms": 2.0743666367265, "mean_action_processing_ms": 0.39341462296689905, "mean_env_wait_ms": 2.306749219469927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009853839874267578, "StateBufferConnector_ms": 0.013017654418945312, "ViewRequirementAgentConnector_ms": 0.22054505348205566}, "num_episodes": 18, "episode_return_max": 124.76811262334442, "episode_return_min": 73.88417954382828, "episode_return_mean": 98.08403525318948, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.07864637731586, "num_env_steps_trained_throughput_per_sec": 318.07864637731586, "timesteps_total": 208896, "num_env_steps_sampled_lifetime": 208896, "num_agent_steps_sampled_lifetime": 208896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 208896, "timers": {"training_iteration_time_ms": 2593.291, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2593.291, "sample_time_ms": 1026.352, "learn_time_ms": 1544.184, "learn_throughput": 663.134, "synch_weights_time_ms": 22.704}, "counters": {"num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "done": false, "training_iteration": 204, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-39", "timestamp": 1744167519, "time_this_iter_s": 3.2329185009002686, "time_total_s": 507.5770893096924, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B7E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 507.5770893096924, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 50.0, "ram_util_percent": 97.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.805218718200922, "cur_kl_coeff": 7.778769097326426e-63, "cur_lr": 1e-07, "total_loss": 2.133611422032118, "policy_loss": -0.00011748773977160454, "vf_loss": 9.75447170138359, "vf_explained_var": -7.082819938659668e-05, "kl": 2.3798391318191616e-06, "entropy": 3.0488901004195212, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "env_runners": {"episode_reward_max": 120.8196120379183, "episode_reward_min": 73.88417954382828, "episode_reward_mean": 98.21185008739413, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.88417954382828}, "policy_reward_max": {"tplp_policy": 120.8196120379183}, "policy_reward_mean": {"tplp_policy": 98.21185008739413}, "custom_metrics": {"mean_episode_reward_mean": 98.21185008739413, "mean_episode_reward_min": 73.88417954382828, "mean_episode_reward_max": 120.8196120379183}, "hist_stats": {"episode_reward": [95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.6297810451695, 92.52730593668299, 119.781483636321, 88.78659294594912, 105.65340402424404, 105.2194158064008, 105.37790257376486, 103.17549108131374, 98.68307412932752, 82.86584978530003, 116.44405998898652, 81.22874332478168, 93.7819729177537, 113.30260810762145, 103.01841734740643, 92.42799334304064, 90.90843406639965, 85.35487868903625, 95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7195399751888462, "mean_inference_ms": 2.0762777617811317, "mean_action_processing_ms": 0.39377735059746954, "mean_env_wait_ms": 2.3089789243677115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007844686508178711, "StateBufferConnector_ms": 0.014661788940429688, "ViewRequirementAgentConnector_ms": 0.23473191261291504}, "num_episodes": 24, "episode_return_max": 120.8196120379183, "episode_return_min": 73.88417954382828, "episode_return_mean": 98.21185008739413, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 342.5917808774261, "num_env_steps_trained_throughput_per_sec": 342.5917808774261, "timesteps_total": 209920, "num_env_steps_sampled_lifetime": 209920, "num_agent_steps_sampled_lifetime": 209920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 209920, "timers": {"training_iteration_time_ms": 2646.478, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2646.478, "sample_time_ms": 1055.343, "learn_time_ms": 1568.469, "learn_throughput": 652.866, "synch_weights_time_ms": 22.615}, "counters": {"num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "done": false, "training_iteration": 205, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-42", "timestamp": 1744167522, "time_this_iter_s": 2.9953715801239014, "time_total_s": 510.5724608898163, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19B20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 510.5724608898163, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 54.77499999999999, "ram_util_percent": 97.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.131899465993047, "cur_kl_coeff": 3.889384548663213e-63, "cur_lr": 1e-07, "total_loss": 2.1406753696501255, "policy_loss": -0.0001190933573525399, "vf_loss": 9.783490800857544, "vf_explained_var": -0.000132804736495018, "kl": 1.5412986887231028e-06, "entropy": 3.0507822930812836, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "env_runners": {"episode_reward_max": 120.8196120379183, "episode_reward_min": 73.88417954382828, "episode_reward_mean": 98.18574216721532, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.88417954382828}, "policy_reward_max": {"tplp_policy": 120.8196120379183}, "policy_reward_mean": {"tplp_policy": 98.18574216721532}, "custom_metrics": {"mean_episode_reward_mean": 98.18574216721532, "mean_episode_reward_min": 73.88417954382828, "mean_episode_reward_max": 120.8196120379183}, "hist_stats": {"episode_reward": [95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.47881446470474, 106.09140129724679, 95.85491599739424, 85.5229953424043, 105.93402258596788, 101.53760449686669, 99.40700228386238, 110.91376910924069, 99.91768234902977, 111.68972501659145, 79.77998885907294, 95.26986037295971, 73.88417954382828, 81.12988339562784, 111.3149163464832, 80.44618816174692, 90.09056213022549, 116.62218093523443, 94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7199395544740474, "mean_inference_ms": 2.077808249602876, "mean_action_processing_ms": 0.39407022855745893, "mean_env_wait_ms": 2.3105816384447606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010305643081665039, "StateBufferConnector_ms": 0.015596628189086914, "ViewRequirementAgentConnector_ms": 0.24502229690551758}, "num_episodes": 18, "episode_return_max": 120.8196120379183, "episode_return_min": 73.88417954382828, "episode_return_mean": 98.18574216721532, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 378.8723716135543, "num_env_steps_trained_throughput_per_sec": 378.8723716135543, "timesteps_total": 210944, "num_env_steps_sampled_lifetime": 210944, "num_agent_steps_sampled_lifetime": 210944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 210944, "timers": {"training_iteration_time_ms": 2688.881, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2688.881, "sample_time_ms": 1066.882, "learn_time_ms": 1599.595, "learn_throughput": 640.162, "synch_weights_time_ms": 22.353}, "counters": {"num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "done": false, "training_iteration": 206, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-45", "timestamp": 1744167525, "time_this_iter_s": 2.710381269454956, "time_total_s": 513.2828421592712, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.2828421592712, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 35.875, "ram_util_percent": 97.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.128340053930879, "cur_kl_coeff": 1.9446922743316066e-63, "cur_lr": 1e-07, "total_loss": 2.140595106780529, "policy_loss": -0.00029153612558729947, "vf_loss": 9.784383189678191, "vf_explained_var": -0.00010348595678806305, "kl": 3.5058260109049887e-06, "entropy": 3.052091437578201, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "env_runners": {"episode_reward_max": 120.8196120379183, "episode_reward_min": 69.15863186366587, "episode_reward_mean": 97.96109514100309, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 69.15863186366587}, "policy_reward_max": {"tplp_policy": 120.8196120379183}, "policy_reward_mean": {"tplp_policy": 97.96109514100309}, "custom_metrics": {"mean_episode_reward_mean": 97.96109514100309, "mean_episode_reward_min": 69.15863186366587, "mean_episode_reward_max": 120.8196120379183}, "hist_stats": {"episode_reward": [94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [94.66746475433344, 82.86761190634363, 99.59809506177524, 93.25013594666899, 96.86934254498009, 104.95594386361456, 93.49721460611087, 97.96866377061976, 102.45382615716088, 91.17157485428191, 94.40325760923696, 111.16908808536279, 116.35506259940799, 90.41442562564238, 88.75674782710108, 98.76036483092108, 114.32205851698669, 89.0121447997823, 91.19494546915212, 114.3329846943157, 98.55007691593602, 75.4822384259388, 81.17520326494964, 107.3085910599366, 106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720353793075292, "mean_inference_ms": 2.0793066724158407, "mean_action_processing_ms": 0.394331577154302, "mean_env_wait_ms": 2.3121622301427593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010754823684692383, "StateBufferConnector_ms": 0.011340856552124023, "ViewRequirementAgentConnector_ms": 0.25078272819519043}, "num_episodes": 18, "episode_return_max": 120.8196120379183, "episode_return_min": 69.15863186366587, "episode_return_mean": 97.96109514100309, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 363.804481597113, "num_env_steps_trained_throughput_per_sec": 363.804481597113, "timesteps_total": 211968, "num_env_steps_sampled_lifetime": 211968, "num_agent_steps_sampled_lifetime": 211968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 211968, "timers": {"training_iteration_time_ms": 2709.846, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2709.846, "sample_time_ms": 1072.013, "learn_time_ms": 1615.465, "learn_throughput": 633.873, "synch_weights_time_ms": 22.317}, "counters": {"num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "done": false, "training_iteration": 207, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-48", "timestamp": 1744167528, "time_this_iter_s": 2.8230772018432617, "time_total_s": 516.1059193611145, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D187C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 516.1059193611145, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 47.325, "ram_util_percent": 97.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.662368901818991, "cur_kl_coeff": 9.723461371658033e-64, "cur_lr": 1e-07, "total_loss": 2.1105060026049616, "policy_loss": -0.0003018695919308811, "vf_loss": 9.664227670431137, "vf_explained_var": -0.0001677095890045166, "kl": 2.1285449234298426e-06, "entropy": 3.052490158379078, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "env_runners": {"episode_reward_max": 120.8196120379183, "episode_reward_min": 69.15863186366587, "episode_reward_mean": 97.49367418162952, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 69.15863186366587}, "policy_reward_max": {"tplp_policy": 120.8196120379183}, "policy_reward_mean": {"tplp_policy": 97.49367418162952}, "custom_metrics": {"mean_episode_reward_mean": 97.49367418162952, "mean_episode_reward_min": 69.15863186366587, "mean_episode_reward_max": 120.8196120379183}, "hist_stats": {"episode_reward": [106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [106.51361706437618, 102.9447165951589, 90.96780872359852, 100.32128256447929, 93.54833717704393, 120.8196120379183, 104.17591605240266, 89.47312168027305, 83.9161455895397, 116.97104525196542, 89.73086044203464, 98.93599477132645, 93.84847926352602, 99.56988898463257, 99.20788877121774, 99.53881357983302, 84.4027105891726, 117.3558629339268, 97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720963924223189, "mean_inference_ms": 2.0813886819765592, "mean_action_processing_ms": 0.39477929421450747, "mean_env_wait_ms": 2.314261265912231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011751413345336914, "StateBufferConnector_ms": 0.014616727828979492, "ViewRequirementAgentConnector_ms": 0.2517528533935547}, "num_episodes": 24, "episode_return_max": 120.8196120379183, "episode_return_min": 69.15863186366587, "episode_return_mean": 97.49367418162952, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 341.6019908031613, "num_env_steps_trained_throughput_per_sec": 341.6019908031613, "timesteps_total": 212992, "num_env_steps_sampled_lifetime": 212992, "num_agent_steps_sampled_lifetime": 212992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 212992, "timers": {"training_iteration_time_ms": 2775.532, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2775.532, "sample_time_ms": 1090.158, "learn_time_ms": 1662.082, "learn_throughput": 616.095, "synch_weights_time_ms": 23.241}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "done": false, "training_iteration": 208, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-51", "timestamp": 1744167531, "time_this_iter_s": 3.005992889404297, "time_total_s": 519.1119122505188, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 519.1119122505188, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 51.75000000000001, "ram_util_percent": 97.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8180418260395528, "cur_kl_coeff": 4.8617306858290166e-64, "cur_lr": 1e-07, "total_loss": 2.138261689245701, "policy_loss": -0.0002809301426168531, "vf_loss": 9.775362288951873, "vf_explained_var": -0.0001285061240196228, "kl": 3.1462497465994942e-06, "entropy": 3.0529795244336126, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "env_runners": {"episode_reward_max": 120.25028303261168, "episode_reward_min": 69.15863186366587, "episode_reward_mean": 97.2513082114396, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 69.15863186366587}, "policy_reward_max": {"tplp_policy": 120.25028303261168}, "policy_reward_mean": {"tplp_policy": 97.2513082114396}, "custom_metrics": {"mean_episode_reward_mean": 97.2513082114396, "mean_episode_reward_min": 69.15863186366587, "mean_episode_reward_max": 120.25028303261168}, "hist_stats": {"episode_reward": [97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.36205880126168, 103.75341293152627, 92.54282491976562, 110.83129206239688, 107.98449758137701, 117.30537532348916, 82.89414251440225, 99.01474854416024, 102.95307111778088, 104.85435386020553, 77.999899706406, 120.22400427470541, 87.93066265852448, 94.87307762806142, 91.36039976166883, 96.36892654734983, 91.90301588631922, 81.66705574491579, 120.25028303261168, 110.64918583290648, 96.70019330949786, 95.93025999910678, 93.06116431513165, 107.11953907946071, 107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.721422103041822, "mean_inference_ms": 2.0827863404698, "mean_action_processing_ms": 0.3950914007460115, "mean_env_wait_ms": 2.3156412990828796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027494430541992188, "StateBufferConnector_ms": 0.01920342445373535, "ViewRequirementAgentConnector_ms": 0.23889994621276855}, "num_episodes": 18, "episode_return_max": 120.25028303261168, "episode_return_min": 69.15863186366587, "episode_return_mean": 97.2513082114396, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 397.22788281660485, "num_env_steps_trained_throughput_per_sec": 397.22788281660485, "timesteps_total": 214016, "num_env_steps_sampled_lifetime": 214016, "num_agent_steps_sampled_lifetime": 214016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 214016, "timers": {"training_iteration_time_ms": 2785.939, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2785.939, "sample_time_ms": 1101.835, "learn_time_ms": 1661.196, "learn_throughput": 616.423, "synch_weights_time_ms": 22.857}, "counters": {"num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "done": false, "training_iteration": 209, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-53", "timestamp": 1744167533, "time_this_iter_s": 2.5829153060913086, "time_total_s": 521.6948275566101, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.6948275566101, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 44.975, "ram_util_percent": 96.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.389334548637271, "cur_kl_coeff": 2.4308653429145083e-64, "cur_lr": 1e-07, "total_loss": 2.12988042011857, "policy_loss": -0.00010451524285599589, "vf_loss": 9.741762298345567, "vf_explained_var": -0.00018867477774620056, "kl": 1.5270349184692833e-06, "entropy": 3.0545562267303468, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "env_runners": {"episode_reward_max": 119.63998866638548, "episode_reward_min": 69.15863186366587, "episode_reward_mean": 96.7738953515399, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 69.15863186366587}, "policy_reward_max": {"tplp_policy": 119.63998866638548}, "policy_reward_mean": {"tplp_policy": 96.7738953515399}, "custom_metrics": {"mean_episode_reward_mean": 96.7738953515399, "mean_episode_reward_min": 69.15863186366587, "mean_episode_reward_max": 119.63998866638548}, "hist_stats": {"episode_reward": [107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [107.85702972150435, 106.3200314880229, 106.64578719352963, 102.91145479458017, 95.65714051424159, 98.03602867739305, 84.1665010301663, 93.46067956671924, 97.41676914623017, 90.62782860596909, 95.57929693673402, 86.54441447760087, 99.23538029463035, 92.27950763518656, 109.42985329734549, 105.20820995717338, 95.30156461643152, 69.15863186366587, 101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7220044730527401, "mean_inference_ms": 2.084332583668538, "mean_action_processing_ms": 0.39535956745700956, "mean_env_wait_ms": 2.317320364858746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027979135513305664, "StateBufferConnector_ms": 0.015015840530395508, "ViewRequirementAgentConnector_ms": 0.23278045654296875}, "num_episodes": 24, "episode_return_max": 119.63998866638548, "episode_return_min": 69.15863186366587, "episode_return_mean": 96.7738953515399, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 330.235906796645, "num_env_steps_trained_throughput_per_sec": 330.235906796645, "timesteps_total": 215040, "num_env_steps_sampled_lifetime": 215040, "num_agent_steps_sampled_lifetime": 215040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 2841.748, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2841.748, "sample_time_ms": 1114.984, "learn_time_ms": 1703.438, "learn_throughput": 601.137, "synch_weights_time_ms": 23.224}, "counters": {"num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "done": false, "training_iteration": 210, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-56", "timestamp": 1744167536, "time_this_iter_s": 3.1107137203216553, "time_total_s": 524.8055412769318, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.8055412769318, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 59.825, "ram_util_percent": 96.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8743382208049297, "cur_kl_coeff": 1.2154326714572541e-64, "cur_lr": 1e-07, "total_loss": 2.119950146228075, "policy_loss": -2.772980369627476e-05, "vf_loss": 9.702279371023177, "vf_explained_var": -0.00020768903195858, "kl": 1.0129027900429577e-06, "entropy": 3.055919718742371, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "env_runners": {"episode_reward_max": 127.29274545596714, "episode_reward_min": 73.61038175685827, "episode_reward_mean": 97.58096255923584, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.61038175685827}, "policy_reward_max": {"tplp_policy": 127.29274545596714}, "policy_reward_mean": {"tplp_policy": 97.58096255923584}, "custom_metrics": {"mean_episode_reward_mean": 97.58096255923584, "mean_episode_reward_min": 73.61038175685827, "mean_episode_reward_max": 127.29274545596714}, "hist_stats": {"episode_reward": [101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.89262258628489, 95.71873349621697, 84.62620684958962, 105.15445871620547, 98.11043294917073, 95.92202190537792, 91.34932467024021, 110.77419596780753, 96.91198626413174, 91.98804209587331, 90.69544102418602, 107.46331427506267, 89.1435526790601, 88.31729968995751, 100.81597714525213, 105.07718327275168, 88.5012463111242, 95.64370476893903, 88.44627210983487, 115.58996358330842, 101.91686206901976, 86.97847396345959, 119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7224407150770218, "mean_inference_ms": 2.0854472002273137, "mean_action_processing_ms": 0.39554581551122425, "mean_env_wait_ms": 2.318851711546643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026974916458129883, "StateBufferConnector_ms": 0.015015602111816406, "ViewRequirementAgentConnector_ms": 0.2510030269622803}, "num_episodes": 18, "episode_return_max": 127.29274545596714, "episode_return_min": 73.61038175685827, "episode_return_mean": 97.58096255923584, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 347.3227676862022, "num_env_steps_trained_throughput_per_sec": 347.3227676862022, "timesteps_total": 216064, "num_env_steps_sampled_lifetime": 216064, "num_agent_steps_sampled_lifetime": 216064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 216064, "timers": {"training_iteration_time_ms": 2870.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2870.57, "sample_time_ms": 1126.637, "learn_time_ms": 1719.731, "learn_throughput": 595.442, "synch_weights_time_ms": 24.001}, "counters": {"num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "done": false, "training_iteration": 211, "trial_id": "374cd_00000", "date": "2025-04-09_10-58-59", "timestamp": 1744167539, "time_this_iter_s": 2.9556691646575928, "time_total_s": 527.7612104415894, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.7612104415894, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 57.25, "ram_util_percent": 96.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7275298204272986, "cur_kl_coeff": 6.077163357286271e-65, "cur_lr": 1e-07, "total_loss": 2.1376923993229866, "policy_loss": -0.00012892222439404578, "vf_loss": 9.77431629896164, "vf_explained_var": -0.0001051630824804306, "kl": 2.2157930593458274e-06, "entropy": 3.057577632367611, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "env_runners": {"episode_reward_max": 127.29274545596714, "episode_reward_min": 73.61038175685827, "episode_reward_mean": 98.12429771445612, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 73.61038175685827}, "policy_reward_max": {"tplp_policy": 127.29274545596714}, "policy_reward_mean": {"tplp_policy": 98.12429771445612}, "custom_metrics": {"mean_episode_reward_mean": 98.12429771445612, "mean_episode_reward_min": 73.61038175685827, "mean_episode_reward_max": 127.29274545596714}, "hist_stats": {"episode_reward": [119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [119.63998866638548, 91.66821790097995, 92.9046987745748, 113.45899825702386, 95.9031604724916, 74.8160945486849, 73.61038175685827, 80.58523190508434, 82.15481044627555, 108.49073042782666, 93.7229780080857, 93.83957373504303, 92.83673139039159, 107.42292154003833, 85.03679541626283, 97.66181750384551, 115.33241797013869, 85.63289572752387, 93.3089217089927, 109.09204034936313, 113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7228913897036524, "mean_inference_ms": 2.086780651598626, "mean_action_processing_ms": 0.395749850601468, "mean_env_wait_ms": 2.320857425942613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022214651107788086, "StateBufferConnector_ms": 0.015015363693237305, "ViewRequirementAgentConnector_ms": 0.2687211036682129}, "num_episodes": 22, "episode_return_max": 127.29274545596714, "episode_return_min": 73.61038175685827, "episode_return_mean": 98.12429771445612, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 391.32861093139013, "num_env_steps_trained_throughput_per_sec": 391.32861093139013, "timesteps_total": 217088, "num_env_steps_sampled_lifetime": 217088, "num_agent_steps_sampled_lifetime": 217088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 217088, "timers": {"training_iteration_time_ms": 2890.03, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2890.03, "sample_time_ms": 1126.418, "learn_time_ms": 1739.207, "learn_throughput": 588.774, "synch_weights_time_ms": 24.203}, "counters": {"num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "done": false, "training_iteration": 212, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-02", "timestamp": 1744167542, "time_this_iter_s": 2.625108480453491, "time_total_s": 530.3863189220428, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AE80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 530.3863189220428, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 44.25, "ram_util_percent": 96.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.017016148939729, "cur_kl_coeff": 3.0385816786431353e-65, "cur_lr": 1e-07, "total_loss": 2.145159162580967, "policy_loss": -0.00027125989145133645, "vf_loss": 9.804986107349396, "vf_explained_var": -0.00010485835373401642, "kl": 1.8954127793513465e-06, "entropy": 3.058160836994648, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "env_runners": {"episode_reward_max": 127.29274545596714, "episode_reward_min": 74.22504261784299, "episode_reward_mean": 98.46574100952267, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.22504261784299}, "policy_reward_max": {"tplp_policy": 127.29274545596714}, "policy_reward_mean": {"tplp_policy": 98.46574100952267}, "custom_metrics": {"mean_episode_reward_mean": 98.46574100952267, "mean_episode_reward_min": 74.22504261784299, "mean_episode_reward_max": 127.29274545596714}, "hist_stats": {"episode_reward": [113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [113.59835653156424, 92.4866617451887, 100.15563466605477, 105.55429251934464, 97.40067073603036, 101.69007640158226, 98.31464638043596, 76.17140166079285, 97.18810089737254, 102.38635436198102, 104.32864769494486, 100.77025127384712, 89.58819265307893, 85.50958338950427, 109.41890863465528, 91.04276344870009, 99.84610519774553, 103.45197705438235, 96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7233433034502991, "mean_inference_ms": 2.0877445371548853, "mean_action_processing_ms": 0.39589359271704394, "mean_env_wait_ms": 2.322062247077986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006410121917724609, "StateBufferConnector_ms": 0.00974130630493164, "ViewRequirementAgentConnector_ms": 0.28287768363952637}, "num_episodes": 20, "episode_return_max": 127.29274545596714, "episode_return_min": 74.22504261784299, "episode_return_mean": 98.46574100952267, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 371.57572805605844, "num_env_steps_trained_throughput_per_sec": 371.57572805605844, "timesteps_total": 218112, "num_env_steps_sampled_lifetime": 218112, "num_agent_steps_sampled_lifetime": 218112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 218112, "timers": {"training_iteration_time_ms": 2872.291, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2872.291, "sample_time_ms": 1119.218, "learn_time_ms": 1728.299, "learn_throughput": 592.49, "synch_weights_time_ms": 24.565}, "counters": {"num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "done": false, "training_iteration": 213, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-05", "timestamp": 1744167545, "time_this_iter_s": 2.763301372528076, "time_total_s": 533.1496202945709, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.1496202945709, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 47.224999999999994, "ram_util_percent": 96.45000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.007039465755224, "cur_kl_coeff": 1.5192908393215677e-65, "cur_lr": 1e-07, "total_loss": 2.128148989379406, "policy_loss": -0.0003506555105559528, "vf_loss": 9.737274366617203, "vf_explained_var": -0.00014155693352222443, "kl": 3.939856810841747e-06, "entropy": 3.058189499378204, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "env_runners": {"episode_reward_max": 127.29274545596714, "episode_reward_min": 74.22504261784299, "episode_reward_mean": 98.03524242192593, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.22504261784299}, "policy_reward_max": {"tplp_policy": 127.29274545596714}, "policy_reward_mean": {"tplp_policy": 98.03524242192593}, "custom_metrics": {"mean_episode_reward_mean": 98.03524242192593, "mean_episode_reward_min": 74.22504261784299, "mean_episode_reward_max": 127.29274545596714}, "hist_stats": {"episode_reward": [96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [96.74077081508838, 109.86706956757826, 95.33846370504706, 99.23500627934486, 102.66263116799735, 101.3617746214594, 94.73873499895646, 91.7348144094037, 108.17351692159201, 104.12700938586218, 89.35018236547569, 96.30398608653826, 108.39356213498972, 103.63489361542344, 89.4963902696496, 115.24647789270703, 90.67432602266133, 94.29200868771856, 92.35558914040966, 79.20058734938108, 84.18485913234514, 87.381422621303, 103.74516448554064, 108.88033269183437, 98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238900263432712, "mean_inference_ms": 2.089032738802916, "mean_action_processing_ms": 0.39607507614842596, "mean_env_wait_ms": 2.3234926525749042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03320956230163574, "StateBufferConnector_ms": 0.006687641143798828, "ViewRequirementAgentConnector_ms": 0.2921154499053955}, "num_episodes": 18, "episode_return_max": 127.29274545596714, "episode_return_min": 74.22504261784299, "episode_return_mean": 98.03524242192593, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 347.67060909521336, "num_env_steps_trained_throughput_per_sec": 347.67060909521336, "timesteps_total": 219136, "num_env_steps_sampled_lifetime": 219136, "num_agent_steps_sampled_lifetime": 219136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 219136, "timers": {"training_iteration_time_ms": 2844.89, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2844.89, "sample_time_ms": 1135.073, "learn_time_ms": 1686.416, "learn_throughput": 607.205, "synch_weights_time_ms": 23.12}, "counters": {"num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "done": false, "training_iteration": 214, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-08", "timestamp": 1744167548, "time_this_iter_s": 2.9538779258728027, "time_total_s": 536.1034982204437, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.1034982204437, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 53.650000000000006, "ram_util_percent": 96.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.966024188697338, "cur_kl_coeff": 7.596454196607838e-66, "cur_lr": 1e-07, "total_loss": 2.1083574518561363, "policy_loss": -0.0001461868640035391, "vf_loss": 9.657691222429275, "vf_explained_var": -0.00016469806432724, "kl": 1.7510092854777782e-06, "entropy": 3.0591915518045427, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "env_runners": {"episode_reward_max": 127.29274545596714, "episode_reward_min": 74.22504261784299, "episode_reward_mean": 97.82125165392692, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.22504261784299}, "policy_reward_max": {"tplp_policy": 127.29274545596714}, "policy_reward_mean": {"tplp_policy": 97.82125165392692}, "custom_metrics": {"mean_episode_reward_mean": 97.82125165392692, "mean_episode_reward_min": 74.22504261784299, "mean_episode_reward_max": 127.29274545596714}, "hist_stats": {"episode_reward": [98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [98.42883576573568, 103.30556493250559, 101.3563082998387, 112.75283249542332, 103.31878787747381, 127.29274545596714, 84.10357679721051, 106.88689997135681, 104.52063026080377, 116.76937769518615, 80.85096047033507, 102.17504483766275, 92.91198914991737, 91.2040460715041, 91.53121513928906, 86.50851818913905, 102.80000256684225, 104.55506696731553, 91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7245021861991652, "mean_inference_ms": 2.090830103950147, "mean_action_processing_ms": 0.3963940323491924, "mean_env_wait_ms": 2.3254198808107827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032724857330322266, "StateBufferConnector_ms": 0.0045244693756103516, "ViewRequirementAgentConnector_ms": 0.2977778911590576}, "num_episodes": 24, "episode_return_max": 127.29274545596714, "episode_return_min": 74.22504261784299, "episode_return_mean": 97.82125165392692, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 351.50276523070215, "num_env_steps_trained_throughput_per_sec": 351.50276523070215, "timesteps_total": 220160, "num_env_steps_sampled_lifetime": 220160, "num_agent_steps_sampled_lifetime": 220160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 220160, "timers": {"training_iteration_time_ms": 2837.312, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2837.312, "sample_time_ms": 1123.063, "learn_time_ms": 1690.766, "learn_throughput": 605.643, "synch_weights_time_ms": 23.202}, "counters": {"num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "done": false, "training_iteration": 215, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-11", "timestamp": 1744167551, "time_this_iter_s": 2.9201929569244385, "time_total_s": 539.0236911773682, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.0236911773682, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 51.25, "ram_util_percent": 96.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.957383502461016, "cur_kl_coeff": 3.798227098303919e-66, "cur_lr": 1e-07, "total_loss": 2.124771936237812, "policy_loss": -0.00021272120939102023, "vf_loss": 9.724071967601777, "vf_explained_var": -0.00018726438283920289, "kl": 2.5377412022908885e-06, "entropy": 3.060333435237408, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "env_runners": {"episode_reward_max": 121.79288621295947, "episode_reward_min": 74.22504261784299, "episode_reward_mean": 97.65963245315936, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.22504261784299}, "policy_reward_max": {"tplp_policy": 121.79288621295947}, "policy_reward_mean": {"tplp_policy": 97.65963245315936}, "custom_metrics": {"mean_episode_reward_mean": 97.65963245315936, "mean_episode_reward_min": 74.22504261784299, "mean_episode_reward_max": 121.79288621295947}, "hist_stats": {"episode_reward": [91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [91.95255436265728, 115.22240665072269, 106.86348324978344, 84.67889192454422, 95.42420007404321, 102.93150250481428, 83.63892212746404, 79.88362179722537, 90.6221997770244, 107.57967652793316, 104.97525472104925, 87.74429681040655, 100.04549759361517, 106.21330588649056, 98.76542047283084, 97.03286362303693, 104.77516757071544, 121.79288621295947, 86.43242044171771, 111.44119005168982, 105.49130454763525, 98.76214464982161, 76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7248930122599081, "mean_inference_ms": 2.0921257649393254, "mean_action_processing_ms": 0.39666377299342137, "mean_env_wait_ms": 2.326758085017311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032721757888793945, "StateBufferConnector_ms": 0.005522012710571289, "ViewRequirementAgentConnector_ms": 0.2805452346801758}, "num_episodes": 18, "episode_return_max": 121.79288621295947, "episode_return_min": 74.22504261784299, "episode_return_mean": 97.65963245315936, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 401.6642865265716, "num_env_steps_trained_throughput_per_sec": 401.6642865265716, "timesteps_total": 221184, "num_env_steps_sampled_lifetime": 221184, "num_agent_steps_sampled_lifetime": 221184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 221184, "timers": {"training_iteration_time_ms": 2821.976, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2821.976, "sample_time_ms": 1123.874, "learn_time_ms": 1674.477, "learn_throughput": 611.534, "synch_weights_time_ms": 23.343}, "counters": {"num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "done": false, "training_iteration": 216, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-14", "timestamp": 1744167554, "time_this_iter_s": 2.558403253555298, "time_total_s": 541.5820944309235, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 541.5820944309235, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 54.23333333333334, "ram_util_percent": 96.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9763667546212673, "cur_kl_coeff": 1.8991135491519596e-66, "cur_lr": 1e-07, "total_loss": 2.108001994341612, "policy_loss": -0.0002736403403105214, "vf_loss": 9.657845723628999, "vf_explained_var": -0.00018128529191017151, "kl": 3.0115508359518373e-06, "entropy": 3.0618579879403116, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "env_runners": {"episode_reward_max": 120.92287745685144, "episode_reward_min": 74.22504261784299, "episode_reward_mean": 97.18506320312504, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 74.22504261784299}, "policy_reward_max": {"tplp_policy": 120.92287745685144}, "policy_reward_mean": {"tplp_policy": 97.18506320312504}, "custom_metrics": {"mean_episode_reward_mean": 97.18506320312504, "mean_episode_reward_min": 74.22504261784299, "mean_episode_reward_max": 120.92287745685144}, "hist_stats": {"episode_reward": [76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [76.91449677436471, 111.57345589679473, 106.96714039519415, 91.68679167670662, 105.57757074611071, 74.22504261784299, 104.89595354009502, 86.02304041917016, 99.74344285917743, 107.10879007863863, 111.44766344366992, 86.8928673887779, 88.29003063157136, 106.4538918391195, 81.31989084709792, 97.91214649196826, 97.81755293991314, 102.16051822885305, 86.08108571917742, 89.78861319335317, 96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7253785468542742, "mean_inference_ms": 2.0935780359393448, "mean_action_processing_ms": 0.3969497232445056, "mean_env_wait_ms": 2.32854587465214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03474736213684082, "StateBufferConnector_ms": 0.0055217742919921875, "ViewRequirementAgentConnector_ms": 0.2666020393371582}, "num_episodes": 22, "episode_return_max": 120.92287745685144, "episode_return_min": 74.22504261784299, "episode_return_mean": 97.18506320312504, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 355.48373601932656, "num_env_steps_trained_throughput_per_sec": 355.48373601932656, "timesteps_total": 222208, "num_env_steps_sampled_lifetime": 222208, "num_agent_steps_sampled_lifetime": 222208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 222208, "timers": {"training_iteration_time_ms": 2828.564, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2828.564, "sample_time_ms": 1124.633, "learn_time_ms": 1680.114, "learn_throughput": 609.482, "synch_weights_time_ms": 23.422}, "counters": {"num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "done": false, "training_iteration": 217, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-17", "timestamp": 1744167557, "time_this_iter_s": 2.887277126312256, "time_total_s": 544.4693715572357, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1BF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.4693715572357, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 48.05, "ram_util_percent": 96.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0024868786334995, "cur_kl_coeff": 9.495567745759798e-67, "cur_lr": 1e-07, "total_loss": 2.1106906458735466, "policy_loss": -0.00033855866640806196, "vf_loss": 9.669347548484803, "vf_explained_var": -0.00017105601727962494, "kl": 3.2283973227187347e-06, "entropy": 3.0630767032504083, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "env_runners": {"episode_reward_max": 120.92287745685144, "episode_reward_min": 77.77897922998137, "episode_reward_mean": 97.31384363801062, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 77.77897922998137}, "policy_reward_max": {"tplp_policy": 120.92287745685144}, "policy_reward_mean": {"tplp_policy": 97.31384363801062}, "custom_metrics": {"mean_episode_reward_mean": 97.31384363801062, "mean_episode_reward_min": 77.77897922998137, "mean_episode_reward_max": 120.92287745685144}, "hist_stats": {"episode_reward": [96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [96.24046071666885, 99.88562025210922, 85.73093850727199, 96.48468142141812, 77.77897922998137, 80.3973947041161, 116.75388656653976, 102.02941880889942, 101.71884130953498, 95.2749928521298, 111.38240002271954, 89.40192607541519, 108.46874014130061, 95.70247839729578, 113.62559187063043, 79.1067166989687, 100.35191303971881, 90.26633564971398, 106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.725802919104434, "mean_inference_ms": 2.094732107901868, "mean_action_processing_ms": 0.3971832002646714, "mean_env_wait_ms": 2.3304016441807764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008010625839233398, "StateBufferConnector_ms": 0.0055217742919921875, "ViewRequirementAgentConnector_ms": 0.2245016098022461}, "num_episodes": 20, "episode_return_max": 120.92287745685144, "episode_return_min": 77.77897922998137, "episode_return_mean": 97.31384363801062, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 370.25621632162176, "num_env_steps_trained_throughput_per_sec": 370.25621632162176, "timesteps_total": 223232, "num_env_steps_sampled_lifetime": 223232, "num_agent_steps_sampled_lifetime": 223232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 223232, "timers": {"training_iteration_time_ms": 2805.365, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2805.365, "sample_time_ms": 1110.759, "learn_time_ms": 1671.227, "learn_throughput": 612.723, "synch_weights_time_ms": 22.934}, "counters": {"num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "done": false, "training_iteration": 218, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-19", "timestamp": 1744167559, "time_this_iter_s": 2.772073268890381, "time_total_s": 547.2414448261261, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 547.2414448261261, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 51.65, "ram_util_percent": 96.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.638306330516935, "cur_kl_coeff": 4.747783872879899e-67, "cur_lr": 1e-07, "total_loss": 2.1231348507106302, "policy_loss": -0.00042929394985549154, "vf_loss": 9.719557094573975, "vf_explained_var": -0.0002214677631855011, "kl": 3.4126061048134204e-06, "entropy": 3.0632514104247095, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "env_runners": {"episode_reward_max": 131.8506300431377, "episode_reward_min": 63.85983578437181, "episode_reward_mean": 97.48023397815463, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.85983578437181}, "policy_reward_max": {"tplp_policy": 131.8506300431377}, "policy_reward_mean": {"tplp_policy": 97.48023397815463}, "custom_metrics": {"mean_episode_reward_mean": 97.48023397815463, "mean_episode_reward_min": 63.85983578437181, "mean_episode_reward_max": 131.8506300431377}, "hist_stats": {"episode_reward": [106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [106.65830200984193, 87.42911475784476, 100.39243222959396, 110.93211224320899, 80.09459787115458, 81.03508500577027, 97.87350152226566, 86.2449024601683, 83.82723720073923, 106.57551733727057, 93.19683708339808, 107.64108905297931, 107.10799591071334, 88.64271030200672, 95.3026207695575, 86.33984940378726, 83.57728299402643, 106.30528694919475, 113.33160612240354, 98.8999595689555, 104.96028638279947, 108.73392170129553, 92.63020727389936, 101.04997633436318, 92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.726019665001446, "mean_inference_ms": 2.0953564477397166, "mean_action_processing_ms": 0.3973555634403379, "mean_env_wait_ms": 2.3317786469705855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009007692337036133, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.2517867088317871}, "num_episodes": 18, "episode_return_max": 131.8506300431377, "episode_return_min": 63.85983578437181, "episode_return_mean": 97.48023397815463, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 386.49724873955495, "num_env_steps_trained_throughput_per_sec": 386.49724873955495, "timesteps_total": 224256, "num_env_steps_sampled_lifetime": 224256, "num_agent_steps_sampled_lifetime": 224256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 224256, "timers": {"training_iteration_time_ms": 2812.522, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2812.522, "sample_time_ms": 1107.635, "learn_time_ms": 1680.823, "learn_throughput": 609.225, "synch_weights_time_ms": 23.62}, "counters": {"num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "done": false, "training_iteration": 219, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-22", "timestamp": 1744167562, "time_this_iter_s": 2.6577396392822266, "time_total_s": 549.8991844654083, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B7E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.8991844654083, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 48.35, "ram_util_percent": 95.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.010755776241422, "cur_kl_coeff": 2.3738919364399495e-67, "cur_lr": 1e-07, "total_loss": 2.131494176387787, "policy_loss": -0.00029482506215572357, "vf_loss": 9.752127313613892, "vf_explained_var": -0.00020365417003631592, "kl": 1.8442025689680007e-06, "entropy": 3.0624281764030457, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "env_runners": {"episode_reward_max": 131.8506300431377, "episode_reward_min": 63.85983578437181, "episode_reward_mean": 98.13586460647787, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.85983578437181}, "policy_reward_max": {"tplp_policy": 131.8506300431377}, "policy_reward_mean": {"tplp_policy": 98.13586460647787}, "custom_metrics": {"mean_episode_reward_mean": 98.13586460647787, "mean_episode_reward_min": 63.85983578437181, "mean_episode_reward_max": 131.8506300431377}, "hist_stats": {"episode_reward": [92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [92.04988726230599, 120.92287745685144, 109.10072250123623, 93.59369919083606, 91.44499029752481, 96.70601754175662, 103.56379688983296, 90.31687819047973, 112.02130539656827, 94.611449624584, 88.95674023528382, 120.65548991510445, 91.88542583646816, 83.54631426651247, 102.21002291932365, 109.84468173381886, 95.65536733361097, 89.4047969874309, 101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7262624673000388, "mean_inference_ms": 2.095933192325485, "mean_action_processing_ms": 0.39755568670716607, "mean_env_wait_ms": 2.3332271797095756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00601506233215332, "StateBufferConnector_ms": 0.004991054534912109, "ViewRequirementAgentConnector_ms": 0.23703289031982422}, "num_episodes": 24, "episode_return_max": 131.8506300431377, "episode_return_min": 63.85983578437181, "episode_return_mean": 98.13586460647787, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.1708412095744, "num_env_steps_trained_throughput_per_sec": 422.1708412095744, "timesteps_total": 225280, "num_env_steps_sampled_lifetime": 225280, "num_agent_steps_sampled_lifetime": 225280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 225280, "timers": {"training_iteration_time_ms": 2744.997, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2744.997, "sample_time_ms": 1094.63, "learn_time_ms": 1627.354, "learn_throughput": 629.242, "synch_weights_time_ms": 22.618}, "counters": {"num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "done": false, "training_iteration": 220, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-25", "timestamp": 1744167565, "time_this_iter_s": 2.4323012828826904, "time_total_s": 552.331485748291, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1BF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.331485748291, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 42.6, "ram_util_percent": 96.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1823374826461075, "cur_kl_coeff": 1.1869459682199747e-67, "cur_lr": 1e-07, "total_loss": 2.1262434870004654, "policy_loss": -0.0002663740771822631, "vf_loss": 9.731086707115173, "vf_explained_var": -0.00013050399720668793, "kl": 2.6475292850464126e-06, "entropy": 3.0626183941960337, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "env_runners": {"episode_reward_max": 131.8506300431377, "episode_reward_min": 63.85983578437181, "episode_reward_mean": 98.10112931264831, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.85983578437181}, "policy_reward_max": {"tplp_policy": 131.8506300431377}, "policy_reward_mean": {"tplp_policy": 98.10112931264831}, "custom_metrics": {"mean_episode_reward_mean": 98.10112931264831, "mean_episode_reward_min": 63.85983578437181, "mean_episode_reward_max": 131.8506300431377}, "hist_stats": {"episode_reward": [101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.15996768213965, 95.18746845655645, 97.94188167620699, 90.37049358897411, 94.76343533854777, 95.76878276341365, 81.75743701957333, 89.33871023359536, 103.68806454191774, 95.90101259013232, 102.0780151551164, 101.7560976129098, 115.40701121386103, 99.78240885489468, 100.84554129649054, 99.2740615483048, 88.91885387805925, 96.13621332024006, 92.46834530782024, 107.20832017495239, 87.91915429524538, 86.52071415751833, 83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7264310030136878, "mean_inference_ms": 2.096507796426374, "mean_action_processing_ms": 0.39768059514852827, "mean_env_wait_ms": 2.3342417521478778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007015705108642578, "StateBufferConnector_ms": 0.004333972930908203, "ViewRequirementAgentConnector_ms": 0.22898006439208984}, "num_episodes": 18, "episode_return_max": 131.8506300431377, "episode_return_min": 63.85983578437181, "episode_return_mean": 98.10112931264831, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 362.33115058436994, "num_env_steps_trained_throughput_per_sec": 362.33115058436994, "timesteps_total": 226304, "num_env_steps_sampled_lifetime": 226304, "num_agent_steps_sampled_lifetime": 226304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 226304, "timers": {"training_iteration_time_ms": 2732.785, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2732.785, "sample_time_ms": 1090.902, "learn_time_ms": 1619.694, "learn_throughput": 632.218, "synch_weights_time_ms": 21.894}, "counters": {"num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "done": false, "training_iteration": 221, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-28", "timestamp": 1744167568, "time_this_iter_s": 2.8324062824249268, "time_total_s": 555.1638920307159, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D187C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 555.1638920307159, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 50.575, "ram_util_percent": 96.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7304641027003527, "cur_kl_coeff": 5.934729841099874e-68, "cur_lr": 1e-07, "total_loss": 2.120853339880705, "policy_loss": -0.00011038643133360892, "vf_loss": 9.709449982643127, "vf_explained_var": -0.0001146029680967331, "kl": 1.6823892553752274e-06, "entropy": 3.063987688720226, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "env_runners": {"episode_reward_max": 131.8506300431377, "episode_reward_min": 63.85983578437181, "episode_reward_mean": 97.59019603492386, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.85983578437181}, "policy_reward_max": {"tplp_policy": 131.8506300431377}, "policy_reward_mean": {"tplp_policy": 97.59019603492386}, "custom_metrics": {"mean_episode_reward_mean": 97.59019603492386, "mean_episode_reward_min": 63.85983578437181, "mean_episode_reward_max": 131.8506300431377}, "hist_stats": {"episode_reward": [83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [83.830655396177, 93.53947007703013, 97.18941963833842, 99.00216598952444, 99.40232431707308, 108.19522329961697, 118.14107550453862, 85.93856580283799, 109.05690730263956, 102.00561030056896, 82.80766401524193, 89.32400358582005, 102.57723590475746, 93.96746199290985, 92.76571842024885, 89.92264891953658, 108.09214485145323, 95.5598654450786, 104.30948501815645, 94.92292261010346, 86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7265861501787227, "mean_inference_ms": 2.097261345563134, "mean_action_processing_ms": 0.39785031125178355, "mean_env_wait_ms": 2.334965287302407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069844722747802734, "StateBufferConnector_ms": 0.004352569580078125, "ViewRequirementAgentConnector_ms": 0.2420947551727295}, "num_episodes": 22, "episode_return_max": 131.8506300431377, "episode_return_min": 63.85983578437181, "episode_return_mean": 97.59019603492386, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.7506940363327, "num_env_steps_trained_throughput_per_sec": 437.7506940363327, "timesteps_total": 227328, "num_env_steps_sampled_lifetime": 227328, "num_agent_steps_sampled_lifetime": 227328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 227328, "timers": {"training_iteration_time_ms": 2705.035, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2705.035, "sample_time_ms": 1082.967, "learn_time_ms": 1600.473, "learn_throughput": 639.811, "synch_weights_time_ms": 21.301}, "counters": {"num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "done": false, "training_iteration": 222, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-30", "timestamp": 1744167570, "time_this_iter_s": 2.3447439670562744, "time_total_s": 557.5086359977722, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 557.5086359977722, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 40.06666666666667, "ram_util_percent": 96.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2858981397002935, "cur_kl_coeff": 2.967364920549937e-68, "cur_lr": 1e-07, "total_loss": 2.1024859823286532, "policy_loss": -0.00027502367738634347, "vf_loss": 9.637133419513702, "vf_explained_var": -7.922127842903137e-05, "kl": 2.736257279041532e-06, "entropy": 3.0652233183383943, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "env_runners": {"episode_reward_max": 131.8506300431377, "episode_reward_min": 63.85983578437181, "episode_reward_mean": 97.36868299667154, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 63.85983578437181}, "policy_reward_max": {"tplp_policy": 131.8506300431377}, "policy_reward_mean": {"tplp_policy": 97.36868299667154}, "custom_metrics": {"mean_episode_reward_mean": 97.36868299667154, "mean_episode_reward_min": 63.85983578437181, "mean_episode_reward_max": 131.8506300431377}, "hist_stats": {"episode_reward": [86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.22481474066409, 104.1020307873455, 86.51610840935035, 131.8506300431377, 97.61601120697452, 105.60432733702365, 105.17626363842004, 81.87955814041668, 96.1206760517806, 102.81989008951616, 91.469146961263, 99.13137249563714, 101.48178981007402, 63.85983578437181, 96.55846806849739, 107.59701908610226, 97.4555458802409, 115.45829878501901, 107.05471821301485, 99.09358199465663, 100.99193065116154, 91.12497945428237, 115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7266280079394627, "mean_inference_ms": 2.09778091809196, "mean_action_processing_ms": 0.39795900127246225, "mean_env_wait_ms": 2.3353644778421034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007984399795532227, "StateBufferConnector_ms": 0.007737159729003906, "ViewRequirementAgentConnector_ms": 0.26022982597351074}, "num_episodes": 20, "episode_return_max": 131.8506300431377, "episode_return_min": 63.85983578437181, "episode_return_mean": 97.36868299667154, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 459.56417533550047, "num_env_steps_trained_throughput_per_sec": 459.56417533550047, "timesteps_total": 228352, "num_env_steps_sampled_lifetime": 228352, "num_agent_steps_sampled_lifetime": 228352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 228352, "timers": {"training_iteration_time_ms": 2652.272, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2652.272, "sample_time_ms": 1075.027, "learn_time_ms": 1556.772, "learn_throughput": 657.771, "synch_weights_time_ms": 20.069}, "counters": {"num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "done": false, "training_iteration": 223, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-32", "timestamp": 1744167572, "time_this_iter_s": 2.2333993911743164, "time_total_s": 559.7420353889465, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1BB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 559.7420353889465, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 41.49999999999999, "ram_util_percent": 96.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.156796434149146, "cur_kl_coeff": 1.4836824602749684e-68, "cur_lr": 1e-07, "total_loss": 2.109823589026928, "policy_loss": -0.00023341424239333718, "vf_loss": 9.666622203588485, "vf_explained_var": -4.71852719783783e-05, "kl": 2.4001754023394995e-06, "entropy": 3.0659853518009186, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "env_runners": {"episode_reward_max": 120.06917848591388, "episode_reward_min": 70.90016149905617, "episode_reward_mean": 97.39107528045946, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.90016149905617}, "policy_reward_max": {"tplp_policy": 120.06917848591388}, "policy_reward_mean": {"tplp_policy": 97.39107528045946}, "custom_metrics": {"mean_episode_reward_mean": 97.39107528045946, "mean_episode_reward_min": 70.90016149905617, "mean_episode_reward_max": 120.06917848591388}, "hist_stats": {"episode_reward": [115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [115.31744001290411, 90.87665511721508, 113.12414543192511, 98.73887245318828, 100.182982384742, 98.4791875601736, 100.4480437859519, 91.96747171469008, 104.96966684593731, 93.60095620917765, 90.24157170346109, 94.70935920660021, 98.60954723909886, 82.7926938052886, 109.61493664581243, 92.47681205130917, 112.68891003821344, 94.32718813549626, 89.54538570826043, 96.9134191037326, 77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7264698834489952, "mean_inference_ms": 2.0979689208837033, "mean_action_processing_ms": 0.39788714695843164, "mean_env_wait_ms": 2.3354566166541377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009987115859985352, "StateBufferConnector_ms": 0.0067348480224609375, "ViewRequirementAgentConnector_ms": 0.21726751327514648}, "num_episodes": 22, "episode_return_max": 120.06917848591388, "episode_return_min": 70.90016149905617, "episode_return_mean": 97.39107528045946, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 400.6453747448023, "num_env_steps_trained_throughput_per_sec": 400.6453747448023, "timesteps_total": 229376, "num_env_steps_sampled_lifetime": 229376, "num_agent_steps_sampled_lifetime": 229376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 229376, "timers": {"training_iteration_time_ms": 2613.328, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2613.328, "sample_time_ms": 1034.25, "learn_time_ms": 1558.891, "learn_throughput": 656.877, "synch_weights_time_ms": 19.907}, "counters": {"num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "done": false, "training_iteration": 224, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-35", "timestamp": 1744167575, "time_this_iter_s": 2.5643529891967773, "time_total_s": 562.3063883781433, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.3063883781433, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 96.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.740985606983304, "cur_kl_coeff": 7.418412301374842e-69, "cur_lr": 1e-07, "total_loss": 2.1233344741165636, "policy_loss": -7.22957294783555e-05, "vf_loss": 9.720165330171586, "vf_explained_var": -0.00015118159353733063, "kl": 6.725653332262382e-07, "entropy": 3.066345615684986, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "env_runners": {"episode_reward_max": 120.06917848591388, "episode_reward_min": 70.90016149905617, "episode_reward_mean": 96.79979264551838, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.90016149905617}, "policy_reward_max": {"tplp_policy": 120.06917848591388}, "policy_reward_mean": {"tplp_policy": 96.79979264551838}, "custom_metrics": {"mean_episode_reward_mean": 96.79979264551838, "mean_episode_reward_min": 70.90016149905617, "mean_episode_reward_max": 120.06917848591388}, "hist_stats": {"episode_reward": [77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [77.89967238469397, 109.99650773718483, 92.63105468653237, 100.8367911510649, 108.68224970613109, 111.91333144545732, 87.16594898697035, 113.4678737633981, 85.20592904595851, 120.06917848591388, 98.00332024310688, 102.35731277817358, 102.24143922264399, 91.5996491329792, 99.00460939188739, 95.48326122248424, 99.48580914296879, 101.1056295261825, 106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.726729644837844, "mean_inference_ms": 2.0987592728631013, "mean_action_processing_ms": 0.3980367534258189, "mean_env_wait_ms": 2.335680340077774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015974998474121094, "StateBufferConnector_ms": 0.005737781524658203, "ViewRequirementAgentConnector_ms": 0.23198294639587402}, "num_episodes": 20, "episode_return_max": 120.06917848591388, "episode_return_min": 70.90016149905617, "episode_return_mean": 96.79979264551838, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 335.1188238183831, "num_env_steps_trained_throughput_per_sec": 335.1188238183831, "timesteps_total": 230400, "num_env_steps_sampled_lifetime": 230400, "num_agent_steps_sampled_lifetime": 230400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 230400, "timers": {"training_iteration_time_ms": 2627.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2627.57, "sample_time_ms": 1051.306, "learn_time_ms": 1556.642, "learn_throughput": 657.826, "synch_weights_time_ms": 19.342}, "counters": {"num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "done": false, "training_iteration": 225, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-38", "timestamp": 1744167578, "time_this_iter_s": 3.063175678253174, "time_total_s": 565.3695640563965, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 565.3695640563965, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 53.3, "ram_util_percent": 96.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6886824291199445, "cur_kl_coeff": 3.709206150687421e-69, "cur_lr": 1e-07, "total_loss": 2.12176274061203, "policy_loss": -0.000166872120462358, "vf_loss": 9.714351797103882, "vf_explained_var": -0.0002304006367921829, "kl": 1.8486341097911918e-06, "entropy": 3.066583241522312, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "env_runners": {"episode_reward_max": 119.16055026329971, "episode_reward_min": 70.90016149905617, "episode_reward_mean": 96.01543880658396, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 70.90016149905617}, "policy_reward_max": {"tplp_policy": 119.16055026329971}, "policy_reward_mean": {"tplp_policy": 96.01543880658396}, "custom_metrics": {"mean_episode_reward_mean": 96.01543880658396, "mean_episode_reward_min": 70.90016149905617, "mean_episode_reward_max": 119.16055026329971}, "hist_stats": {"episode_reward": [106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [106.29728979111516, 94.85063151772141, 106.46019422534096, 101.36724420052842, 101.50945761802427, 79.76078529775711, 108.58861252028572, 85.9528221589741, 89.57543619378255, 70.90016149905617, 98.4627378523334, 97.52280629070485, 81.74333980652644, 92.18567167855734, 84.4480119381829, 99.07262967845226, 97.61202105804875, 83.03600438238058, 87.82225844208902, 105.33910811501515, 99.70720461748598, 85.95057415296644, 93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7269340408771642, "mean_inference_ms": 2.0995378704916807, "mean_action_processing_ms": 0.3981440631619707, "mean_env_wait_ms": 2.3360176139645183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015970945358276367, "StateBufferConnector_ms": 0.008868694305419922, "ViewRequirementAgentConnector_ms": 0.2405538558959961}, "num_episodes": 18, "episode_return_max": 119.16055026329971, "episode_return_min": 70.90016149905617, "episode_return_mean": 96.01543880658396, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 413.1139522196171, "num_env_steps_trained_throughput_per_sec": 413.1139522196171, "timesteps_total": 231424, "num_env_steps_sampled_lifetime": 231424, "num_agent_steps_sampled_lifetime": 231424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 231424, "timers": {"training_iteration_time_ms": 2620.505, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2620.505, "sample_time_ms": 1052.894, "learn_time_ms": 1547.927, "learn_throughput": 661.53, "synch_weights_time_ms": 19.403}, "counters": {"num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "done": false, "training_iteration": 226, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-40", "timestamp": 1744167580, "time_this_iter_s": 2.485833168029785, "time_total_s": 567.8553972244263, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE2BC13A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.8553972244263, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 34.175, "ram_util_percent": 96.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.90219534561038, "cur_kl_coeff": 1.8546030753437105e-69, "cur_lr": 1e-07, "total_loss": 2.1246203988790513, "policy_loss": -0.0002691706526093185, "vf_loss": 9.726320379972458, "vf_explained_var": -0.00018118955194950103, "kl": 2.2546079802232556e-06, "entropy": 3.066905212402344, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "env_runners": {"episode_reward_max": 119.16055026329971, "episode_reward_min": 71.78082242796177, "episode_reward_mean": 96.68521364220612, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.78082242796177}, "policy_reward_max": {"tplp_policy": 119.16055026329971}, "policy_reward_mean": {"tplp_policy": 96.68521364220612}, "custom_metrics": {"mean_episode_reward_mean": 96.68521364220612, "mean_episode_reward_min": 71.78082242796177, "mean_episode_reward_max": 119.16055026329971}, "hist_stats": {"episode_reward": [93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [93.69260388448167, 87.80378438702996, 99.54723976273844, 98.44880540172014, 84.07713772423887, 97.1615748550729, 94.70871796450393, 107.27443282373379, 88.6408549677845, 98.45478459223179, 96.83736224788387, 103.50785709352003, 106.8334092250129, 77.6512048489323, 102.80112560716488, 100.32416748409074, 103.53634331369203, 101.440079612133, 100.14202127372124, 112.96128534614975, 97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.727227276700766, "mean_inference_ms": 2.1004163273005236, "mean_action_processing_ms": 0.39826365388873364, "mean_env_wait_ms": 2.3366035791449224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021959781646728516, "StateBufferConnector_ms": 0.007848024368286133, "ViewRequirementAgentConnector_ms": 0.23238372802734375}, "num_episodes": 22, "episode_return_max": 119.16055026329971, "episode_return_min": 71.78082242796177, "episode_return_mean": 96.68521364220612, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 402.08167515897094, "num_env_steps_trained_throughput_per_sec": 402.08167515897094, "timesteps_total": 232448, "num_env_steps_sampled_lifetime": 232448, "num_agent_steps_sampled_lifetime": 232448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 232448, "timers": {"training_iteration_time_ms": 2587.121, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2587.121, "sample_time_ms": 1046.657, "learn_time_ms": 1521.164, "learn_throughput": 673.169, "synch_weights_time_ms": 19.133}, "counters": {"num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "done": false, "training_iteration": 227, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-43", "timestamp": 1744167583, "time_this_iter_s": 2.5542759895324707, "time_total_s": 570.4096732139587, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 570.4096732139587, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 45.9, "ram_util_percent": 96.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.864197911694646, "cur_kl_coeff": 9.273015376718553e-70, "cur_lr": 1e-07, "total_loss": 2.106010675430298, "policy_loss": -0.00013870127149857582, "vf_loss": 9.651658564805984, "vf_explained_var": -0.00014358758926391602, "kl": 1.9527442178146616e-06, "entropy": 3.0676528424024583, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "env_runners": {"episode_reward_max": 119.16055026329971, "episode_reward_min": 71.78082242796177, "episode_reward_mean": 96.33007588969247, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.78082242796177}, "policy_reward_max": {"tplp_policy": 119.16055026329971}, "policy_reward_mean": {"tplp_policy": 96.33007588969247}, "custom_metrics": {"mean_episode_reward_mean": 96.33007588969247, "mean_episode_reward_min": 71.78082242796177, "mean_episode_reward_max": 119.16055026329971}, "hist_stats": {"episode_reward": [97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [97.13891391079635, 101.16725721639061, 119.16055026329971, 93.18459801313651, 94.5009909638856, 78.2807348027337, 99.11510760616298, 89.2117017930215, 100.00809079914224, 102.42961922048558, 96.87467748952038, 90.67203611310592, 97.73118009747529, 104.23051696258047, 106.33072068162186, 82.83994555715246, 95.39322725753188, 111.48162284812393, 101.25186327914905, 97.31956451255672, 99.71946607504302, 97.86102089966612, 100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7275686068004791, "mean_inference_ms": 2.1015109961297878, "mean_action_processing_ms": 0.3983780815971211, "mean_env_wait_ms": 2.3373938762153266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02225470542907715, "StateBufferConnector_ms": 0.008456945419311523, "ViewRequirementAgentConnector_ms": 0.24686336517333984}, "num_episodes": 20, "episode_return_max": 119.16055026329971, "episode_return_min": 71.78082242796177, "episode_return_mean": 96.33007588969247, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 380.6761885186655, "num_env_steps_trained_throughput_per_sec": 380.6761885186655, "timesteps_total": 233472, "num_env_steps_sampled_lifetime": 233472, "num_agent_steps_sampled_lifetime": 233472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 233472, "timers": {"training_iteration_time_ms": 2579.551, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2579.551, "sample_time_ms": 1049.526, "learn_time_ms": 1511.229, "learn_throughput": 677.594, "synch_weights_time_ms": 18.582}, "counters": {"num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "done": false, "training_iteration": 228, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-46", "timestamp": 1744167586, "time_this_iter_s": 2.6954903602600098, "time_total_s": 573.1051635742188, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 573.1051635742188, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 46.050000000000004, "ram_util_percent": 96.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8170035891234875, "cur_kl_coeff": 4.6365076883592763e-70, "cur_lr": 1e-07, "total_loss": 2.1214384883642197, "policy_loss": -0.00013117274502292276, "vf_loss": 9.713699382543563, "vf_explained_var": -8.508116006851196e-05, "kl": 1.3372996165106344e-06, "entropy": 3.0685518428683283, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "env_runners": {"episode_reward_max": 130.25489752207992, "episode_reward_min": 71.78082242796177, "episode_reward_mean": 97.09592644071935, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.78082242796177}, "policy_reward_max": {"tplp_policy": 130.25489752207992}, "policy_reward_mean": {"tplp_policy": 97.09592644071935}, "custom_metrics": {"mean_episode_reward_mean": 97.09592644071935, "mean_episode_reward_min": 71.78082242796177, "mean_episode_reward_max": 130.25489752207992}, "hist_stats": {"episode_reward": [100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [100.90607548652947, 88.40658956688819, 90.37024588746274, 80.16229214420935, 99.74901073842784, 97.4213116735492, 96.08069796762149, 100.9478667013089, 93.92955733440012, 93.20290680413426, 84.61732351052456, 110.4023510390116, 93.01211459892816, 89.88206517222869, 101.32397087902743, 87.74292457118337, 97.07134214374287, 107.68784846517913, 106.21173576723262, 96.44553330752358, 103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7281359282109235, "mean_inference_ms": 2.1033345966930757, "mean_action_processing_ms": 0.39858927805817534, "mean_env_wait_ms": 2.3389946918700515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023596525192260742, "StateBufferConnector_ms": 0.009454488754272461, "ViewRequirementAgentConnector_ms": 0.2576563358306885}, "num_episodes": 22, "episode_return_max": 130.25489752207992, "episode_return_min": 71.78082242796177, "episode_return_mean": 97.09592644071935, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 397.3225433461844, "num_env_steps_trained_throughput_per_sec": 397.3225433461844, "timesteps_total": 234496, "num_env_steps_sampled_lifetime": 234496, "num_agent_steps_sampled_lifetime": 234496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 234496, "timers": {"training_iteration_time_ms": 2572.332, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2572.332, "sample_time_ms": 1063.656, "learn_time_ms": 1490.486, "learn_throughput": 687.024, "synch_weights_time_ms": 17.975}, "counters": {"num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "done": false, "training_iteration": 229, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-48", "timestamp": 1744167588, "time_this_iter_s": 2.5844128131866455, "time_total_s": 575.6895763874054, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 575.6895763874054, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 53.666666666666664, "ram_util_percent": 96.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.115296445041895, "cur_kl_coeff": 2.3182538441796382e-70, "cur_lr": 1e-07, "total_loss": 2.1249510124325752, "policy_loss": -0.00027774785412475466, "vf_loss": 9.728543543815613, "vf_explained_var": -0.00020865574479103088, "kl": 2.571458628275458e-06, "entropy": 3.069071339070797, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "env_runners": {"episode_reward_max": 130.25489752207992, "episode_reward_min": 71.78082242796177, "episode_reward_mean": 98.68004660357389, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.78082242796177}, "policy_reward_max": {"tplp_policy": 130.25489752207992}, "policy_reward_mean": {"tplp_policy": 98.68004660357389}, "custom_metrics": {"mean_episode_reward_mean": 98.68004660357389, "mean_episode_reward_min": 71.78082242796177, "mean_episode_reward_max": 130.25489752207992}, "hist_stats": {"episode_reward": [103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.01594530623281, 82.1633643848899, 110.09263419871739, 87.34750976690738, 96.21721303344, 82.08500660309572, 86.30529608026399, 93.7674471650666, 102.66227554508376, 78.05567779667987, 105.17812889977978, 98.07345413089828, 101.6393007590076, 91.48466373914655, 97.53861056965223, 100.43038710667308, 104.3881204525536, 105.5475089864839, 98.19758128519011, 85.35206894515186, 95.4646139119321, 94.11049639943496, 86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7282946874669156, "mean_inference_ms": 2.1040960631429306, "mean_action_processing_ms": 0.3986020909009045, "mean_env_wait_ms": 2.3397143452140505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0205996036529541, "StateBufferConnector_ms": 0.011449813842773438, "ViewRequirementAgentConnector_ms": 0.24129939079284668}, "num_episodes": 20, "episode_return_max": 130.25489752207992, "episode_return_min": 71.78082242796177, "episode_return_mean": 98.68004660357389, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.3406683707956, "num_env_steps_trained_throughput_per_sec": 467.3406683707956, "timesteps_total": 235520, "num_env_steps_sampled_lifetime": 235520, "num_agent_steps_sampled_lifetime": 235520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 235520, "timers": {"training_iteration_time_ms": 2548.889, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2548.889, "sample_time_ms": 1049.481, "learn_time_ms": 1481.21, "learn_throughput": 691.327, "synch_weights_time_ms": 17.983}, "counters": {"num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "done": false, "training_iteration": 230, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-51", "timestamp": 1744167591, "time_this_iter_s": 2.196791887283325, "time_total_s": 577.8863682746887, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.8863682746887, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 30.825000000000003, "ram_util_percent": 97.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4740049108862876, "cur_kl_coeff": 1.1591269220898191e-70, "cur_lr": 1e-07, "total_loss": 2.1397050373256206, "policy_loss": -9.23444633372128e-05, "vf_loss": 9.786866593360902, "vf_explained_var": -0.00015613138675689696, "kl": 5.694157656332966e-07, "entropy": 3.0691925182938578, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "env_runners": {"episode_reward_max": 130.25489752207992, "episode_reward_min": 71.78082242796177, "episode_reward_mean": 99.66039621047163, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 71.78082242796177}, "policy_reward_max": {"tplp_policy": 130.25489752207992}, "policy_reward_mean": {"tplp_policy": 99.66039621047163}, "custom_metrics": {"mean_episode_reward_mean": 99.66039621047163, "mean_episode_reward_min": 71.78082242796177, "mean_episode_reward_max": 130.25489752207992}, "hist_stats": {"episode_reward": [86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [86.55475992785466, 92.95360436699191, 92.77159635899702, 99.97881242495362, 92.33782923857041, 100.23615363761445, 94.44669560406426, 87.18793906394795, 94.49158754871301, 93.89188831691965, 118.47659632579264, 106.03304873552217, 88.75237872161935, 112.43806707692282, 109.75031684035216, 71.78082242796177, 94.85301928308465, 106.37673881539274, 99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.728432767902061, "mean_inference_ms": 2.1048113981444163, "mean_action_processing_ms": 0.39855139128987765, "mean_env_wait_ms": 2.3405790336860925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015748977661132812, "StateBufferConnector_ms": 0.008242368698120117, "ViewRequirementAgentConnector_ms": 0.2474665641784668}, "num_episodes": 22, "episode_return_max": 130.25489752207992, "episode_return_min": 71.78082242796177, "episode_return_mean": 99.66039621047163, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 332.0180291414327, "num_env_steps_trained_throughput_per_sec": 332.0180291414327, "timesteps_total": 236544, "num_env_steps_sampled_lifetime": 236544, "num_agent_steps_sampled_lifetime": 236544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 2574.691, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2574.691, "sample_time_ms": 1045.422, "learn_time_ms": 1509.855, "learn_throughput": 678.211, "synch_weights_time_ms": 19.094}, "counters": {"num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "done": false, "training_iteration": 231, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-54", "timestamp": 1744167594, "time_this_iter_s": 3.092527389526367, "time_total_s": 580.9788956642151, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 580.9788956642151, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 50.300000000000004, "ram_util_percent": 96.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.340072491019964, "cur_kl_coeff": 5.7956346104490954e-71, "cur_lr": 1e-07, "total_loss": 2.11947762966156, "policy_loss": -0.00033131911186501384, "vf_loss": 9.707001149654388, "vf_explained_var": -0.00021539032459259034, "kl": 3.936959043271404e-06, "entropy": 3.0694134801626207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "env_runners": {"episode_reward_max": 130.25489752207992, "episode_reward_min": 78.98330412143089, "episode_reward_mean": 100.28924079906805, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.98330412143089}, "policy_reward_max": {"tplp_policy": 130.25489752207992}, "policy_reward_mean": {"tplp_policy": 100.28924079906805}, "custom_metrics": {"mean_episode_reward_mean": 100.28924079906805, "mean_episode_reward_min": 78.98330412143089, "mean_episode_reward_max": 130.25489752207992}, "hist_stats": {"episode_reward": [99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [99.52910728167316, 95.60481141566717, 93.48161230680027, 98.41623121771433, 86.44350244054753, 102.45892841129469, 96.14088604349904, 89.29335409390855, 90.38630629279935, 102.40433716127225, 114.13411254068984, 84.54776331029727, 102.56278959224508, 93.75434091761004, 87.73191161931216, 87.86103860967683, 92.16962574686136, 102.18060006412607, 108.78662874605818, 101.60388349010006, 95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7287068887509794, "mean_inference_ms": 2.105721302363084, "mean_action_processing_ms": 0.39859432461256367, "mean_env_wait_ms": 2.3411533233698436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01475071907043457, "StateBufferConnector_ms": 0.00924062728881836, "ViewRequirementAgentConnector_ms": 0.2559230327606201}, "num_episodes": 18, "episode_return_max": 130.25489752207992, "episode_return_min": 78.98330412143089, "episode_return_mean": 100.28924079906805, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 356.9387549100229, "num_env_steps_trained_throughput_per_sec": 356.9387549100229, "timesteps_total": 237568, "num_env_steps_sampled_lifetime": 237568, "num_agent_steps_sampled_lifetime": 237568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 237568, "timers": {"training_iteration_time_ms": 2627.652, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2627.652, "sample_time_ms": 1063.009, "learn_time_ms": 1544.693, "learn_throughput": 662.915, "synch_weights_time_ms": 19.63}, "counters": {"num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "done": false, "training_iteration": 232, "trial_id": "374cd_00000", "date": "2025-04-09_10-59-57", "timestamp": 1744167597, "time_this_iter_s": 2.875659704208374, "time_total_s": 583.8545553684235, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1B740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 583.8545553684235, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 51.525000000000006, "ram_util_percent": 97.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.761903829500079, "cur_kl_coeff": 2.8978173052245477e-71, "cur_lr": 1e-07, "total_loss": 2.126643378287554, "policy_loss": -0.00015597158926539123, "vf_loss": 9.735552144050597, "vf_explained_var": -0.00011823363602161407, "kl": 2.2351327236158626e-06, "entropy": 3.0708869501948355, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "env_runners": {"episode_reward_max": 130.25489752207992, "episode_reward_min": 78.98330412143089, "episode_reward_mean": 101.26647822004712, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.98330412143089}, "policy_reward_max": {"tplp_policy": 130.25489752207992}, "policy_reward_mean": {"tplp_policy": 101.26647822004712}, "custom_metrics": {"mean_episode_reward_mean": 101.26647822004712, "mean_episode_reward_min": 78.98330412143089, "mean_episode_reward_max": 130.25489752207992}, "hist_stats": {"episode_reward": [95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [95.25336486222683, 87.88003837597046, 95.22343298879964, 112.55585827520297, 92.93467236506251, 90.27257835170768, 130.25489752207992, 122.4431811963453, 98.86677603934307, 95.12175487683783, 101.69526889544504, 94.09438598863564, 102.43740075666977, 97.07515141774466, 111.74538796637128, 110.78833243998022, 78.98330412143089, 102.87057690630891, 92.8128284345011, 108.78875744844758, 91.08350519830641, 85.7695354859787, 114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.728993332682141, "mean_inference_ms": 2.1068464354844463, "mean_action_processing_ms": 0.39870687392867404, "mean_env_wait_ms": 2.3422041559974485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012458562850952148, "StateBufferConnector_ms": 0.00824427604675293, "ViewRequirementAgentConnector_ms": 0.2544431686401367}, "num_episodes": 20, "episode_return_max": 130.25489752207992, "episode_return_min": 78.98330412143089, "episode_return_mean": 101.26647822004712, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 369.1323343908905, "num_env_steps_trained_throughput_per_sec": 369.1323343908905, "timesteps_total": 238592, "num_env_steps_sampled_lifetime": 238592, "num_agent_steps_sampled_lifetime": 238592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 238592, "timers": {"training_iteration_time_ms": 2682.239, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2682.239, "sample_time_ms": 1089.425, "learn_time_ms": 1572.424, "learn_throughput": 651.224, "synch_weights_time_ms": 20.187}, "counters": {"num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "done": false, "training_iteration": 233, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-00", "timestamp": 1744167600, "time_this_iter_s": 2.7805848121643066, "time_total_s": 586.6351401805878, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 586.6351401805878, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 45.42500000000001, "ram_util_percent": 97.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.980170016735792, "cur_kl_coeff": 1.4489086526122739e-71, "cur_lr": 1e-07, "total_loss": 2.128035049140453, "policy_loss": -0.00013346845516934991, "vf_loss": 9.741600722074509, "vf_explained_var": -0.0001914292573928833, "kl": 1.939444613385799e-06, "entropy": 3.072316788136959, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "env_runners": {"episode_reward_max": 117.83976216792611, "episode_reward_min": 81.80407013792431, "episode_reward_mean": 101.7381699887073, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 81.80407013792431}, "policy_reward_max": {"tplp_policy": 117.83976216792611}, "policy_reward_mean": {"tplp_policy": 101.7381699887073}, "custom_metrics": {"mean_episode_reward_mean": 101.7381699887073, "mean_episode_reward_min": 81.80407013792431, "mean_episode_reward_max": 117.83976216792611}, "hist_stats": {"episode_reward": [114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [114.24321904139595, 101.93751124617683, 88.75573540179596, 116.16815070149364, 101.45662406721907, 113.01235853658928, 90.57527110797845, 98.56988269550085, 108.24859715792788, 103.43057804454568, 90.8801072998814, 103.77875625578488, 110.593107611254, 112.09020413185998, 112.21044368919607, 117.19561483574478, 98.6435822383778, 115.34299529755864, 103.30004513664825, 85.8831516278211, 87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.729208276543095, "mean_inference_ms": 2.1077146291212547, "mean_action_processing_ms": 0.3987772450211453, "mean_env_wait_ms": 2.342743436635342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010110855102539062, "StateBufferConnector_ms": 0.008243560791015625, "ViewRequirementAgentConnector_ms": 0.24035310745239258}, "num_episodes": 22, "episode_return_max": 117.83976216792611, "episode_return_min": 81.80407013792431, "episode_return_mean": 101.7381699887073, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 426.00561359657604, "num_env_steps_trained_throughput_per_sec": 426.00561359657604, "timesteps_total": 239616, "num_env_steps_sampled_lifetime": 239616, "num_agent_steps_sampled_lifetime": 239616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 239616, "timers": {"training_iteration_time_ms": 2667.024, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2667.024, "sample_time_ms": 1099.974, "learn_time_ms": 1546.705, "learn_throughput": 662.053, "synch_weights_time_ms": 20.142}, "counters": {"num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "done": false, "training_iteration": 234, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-02", "timestamp": 1744167602, "time_this_iter_s": 2.410243272781372, "time_total_s": 589.0453834533691, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.0453834533691, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 27.25, "ram_util_percent": 96.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.136728271842003, "cur_kl_coeff": 7.244543263061369e-72, "cur_lr": 1e-07, "total_loss": 2.1217592775821688, "policy_loss": -0.00020022264216095208, "vf_loss": 9.717146080732345, "vf_explained_var": -0.00013684816658496857, "kl": 1.878810529909458e-06, "entropy": 3.0732698425650598, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "env_runners": {"episode_reward_max": 118.86412929478469, "episode_reward_min": 78.59811630365141, "episode_reward_mean": 101.0453653567879, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.59811630365141}, "policy_reward_max": {"tplp_policy": 118.86412929478469}, "policy_reward_mean": {"tplp_policy": 101.0453653567879}, "custom_metrics": {"mean_episode_reward_mean": 101.0453653567879, "mean_episode_reward_min": 78.59811630365141, "mean_episode_reward_max": 118.86412929478469}, "hist_stats": {"episode_reward": [87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [87.09169678870481, 95.22061195514304, 112.29930460700419, 99.70081067987192, 97.23160772458642, 100.11250199129258, 92.9548767376979, 96.36636218202862, 90.55001197776188, 101.03795636841066, 103.38074164371395, 92.6392572742397, 109.15821712657782, 106.82968733790588, 88.774416413493, 113.90850626577978, 96.47982418646916, 106.52764747064249, 113.387208926389, 104.31782133387497, 99.45309718339793, 101.59280412803416, 103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7294926622300392, "mean_inference_ms": 2.108759661473798, "mean_action_processing_ms": 0.39891785835114535, "mean_env_wait_ms": 2.343525463070133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009114742279052734, "StateBufferConnector_ms": 0.007249593734741211, "ViewRequirementAgentConnector_ms": 0.2608199119567871}, "num_episodes": 20, "episode_return_max": 118.86412929478469, "episode_return_min": 78.59811630365141, "episode_return_mean": 101.0453653567879, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 389.26078822511136, "num_env_steps_trained_throughput_per_sec": 389.26078822511136, "timesteps_total": 240640, "num_env_steps_sampled_lifetime": 240640, "num_agent_steps_sampled_lifetime": 240640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 240640, "timers": {"training_iteration_time_ms": 2624.524, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2624.524, "sample_time_ms": 1072.067, "learn_time_ms": 1531.859, "learn_throughput": 668.469, "synch_weights_time_ms": 20.395}, "counters": {"num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "done": false, "training_iteration": 235, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-05", "timestamp": 1744167605, "time_this_iter_s": 2.636317253112793, "time_total_s": 591.6817007064819, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1CE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 591.6817007064819, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 55.56666666666666, "ram_util_percent": 96.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8135912332683803, "cur_kl_coeff": 3.6222716315306846e-72, "cur_lr": 1e-07, "total_loss": 2.1332234665751457, "policy_loss": -0.0002932809176854789, "vf_loss": 9.76336744427681, "vf_explained_var": -0.00012795515358448027, "kl": 3.3621838678499215e-06, "entropy": 3.0732511222362517, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "env_runners": {"episode_reward_max": 118.86412929478469, "episode_reward_min": 78.59811630365141, "episode_reward_mean": 100.77713555929512, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.59811630365141}, "policy_reward_max": {"tplp_policy": 118.86412929478469}, "policy_reward_mean": {"tplp_policy": 100.77713555929512}, "custom_metrics": {"mean_episode_reward_mean": 100.77713555929512, "mean_episode_reward_min": 78.59811630365141, "mean_episode_reward_max": 118.86412929478469}, "hist_stats": {"episode_reward": [103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.70617691714138, 98.28411648085887, 109.79411143732902, 106.10082053246178, 107.69452970521114, 84.29707910902584, 110.45277647615103, 101.71775930207768, 94.19590787877894, 93.51433929446563, 115.26796486113766, 81.80407013792431, 99.76641709610064, 112.50531896263827, 94.4447555211342, 91.60426855104949, 99.72270642583443, 106.51458377692379, 109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.729842354809132, "mean_inference_ms": 2.1099144931375715, "mean_action_processing_ms": 0.39904522261085673, "mean_env_wait_ms": 2.344363873201009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006981372833251953, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.26317381858825684}, "num_episodes": 22, "episode_return_max": 118.86412929478469, "episode_return_min": 78.59811630365141, "episode_return_mean": 100.77713555929512, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 407.2472640266223, "num_env_steps_trained_throughput_per_sec": 407.2472640266223, "timesteps_total": 241664, "num_env_steps_sampled_lifetime": 241664, "num_agent_steps_sampled_lifetime": 241664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 241664, "timers": {"training_iteration_time_ms": 2628.095, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2628.095, "sample_time_ms": 1072.196, "learn_time_ms": 1535.292, "learn_throughput": 666.974, "synch_weights_time_ms": 20.403}, "counters": {"num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "done": false, "training_iteration": 236, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-07", "timestamp": 1744167607, "time_this_iter_s": 2.5223214626312256, "time_total_s": 594.2040221691132, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1BF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.2040221691132, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 39.4, "ram_util_percent": 96.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7698278181254863, "cur_kl_coeff": 1.8111358157653423e-72, "cur_lr": 1e-07, "total_loss": 2.1420880265533926, "policy_loss": -0.00019546677940525116, "vf_loss": 9.798486757278443, "vf_explained_var": -0.00015052482485771178, "kl": 1.6139753714866645e-06, "entropy": 3.0733818039298058, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "env_runners": {"episode_reward_max": 118.86412929478469, "episode_reward_min": 78.59811630365141, "episode_reward_mean": 101.13909295166012, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.59811630365141}, "policy_reward_max": {"tplp_policy": 118.86412929478469}, "policy_reward_mean": {"tplp_policy": 101.13909295166012}, "custom_metrics": {"mean_episode_reward_mean": 101.13909295166012, "mean_episode_reward_min": 78.59811630365141, "mean_episode_reward_max": 118.86412929478469}, "hist_stats": {"episode_reward": [109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [109.29268537186246, 111.98467527862255, 108.13477024994435, 110.63014886917082, 103.91240061631464, 101.39365090059887, 105.32327007934954, 90.21853137092745, 110.15964584146396, 89.5716443339179, 93.17600732556237, 94.89865694158166, 90.59174323756969, 103.4805484503888, 97.93903585580337, 89.94296611731471, 106.01632362794568, 104.31151872896159, 105.10701727874597, 115.21719276359076, 104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7300965678667076, "mean_inference_ms": 2.1106154121904037, "mean_action_processing_ms": 0.3991443270444682, "mean_env_wait_ms": 2.344892672833495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006980419158935547, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.2518582344055176}, "num_episodes": 18, "episode_return_max": 118.86412929478469, "episode_return_min": 78.59811630365141, "episode_return_mean": 101.13909295166012, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 370.59620677441217, "num_env_steps_trained_throughput_per_sec": 370.59620677441217, "timesteps_total": 242688, "num_env_steps_sampled_lifetime": 242688, "num_agent_steps_sampled_lifetime": 242688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 242688, "timers": {"training_iteration_time_ms": 2649.731, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2649.731, "sample_time_ms": 1077.878, "learn_time_ms": 1551.084, "learn_throughput": 660.184, "synch_weights_time_ms": 20.566}, "counters": {"num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "done": false, "training_iteration": 237, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-10", "timestamp": 1744167610, "time_this_iter_s": 2.769928216934204, "time_total_s": 596.9739503860474, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1CFE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 596.9739503860474, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 44.50000000000001, "ram_util_percent": 96.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.403401701152324, "cur_kl_coeff": 9.055679078826712e-73, "cur_lr": 1e-07, "total_loss": 2.1149366199970245, "policy_loss": -0.000402236107038334, "vf_loss": 9.690841084718704, "vf_explained_var": -0.0001584678888320923, "kl": 4.1385316906297764e-06, "entropy": 3.0737141400575636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "env_runners": {"episode_reward_max": 118.86412929478469, "episode_reward_min": 78.59811630365141, "episode_reward_mean": 100.30275442731967, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.59811630365141}, "policy_reward_max": {"tplp_policy": 118.86412929478469}, "policy_reward_mean": {"tplp_policy": 100.30275442731967}, "custom_metrics": {"mean_episode_reward_mean": 100.30275442731967, "mean_episode_reward_min": 78.59811630365141, "mean_episode_reward_max": 118.86412929478469}, "hist_stats": {"episode_reward": [104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [104.7275227086663, 98.7232926135813, 107.35408527509604, 103.88731011061505, 106.05839157293855, 90.06453709981145, 104.22920339801122, 91.00788348873209, 117.83976216792611, 96.87546585972517, 102.41691953761364, 117.39095429462552, 86.3838713488138, 90.06214460450903, 105.72510015434925, 106.02477326314452, 92.38860931115978, 112.54065238789235, 95.34890695096139, 96.74657058890826, 114.35378957425542, 114.37808611943758, 101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7303719273443554, "mean_inference_ms": 2.1112439308035937, "mean_action_processing_ms": 0.39918273527522147, "mean_env_wait_ms": 2.3455110480108505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009978771209716797, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.2231895923614502}, "num_episodes": 20, "episode_return_max": 118.86412929478469, "episode_return_min": 78.59811630365141, "episode_return_mean": 100.30275442731967, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 359.58773233039824, "num_env_steps_trained_throughput_per_sec": 359.58773233039824, "timesteps_total": 243712, "num_env_steps_sampled_lifetime": 243712, "num_agent_steps_sampled_lifetime": 243712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 243712, "timers": {"training_iteration_time_ms": 2665.507, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2665.507, "sample_time_ms": 1084.529, "learn_time_ms": 1559.352, "learn_throughput": 656.683, "synch_weights_time_ms": 21.521}, "counters": {"num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "done": false, "training_iteration": 238, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-13", "timestamp": 1744167613, "time_this_iter_s": 2.8551230430603027, "time_total_s": 599.8290734291077, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D18720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 599.8290734291077, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 48.699999999999996, "ram_util_percent": 96.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7152541056275368, "cur_kl_coeff": 4.527839539413356e-73, "cur_lr": 1e-07, "total_loss": 2.108012522757053, "policy_loss": -0.00016812156536616385, "vf_loss": 9.66250159740448, "vf_explained_var": -0.00015345178544521332, "kl": 1.7144390767498407e-06, "entropy": 3.074447423219681, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "env_runners": {"episode_reward_max": 118.86412929478469, "episode_reward_min": 78.59811630365141, "episode_reward_mean": 99.53909152541877, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.59811630365141}, "policy_reward_max": {"tplp_policy": 118.86412929478469}, "policy_reward_mean": {"tplp_policy": 99.53909152541877}, "custom_metrics": {"mean_episode_reward_mean": 99.53909152541877, "mean_episode_reward_min": 78.59811630365141, "mean_episode_reward_max": 118.86412929478469}, "hist_stats": {"episode_reward": [101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [101.57677301125986, 100.31921899487199, 106.30189186797452, 90.44685117917933, 103.8273025212106, 108.31226403418992, 118.86412929478469, 78.59811630365141, 88.91828850684473, 107.78141263377472, 96.7249562215994, 86.72059669239736, 86.14968054679146, 109.7354823707802, 109.6066973981858, 85.4611415302296, 105.19787194651784, 103.7609221848703, 86.70020333565662, 95.24172863100526, 85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7308480504365897, "mean_inference_ms": 2.1123522447301353, "mean_action_processing_ms": 0.3992437929851366, "mean_env_wait_ms": 2.3466278601675974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00798487663269043, "StateBufferConnector_ms": 0.007485389709472656, "ViewRequirementAgentConnector_ms": 0.22646379470825195}, "num_episodes": 22, "episode_return_max": 118.86412929478469, "episode_return_min": 78.59811630365141, "episode_return_mean": 99.53909152541877, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 365.91581895523126, "num_env_steps_trained_throughput_per_sec": 365.91581895523126, "timesteps_total": 244736, "num_env_steps_sampled_lifetime": 244736, "num_agent_steps_sampled_lifetime": 244736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 244736, "timers": {"training_iteration_time_ms": 2687.628, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2687.628, "sample_time_ms": 1082.968, "learn_time_ms": 1581.618, "learn_throughput": 647.438, "synch_weights_time_ms": 22.937}, "counters": {"num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "done": false, "training_iteration": 239, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-16", "timestamp": 1744167616, "time_this_iter_s": 2.806469202041626, "time_total_s": 602.6355426311493, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1CC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 602.6355426311493, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 48.7, "ram_util_percent": 96.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.066353257745504, "cur_kl_coeff": 2.263919769706678e-73, "cur_lr": 1e-07, "total_loss": 2.0950832448899748, "policy_loss": -0.00022049380640964955, "vf_loss": 9.611108070611953, "vf_explained_var": -0.00016020722687244416, "kl": 1.5824741362246987e-06, "entropy": 3.074732595682144, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "env_runners": {"episode_reward_max": 117.67851716654143, "episode_reward_min": 78.14389133827765, "episode_reward_mean": 99.35857293389213, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.14389133827765}, "policy_reward_max": {"tplp_policy": 117.67851716654143}, "policy_reward_mean": {"tplp_policy": 99.35857293389213}, "custom_metrics": {"mean_episode_reward_mean": 99.35857293389213, "mean_episode_reward_min": 78.14389133827765, "mean_episode_reward_max": 117.67851716654143}, "hist_stats": {"episode_reward": [85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [85.10245531105238, 101.47632013636964, 92.82169221269382, 88.18558349061426, 108.00098078762935, 93.1110304544836, 105.91718930186111, 106.38763205419085, 111.42190350696046, 84.95550095848178, 104.3669499170463, 108.05932349146957, 99.55907925834691, 109.19647569242001, 105.00235788794346, 96.29727992578327, 94.68166561870355, 85.48009608297468, 111.41503893683766, 108.81150356121849, 84.4482446606435, 113.58726322957455, 79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7312239172276329, "mean_inference_ms": 2.113421273750603, "mean_action_processing_ms": 0.39931276735687665, "mean_env_wait_ms": 2.3477919978307313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006987333297729492, "StateBufferConnector_ms": 0.0075452327728271484, "ViewRequirementAgentConnector_ms": 0.21020150184631348}, "num_episodes": 20, "episode_return_max": 117.67851716654143, "episode_return_min": 78.14389133827765, "episode_return_mean": 99.35857293389213, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 371.1319607539005, "num_env_steps_trained_throughput_per_sec": 371.1319607539005, "timesteps_total": 245760, "num_env_steps_sampled_lifetime": 245760, "num_agent_steps_sampled_lifetime": 245760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 2744.428, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2744.428, "sample_time_ms": 1101.827, "learn_time_ms": 1619.004, "learn_throughput": 632.488, "synch_weights_time_ms": 23.492}, "counters": {"num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "training_iteration": 240, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-19", "timestamp": 1744167619, "time_this_iter_s": 2.7671191692352295, "time_total_s": 605.4026618003845, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D1AA20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 605.4026618003845, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 45.425, "ram_util_percent": 96.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.842950862273574, "cur_kl_coeff": 1.131959884853339e-73, "cur_lr": 1e-07, "total_loss": 2.131070598959923, "policy_loss": -0.00025492681306786834, "vf_loss": 9.755488437414169, "vf_explained_var": -0.00015037134289741516, "kl": 3.499313228938483e-06, "entropy": 3.075465740263462, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "env_runners": {"episode_reward_max": 117.67851716654143, "episode_reward_min": 78.14389133827765, "episode_reward_mean": 99.28927291426271, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.14389133827765}, "policy_reward_max": {"tplp_policy": 117.67851716654143}, "policy_reward_mean": {"tplp_policy": 99.28927291426271}, "custom_metrics": {"mean_episode_reward_mean": 99.28927291426271, "mean_episode_reward_min": 78.14389133827765, "mean_episode_reward_max": 117.67851716654143}, "hist_stats": {"episode_reward": [79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [79.16468259058699, 105.35980039798866, 83.74751720217157, 100.66336302384752, 105.25514749459218, 106.49640565942947, 101.80380136983723, 114.48471939864203, 105.57227763042586, 111.79985690910998, 107.67704692230895, 116.68041430184593, 117.0645232130214, 96.22813220488938, 96.26011860301148, 101.29012689081496, 103.61167769933083, 78.66800544549038, 103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7316665487283516, "mean_inference_ms": 2.1147794809457126, "mean_action_processing_ms": 0.39941464057783216, "mean_env_wait_ms": 2.3493247317718744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008983373641967773, "StateBufferConnector_ms": 0.011521577835083008, "ViewRequirementAgentConnector_ms": 0.2013990879058838}, "num_episodes": 22, "episode_return_max": 117.67851716654143, "episode_return_min": 78.14389133827765, "episode_return_mean": 99.28927291426271, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 368.22548225474026, "num_env_steps_trained_throughput_per_sec": 368.22548225474026, "timesteps_total": 246784, "num_env_steps_sampled_lifetime": 246784, "num_agent_steps_sampled_lifetime": 246784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 246784, "timers": {"training_iteration_time_ms": 2714.102, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2714.102, "sample_time_ms": 1111.861, "learn_time_ms": 1578.733, "learn_throughput": 648.621, "synch_weights_time_ms": 23.407}, "counters": {"num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "done": false, "training_iteration": 241, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-22", "timestamp": 1744167622, "time_this_iter_s": 2.7873570919036865, "time_total_s": 608.1900188922882, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1CB80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 608.1900188922882, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 48.575, "ram_util_percent": 96.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8498823188245295, "cur_kl_coeff": 5.659799424266695e-74, "cur_lr": 1e-07, "total_loss": 2.1252831637859346, "policy_loss": -0.00034573445445857943, "vf_loss": 9.733248329162597, "vf_explained_var": -0.00016811229288578035, "kl": 3.757628767164789e-06, "entropy": 3.076831948757172, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "env_runners": {"episode_reward_max": 124.62730228029544, "episode_reward_min": 78.14389133827765, "episode_reward_mean": 99.04157324678673, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.14389133827765}, "policy_reward_max": {"tplp_policy": 124.62730228029544}, "policy_reward_mean": {"tplp_policy": 99.04157324678673}, "custom_metrics": {"mean_episode_reward_mean": 99.04157324678673, "mean_episode_reward_min": 78.14389133827765, "mean_episode_reward_max": 124.62730228029544}, "hist_stats": {"episode_reward": [103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.46209233666941, 96.78910232082245, 110.44586099988338, 84.75186556830027, 96.66815282689585, 93.01814689325418, 102.12212726862693, 92.26138647707675, 102.68725839097132, 93.43924425783692, 117.67851716654143, 90.71501391224118, 109.65560358729296, 85.61179960998486, 110.1181590161527, 98.5573588886651, 95.57098045213591, 91.83622768742214, 83.98481328178445, 98.94393601963772, 101.14717326617803, 105.96287554297002, 96.66207270880426, 97.87490089172901, 100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7320150319624983, "mean_inference_ms": 2.115783887702574, "mean_action_processing_ms": 0.39956947419212574, "mean_env_wait_ms": 2.3505787286089412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989002227783203, "StateBufferConnector_ms": 0.012518882751464844, "ViewRequirementAgentConnector_ms": 0.20400142669677734}, "num_episodes": 18, "episode_return_max": 124.62730228029544, "episode_return_min": 78.14389133827765, "episode_return_mean": 99.04157324678673, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 370.29455461976795, "num_env_steps_trained_throughput_per_sec": 370.29455461976795, "timesteps_total": 247808, "num_env_steps_sampled_lifetime": 247808, "num_agent_steps_sampled_lifetime": 247808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 247808, "timers": {"training_iteration_time_ms": 2703.754, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2703.754, "sample_time_ms": 1103.088, "learn_time_ms": 1576.505, "learn_throughput": 649.538, "synch_weights_time_ms": 24.06}, "counters": {"num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "done": false, "training_iteration": 242, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-25", "timestamp": 1744167625, "time_this_iter_s": 2.7748844623565674, "time_total_s": 610.9649033546448, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1D120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.9649033546448, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 63.199999999999996, "ram_util_percent": 96.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.198441068828106, "cur_kl_coeff": 2.8298997121333474e-74, "cur_lr": 1e-07, "total_loss": 2.1135785840451717, "policy_loss": -0.00013535262551158666, "vf_loss": 9.686042910814285, "vf_explained_var": -0.00014760494232177735, "kl": 2.984632661817699e-06, "entropy": 3.077967938780785, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "env_runners": {"episode_reward_max": 124.62730228029544, "episode_reward_min": 78.14389133827765, "episode_reward_mean": 99.99353364532595, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.14389133827765}, "policy_reward_max": {"tplp_policy": 124.62730228029544}, "policy_reward_mean": {"tplp_policy": 99.99353364532595}, "custom_metrics": {"mean_episode_reward_mean": 99.99353364532595, "mean_episode_reward_min": 78.14389133827765, "mean_episode_reward_max": 124.62730228029544}, "hist_stats": {"episode_reward": [100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [100.76628138623785, 100.84309563605022, 86.10345876582764, 112.24889690952904, 95.03180467209579, 110.4696598185227, 88.01834348909736, 96.60771629377533, 106.92027376368658, 107.48963837649028, 91.24745190580973, 108.31014951505033, 86.30830961596435, 104.35507961274877, 81.36250881011676, 117.50310195857887, 96.52761349597732, 90.63336023248203, 103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7323188874238704, "mean_inference_ms": 2.1169785406402792, "mean_action_processing_ms": 0.3997326101915779, "mean_env_wait_ms": 2.352121575296487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005986213684082031, "StateBufferConnector_ms": 0.015514612197875977, "ViewRequirementAgentConnector_ms": 0.22675776481628418}, "num_episodes": 24, "episode_return_max": 124.62730228029544, "episode_return_min": 78.14389133827765, "episode_return_mean": 99.99353364532595, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 391.87142942647466, "num_env_steps_trained_throughput_per_sec": 391.87142942647466, "timesteps_total": 248832, "num_env_steps_sampled_lifetime": 248832, "num_agent_steps_sampled_lifetime": 248832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 248832, "timers": {"training_iteration_time_ms": 2687.657, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2687.657, "sample_time_ms": 1090.569, "learn_time_ms": 1572.936, "learn_throughput": 651.012, "synch_weights_time_ms": 24.052}, "counters": {"num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "done": false, "training_iteration": 243, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-27", "timestamp": 1744167627, "time_this_iter_s": 2.619948148727417, "time_total_s": 613.5848515033722, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3D19B20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.5848515033722, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 50.050000000000004, "ram_util_percent": 96.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6822732482105494, "cur_kl_coeff": 1.4149498560666737e-74, "cur_lr": 1e-07, "total_loss": 2.1221055686473846, "policy_loss": -0.00018931630766019225, "vf_loss": 9.721480506658555, "vf_explained_var": -0.00014950521290302277, "kl": 3.331698958231044e-06, "entropy": 3.080752269923687, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "env_runners": {"episode_reward_max": 124.62730228029544, "episode_reward_min": 78.14389133827765, "episode_reward_mean": 100.31290739187331, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.14389133827765}, "policy_reward_max": {"tplp_policy": 124.62730228029544}, "policy_reward_mean": {"tplp_policy": 100.31290739187331}, "custom_metrics": {"mean_episode_reward_mean": 100.31290739187331, "mean_episode_reward_min": 78.14389133827765, "mean_episode_reward_max": 124.62730228029544}, "hist_stats": {"episode_reward": [103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734, 108.98274233117859, 122.94654541057955, 95.77344347452512, 107.73416803548129, 113.41326593242925, 101.20564330801732, 104.92346743087224, 97.85896934459034, 107.09019092142785, 95.68334395403049, 86.13365975907143, 93.27393742999301, 101.35481065328855, 90.31428896768871, 101.46071190816217, 102.56838753831296, 84.07407697943822, 97.89246553368919], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [103.79039718566284, 91.64933882117441, 78.14389133827765, 93.61109060088586, 104.51634480441152, 83.29317717271532, 112.63297809163502, 95.91917565809342, 105.84736125264605, 112.9446333647936, 90.9109678166191, 100.4576149079838, 100.83763590650776, 110.0787017656534, 86.99151942439447, 106.56076011302079, 98.19091958401819, 88.65618851615721, 97.64263834571565, 95.40557917761535, 89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734, 108.98274233117859, 122.94654541057955, 95.77344347452512, 107.73416803548129, 113.41326593242925, 101.20564330801732, 104.92346743087224, 97.85896934459034, 107.09019092142785, 95.68334395403049, 86.13365975907143, 93.27393742999301, 101.35481065328855, 90.31428896768871, 101.46071190816217, 102.56838753831296, 84.07407697943822, 97.89246553368919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7326243921719324, "mean_inference_ms": 2.1177043492685867, "mean_action_processing_ms": 0.3999235555837815, "mean_env_wait_ms": 2.352941640513249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006983757019042969, "StateBufferConnector_ms": 0.014026880264282227, "ViewRequirementAgentConnector_ms": 0.22675776481628418}, "num_episodes": 18, "episode_return_max": 124.62730228029544, "episode_return_min": 78.14389133827765, "episode_return_mean": 100.31290739187331, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 352.3468031195768, "num_env_steps_trained_throughput_per_sec": 352.3468031195768, "timesteps_total": 249856, "num_env_steps_sampled_lifetime": 249856, "num_agent_steps_sampled_lifetime": 249856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 249856, "timers": {"training_iteration_time_ms": 2737.908, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2737.908, "sample_time_ms": 1102.485, "learn_time_ms": 1610.629, "learn_throughput": 635.777, "synch_weights_time_ms": 24.694}, "counters": {"num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "done": false, "training_iteration": 244, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-30", "timestamp": 1744167630, "time_this_iter_s": 2.9148402214050293, "time_total_s": 616.4996917247772, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1CB80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.4996917247772, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 49.75, "ram_util_percent": 96.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.868096944689751, "cur_kl_coeff": 7.074749280333368e-75, "cur_lr": 1e-07, "total_loss": 2.135188266634941, "policy_loss": -0.0001681429333984852, "vf_loss": 9.774254167079926, "vf_explained_var": -0.00016010142862796784, "kl": 1.8285565470704812e-06, "entropy": 3.0820713222026823, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "env_runners": {"episode_reward_max": 124.62730228029544, "episode_reward_min": 78.8828350997856, "episode_reward_mean": 100.48999802492399, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 78.8828350997856}, "policy_reward_max": {"tplp_policy": 124.62730228029544}, "policy_reward_mean": {"tplp_policy": 100.48999802492399}, "custom_metrics": {"mean_episode_reward_mean": 100.48999802492399, "mean_episode_reward_min": 78.8828350997856, "mean_episode_reward_max": 124.62730228029544}, "hist_stats": {"episode_reward": [89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734, 108.98274233117859, 122.94654541057955, 95.77344347452512, 107.73416803548129, 113.41326593242925, 101.20564330801732, 104.92346743087224, 97.85896934459034, 107.09019092142785, 95.68334395403049, 86.13365975907143, 93.27393742999301, 101.35481065328855, 90.31428896768871, 101.46071190816217, 102.56838753831296, 84.07407697943822, 97.89246553368919, 103.29095853302653, 100.04259376104928, 78.8828350997856, 110.73202679383286, 92.6020662731587, 103.90033221672917, 109.8615546470686, 107.42046970302778, 101.72882811287323, 101.64875324469506, 101.0847446471373, 80.98323759579527, 83.48169883930859, 106.22311694823777, 106.33363198485885, 98.78286608065704, 95.82320108661126, 94.1010604145701, 106.61400315624378, 92.25199801438085], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [89.57906008928617, 109.61269920939154, 97.5926384440118, 97.23914874599771, 81.72132188915545, 94.70941094283893, 112.85203201485291, 95.3274468947881, 95.99808784436094, 116.30593277418491, 108.75455383122673, 97.7271935760686, 101.05172187490058, 94.18331336555603, 102.42928868754517, 100.42199052829295, 101.54335662987981, 92.1437440338458, 114.16657421587055, 94.94783139897316, 124.62730228029544, 101.04198220957282, 105.45706536976017, 90.76233143501936, 110.69891187895537, 100.69232636389182, 92.13258484462119, 92.50628745980482, 112.23524924524193, 89.00410067927326, 92.790304834351, 101.80740933421595, 102.66634640005478, 97.14161075203015, 92.49617816611422, 87.62108223342295, 101.17572623644031, 112.20085048667957, 95.55526010641648, 88.63501072172735, 84.35251102622348, 121.75297568812454, 112.63101308486547, 112.02789166387868, 94.68649383545048, 102.9222001579101, 110.19818724331334, 106.33268402785403, 109.09864012818369, 108.52828366955437, 96.97135344523909, 96.87796468117172, 106.83427120550338, 100.1806340649459, 106.08905202582137, 107.480346340759, 101.81044188275933, 102.83343436594552, 93.19834580206323, 108.80719292354165, 85.77949241404029, 101.57702872050734, 108.98274233117859, 122.94654541057955, 95.77344347452512, 107.73416803548129, 113.41326593242925, 101.20564330801732, 104.92346743087224, 97.85896934459034, 107.09019092142785, 95.68334395403049, 86.13365975907143, 93.27393742999301, 101.35481065328855, 90.31428896768871, 101.46071190816217, 102.56838753831296, 84.07407697943822, 97.89246553368919, 103.29095853302653, 100.04259376104928, 78.8828350997856, 110.73202679383286, 92.6020662731587, 103.90033221672917, 109.8615546470686, 107.42046970302778, 101.72882811287323, 101.64875324469506, 101.0847446471373, 80.98323759579527, 83.48169883930859, 106.22311694823777, 106.33363198485885, 98.78286608065704, 95.82320108661126, 94.1010604145701, 106.61400315624378, 92.25199801438085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7329083693425616, "mean_inference_ms": 2.1185067946342233, "mean_action_processing_ms": 0.4000782587578297, "mean_env_wait_ms": 2.3540740104526936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008982181549072266, "StateBufferConnector_ms": 0.014961957931518555, "ViewRequirementAgentConnector_ms": 0.22432374954223633}, "num_episodes": 20, "episode_return_max": 124.62730228029544, "episode_return_min": 78.8828350997856, "episode_return_mean": 100.48999802492399, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 363.34304336589344, "num_env_steps_trained_throughput_per_sec": 363.34304336589344, "timesteps_total": 250880, "num_env_steps_sampled_lifetime": 250880, "num_agent_steps_sampled_lifetime": 250880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 250880, "timers": {"training_iteration_time_ms": 2756.672, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2756.672, "sample_time_ms": 1106.854, "learn_time_ms": 1624.577, "learn_throughput": 630.318, "synch_weights_time_ms": 25.042}, "counters": {"num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "done": true, "training_iteration": 245, "trial_id": "374cd_00000", "date": "2025-04-09_11-00-33", "timestamp": 1744167633, "time_this_iter_s": 2.826085090637207, "time_total_s": 619.3257768154144, "pid": 24620, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x0000027BE3E1D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 619.3257768154144, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 51.574999999999996, "ram_util_percent": 96.475}}
