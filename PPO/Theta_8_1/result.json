{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.196221874654293, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 1e-07, "total_loss": 2.21685089841485, "policy_loss": 5.972958751954138e-05, "vf_loss": 10.0, "vf_explained_var": -1.3571232557296753e-06, "kl": 0.00016505504781889614, "entropy": 2.8324184313416483, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "env_runners": {"episode_reward_max": 503.3058061505168, "episode_reward_min": 417.76233986364804, "episode_reward_mean": 473.60256032640405, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 900, "policy_reward_min": {"tplp_policy": 417.76233986364804}, "policy_reward_max": {"tplp_policy": 503.3058061505168}, "policy_reward_mean": {"tplp_policy": 473.60256032640405}, "custom_metrics": {"mean_episode_reward_mean": 473.60256032640405, "mean_episode_reward_min": 417.76233986364804, "mean_episode_reward_max": 503.3058061505168}, "hist_stats": {"episode_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3052720642893973, "mean_inference_ms": 3.8471426334335277, "mean_action_processing_ms": 0.6664795087954146, "mean_env_wait_ms": 3.9782272452937164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011222892337375216, "StateBufferConnector_ms": 0.014411078559027778, "ViewRequirementAgentConnector_ms": 0.42239824930826825}, "num_episodes": 18, "episode_return_max": 503.3058061505168, "episode_return_min": 417.76233986364804, "episode_return_mean": 473.60256032640405, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 228.3826976588867, "num_env_steps_trained_throughput_per_sec": 228.3826976588867, "timesteps_total": 1024, "num_env_steps_sampled_lifetime": 1024, "num_agent_steps_sampled_lifetime": 1024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 4483.702, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4483.702, "sample_time_ms": 1755.623, "learn_time_ms": 2687.769, "learn_throughput": 380.985, "synch_weights_time_ms": 40.31}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "training_iteration": 1, "trial_id": "f7884_00000", "date": "2025-04-08_23-42-56", "timestamp": 1744126976, "time_this_iter_s": 4.491840839385986, "time_total_s": 4.491840839385986, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA1E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4.491840839385986, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.457142857142856, "ram_util_percent": 90.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0174101568758487, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 1e-07, "total_loss": 2.214087888598442, "policy_loss": -0.00015235745231620968, "vf_loss": 9.990485668182373, "vf_explained_var": -1.3828277587890625e-06, "kl": 2.1205802796187e-06, "entropy": 2.8338134422898293, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "env_runners": {"episode_reward_max": 509.41769753842135, "episode_reward_min": 417.76233986364804, "episode_reward_mean": 473.4622843129186, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 1800, "policy_reward_min": {"tplp_policy": 417.76233986364804}, "policy_reward_max": {"tplp_policy": 509.41769753842135}, "policy_reward_mean": {"tplp_policy": 473.4622843129186}, "custom_metrics": {"mean_episode_reward_mean": 473.4622843129186, "mean_episode_reward_min": 417.76233986364804, "mean_episode_reward_max": 509.41769753842135}, "hist_stats": {"episode_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3723922704816913, "mean_inference_ms": 3.9809314169877643, "mean_action_processing_ms": 0.7128253166960759, "mean_env_wait_ms": 4.041054302803796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023102098041110568, "StateBufferConnector_ms": 0.016929043663872614, "ViewRequirementAgentConnector_ms": 0.4782213105095757}, "num_episodes": 18, "episode_return_max": 509.41769753842135, "episode_return_min": 417.76233986364804, "episode_return_mean": 473.4622843129186, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 193.76237820565828, "num_env_steps_trained_throughput_per_sec": 193.76237820565828, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 2048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 4884.263, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4884.263, "sample_time_ms": 1905.833, "learn_time_ms": 2934.934, "learn_throughput": 348.901, "synch_weights_time_ms": 42.931}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "training_iteration": 2, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-01", "timestamp": 1744126981, "time_this_iter_s": 5.305519104003906, "time_total_s": 9.797359943389893, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.797359943389893, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 62.79999999999999, "ram_util_percent": 90.47142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4458993449807167, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 1e-07, "total_loss": 2.2152667976915836, "policy_loss": -0.0002030376432230696, "vf_loss": 9.996109318733215, "vf_explained_var": -1.1194497346878052e-06, "kl": 1.8038589792324089e-06, "entropy": 2.835575769841671, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "env_runners": {"episode_reward_max": 509.41769753842135, "episode_reward_min": 417.76233986364804, "episode_reward_mean": 469.8893906849792, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"tplp_policy": 417.76233986364804}, "policy_reward_max": {"tplp_policy": 509.41769753842135}, "policy_reward_mean": {"tplp_policy": 469.8893906849792}, "custom_metrics": {"mean_episode_reward_mean": 469.8893906849792, "mean_episode_reward_min": 417.76233986364804, "mean_episode_reward_max": 509.41769753842135}, "hist_stats": {"episode_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4646830825533654, "mean_inference_ms": 4.197772284469953, "mean_action_processing_ms": 0.7555819591955728, "mean_env_wait_ms": 4.17502719036329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017880598704020183, "StateBufferConnector_ms": 0.01961827278137207, "ViewRequirementAgentConnector_ms": 0.45676549275716144}, "num_episodes": 24, "episode_return_max": 509.41769753842135, "episode_return_min": 417.76233986364804, "episode_return_mean": 469.8893906849792, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 161.808169999708, "num_env_steps_trained_throughput_per_sec": 161.808169999708, "timesteps_total": 3072, "num_env_steps_sampled_lifetime": 3072, "num_agent_steps_sampled_lifetime": 3072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 5365.669, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5365.669, "sample_time_ms": 2042.947, "learn_time_ms": 3280.271, "learn_throughput": 312.169, "synch_weights_time_ms": 42.075}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "training_iteration": 3, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-08", "timestamp": 1744126988, "time_this_iter_s": 6.344799518585205, "time_total_s": 16.142159461975098, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA0EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16.142159461975098, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 80.74444444444444, "ram_util_percent": 91.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1699587110430003, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 1e-07, "total_loss": 2.2048582710325717, "policy_loss": -0.00011888722074218094, "vf_loss": 9.9547585606575, "vf_explained_var": -1.389533281326294e-06, "kl": 1.0713290027553058e-06, "entropy": 2.8371246293187142, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "env_runners": {"episode_reward_max": 509.4876684044063, "episode_reward_min": 396.9336003987148, "episode_reward_mean": 470.05574031486367, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3900, "policy_reward_min": {"tplp_policy": 396.9336003987148}, "policy_reward_max": {"tplp_policy": 509.4876684044063}, "policy_reward_mean": {"tplp_policy": 470.05574031486367}, "custom_metrics": {"mean_episode_reward_mean": 470.05574031486367, "mean_episode_reward_min": 396.9336003987148, "mean_episode_reward_max": 509.4876684044063}, "hist_stats": {"episode_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.15024549398504, 475.1261222528167, 503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4942531607580443, "mean_inference_ms": 4.267723571754588, "mean_action_processing_ms": 0.7711568206766979, "mean_env_wait_ms": 4.222342823616351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025874834794264574, "StateBufferConnector_ms": 0.019004406073154546, "ViewRequirementAgentConnector_ms": 0.45131230965638774}, "num_episodes": 18, "episode_return_max": 509.4876684044063, "episode_return_min": 396.9336003987148, "episode_return_mean": 470.05574031486367, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 173.61567712590175, "num_env_steps_trained_throughput_per_sec": 173.61567712590175, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 4096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 5498.773, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5498.773, "sample_time_ms": 2074.73, "learn_time_ms": 3381.692, "learn_throughput": 302.807, "synch_weights_time_ms": 42.069}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "training_iteration": 4, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-14", "timestamp": 1744126994, "time_this_iter_s": 5.917117118835449, "time_total_s": 22.059276580810547, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22.059276580810547, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 82.325, "ram_util_percent": 91.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.039536829665303, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 1e-07, "total_loss": 2.2161446429789065, "policy_loss": -3.917015856131911e-05, "vf_loss": 10.0, "vf_explained_var": -9.577721357345582e-07, "kl": 5.87348917919367e-07, "entropy": 2.8381617590785027, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "env_runners": {"episode_reward_max": 509.4876684044063, "episode_reward_min": 396.9336003987148, "episode_reward_mean": 468.35077978619825, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 396.9336003987148}, "policy_reward_max": {"tplp_policy": 509.4876684044063}, "policy_reward_mean": {"tplp_policy": 468.35077978619825}, "custom_metrics": {"mean_episode_reward_mean": 468.35077978619825, "mean_episode_reward_min": 396.9336003987148, "mean_episode_reward_max": 509.4876684044063}, "hist_stats": {"episode_reward": [503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [503.3058061505168, 466.73293053123155, 484.82374923541704, 461.9666656031753, 458.3765893987137, 478.91076518397193, 491.61503260366726, 488.22719078884023, 417.76233986364804, 476.63664355501794, 497.9018217206842, 459.27424788153206, 482.3272301119359, 481.7604852446163, 503.03383868039754, 429.91438157510544, 458.5645708800823, 459.7910682965765, 509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.510798896344312, "mean_inference_ms": 4.3205646866346115, "mean_action_processing_ms": 0.783659305122755, "mean_env_wait_ms": 4.245335564580834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020709991455078125, "StateBufferConnector_ms": 0.018314361572265625, "ViewRequirementAgentConnector_ms": 0.4304077625274658}, "num_episodes": 24, "episode_return_max": 509.4876684044063, "episode_return_min": 396.9336003987148, "episode_return_mean": 468.35077978619825, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 199.11502761067288, "num_env_steps_trained_throughput_per_sec": 199.11502761067288, "timesteps_total": 5120, "num_env_steps_sampled_lifetime": 5120, "num_agent_steps_sampled_lifetime": 5120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 5427.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5427.57, "sample_time_ms": 2030.859, "learn_time_ms": 3354.336, "learn_throughput": 305.277, "synch_weights_time_ms": 42.149}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "training_iteration": 5, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-19", "timestamp": 1744126999, "time_this_iter_s": 5.171194553375244, "time_total_s": 27.23047113418579, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA23E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.23047113418579, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 62.68571428571429, "ram_util_percent": 91.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4194901093840597, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 1e-07, "total_loss": 2.2160405822098257, "policy_loss": -2.0461971871554852e-06, "vf_loss": 10.0, "vf_explained_var": -1.4416873455047607e-06, "kl": 6.838369223827189e-07, "entropy": 2.8395737066864966, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "env_runners": {"episode_reward_max": 523.2628225260238, "episode_reward_min": 396.9336003987148, "episode_reward_mean": 467.74179111584164, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 396.9336003987148}, "policy_reward_max": {"tplp_policy": 523.2628225260238}, "policy_reward_mean": {"tplp_policy": 467.74179111584164}, "custom_metrics": {"mean_episode_reward_mean": 467.74179111584164, "mean_episode_reward_min": 396.9336003987148, "mean_episode_reward_max": 523.2628225260238}, "hist_stats": {"episode_reward": [509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.41769753842135, 508.9072808991213, 442.1592904290415, 467.7013634212204, 470.414778570542, 509.0637341065621, 455.8225275433647, 436.55465617753, 477.2907306356415, 472.76819258331915, 456.07317187313265, 443.3570408604504, 495.28450381910204, 504.2581483398939, 473.4385940672774, 478.9287993485141, 497.68903119878144, 492.3695574333294, 431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5725807501361848, "mean_inference_ms": 4.485990783736512, "mean_action_processing_ms": 0.8199062322826061, "mean_env_wait_ms": 4.398064157717563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020699262619018555, "StateBufferConnector_ms": 0.016760826110839844, "ViewRequirementAgentConnector_ms": 0.4972798824310303}, "num_episodes": 18, "episode_return_max": 523.2628225260238, "episode_return_min": 396.9336003987148, "episode_return_mean": 467.74179111584164, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 112.04754546177898, "num_env_steps_trained_throughput_per_sec": 112.04754546177898, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 6144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 6046.138, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6046.138, "sample_time_ms": 2233.505, "learn_time_ms": 3770.663, "learn_throughput": 271.57, "synch_weights_time_ms": 41.782}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "training_iteration": 6, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-28", "timestamp": 1744127008, "time_this_iter_s": 9.154149055480957, "time_total_s": 36.38462018966675, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.38462018966675, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 97.07272727272726, "ram_util_percent": 91.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1568161921575664, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 1e-07, "total_loss": 2.211540074646473, "policy_loss": -0.0001375123916659504, "vf_loss": 9.982780176401139, "vf_explained_var": -1.6178935766220093e-06, "kl": 6.137438700815067e-07, "entropy": 2.8401745706796646, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "env_runners": {"episode_reward_max": 523.2628225260238, "episode_reward_min": 396.9336003987148, "episode_reward_mean": 466.35779173999106, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 396.9336003987148}, "policy_reward_max": {"tplp_policy": 523.2628225260238}, "policy_reward_mean": {"tplp_policy": 466.35779173999106}, "custom_metrics": {"mean_episode_reward_mean": 466.35779173999106, "mean_episode_reward_min": 396.9336003987148, "mean_episode_reward_max": 523.2628225260238}, "hist_stats": {"episode_reward": [431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [431.1041284116705, 478.18639521310024, 430.4723098947931, 460.2714450558702, 477.61340033150196, 485.69318451296544, 443.3909487340708, 474.8585072002863, 483.56265320147605, 418.84736605924957, 448.7834566813574, 494.05186915008494, 504.4334657442784, 459.5124470629645, 466.01068816413823, 480.7002623199119, 457.0255315976362, 440.8241490568007, 468.37875129023274, 480.8754143591184, 444.0526999032005, 430.0135432568669, 483.38701362787475, 472.3048180469335, 463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598051978447542, "mean_inference_ms": 4.568949312251942, "mean_action_processing_ms": 0.8373517733448598, "mean_env_wait_ms": 4.502519807934175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02041482925415039, "StateBufferConnector_ms": 0.016895771026611328, "ViewRequirementAgentConnector_ms": 0.4953885078430176}, "num_episodes": 18, "episode_return_max": 523.2628225260238, "episode_return_min": 396.9336003987148, "episode_return_mean": 466.35779173999106, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.04194444864206, "num_env_steps_trained_throughput_per_sec": 210.04194444864206, "timesteps_total": 7168, "num_env_steps_sampled_lifetime": 7168, "num_agent_steps_sampled_lifetime": 7168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 5878.863, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5878.863, "sample_time_ms": 2173.401, "learn_time_ms": 3665.067, "learn_throughput": 279.395, "synch_weights_time_ms": 40.234}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "training_iteration": 7, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-33", "timestamp": 1744127013, "time_this_iter_s": 4.885204553604126, "time_total_s": 41.269824743270874, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.269824743270874, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 62.671428571428564, "ram_util_percent": 92.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2949764911085366, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 1e-07, "total_loss": 2.2157896630465985, "policy_loss": -0.00012447315675672143, "vf_loss": 10.0, "vf_explained_var": -1.5825033187866211e-06, "kl": 1.5829348121942922e-06, "entropy": 2.84085845798254, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "env_runners": {"episode_reward_max": 523.2628225260238, "episode_reward_min": 396.9336003987148, "episode_reward_mean": 467.32921914670857, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 396.9336003987148}, "policy_reward_max": {"tplp_policy": 523.2628225260238}, "policy_reward_mean": {"tplp_policy": 467.32921914670857}, "custom_metrics": {"mean_episode_reward_mean": 467.32921914670857, "mean_episode_reward_min": 396.9336003987148, "mean_episode_reward_max": 523.2628225260238}, "hist_stats": {"episode_reward": [463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.79210115665217, 463.24133837301576, 509.4876684044063, 488.56022629709634, 475.543925380821, 454.62816401676116, 480.68058856870186, 490.56850175205534, 396.9336003987148, 492.1242627468283, 457.9840942896078, 488.77342955940566, 442.6176146316462, 460.50445257706895, 489.0461731994387, 460.80633043358966, 482.334175089784, 483.4614351502379, 460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5821923689613056, "mean_inference_ms": 4.562339489176388, "mean_action_processing_ms": 0.8384128262858479, "mean_env_wait_ms": 4.551834442022725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02021932601928711, "StateBufferConnector_ms": 0.013283729553222656, "ViewRequirementAgentConnector_ms": 0.49225497245788574}, "num_episodes": 24, "episode_return_max": 523.2628225260238, "episode_return_min": 396.9336003987148, "episode_return_mean": 467.32921914670857, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 268.44402943118996, "num_env_steps_trained_throughput_per_sec": 268.44402943118996, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 8192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 5620.827, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5620.827, "sample_time_ms": 2091.436, "learn_time_ms": 3489.654, "learn_throughput": 293.439, "synch_weights_time_ms": 39.596}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "training_iteration": 8, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-37", "timestamp": 1744127017, "time_this_iter_s": 3.826158046722412, "time_total_s": 45.095982789993286, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC055300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.095982789993286, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.61999999999999, "ram_util_percent": 93.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2705872286111117, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 1e-07, "total_loss": 2.212434920668602, "policy_loss": -0.00014371933066286146, "vf_loss": 9.987293273210526, "vf_explained_var": -1.6726553440093994e-06, "kl": 9.715377207619724e-07, "entropy": 2.842447045445442, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "env_runners": {"episode_reward_max": 523.2628225260238, "episode_reward_min": 414.561249157898, "episode_reward_mean": 467.74537117168717, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.561249157898}, "policy_reward_max": {"tplp_policy": 523.2628225260238}, "policy_reward_mean": {"tplp_policy": 467.74537117168717}, "custom_metrics": {"mean_episode_reward_mean": 467.74537117168717, "mean_episode_reward_min": 414.561249157898, "mean_episode_reward_max": 523.2628225260238}, "hist_stats": {"episode_reward": [460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [460.9730399542648, 439.965159219594, 465.37632071554157, 484.2418816883384, 479.4950508404137, 423.0850403628474, 434.7135176087746, 432.6675039702571, 478.9112336079249, 481.5864903299557, 490.2463937146641, 496.8498253640308, 463.9223720184789, 434.52400454123153, 450.84774772467534, 474.9784149515833, 467.76484849362873, 482.60696910467345, 470.50988688171833, 450.10810602222165, 433.86690180935256, 449.97028264307465, 452.2731058058603, 488.4728993090233, 487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5661494033647916, "mean_inference_ms": 4.5488200029101025, "mean_action_processing_ms": 0.8377081078853419, "mean_env_wait_ms": 4.571603628944202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014081239700317383, "StateBufferConnector_ms": 0.011739969253540039, "ViewRequirementAgentConnector_ms": 0.4911174774169922}, "num_episodes": 18, "episode_return_max": 523.2628225260238, "episode_return_min": 414.561249157898, "episode_return_mean": 467.74537117168717, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 191.1204494297225, "num_env_steps_trained_throughput_per_sec": 191.1204494297225, "timesteps_total": 9216, "num_env_steps_sampled_lifetime": 9216, "num_agent_steps_sampled_lifetime": 9216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 5591.611, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5591.611, "sample_time_ms": 2057.425, "learn_time_ms": 3494.283, "learn_throughput": 293.05, "synch_weights_time_ms": 39.777}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "training_iteration": 9, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-43", "timestamp": 1744127023, "time_this_iter_s": 5.376880884170532, "time_total_s": 50.47286367416382, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054FE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.47286367416382, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 62.737500000000004, "ram_util_percent": 93.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.287613993883133, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 1e-07, "total_loss": 2.2150546953082086, "policy_loss": -0.00017054901691153644, "vf_loss": 9.998200780153274, "vf_explained_var": -1.449882984161377e-06, "kl": 1.2705874474105982e-06, "entropy": 2.8432496055960654, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "env_runners": {"episode_reward_max": 523.2628225260238, "episode_reward_min": 414.561249157898, "episode_reward_mean": 468.0985436021433, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.561249157898}, "policy_reward_max": {"tplp_policy": 523.2628225260238}, "policy_reward_mean": {"tplp_policy": 468.0985436021433}, "custom_metrics": {"mean_episode_reward_mean": 468.0985436021433, "mean_episode_reward_min": 414.561249157898, "mean_episode_reward_max": 523.2628225260238}, "hist_stats": {"episode_reward": [487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.8412540325232, 414.561249157898, 465.98003658924733, 523.2628225260238, 463.20759819431333, 468.5325603445225, 452.3132784144793, 474.30305028577203, 480.0800434646383, 463.8138444817281, 476.15189504020117, 469.3046274035824, 510.84353614028714, 446.96560755018004, 446.38332182492155, 455.7357597042568, 455.6730328471052, 437.508738007898, 518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.571290296520712, "mean_inference_ms": 4.603894962762816, "mean_action_processing_ms": 0.842229899013456, "mean_env_wait_ms": 4.650432774596335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01656198501586914, "StateBufferConnector_ms": 0.0124359130859375, "ViewRequirementAgentConnector_ms": 0.6638278961181641}, "num_episodes": 24, "episode_return_max": 523.2628225260238, "episode_return_min": 414.561249157898, "episode_return_mean": 468.0985436021433, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 164.76198429106233, "num_env_steps_trained_throughput_per_sec": 164.76198429106233, "timesteps_total": 10240, "num_env_steps_sampled_lifetime": 10240, "num_agent_steps_sampled_lifetime": 10240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 5653.952, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5653.952, "sample_time_ms": 2151.339, "learn_time_ms": 3462.856, "learn_throughput": 295.71, "synch_weights_time_ms": 39.644}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "training_iteration": 10, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-49", "timestamp": 1744127029, "time_this_iter_s": 6.231121301651001, "time_total_s": 56.70398497581482, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.70398497581482, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 65.12857142857142, "ram_util_percent": 94.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.114873345196247, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 1e-07, "total_loss": 2.2153951808810235, "policy_loss": -0.0001099570537917316, "vf_loss": 10.0, "vf_explained_var": -1.854822039604187e-06, "kl": 1.3429311988694126e-06, "entropy": 2.84494863152504, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "env_runners": {"episode_reward_max": 529.2884326207962, "episode_reward_min": 415.5419106218741, "episode_reward_mean": 467.7494464801297, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.5419106218741}, "policy_reward_max": {"tplp_policy": 529.2884326207962}, "policy_reward_mean": {"tplp_policy": 467.7494464801297}, "custom_metrics": {"mean_episode_reward_mean": 467.7494464801297, "mean_episode_reward_min": 415.5419106218741, "mean_episode_reward_max": 529.2884326207962}, "hist_stats": {"episode_reward": [518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [518.2626673810219, 433.43540556843817, 498.92639175628614, 489.650279276455, 444.6539333943221, 474.1297015004015, 455.9078146385373, 424.69017288573343, 444.7159931356929, 491.7298529556834, 456.8350130844312, 463.5917704334398, 506.36332562136005, 468.1099863104888, 502.29285932650475, 486.6222231363966, 447.61726665663116, 487.8637188426322, 459.4487670681157, 478.0305695158107, 476.59967098027437, 449.768323784778, 448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5706198184996385, "mean_inference_ms": 4.609954870299803, "mean_action_processing_ms": 0.8418138872403164, "mean_env_wait_ms": 4.646092654953417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018559932708740234, "StateBufferConnector_ms": 0.012426614761352539, "ViewRequirementAgentConnector_ms": 0.7502963542938232}, "num_episodes": 18, "episode_return_max": 529.2884326207962, "episode_return_min": 415.5419106218741, "episode_return_mean": 467.7494464801297, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 169.03512974243574, "num_env_steps_trained_throughput_per_sec": 169.03512974243574, "timesteps_total": 11264, "num_env_steps_sampled_lifetime": 11264, "num_agent_steps_sampled_lifetime": 11264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 5811.373, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5811.373, "sample_time_ms": 2256.594, "learn_time_ms": 3514.394, "learn_throughput": 291.373, "synch_weights_time_ms": 40.273}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "training_iteration": 11, "trial_id": "f7884_00000", "date": "2025-04-08_23-43-55", "timestamp": 1744127035, "time_this_iter_s": 6.077961444854736, "time_total_s": 62.781946420669556, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA1EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.781946420669556, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 64.4125, "ram_util_percent": 94.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9417083386331795, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 1e-07, "total_loss": 2.214549358934164, "policy_loss": -5.904630816075951e-05, "vf_loss": 9.996998804807664, "vf_explained_var": -7.446855306625366e-07, "kl": 7.1788695636954e-07, "entropy": 2.8464129373431204, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "env_runners": {"episode_reward_max": 529.2884326207962, "episode_reward_min": 415.5419106218741, "episode_reward_mean": 469.45560461690513, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.5419106218741}, "policy_reward_max": {"tplp_policy": 529.2884326207962}, "policy_reward_mean": {"tplp_policy": 469.45560461690513}, "custom_metrics": {"mean_episode_reward_mean": 469.45560461690513, "mean_episode_reward_min": 415.5419106218741, "mean_episode_reward_max": 529.2884326207962}, "hist_stats": {"episode_reward": [448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [448.229145045651, 446.9941767495701, 442.41664227194, 476.64961989105, 498.67128678222844, 434.783691530424, 493.45797999085613, 432.0006752517397, 501.01649457065696, 499.27827992383, 459.77195565289577, 442.08193303448525, 477.54791462022604, 481.2513451770296, 451.6153441768058, 489.8789523326884, 479.84939606629115, 456.6740396315289, 444.07292074563946, 509.57671531576887, 487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.59510571792234, "mean_inference_ms": 4.6903464438639855, "mean_action_processing_ms": 0.8560721824342709, "mean_env_wait_ms": 4.705000612556521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03260040283203125, "StateBufferConnector_ms": 0.015462398529052734, "ViewRequirementAgentConnector_ms": 0.7858705520629883}, "num_episodes": 22, "episode_return_max": 529.2884326207962, "episode_return_min": 415.5419106218741, "episode_return_mean": 469.45560461690513, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 145.2763105773426, "num_env_steps_trained_throughput_per_sec": 145.2763105773426, "timesteps_total": 12288, "num_env_steps_sampled_lifetime": 12288, "num_agent_steps_sampled_lifetime": 12288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 5987.755, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5987.755, "sample_time_ms": 2360.126, "learn_time_ms": 3587.703, "learn_throughput": 285.419, "synch_weights_time_ms": 39.926}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "training_iteration": 12, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-02", "timestamp": 1744127042, "time_this_iter_s": 7.078917026519775, "time_total_s": 69.86086344718933, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 69.86086344718933, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 73.11, "ram_util_percent": 94.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.062018678151071, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 1e-07, "total_loss": 2.2081024385988712, "policy_loss": -0.00013249008625280113, "vf_loss": 9.972121274471283, "vf_explained_var": -1.4737248420715333e-06, "kl": 1.7367069660240154e-06, "entropy": 2.8479539498686792, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "env_runners": {"episode_reward_max": 529.2884326207962, "episode_reward_min": 415.5419106218741, "episode_reward_mean": 470.51767569863404, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.5419106218741}, "policy_reward_max": {"tplp_policy": 529.2884326207962}, "policy_reward_mean": {"tplp_policy": 470.51767569863404}, "custom_metrics": {"mean_episode_reward_mean": 470.51767569863404, "mean_episode_reward_min": 415.5419106218741, "mean_episode_reward_max": 529.2884326207962}, "hist_stats": {"episode_reward": [487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.92426897834656, 451.4718401653636, 487.3547632665526, 457.132793965018, 482.1756537791388, 489.75393787097175, 472.1603178449497, 468.5653461554362, 481.1795939555321, 501.4324357630459, 485.1088109586965, 440.1731251444974, 482.6867660548663, 459.75485685536535, 464.2336071798223, 457.9455305246656, 449.24262189418465, 451.77715802393914, 482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6386590259161817, "mean_inference_ms": 4.80320572219475, "mean_action_processing_ms": 0.8771103595662316, "mean_env_wait_ms": 4.790244295762563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03511238098144531, "StateBufferConnector_ms": 0.028952598571777344, "ViewRequirementAgentConnector_ms": 0.8455603122711182}, "num_episodes": 20, "episode_return_max": 529.2884326207962, "episode_return_min": 415.5419106218741, "episode_return_mean": 470.51767569863404, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 179.40133281794564, "num_env_steps_trained_throughput_per_sec": 179.40133281794564, "timesteps_total": 13312, "num_env_steps_sampled_lifetime": 13312, "num_agent_steps_sampled_lifetime": 13312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 5925.694, "restore_workers_time_ms": 0.126, "training_step_time_ms": 5925.568, "sample_time_ms": 2389.382, "learn_time_ms": 3495.781, "learn_throughput": 292.925, "synch_weights_time_ms": 40.405}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "training_iteration": 13, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-08", "timestamp": 1744127048, "time_this_iter_s": 5.73029637336731, "time_total_s": 75.59115982055664, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA18A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.59115982055664, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 64.89999999999999, "ram_util_percent": 94.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0140438433736563, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 1e-07, "total_loss": 2.2127026945352553, "policy_loss": -0.00010110974544659257, "vf_loss": 9.99137173295021, "vf_explained_var": -1.5657395124435425e-06, "kl": 1.5988639421316009e-06, "entropy": 2.85039099752903, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "env_runners": {"episode_reward_max": 529.2884326207962, "episode_reward_min": 415.5419106218741, "episode_reward_mean": 470.65821083776484, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.5419106218741}, "policy_reward_max": {"tplp_policy": 529.2884326207962}, "policy_reward_mean": {"tplp_policy": 470.65821083776484}, "custom_metrics": {"mean_episode_reward_mean": 470.65821083776484, "mean_episode_reward_min": 415.5419106218741, "mean_episode_reward_max": 529.2884326207962}, "hist_stats": {"episode_reward": [482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.60852795338394, 478.5698399601838, 465.25048702566346, 451.6111950592648, 496.0755244920833, 443.6712406819602, 466.1763035594452, 484.73000669774933, 444.3932168538656, 503.8829414444978, 458.66425074513296, 456.2453404621903, 457.99104027011924, 442.80688803617164, 469.106049989872, 470.11254490578574, 444.03127910416816, 469.84351794490766, 415.5419106218741, 485.7166918787788, 482.5740533987913, 452.65160872372894, 501.7821942977133, 457.42190196224306, 465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6806921903946133, "mean_inference_ms": 4.917404704158913, "mean_action_processing_ms": 0.8984296089028121, "mean_env_wait_ms": 4.8910764930138315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600358963012695, "StateBufferConnector_ms": 0.04411196708679199, "ViewRequirementAgentConnector_ms": 0.8809912204742432}, "num_episodes": 18, "episode_return_max": 529.2884326207962, "episode_return_min": 415.5419106218741, "episode_return_mean": 470.65821083776484, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 175.6765837773649, "num_env_steps_trained_throughput_per_sec": 175.6765837773649, "timesteps_total": 14336, "num_env_steps_sampled_lifetime": 14336, "num_agent_steps_sampled_lifetime": 14336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 5918.774, "restore_workers_time_ms": 0.126, "training_step_time_ms": 5918.649, "sample_time_ms": 2435.963, "learn_time_ms": 3441.706, "learn_throughput": 297.527, "synch_weights_time_ms": 40.98}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "training_iteration": 14, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-14", "timestamp": 1744127054, "time_this_iter_s": 5.850451231002808, "time_total_s": 81.44161105155945, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0544A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.44161105155945, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 61.9875, "ram_util_percent": 94.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2211226403713225, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 1e-07, "total_loss": 2.2125404216349125, "policy_loss": -7.867882959544659e-05, "vf_loss": 9.991422110795975, "vf_explained_var": -1.7754733562469483e-06, "kl": 1.2087424500872857e-06, "entropy": 2.8523642107844354, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "env_runners": {"episode_reward_max": 529.2884326207962, "episode_reward_min": 413.0121584690136, "episode_reward_mean": 472.10743604996276, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.0121584690136}, "policy_reward_max": {"tplp_policy": 529.2884326207962}, "policy_reward_mean": {"tplp_policy": 472.10743604996276}, "custom_metrics": {"mean_episode_reward_mean": 472.10743604996276, "mean_episode_reward_min": 413.0121584690136, "mean_episode_reward_max": 529.2884326207962}, "hist_stats": {"episode_reward": [465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.29143990921546, 478.23184104250834, 469.72494421421914, 444.61390680537477, 431.0527558658937, 529.2884326207962, 457.81038582190433, 479.43534053399463, 443.9107693800438, 459.2101701894991, 431.8276417267865, 470.51209024535274, 436.43779546994983, 445.8510407007644, 476.7784850822596, 478.3714079397048, 506.04432536357376, 497.0777457751675, 474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7240497803585098, "mean_inference_ms": 5.031377721428857, "mean_action_processing_ms": 0.9207440050855129, "mean_env_wait_ms": 4.988178504562826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086446762084961, "StateBufferConnector_ms": 0.039893388748168945, "ViewRequirementAgentConnector_ms": 0.7127501964569092}, "num_episodes": 24, "episode_return_max": 529.2884326207962, "episode_return_min": 413.0121584690136, "episode_return_mean": 472.10743604996276, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 165.81014026872566, "num_env_steps_trained_throughput_per_sec": 165.81014026872566, "timesteps_total": 15360, "num_env_steps_sampled_lifetime": 15360, "num_agent_steps_sampled_lifetime": 15360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 6022.073, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6021.947, "sample_time_ms": 2514.5, "learn_time_ms": 3466.468, "learn_throughput": 295.402, "synch_weights_time_ms": 40.978}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "training_iteration": 15, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-21", "timestamp": 1744127061, "time_this_iter_s": 6.189777612686157, "time_total_s": 87.6313886642456, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.6313886642456, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 67.07499999999999, "ram_util_percent": 94.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.170511154830456, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 1e-07, "total_loss": 2.205951800197363, "policy_loss": -0.00015607422683387994, "vf_loss": 9.966133147478104, "vf_explained_var": -2.0988285541534423e-06, "kl": 1.8967497925209686e-06, "entropy": 2.8542540997266768, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "env_runners": {"episode_reward_max": 528.6848940057182, "episode_reward_min": 413.0121584690136, "episode_reward_mean": 472.6897382814952, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.0121584690136}, "policy_reward_max": {"tplp_policy": 528.6848940057182}, "policy_reward_mean": {"tplp_policy": 472.6897382814952}, "custom_metrics": {"mean_episode_reward_mean": 472.6897382814952, "mean_episode_reward_min": 413.0121584690136, "mean_episode_reward_max": 528.6848940057182}, "hist_stats": {"episode_reward": [474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.0553599813836, 477.3086699088499, 460.944263950339, 480.7026398823879, 465.86945345349426, 492.47145805259055, 483.7420330422702, 443.2435097870202, 512.0710919541788, 484.57396733096994, 528.6848940057182, 481.1701011958913, 463.72282323185743, 468.7720610027285, 479.53257800289214, 466.05717750822583, 463.74951460546896, 470.7570729208756, 474.54897832627387, 454.76180164881396, 486.5505803112135, 476.55924830591516, 471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7477722760699965, "mean_inference_ms": 5.0961046731521895, "mean_action_processing_ms": 0.9312176529403641, "mean_env_wait_ms": 5.044873563123287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024413585662841797, "StateBufferConnector_ms": 0.040898799896240234, "ViewRequirementAgentConnector_ms": 0.6012654304504395}, "num_episodes": 18, "episode_return_max": 528.6848940057182, "episode_return_min": 413.0121584690136, "episode_return_mean": 472.6897382814952, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 153.19156624606612, "num_env_steps_trained_throughput_per_sec": 153.19156624606612, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 16384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 5776.619, "restore_workers_time_ms": 0.126, "training_step_time_ms": 5776.493, "sample_time_ms": 2438.098, "learn_time_ms": 3296.98, "learn_throughput": 310.587, "synch_weights_time_ms": 41.415}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "training_iteration": 16, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-27", "timestamp": 1744127067, "time_this_iter_s": 6.7005839347839355, "time_total_s": 94.33197259902954, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.33197259902954, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 80.38888888888889, "ram_util_percent": 93.82222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3293926887214185, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 1e-07, "total_loss": 2.214237058162689, "policy_loss": -7.197732920758427e-05, "vf_loss": 10.0, "vf_explained_var": -1.3671815395355225e-06, "kl": 1.8290547163957171e-06, "entropy": 2.8569094821810723, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "env_runners": {"episode_reward_max": 515.3527710518933, "episode_reward_min": 413.0121584690136, "episode_reward_mean": 471.7960487978133, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.0121584690136}, "policy_reward_max": {"tplp_policy": 515.3527710518933}, "policy_reward_mean": {"tplp_policy": 471.7960487978133}, "custom_metrics": {"mean_episode_reward_mean": 471.7960487978133, "mean_episode_reward_min": 413.0121584690136, "mean_episode_reward_max": 515.3527710518933}, "hist_stats": {"episode_reward": [471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.81296266111303, 480.1695258169558, 468.4240935282174, 472.55052068345555, 457.10896339378877, 505.6532326303992, 450.69764413065224, 481.05483424304754, 478.6295580429137, 436.05236478789493, 478.0187643211893, 502.55095265095247, 436.43380673947684, 477.28316412819163, 472.2563503834946, 477.3814892902632, 490.7267708704856, 472.1107900145778, 487.1777068231015, 478.0523493966648, 469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7648063988698839, "mean_inference_ms": 5.147738763459655, "mean_action_processing_ms": 0.9380500649113599, "mean_env_wait_ms": 5.0889843861574935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0359189510345459, "StateBufferConnector_ms": 0.044649600982666016, "ViewRequirementAgentConnector_ms": 0.5806467533111572}, "num_episodes": 22, "episode_return_max": 515.3527710518933, "episode_return_min": 413.0121584690136, "episode_return_mean": 471.7960487978133, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 174.43186645508334, "num_env_steps_trained_throughput_per_sec": 174.43186645508334, "timesteps_total": 17408, "num_env_steps_sampled_lifetime": 17408, "num_agent_steps_sampled_lifetime": 17408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 5876.146, "restore_workers_time_ms": 0.126, "training_step_time_ms": 5876.02, "sample_time_ms": 2511.075, "learn_time_ms": 3321.707, "learn_throughput": 308.275, "synch_weights_time_ms": 43.06}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "training_iteration": 17, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-33", "timestamp": 1744127073, "time_this_iter_s": 5.888245344161987, "time_total_s": 100.22021794319153, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.22021794319153, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 66.4375, "ram_util_percent": 93.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7404134295880795, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 1e-07, "total_loss": 2.2126600727438928, "policy_loss": -1.535859191790223e-05, "vf_loss": 9.994511848688125, "vf_explained_var": -1.627206802368164e-06, "kl": 9.537229159306549e-07, "entropy": 2.85952533185482, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "env_runners": {"episode_reward_max": 515.3527710518933, "episode_reward_min": 413.0121584690136, "episode_reward_mean": 472.1946690639736, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.0121584690136}, "policy_reward_max": {"tplp_policy": 515.3527710518933}, "policy_reward_mean": {"tplp_policy": 472.1946690639736}, "custom_metrics": {"mean_episode_reward_mean": 472.1946690639736, "mean_episode_reward_min": 413.0121584690136, "mean_episode_reward_max": 515.3527710518933}, "hist_stats": {"episode_reward": [469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.85640993963, 484.52341988129103, 445.75263145465584, 439.93850081122093, 476.35825974185786, 466.37595949249356, 469.55259889557794, 471.11973511202154, 471.5553794816773, 450.7566461633288, 480.90531408258425, 504.7142869533882, 468.8923153681954, 456.75027015467236, 473.5124189086106, 488.33273963249417, 485.5818826364839, 443.99566434664746, 491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777553501925924, "mean_inference_ms": 5.1971740486464535, "mean_action_processing_ms": 0.9477233975683269, "mean_env_wait_ms": 5.130956390247681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.027445077896118164, "ViewRequirementAgentConnector_ms": 0.5868875980377197}, "num_episodes": 20, "episode_return_max": 515.3527710518933, "episode_return_min": 413.0121584690136, "episode_return_mean": 472.1946690639736, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 135.8502790107633, "num_env_steps_trained_throughput_per_sec": 135.8502790107633, "timesteps_total": 18432, "num_env_steps_sampled_lifetime": 18432, "num_agent_steps_sampled_lifetime": 18432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 6248.46, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6248.334, "sample_time_ms": 2691.556, "learn_time_ms": 3511.87, "learn_throughput": 291.583, "synch_weights_time_ms": 44.73}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "training_iteration": 18, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-41", "timestamp": 1744127081, "time_this_iter_s": 7.567875862121582, "time_total_s": 107.78809380531311, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 107.78809380531311, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 72.22222222222223, "ram_util_percent": 93.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.292996181547642, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 1e-07, "total_loss": 2.210622015595436, "policy_loss": -0.00020735653233714402, "vf_loss": 9.987443000078201, "vf_explained_var": -1.9021332263946534e-06, "kl": 1.0460218430541347e-06, "entropy": 2.8603137359023094, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "env_runners": {"episode_reward_max": 523.0059622424398, "episode_reward_min": 413.0121584690136, "episode_reward_mean": 473.0583737240722, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.0121584690136}, "policy_reward_max": {"tplp_policy": 523.0059622424398}, "policy_reward_mean": {"tplp_policy": 473.0583737240722}, "custom_metrics": {"mean_episode_reward_mean": 473.0583737240722, "mean_episode_reward_min": 413.0121584690136, "mean_episode_reward_max": 523.0059622424398}, "hist_stats": {"episode_reward": [491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.6288497774918, 466.2369371993337, 508.96009922579486, 490.7466601048521, 503.2161510564643, 467.3867008372536, 453.1886459521814, 501.61185823960477, 453.1263872797918, 463.7890448906301, 473.44690594589133, 483.44783277986295, 489.13667587885107, 413.0121584690136, 438.648064469245, 472.3391828393427, 464.14487903759084, 466.7762730526035, 490.407331836651, 477.8166922150602, 477.6865361992975, 450.0496630194339, 450.5559006218734, 428.27618305116954, 476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7941513673411935, "mean_inference_ms": 5.249393603286179, "mean_action_processing_ms": 0.9584726765644931, "mean_env_wait_ms": 5.175435986461116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0368351936340332, "StateBufferConnector_ms": 0.05010104179382324, "ViewRequirementAgentConnector_ms": 0.6107354164123535}, "num_episodes": 18, "episode_return_max": 523.0059622424398, "episode_return_min": 413.0121584690136, "episode_return_mean": 473.0583737240722, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 160.91882222411138, "num_env_steps_trained_throughput_per_sec": 160.91882222411138, "timesteps_total": 19456, "num_env_steps_sampled_lifetime": 19456, "num_agent_steps_sampled_lifetime": 19456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 6349.017, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6348.892, "sample_time_ms": 2832.632, "learn_time_ms": 3472.009, "learn_throughput": 294.93, "synch_weights_time_ms": 44.072}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "training_iteration": 19, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-48", "timestamp": 1744127088, "time_this_iter_s": 6.377553462982178, "time_total_s": 114.16564726829529, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.16564726829529, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 67.25, "ram_util_percent": 94.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8462900064885615, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 1e-07, "total_loss": 2.2138614036142825, "policy_loss": -5.7390856090933086e-05, "vf_loss": 9.999996894598008, "vf_explained_var": -2.175569534301758e-06, "kl": 9.210497112346894e-07, "entropy": 2.8608041539788247, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "env_runners": {"episode_reward_max": 523.0059622424398, "episode_reward_min": 424.3987121349567, "episode_reward_mean": 474.0458422196893, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.3987121349567}, "policy_reward_max": {"tplp_policy": 523.0059622424398}, "policy_reward_mean": {"tplp_policy": 474.0458422196893}, "custom_metrics": {"mean_episode_reward_mean": 474.0458422196893, "mean_episode_reward_min": 424.3987121349567, "mean_episode_reward_max": 523.0059622424398}, "hist_stats": {"episode_reward": [476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.6820642655698, 486.90098590865955, 468.69715086671266, 476.84665290044614, 456.3128903926116, 481.5727721728534, 477.32483589608125, 479.90213261850494, 481.6523841955227, 457.04310369343824, 458.0232601104522, 481.9101840700295, 461.1637266634012, 459.3170384019442, 515.3527710518933, 462.1667049590912, 457.35085271811533, 483.86444089053754, 446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8138485772691684, "mean_inference_ms": 5.306683189424387, "mean_action_processing_ms": 0.9716664659060289, "mean_env_wait_ms": 5.2211573914377345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03079056739807129, "StateBufferConnector_ms": 0.05207109451293945, "ViewRequirementAgentConnector_ms": 0.6310725212097168}, "num_episodes": 24, "episode_return_max": 523.0059622424398, "episode_return_min": 424.3987121349567, "episode_return_mean": 474.0458422196893, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 153.35367933804977, "num_env_steps_trained_throughput_per_sec": 153.35367933804977, "timesteps_total": 20480, "num_env_steps_sampled_lifetime": 20480, "num_agent_steps_sampled_lifetime": 20480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 6395.252, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6395.126, "sample_time_ms": 2773.625, "learn_time_ms": 3576.359, "learn_throughput": 286.325, "synch_weights_time_ms": 44.964}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "training_iteration": 20, "trial_id": "f7884_00000", "date": "2025-04-08_23-44-54", "timestamp": 1744127094, "time_this_iter_s": 6.693406343460083, "time_total_s": 120.85905361175537, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07C180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.85905361175537, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 70.14444444444445, "ram_util_percent": 94.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9316636860370635, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 1e-07, "total_loss": 2.2134222619235517, "policy_loss": -7.649091421626508e-05, "vf_loss": 9.999092262983321, "vf_explained_var": -2.434477210044861e-06, "kl": 1.2563663756459675e-06, "entropy": 2.8627431452274323, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "env_runners": {"episode_reward_max": 523.0059622424398, "episode_reward_min": 424.3987121349567, "episode_reward_mean": 473.4422521363599, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.3987121349567}, "policy_reward_max": {"tplp_policy": 523.0059622424398}, "policy_reward_mean": {"tplp_policy": 473.4422521363599}, "custom_metrics": {"mean_episode_reward_mean": 473.4422521363599, "mean_episode_reward_min": 424.3987121349567, "mean_episode_reward_max": 523.0059622424398}, "hist_stats": {"episode_reward": [446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [446.28873140647795, 462.4154096652947, 466.8209225143315, 480.4963864704593, 503.91689688679315, 484.53232057906445, 467.539892188935, 435.93577770519664, 464.0509685328013, 495.23376237745373, 480.4657289867466, 451.2124191000114, 492.7722904759262, 471.9447026859125, 504.35922252623993, 424.3987121349567, 494.4968407294516, 506.587584510353, 492.8145849829915, 432.9818819731179, 430.1303397994421, 473.1212761492125, 450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8371981678007014, "mean_inference_ms": 5.3843668387395205, "mean_action_processing_ms": 0.9902551956439303, "mean_env_wait_ms": 5.288727209745057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030781269073486328, "StateBufferConnector_ms": 0.04894447326660156, "ViewRequirementAgentConnector_ms": 0.7367782592773438}, "num_episodes": 18, "episode_return_max": 523.0059622424398, "episode_return_min": 424.3987121349567, "episode_return_mean": 473.4422521363599, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 100.2785054387086, "num_env_steps_trained_throughput_per_sec": 100.2785054387086, "timesteps_total": 21504, "num_env_steps_sampled_lifetime": 21504, "num_agent_steps_sampled_lifetime": 21504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 6810.617, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6810.491, "sample_time_ms": 2967.915, "learn_time_ms": 3795.193, "learn_throughput": 269.815, "synch_weights_time_ms": 47.205}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "training_iteration": 21, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-06", "timestamp": 1744127106, "time_this_iter_s": 10.237936019897461, "time_total_s": 131.09698963165283, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.09698963165283, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 86.63846153846156, "ram_util_percent": 94.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1775870323181152, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 1e-07, "total_loss": 2.20912988781929, "policy_loss": -0.00013030756963416934, "vf_loss": 9.982967019081116, "vf_explained_var": -1.635029911994934e-06, "kl": 1.6509501985506603e-06, "entropy": 2.864815443754196, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "env_runners": {"episode_reward_max": 529.6001654769697, "episode_reward_min": 425.4387145507604, "episode_reward_mean": 475.75250874604785, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.4387145507604}, "policy_reward_max": {"tplp_policy": 529.6001654769697}, "policy_reward_mean": {"tplp_policy": 475.75250874604785}, "custom_metrics": {"mean_episode_reward_mean": 475.75250874604785, "mean_episode_reward_min": 425.4387145507604, "mean_episode_reward_max": 529.6001654769697}, "hist_stats": {"episode_reward": [450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.28315534344836, 479.4420954392625, 436.90325275496593, 475.34427283012866, 495.44810590795913, 473.99720276771785, 482.3838921080471, 471.5324024622048, 492.61800387945783, 500.21911520483746, 500.6290291142161, 505.47716449434614, 496.05690374601323, 486.94920465819865, 458.09924774158173, 470.8781032506852, 495.547066869639, 438.9480366315041, 495.6857289355485, 507.38231674290887, 443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.862523359605803, "mean_inference_ms": 5.476386405931668, "mean_action_processing_ms": 1.0103186871195868, "mean_env_wait_ms": 5.37159917218239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020262718200683594, "StateBufferConnector_ms": 0.04688525199890137, "ViewRequirementAgentConnector_ms": 0.7303249835968018}, "num_episodes": 22, "episode_return_max": 529.6001654769697, "episode_return_min": 425.4387145507604, "episode_return_mean": 475.75250874604785, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 153.83290939717062, "num_env_steps_trained_throughput_per_sec": 153.83290939717062, "timesteps_total": 22528, "num_env_steps_sampled_lifetime": 22528, "num_agent_steps_sampled_lifetime": 22528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 6771.411, "restore_workers_time_ms": 0.126, "training_step_time_ms": 6771.285, "sample_time_ms": 2932.374, "learn_time_ms": 3791.095, "learn_throughput": 270.107, "synch_weights_time_ms": 47.5}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "training_iteration": 22, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-12", "timestamp": 1744127112, "time_this_iter_s": 6.669049501419067, "time_total_s": 137.7660391330719, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 137.7660391330719, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 66.7375, "ram_util_percent": 94.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1593212438747287, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 1e-07, "total_loss": 2.211526831239462, "policy_loss": -0.00017227899516001344, "vf_loss": 9.99326969385147, "vf_explained_var": -1.983344554901123e-06, "kl": 1.237105861395804e-06, "entropy": 2.866183061897755, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "env_runners": {"episode_reward_max": 529.6001654769697, "episode_reward_min": 425.4387145507604, "episode_reward_mean": 473.2905382982297, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.4387145507604}, "policy_reward_max": {"tplp_policy": 529.6001654769697}, "policy_reward_mean": {"tplp_policy": 473.2905382982297}, "custom_metrics": {"mean_episode_reward_mean": 473.2905382982297, "mean_episode_reward_min": 425.4387145507604, "mean_episode_reward_max": 529.6001654769697}, "hist_stats": {"episode_reward": [443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [443.2419726737296, 459.29966703841006, 474.3778188920928, 481.57871725395233, 523.0059622424398, 434.7550402637335, 486.1933868957802, 447.12846556087874, 450.1561557452427, 439.11956839893134, 482.8297544086852, 465.73666928786406, 478.19714546948654, 514.5727577108091, 479.7319488272831, 471.85182271891057, 464.5550047079695, 425.4387145507604, 495.88952495244394, 469.75855643549244, 468.76024639161244, 508.03979756153996, 486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8797646494505862, "mean_inference_ms": 5.54002494915773, "mean_action_processing_ms": 1.0220231775870658, "mean_env_wait_ms": 5.426327454567143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01848435401916504, "StateBufferConnector_ms": 0.04882407188415527, "ViewRequirementAgentConnector_ms": 0.6816291809082031}, "num_episodes": 20, "episode_return_max": 529.6001654769697, "episode_return_min": 425.4387145507604, "episode_return_mean": 473.2905382982297, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 149.68508026736225, "num_env_steps_trained_throughput_per_sec": 149.68508026736225, "timesteps_total": 23552, "num_env_steps_sampled_lifetime": 23552, "num_agent_steps_sampled_lifetime": 23552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 6884.726, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6884.726, "sample_time_ms": 2903.07, "learn_time_ms": 3933.002, "learn_throughput": 260.361, "synch_weights_time_ms": 48.226}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "training_iteration": 23, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-19", "timestamp": 1744127119, "time_this_iter_s": 6.87434983253479, "time_total_s": 144.6403889656067, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.6403889656067, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 67.41, "ram_util_percent": 94.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1028888639062644, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 1e-07, "total_loss": 2.212360955029726, "policy_loss": -0.00012920955778099595, "vf_loss": 9.997067946195603, "vf_explained_var": -1.0699033737182617e-06, "kl": 1.97455773533195e-06, "entropy": 2.8677681773900985, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "env_runners": {"episode_reward_max": 529.6001654769697, "episode_reward_min": 431.9608955052817, "episode_reward_mean": 473.0835578841609, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.9608955052817}, "policy_reward_max": {"tplp_policy": 529.6001654769697}, "policy_reward_mean": {"tplp_policy": 473.0835578841609}, "custom_metrics": {"mean_episode_reward_mean": 473.0835578841609, "mean_episode_reward_min": 431.9608955052817, "mean_episode_reward_max": 529.6001654769697}, "hist_stats": {"episode_reward": [486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [486.36075718947035, 460.9336957829256, 486.7720897653716, 479.0353522275377, 446.51168101251335, 476.46971604721654, 445.75381799482244, 504.146314935135, 484.24036088350556, 448.1317308180075, 476.4445747315062, 518.1682614027911, 497.0336971655473, 451.3485447601121, 453.1094144167984, 474.7921475809765, 494.14630915710325, 458.5421530698317, 457.5998796467926, 442.4682788149294, 458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8946553028571298, "mean_inference_ms": 5.589803585618366, "mean_action_processing_ms": 1.0323487665629798, "mean_env_wait_ms": 5.478845100431264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020686626434326172, "StateBufferConnector_ms": 0.01676321029663086, "ViewRequirementAgentConnector_ms": 0.6380116939544678}, "num_episodes": 22, "episode_return_max": 529.6001654769697, "episode_return_min": 431.9608955052817, "episode_return_mean": 473.0835578841609, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 134.72991640815528, "num_env_steps_trained_throughput_per_sec": 134.72991640815528, "timesteps_total": 24576, "num_env_steps_sampled_lifetime": 24576, "num_agent_steps_sampled_lifetime": 24576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 7061.876, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7061.876, "sample_time_ms": 2924.447, "learn_time_ms": 4083.248, "learn_throughput": 250.781, "synch_weights_time_ms": 53.754}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "training_iteration": 24, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-27", "timestamp": 1744127127, "time_this_iter_s": 7.63014817237854, "time_total_s": 152.27053713798523, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA39C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.27053713798523, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 84.19000000000001, "ram_util_percent": 93.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1534482311457395, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 1e-07, "total_loss": 2.2129248932003973, "policy_loss": -0.00013128108985256405, "vf_loss": 10.0, "vf_explained_var": -2.559274435043335e-06, "kl": 8.274371325001084e-07, "entropy": 2.869438147544861, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "env_runners": {"episode_reward_max": 529.6001654769697, "episode_reward_min": 427.5525316668181, "episode_reward_mean": 471.5619772081537, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.5525316668181}, "policy_reward_max": {"tplp_policy": 529.6001654769697}, "policy_reward_mean": {"tplp_policy": 471.5619772081537}, "custom_metrics": {"mean_episode_reward_mean": 471.5619772081537, "mean_episode_reward_min": 427.5525316668181, "mean_episode_reward_max": 529.6001654769697}, "hist_stats": {"episode_reward": [458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.7255258568138, 461.1547061428891, 456.1207970907525, 473.4176199981006, 500.783609309511, 490.02308624717904, 453.04561696331257, 442.56452831563513, 456.84847123367564, 521.8410581900248, 494.04855300108267, 476.6762094717323, 477.752082993495, 431.9608955052817, 481.79643210787253, 484.89759255384075, 465.24871152433974, 471.66140094866785, 453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9090247848744912, "mean_inference_ms": 5.644325571327451, "mean_action_processing_ms": 1.040419527322338, "mean_env_wait_ms": 5.534551544880275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02793407440185547, "StateBufferConnector_ms": 0.024983882904052734, "ViewRequirementAgentConnector_ms": 0.6980085372924805}, "num_episodes": 20, "episode_return_max": 529.6001654769697, "episode_return_min": 427.5525316668181, "episode_return_mean": 471.5619772081537, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 126.8293252894285, "num_env_steps_trained_throughput_per_sec": 126.8293252894285, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 25600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 7251.687, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7251.687, "sample_time_ms": 2966.868, "learn_time_ms": 4230.599, "learn_throughput": 242.046, "synch_weights_time_ms": 53.792}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "training_iteration": 25, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-35", "timestamp": 1744127135, "time_this_iter_s": 8.088303565979004, "time_total_s": 160.35884070396423, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA1F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.35884070396423, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 88.26, "ram_util_percent": 93.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.903560408204794, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 1e-07, "total_loss": 2.2087238170206547, "policy_loss": -9.513550903648139e-05, "vf_loss": 9.983197742700577, "vf_explained_var": -2.6065856218338014e-06, "kl": 7.50528526488603e-07, "entropy": 2.8698048830032348, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "env_runners": {"episode_reward_max": 529.6001654769697, "episode_reward_min": 399.1203963875484, "episode_reward_mean": 470.59955989963635, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 399.1203963875484}, "policy_reward_max": {"tplp_policy": 529.6001654769697}, "policy_reward_mean": {"tplp_policy": 470.59955989963635}, "custom_metrics": {"mean_episode_reward_mean": 470.59955989963635, "mean_episode_reward_min": 399.1203963875484, "mean_episode_reward_max": 529.6001654769697}, "hist_stats": {"episode_reward": [453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.6345233149694, 465.5627186033018, 464.0274995690828, 476.44936279783605, 467.83674042663097, 454.15062559167586, 441.11398240408977, 471.6138042337655, 477.5769784834191, 504.7169128689309, 492.05161044993747, 449.9789878686501, 529.6001654769697, 520.2793407433215, 514.50435634616, 485.2564672825601, 474.4542331062656, 516.3108823158626, 481.73621388281697, 515.776795110725, 497.15041955872357, 472.37099724241375, 449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9078480947075243, "mean_inference_ms": 5.641754181610331, "mean_action_processing_ms": 1.0395091366908276, "mean_env_wait_ms": 5.5347006902773055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02694559097290039, "StateBufferConnector_ms": 0.0239865779876709, "ViewRequirementAgentConnector_ms": 0.5783560276031494}, "num_episodes": 18, "episode_return_max": 529.6001654769697, "episode_return_min": 399.1203963875484, "episode_return_mean": 470.59955989963635, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 167.89146787435823, "num_env_steps_trained_throughput_per_sec": 167.89146787435823, "timesteps_total": 26624, "num_env_steps_sampled_lifetime": 26624, "num_agent_steps_sampled_lifetime": 26624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 7193.16, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7193.16, "sample_time_ms": 2904.797, "learn_time_ms": 4232.705, "learn_throughput": 241.926, "synch_weights_time_ms": 55.131}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "training_iteration": 26, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-42", "timestamp": 1744127142, "time_this_iter_s": 6.117072105407715, "time_total_s": 166.47591280937195, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0556C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.47591280937195, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 75.63749999999999, "ram_util_percent": 93.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2136248730123045, "cur_kl_coeff": 2.980232238769531e-09, "cur_lr": 1e-07, "total_loss": 2.208952835947275, "policy_loss": -0.00012151515402365476, "vf_loss": 9.984762197732925, "vf_explained_var": -2.364441752433777e-06, "kl": 1.6624323467162582e-06, "entropy": 2.8711619943380358, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "env_runners": {"episode_reward_max": 514.5793503459773, "episode_reward_min": 399.1203963875484, "episode_reward_mean": 469.8746564133022, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 399.1203963875484}, "policy_reward_max": {"tplp_policy": 514.5793503459773}, "policy_reward_mean": {"tplp_policy": 469.8746564133022}, "custom_metrics": {"mean_episode_reward_mean": 469.8746564133022, "mean_episode_reward_min": 399.1203963875484, "mean_episode_reward_max": 514.5793503459773}, "hist_stats": {"episode_reward": [449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [449.40087368306797, 501.86333908806364, 465.9142268417995, 468.66192671602903, 488.36829980266066, 500.42988549873945, 437.86784186574135, 489.56583991139917, 463.6675273159962, 461.4177542315977, 467.5603854518912, 465.6298326237543, 442.39769156940423, 441.02160304030684, 470.49986902922126, 486.61449902000703, 434.23928013644417, 462.9851634735866, 434.7052749436937, 477.4316700233724, 455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.90507881830553, "mean_inference_ms": 5.627803496418668, "mean_action_processing_ms": 1.0376598035773552, "mean_env_wait_ms": 5.529849887275103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023360729217529297, "StateBufferConnector_ms": 0.023721933364868164, "ViewRequirementAgentConnector_ms": 0.5922749042510986}, "num_episodes": 22, "episode_return_max": 514.5793503459773, "episode_return_min": 399.1203963875484, "episode_return_mean": 469.8746564133022, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 144.8439998346169, "num_env_steps_trained_throughput_per_sec": 144.8439998346169, "timesteps_total": 27648, "num_env_steps_sampled_lifetime": 27648, "num_agent_steps_sampled_lifetime": 27648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 7313.079, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7313.027, "sample_time_ms": 2878.91, "learn_time_ms": 4379.093, "learn_throughput": 233.838, "synch_weights_time_ms": 54.537}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "training_iteration": 27, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-49", "timestamp": 1744127149, "time_this_iter_s": 7.085108041763306, "time_total_s": 173.56102085113525, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056B60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.56102085113525, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 80.92999999999999, "ram_util_percent": 92.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1786084048449994, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 1e-07, "total_loss": 2.212519679963589, "policy_loss": -0.00011290476541034878, "vf_loss": 10.0, "vf_explained_var": -2.3618340492248535e-06, "kl": 1.8529060965555288e-06, "entropy": 2.8736740604043005, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "env_runners": {"episode_reward_max": 541.3194466621634, "episode_reward_min": 399.1203963875484, "episode_reward_mean": 473.4774447971784, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 399.1203963875484}, "policy_reward_max": {"tplp_policy": 541.3194466621634}, "policy_reward_mean": {"tplp_policy": 473.4774447971784}, "custom_metrics": {"mean_episode_reward_mean": 473.4774447971784, "mean_episode_reward_min": 399.1203963875484, "mean_episode_reward_max": 541.3194466621634}, "hist_stats": {"episode_reward": [455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [455.88484495082474, 455.5576134740405, 468.06784829209187, 471.12904923124563, 488.1325445306366, 500.5817808253616, 482.1175384247502, 477.5011473682012, 473.3710045301213, 462.3269002264959, 464.61917522124304, 474.47948021182185, 478.7568818650876, 452.04024036017705, 463.61056646455984, 435.4720985087513, 500.62128470781056, 479.481013887846, 473.58981002220196, 474.0428885108292, 453.88343439258824, 458.0538302576324, 427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8981500399510234, "mean_inference_ms": 5.606315838564891, "mean_action_processing_ms": 1.0343844749067148, "mean_env_wait_ms": 5.5108061054232325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023433923721313477, "StateBufferConnector_ms": 0.022718429565429688, "ViewRequirementAgentConnector_ms": 0.5738546848297119}, "num_episodes": 20, "episode_return_max": 541.3194466621634, "episode_return_min": 399.1203963875484, "episode_return_mean": 473.4774447971784, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 216.27350392230974, "num_env_steps_trained_throughput_per_sec": 216.27350392230974, "timesteps_total": 28672, "num_env_steps_sampled_lifetime": 28672, "num_agent_steps_sampled_lifetime": 28672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 7032.783, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7032.73, "sample_time_ms": 2703.486, "learn_time_ms": 4274.771, "learn_throughput": 239.545, "synch_weights_time_ms": 53.779}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "training_iteration": 28, "trial_id": "f7884_00000", "date": "2025-04-08_23-45-54", "timestamp": 1744127154, "time_this_iter_s": 4.778110504150391, "time_total_s": 178.33913135528564, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA1F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.33913135528564, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 63.5142857142857, "ram_util_percent": 93.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.056504485011101, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 1e-07, "total_loss": 2.2076016582548617, "policy_loss": -3.9505737368017436e-05, "vf_loss": 9.980898678302765, "vf_explained_var": -1.8928200006484986e-06, "kl": 8.01618218697342e-07, "entropy": 2.875835070014, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "env_runners": {"episode_reward_max": 541.3194466621634, "episode_reward_min": 399.1203963875484, "episode_reward_mean": 475.21567692735954, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 399.1203963875484}, "policy_reward_max": {"tplp_policy": 541.3194466621634}, "policy_reward_mean": {"tplp_policy": 475.21567692735954}, "custom_metrics": {"mean_episode_reward_mean": 475.21567692735954, "mean_episode_reward_min": 399.1203963875484, "mean_episode_reward_max": 541.3194466621634}, "hist_stats": {"episode_reward": [427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [427.5525316668181, 466.8919195355488, 453.19189113819544, 490.82686161427495, 477.236698328022, 471.71576480235126, 491.24436297129773, 455.5227189012868, 464.9640621149281, 454.9956158487141, 503.2483591913916, 439.6286154596071, 470.57629772106435, 460.5338872088176, 476.5775462957167, 439.46955299667025, 461.7888908787005, 471.9478684785463, 493.75713685247274, 486.4954106461434, 451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.887381191039165, "mean_inference_ms": 5.574350439232945, "mean_action_processing_ms": 1.0278937113208004, "mean_env_wait_ms": 5.481937442343206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021512269973754883, "StateBufferConnector_ms": 0.03062605857849121, "ViewRequirementAgentConnector_ms": 0.5470643043518066}, "num_episodes": 22, "episode_return_max": 541.3194466621634, "episode_return_min": 399.1203963875484, "episode_return_mean": 475.21567692735954, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 178.56241469110483, "num_env_steps_trained_throughput_per_sec": 178.56241469110483, "timesteps_total": 29696, "num_env_steps_sampled_lifetime": 29696, "num_agent_steps_sampled_lifetime": 29696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 6969.906, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6969.853, "sample_time_ms": 2617.408, "learn_time_ms": 4298.632, "learn_throughput": 238.215, "synch_weights_time_ms": 53.02}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "training_iteration": 29, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-00", "timestamp": 1744127160, "time_this_iter_s": 5.745021820068359, "time_total_s": 184.084153175354, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07CAE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.084153175354, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 77.35714285714286, "ram_util_percent": 94.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.045821671187878, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 1e-07, "total_loss": 2.2091489166021345, "policy_loss": -0.0001409968885127455, "vf_loss": 9.987734884023666, "vf_explained_var": -2.5138258934020994e-06, "kl": 9.73331221476581e-07, "entropy": 2.8764378994703295, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "env_runners": {"episode_reward_max": 541.3194466621634, "episode_reward_min": 399.1203963875484, "episode_reward_mean": 477.2984598242235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 399.1203963875484}, "policy_reward_max": {"tplp_policy": 541.3194466621634}, "policy_reward_mean": {"tplp_policy": 477.2984598242235}, "custom_metrics": {"mean_episode_reward_mean": 477.2984598242235, "mean_episode_reward_min": 399.1203963875484, "mean_episode_reward_max": 541.3194466621634}, "hist_stats": {"episode_reward": [451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [451.37637702090717, 472.66085803969315, 501.30154536826797, 399.1203963875484, 466.74438791536346, 473.79242419037735, 454.82094963359265, 496.60275359827136, 478.55620706775215, 475.52459178899755, 467.79807583482204, 475.3901410269389, 473.47124050795344, 490.3127449748379, 417.4498843860418, 427.1500413624929, 469.3890334133507, 486.08264088018467, 470.4716718372951, 464.3642335952124, 474.9345779712622, 502.921142531471, 514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8691742604009494, "mean_inference_ms": 5.523737174117411, "mean_action_processing_ms": 1.0184501205116328, "mean_env_wait_ms": 5.438150933304319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016486167907714844, "StateBufferConnector_ms": 0.025736570358276367, "ViewRequirementAgentConnector_ms": 0.4412384033203125}, "num_episodes": 20, "episode_return_max": 541.3194466621634, "episode_return_min": 399.1203963875484, "episode_return_mean": 477.2984598242235, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 259.4151220175414, "num_env_steps_trained_throughput_per_sec": 259.4151220175414, "timesteps_total": 30720, "num_env_steps_sampled_lifetime": 30720, "num_agent_steps_sampled_lifetime": 30720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 6696.903, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6696.85, "sample_time_ms": 2511.946, "learn_time_ms": 4132.855, "learn_throughput": 247.771, "synch_weights_time_ms": 51.256}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "training_iteration": 30, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-04", "timestamp": 1744127164, "time_this_iter_s": 3.9580888748168945, "time_total_s": 188.0422420501709, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07C220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.0422420501709, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 53.78333333333334, "ram_util_percent": 95.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.115365930646658, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 1e-07, "total_loss": 2.209843588620424, "policy_loss": -0.00010155136114917696, "vf_loss": 9.99050577878952, "vf_explained_var": -7.767230272293091e-07, "kl": 9.550074174136114e-07, "entropy": 2.8768130213022234, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "env_runners": {"episode_reward_max": 541.3194466621634, "episode_reward_min": 426.3157532425335, "episode_reward_mean": 478.61263155134014, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.3157532425335}, "policy_reward_max": {"tplp_policy": 541.3194466621634}, "policy_reward_mean": {"tplp_policy": 478.61263155134014}, "custom_metrics": {"mean_episode_reward_mean": 478.61263155134014, "mean_episode_reward_min": 426.3157532425335, "mean_episode_reward_max": 541.3194466621634}, "hist_stats": {"episode_reward": [514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [514.5793503459773, 487.77410435434473, 464.27130001324787, 501.1925647340749, 430.46732748933465, 480.94857212521015, 513.9965020494437, 483.8533972769528, 475.77333293805975, 501.1569347686088, 472.40763198546796, 426.3157532425335, 497.7006921503772, 455.1844212751205, 485.2329781218574, 494.64510594530526, 541.3194466621634, 463.74616206158953, 506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.849024584567677, "mean_inference_ms": 5.46412056256021, "mean_action_processing_ms": 1.0065591833149974, "mean_env_wait_ms": 5.386982123733452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021541833877563477, "StateBufferConnector_ms": 0.024023056030273438, "ViewRequirementAgentConnector_ms": 0.40607643127441406}, "num_episodes": 22, "episode_return_max": 541.3194466621634, "episode_return_min": 426.3157532425335, "episode_return_mean": 478.61263155134014, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 275.02026623445147, "num_env_steps_trained_throughput_per_sec": 275.02026623445147, "timesteps_total": 31744, "num_env_steps_sampled_lifetime": 31744, "num_agent_steps_sampled_lifetime": 31744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 6048.083, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6048.03, "sample_time_ms": 2180.804, "learn_time_ms": 3819.295, "learn_throughput": 268.112, "synch_weights_time_ms": 47.138}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "training_iteration": 31, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-08", "timestamp": 1744127168, "time_this_iter_s": 3.732168197631836, "time_total_s": 191.77441024780273, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.77441024780273, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 95.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5970648735761643, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 1e-07, "total_loss": 2.202020247280598, "policy_loss": -0.000212368048960343, "vf_loss": 9.960053038597106, "vf_explained_var": -2.2649765014648438e-06, "kl": 1.392321092774651e-06, "entropy": 2.8778063252568247, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "env_runners": {"episode_reward_max": 518.82781883002, "episode_reward_min": 439.70562959280096, "episode_reward_mean": 477.7846186030516, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.70562959280096}, "policy_reward_max": {"tplp_policy": 518.82781883002}, "policy_reward_mean": {"tplp_policy": 477.7846186030516}, "custom_metrics": {"mean_episode_reward_mean": 477.7846186030516, "mean_episode_reward_min": 439.70562959280096, "mean_episode_reward_max": 518.82781883002}, "hist_stats": {"episode_reward": [506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.6357122052051, 472.90576821634914, 498.58664653654415, 476.14782256195554, 464.2859737950825, 491.10952287328854, 500.69909538353187, 513.234866929905, 482.94615225736413, 476.90127659578724, 499.3755336466045, 441.6806208718138, 455.96477698619543, 473.4122980126018, 500.2407372341894, 498.1821952052566, 446.96057413691244, 466.1864404820525, 500.14597906711606, 478.3026468069911, 457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.82945240162017, "mean_inference_ms": 5.412469584942636, "mean_action_processing_ms": 0.9971709192087178, "mean_env_wait_ms": 5.3378987881417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022579193115234375, "StateBufferConnector_ms": 0.021039724349975586, "ViewRequirementAgentConnector_ms": 0.35762572288513184}, "num_episodes": 18, "episode_return_max": 518.82781883002, "episode_return_min": 439.70562959280096, "episode_return_mean": 477.7846186030516, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 313.90053479703454, "num_env_steps_trained_throughput_per_sec": 313.90053479703454, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 32768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 5708.643, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5708.591, "sample_time_ms": 2050.804, "learn_time_ms": 3611.631, "learn_throughput": 283.528, "synch_weights_time_ms": 45.499}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "training_iteration": 32, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-11", "timestamp": 1744127171, "time_this_iter_s": 3.272850275039673, "time_total_s": 195.0472605228424, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0556C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.0472605228424, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 48.800000000000004, "ram_util_percent": 95.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.048952311091125, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 1e-07, "total_loss": 2.2095466040074827, "policy_loss": -0.00010616734798531979, "vf_loss": 9.990234702825546, "vf_explained_var": -2.7295202016830446e-06, "kl": 1.2190311602822134e-06, "entropy": 2.879058873653412, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "env_runners": {"episode_reward_max": 520.6516324877866, "episode_reward_min": 429.39174807496374, "episode_reward_mean": 476.91462961384036, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.39174807496374}, "policy_reward_max": {"tplp_policy": 520.6516324877866}, "policy_reward_mean": {"tplp_policy": 476.91462961384036}, "custom_metrics": {"mean_episode_reward_mean": 476.91462961384036, "mean_episode_reward_min": 429.39174807496374, "mean_episode_reward_max": 520.6516324877866}, "hist_stats": {"episode_reward": [457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [457.91254224717886, 471.3668063631317, 494.282807891763, 497.4524071292594, 466.0674507315325, 472.47919234312616, 459.02086955525857, 477.5726488803669, 477.2583972813033, 481.217474562034, 518.7743105982022, 454.22927590950883, 494.8303235771886, 460.3031874858726, 498.7539616419003, 455.32898912785146, 477.2865123760428, 497.0617293615121, 468.28309352654804, 459.2135828187508, 477.7240617401288, 456.94714515370777, 483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.808351950737554, "mean_inference_ms": 5.352709630028254, "mean_action_processing_ms": 0.9855339052679299, "mean_env_wait_ms": 5.282652083426975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025614261627197266, "StateBufferConnector_ms": 0.02153944969177246, "ViewRequirementAgentConnector_ms": 0.3491499423980713}, "num_episodes": 20, "episode_return_max": 520.6516324877866, "episode_return_min": 429.39174807496374, "episode_return_mean": 476.91462961384036, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 310.9296248328605, "num_env_steps_trained_throughput_per_sec": 310.9296248328605, "timesteps_total": 33792, "num_env_steps_sampled_lifetime": 33792, "num_agent_steps_sampled_lifetime": 33792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 5353.875, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5353.823, "sample_time_ms": 1951.746, "learn_time_ms": 3358.731, "learn_throughput": 304.877, "synch_weights_time_ms": 42.803}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "training_iteration": 33, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-14", "timestamp": 1744127174, "time_this_iter_s": 3.308227777481079, "time_total_s": 198.3554883003235, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.3554883003235, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 46.779999999999994, "ram_util_percent": 94.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.936760814115405, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 1e-07, "total_loss": 2.209854584187269, "policy_loss": -5.6650966871529815e-05, "vf_loss": 9.991927194595338, "vf_explained_var": -2.6114284992218018e-06, "kl": 8.317169151172976e-07, "entropy": 2.880705752968788, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "env_runners": {"episode_reward_max": 527.2646778759862, "episode_reward_min": 429.39174807496374, "episode_reward_mean": 477.75613437007183, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.39174807496374}, "policy_reward_max": {"tplp_policy": 527.2646778759862}, "policy_reward_mean": {"tplp_policy": 477.75613437007183}, "custom_metrics": {"mean_episode_reward_mean": 477.75613437007183, "mean_episode_reward_min": 429.39174807496374, "mean_episode_reward_max": 527.2646778759862}, "hist_stats": {"episode_reward": [483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.7492471830222, 511.6389691254465, 450.0922505190748, 495.04959618404064, 490.6134856183467, 469.8448246600311, 444.2256407700434, 473.3863995616522, 463.4396635676359, 483.759790616062, 497.5219200777499, 494.05609359042955, 461.49565312332567, 494.54733171029835, 499.1108323447212, 489.2268994063545, 459.5250517666056, 470.4894256182959, 473.8326442752623, 495.89414671879064, 463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7812671286726933, "mean_inference_ms": 5.274436140133755, "mean_action_processing_ms": 0.9714420080985694, "mean_env_wait_ms": 5.209727165706339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025893688201904297, "StateBufferConnector_ms": 0.009335517883300781, "ViewRequirementAgentConnector_ms": 0.312471866607666}, "num_episodes": 22, "episode_return_max": 527.2646778759862, "episode_return_min": 429.39174807496374, "episode_return_mean": 477.75613437007183, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.8157819393307, "num_env_steps_trained_throughput_per_sec": 318.8157819393307, "timesteps_total": 34816, "num_env_steps_sampled_lifetime": 34816, "num_agent_steps_sampled_lifetime": 34816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 4915.025, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4914.972, "sample_time_ms": 1791.529, "learn_time_ms": 3087.595, "learn_throughput": 331.65, "synch_weights_time_ms": 35.305}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "training_iteration": 34, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-18", "timestamp": 1744127178, "time_this_iter_s": 3.221174955368042, "time_total_s": 201.57666325569153, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.57666325569153, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 45.540000000000006, "ram_util_percent": 94.61999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2248458676040173, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 1e-07, "total_loss": 2.2117019936442377, "policy_loss": -9.696375345811248e-05, "vf_loss": 10.0, "vf_explained_var": -3.1337141990661623e-06, "kl": 1.0368636932600595e-06, "entropy": 2.8820104777812956, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "env_runners": {"episode_reward_max": 527.2646778759862, "episode_reward_min": 416.1964225929129, "episode_reward_mean": 476.9445568153122, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.1964225929129}, "policy_reward_max": {"tplp_policy": 527.2646778759862}, "policy_reward_mean": {"tplp_policy": 476.9445568153122}, "custom_metrics": {"mean_episode_reward_mean": 476.9445568153122, "mean_episode_reward_min": 416.1964225929129, "mean_episode_reward_max": 527.2646778759862}, "hist_stats": {"episode_reward": [463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.49756651004316, 463.92122081918995, 467.00576414300457, 496.6276667036287, 468.25096122610046, 464.932055131799, 499.4618030565019, 460.7775892949834, 479.6026951850223, 482.06028954729373, 458.5673569295291, 467.9209568994489, 485.5146105649018, 478.7557005654891, 477.2023749429905, 443.03603747445106, 478.04412706280095, 447.2970483695402, 499.1375100702335, 470.31296655329203, 452.6198544674917, 482.1477821197888, 439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.758363328411297, "mean_inference_ms": 5.206324363430898, "mean_action_processing_ms": 0.9593320831901732, "mean_env_wait_ms": 5.147226569736948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023836374282836914, "StateBufferConnector_ms": 0.006537914276123047, "ViewRequirementAgentConnector_ms": 0.32355642318725586}, "num_episodes": 20, "episode_return_max": 527.2646778759862, "episode_return_min": 416.1964225929129, "episode_return_mean": 476.9445568153122, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 323.63922579482295, "num_env_steps_trained_throughput_per_sec": 323.63922579482295, "timesteps_total": 35840, "num_env_steps_sampled_lifetime": 35840, "num_agent_steps_sampled_lifetime": 35840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 4424.042, "restore_workers_time_ms": 0.054, "training_step_time_ms": 4423.936, "sample_time_ms": 1615.36, "learn_time_ms": 2774.566, "learn_throughput": 369.067, "synch_weights_time_ms": 33.466}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "training_iteration": 35, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-21", "timestamp": 1744127181, "time_this_iter_s": 3.1707589626312256, "time_total_s": 204.74742221832275, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.74742221832275, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 52.849999999999994, "ram_util_percent": 94.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.256597736477852, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 1e-07, "total_loss": 2.1939979627728463, "policy_loss": -0.00012525322963483632, "vf_loss": 9.929802453517913, "vf_explained_var": -1.6923993825912476e-06, "kl": 1.1794602361447915e-06, "entropy": 2.883274015784264, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "env_runners": {"episode_reward_max": 527.2646778759862, "episode_reward_min": 416.0122776975132, "episode_reward_mean": 477.1343977841578, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.0122776975132}, "policy_reward_max": {"tplp_policy": 527.2646778759862}, "policy_reward_mean": {"tplp_policy": 477.1343977841578}, "custom_metrics": {"mean_episode_reward_mean": 477.1343977841578, "mean_episode_reward_min": 416.0122776975132, "mean_episode_reward_max": 527.2646778759862}, "hist_stats": {"episode_reward": [439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [439.70562959280096, 457.2645207506354, 497.7574285158371, 487.6536330873538, 498.97660652945916, 491.2454387359537, 457.9139792764076, 458.4957806750056, 489.3263389120104, 494.29307313548804, 475.8580795701865, 465.2894587114338, 501.3401322884451, 465.80908797683594, 518.82781883002, 473.2396395356694, 465.095920389368, 520.6516324877866, 461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.73414897821799, "mean_inference_ms": 5.132107807461978, "mean_action_processing_ms": 0.9459316520161769, "mean_env_wait_ms": 5.07978992920619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018794536590576172, "StateBufferConnector_ms": 0.008143901824951172, "ViewRequirementAgentConnector_ms": 0.2944984436035156}, "num_episodes": 22, "episode_return_max": 527.2646778759862, "episode_return_min": 416.0122776975132, "episode_return_mean": 477.1343977841578, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 319.0311670939761, "num_env_steps_trained_throughput_per_sec": 319.0311670939761, "timesteps_total": 36864, "num_env_steps_sampled_lifetime": 36864, "num_agent_steps_sampled_lifetime": 36864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 4135.096, "restore_workers_time_ms": 0.054, "training_step_time_ms": 4134.99, "sample_time_ms": 1558.124, "learn_time_ms": 2546.059, "learn_throughput": 402.19, "synch_weights_time_ms": 30.16}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "training_iteration": 36, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-24", "timestamp": 1744127184, "time_this_iter_s": 3.215601682662964, "time_total_s": 207.96302390098572, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.96302390098572, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.36, "ram_util_percent": 94.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.166876204498112, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 1e-07, "total_loss": 2.207027827203274, "policy_loss": -8.689152309671044e-05, "vf_loss": 9.982281070947646, "vf_explained_var": -2.993270754814148e-06, "kl": 1.049637192740427e-06, "entropy": 2.884555362164974, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "env_runners": {"episode_reward_max": 527.2646778759862, "episode_reward_min": 416.0122776975132, "episode_reward_mean": 475.54131899170017, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.0122776975132}, "policy_reward_max": {"tplp_policy": 527.2646778759862}, "policy_reward_mean": {"tplp_policy": 475.54131899170017}, "custom_metrics": {"mean_episode_reward_mean": 475.54131899170017, "mean_episode_reward_min": 416.0122776975132, "mean_episode_reward_max": 527.2646778759862}, "hist_stats": {"episode_reward": [461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [461.51451331850575, 429.39174807496374, 434.7497985500058, 489.1518173728388, 464.6141063043875, 486.13997901487005, 449.4149167523904, 488.27330548713087, 478.7462446828945, 476.2130203944866, 507.6178892651665, 503.40287453376976, 500.31842641337613, 470.03430197055224, 478.3977158681525, 495.67181093179084, 456.5542016624237, 500.95151740875764, 454.765292912895, 525.8377892288479, 452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7151821781149301, "mean_inference_ms": 5.072523664680565, "mean_action_processing_ms": 0.9353976303893734, "mean_env_wait_ms": 5.025910427953825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017888545989990234, "StateBufferConnector_ms": 0.0071392059326171875, "ViewRequirementAgentConnector_ms": 0.28780126571655273}, "num_episodes": 18, "episode_return_max": 527.2646778759862, "episode_return_min": 416.0122776975132, "episode_return_mean": 475.54131899170017, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.86849720843463, "num_env_steps_trained_throughput_per_sec": 317.86849720843463, "timesteps_total": 37888, "num_env_steps_sampled_lifetime": 37888, "num_agent_steps_sampled_lifetime": 37888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 3750.275, "restore_workers_time_ms": 0.054, "training_step_time_ms": 3750.221, "sample_time_ms": 1461.843, "learn_time_ms": 2259.263, "learn_throughput": 453.245, "synch_weights_time_ms": 28.504}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "training_iteration": 37, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-27", "timestamp": 1744127187, "time_this_iter_s": 3.231431007385254, "time_total_s": 211.19445490837097, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07C5E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 211.19445490837097, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 48.22500000000001, "ram_util_percent": 94.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1296638369560243, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 1e-07, "total_loss": 2.2114003665745257, "policy_loss": -6.401917198672891e-06, "vf_loss": 10.0, "vf_explained_var": -2.681836485862732e-06, "kl": 6.495106358112013e-07, "entropy": 2.885932359099388, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "env_runners": {"episode_reward_max": 527.2646778759862, "episode_reward_min": 416.0122776975132, "episode_reward_mean": 476.26425026799166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.0122776975132}, "policy_reward_max": {"tplp_policy": 527.2646778759862}, "policy_reward_mean": {"tplp_policy": 476.26425026799166}, "custom_metrics": {"mean_episode_reward_mean": 476.26425026799166, "mean_episode_reward_min": 416.0122776975132, "mean_episode_reward_max": 527.2646778759862}, "hist_stats": {"episode_reward": [452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [452.8969590546242, 480.3951075841566, 464.1862704193306, 464.1149805336794, 486.04461891495674, 491.8573088316988, 488.0413886783801, 448.63611085445797, 453.54199187046555, 527.2646778759862, 519.7669428374799, 470.94086925330845, 489.30336338142064, 477.85607991940526, 460.05776421923883, 434.30847757172324, 500.29725909069253, 505.36086486694694, 471.902293995002, 490.1408340306087, 457.5401152039097, 493.2981746082067, 416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6946314054450102, "mean_inference_ms": 5.010262250194151, "mean_action_processing_ms": 0.9244364380283215, "mean_env_wait_ms": 4.970191297858562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013765573501586914, "StateBufferConnector_ms": 0.004132509231567383, "ViewRequirementAgentConnector_ms": 0.2783811092376709}, "num_episodes": 20, "episode_return_max": 527.2646778759862, "episode_return_min": 416.0122776975132, "episode_return_mean": 476.26425026799166, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 319.8390959543211, "num_env_steps_trained_throughput_per_sec": 319.8390959543211, "timesteps_total": 38912, "num_env_steps_sampled_lifetime": 38912, "num_agent_steps_sampled_lifetime": 38912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 3596.961, "restore_workers_time_ms": 0.054, "training_step_time_ms": 3596.907, "sample_time_ms": 1443.963, "learn_time_ms": 2125.748, "learn_throughput": 481.713, "synch_weights_time_ms": 26.793}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "training_iteration": 38, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-31", "timestamp": 1744127191, "time_this_iter_s": 3.208876132965088, "time_total_s": 214.40333104133606, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.40333104133606, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 53.15, "ram_util_percent": 94.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.751756715774536, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 1e-07, "total_loss": 2.2087656632065773, "policy_loss": -8.437082287855446e-05, "vf_loss": 9.990459460020066, "vf_explained_var": -3.180280327796936e-06, "kl": 1.3426139182204367e-06, "entropy": 2.887648269534111, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "env_runners": {"episode_reward_max": 520.9166655904755, "episode_reward_min": 416.0122776975132, "episode_reward_mean": 473.9420298766221, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.0122776975132}, "policy_reward_max": {"tplp_policy": 520.9166655904755}, "policy_reward_mean": {"tplp_policy": 473.9420298766221}, "custom_metrics": {"mean_episode_reward_mean": 473.9420298766221, "mean_episode_reward_min": 416.0122776975132, "mean_episode_reward_max": 520.9166655904755}, "hist_stats": {"episode_reward": [416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [416.1964225929129, 457.69807505427815, 504.4932310114672, 469.6607668256357, 484.2835487752632, 472.47696645754866, 448.9048098487218, 478.13560668076155, 468.55041729196245, 491.1455147049431, 493.1974013659664, 459.45027912782325, 490.43825643656123, 491.3722070463829, 500.3373686437206, 486.58203126640973, 476.11188610343106, 480.4690319153174, 492.1573463814504, 455.28427092471384, 479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.673977102497459, "mean_inference_ms": 4.944955363992093, "mean_action_processing_ms": 0.9129079828398406, "mean_env_wait_ms": 4.911398662617576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014683008193969727, "StateBufferConnector_ms": 0.004633665084838867, "ViewRequirementAgentConnector_ms": 0.29274749755859375}, "num_episodes": 22, "episode_return_max": 520.9166655904755, "episode_return_min": 416.0122776975132, "episode_return_mean": 473.9420298766221, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 313.7317981030294, "num_env_steps_trained_throughput_per_sec": 313.7317981030294, "timesteps_total": 39936, "num_env_steps_sampled_lifetime": 39936, "num_agent_steps_sampled_lifetime": 39936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 3349.886, "restore_workers_time_ms": 0.054, "training_step_time_ms": 3349.831, "sample_time_ms": 1330.842, "learn_time_ms": 1991.782, "learn_throughput": 514.113, "synch_weights_time_ms": 26.904}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "training_iteration": 39, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-34", "timestamp": 1744127194, "time_this_iter_s": 3.2706339359283447, "time_total_s": 217.6739649772644, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC055120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.6739649772644, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 46.080000000000005, "ram_util_percent": 94.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1375114768743515, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 1e-07, "total_loss": 2.2073490127921103, "policy_loss": -0.00015470973448827863, "vf_loss": 9.985878485441209, "vf_explained_var": -2.754479646682739e-06, "kl": 1.5405791294220705e-06, "entropy": 2.889659008383751, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "env_runners": {"episode_reward_max": 520.9166655904755, "episode_reward_min": 415.2199240768473, "episode_reward_mean": 473.9899900902609, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.2199240768473}, "policy_reward_max": {"tplp_policy": 520.9166655904755}, "policy_reward_mean": {"tplp_policy": 473.9899900902609}, "custom_metrics": {"mean_episode_reward_mean": 473.9899900902609, "mean_episode_reward_min": 415.2199240768473, "mean_episode_reward_max": 520.9166655904755}, "hist_stats": {"episode_reward": [479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [479.3029059794018, 489.60342687886134, 472.303554761435, 482.3901544350989, 458.13266054607305, 475.54721641205043, 472.8149278277707, 459.73872701930895, 441.17526623609047, 519.1731573070817, 513.0881037290468, 451.8434061405589, 482.4115745570297, 479.35092742727403, 465.8538193173345, 416.0122776975132, 474.4349048288562, 502.29641411400746, 452.23138400193096, 470.53160799919016, 501.4905860384196, 474.41007124796556, 500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6552331920706336, "mean_inference_ms": 4.8881731886511695, "mean_action_processing_ms": 0.9029272219382388, "mean_env_wait_ms": 4.860160597109115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013688325881958008, "StateBufferConnector_ms": 0.006704807281494141, "ViewRequirementAgentConnector_ms": 0.28829431533813477}, "num_episodes": 20, "episode_return_max": 520.9166655904755, "episode_return_min": 415.2199240768473, "episode_return_mean": 473.9899900902609, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.4874820969279, "num_env_steps_trained_throughput_per_sec": 322.4874820969279, "timesteps_total": 40960, "num_env_steps_sampled_lifetime": 40960, "num_agent_steps_sampled_lifetime": 40960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 3272.683, "restore_workers_time_ms": 0.197, "training_step_time_ms": 3272.486, "sample_time_ms": 1319.806, "learn_time_ms": 1925.591, "learn_throughput": 531.785, "synch_weights_time_ms": 26.786}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "training_iteration": 40, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-37", "timestamp": 1744127197, "time_this_iter_s": 3.188823699951172, "time_total_s": 220.86278867721558, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA20C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.86278867721558, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 43.779999999999994, "ram_util_percent": 93.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.171696463599801, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 1e-07, "total_loss": 2.2090565979480745, "policy_loss": -5.314549780450761e-05, "vf_loss": 9.992828261852264, "vf_explained_var": -3.1583011150360106e-06, "kl": 6.601199169953275e-07, "entropy": 2.8909730821847917, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "env_runners": {"episode_reward_max": 523.0116527737973, "episode_reward_min": 415.2199240768473, "episode_reward_mean": 474.5353057581591, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.2199240768473}, "policy_reward_max": {"tplp_policy": 523.0116527737973}, "policy_reward_mean": {"tplp_policy": 474.5353057581591}, "custom_metrics": {"mean_episode_reward_mean": 474.5353057581591, "mean_episode_reward_min": 415.2199240768473, "mean_episode_reward_max": 523.0116527737973}, "hist_stats": {"episode_reward": [500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [500.7582343300948, 488.8438351013103, 465.433436764716, 477.1999976196548, 480.8889736354801, 486.95057614089353, 471.7914788810458, 458.51349274244507, 450.184620466016, 474.8615031171654, 470.88682369624286, 468.7341987262371, 464.9313806228188, 454.2563187232308, 453.95069096398424, 455.35010093722485, 501.5879480442759, 467.80918696936294, 464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.636364414771153, "mean_inference_ms": 4.831083548998609, "mean_action_processing_ms": 0.8928871117284299, "mean_env_wait_ms": 4.808194963347059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014049053192138672, "StateBufferConnector_ms": 0.006601810455322266, "ViewRequirementAgentConnector_ms": 0.34603095054626465}, "num_episodes": 22, "episode_return_max": 523.0116527737973, "episode_return_min": 415.2199240768473, "episode_return_mean": 474.5353057581591, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 294.5440424190541, "num_env_steps_trained_throughput_per_sec": 294.5440424190541, "timesteps_total": 41984, "num_env_steps_sampled_lifetime": 41984, "num_agent_steps_sampled_lifetime": 41984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 3248.003, "restore_workers_time_ms": 0.197, "training_step_time_ms": 3247.806, "sample_time_ms": 1321.983, "learn_time_ms": 1899.25, "learn_throughput": 539.16, "synch_weights_time_ms": 26.27}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "training_iteration": 41, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-41", "timestamp": 1744127201, "time_this_iter_s": 3.484077215194702, "time_total_s": 224.34686589241028, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206FC12E660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.34686589241028, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 60.05, "ram_util_percent": 93.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.057254055701196, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 1e-07, "total_loss": 2.2072605937719345, "policy_loss": -0.00010336705599911511, "vf_loss": 9.98633252978325, "vf_explained_var": -3.221631050109863e-06, "kl": 1.2980170042808937e-06, "entropy": 2.892191690206528, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "env_runners": {"episode_reward_max": 523.0116527737973, "episode_reward_min": 415.2199240768473, "episode_reward_mean": 475.04872617686567, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.2199240768473}, "policy_reward_max": {"tplp_policy": 523.0116527737973}, "policy_reward_mean": {"tplp_policy": 475.04872617686567}, "custom_metrics": {"mean_episode_reward_mean": 475.04872617686567, "mean_episode_reward_min": 415.2199240768473, "mean_episode_reward_max": 523.0116527737973}, "hist_stats": {"episode_reward": [464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.5519096177859, 508.4360321419552, 479.92729802580004, 489.57847169281297, 489.77286897032803, 467.14539960441726, 464.49668347151567, 490.06315907044575, 489.9030545822673, 520.9166655904755, 494.2565724680312, 477.93050961499404, 475.0145500255847, 468.4705900138745, 490.7203330757703, 479.44614495738864, 450.56445583324955, 453.4625640070226, 444.22903917278035, 467.4168880597886, 496.5626817366582, 473.9683000679168, 461.8556016983178, 417.2772893869955, 471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6214258515920625, "mean_inference_ms": 4.786892630633788, "mean_action_processing_ms": 0.8848881864122262, "mean_env_wait_ms": 4.767842279911726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01555180549621582, "StateBufferConnector_ms": 0.008944511413574219, "ViewRequirementAgentConnector_ms": 0.3414945602416992}, "num_episodes": 18, "episode_return_max": 523.0116527737973, "episode_return_min": 415.2199240768473, "episode_return_mean": 475.04872617686567, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.36186331739015, "num_env_steps_trained_throughput_per_sec": 329.36186331739015, "timesteps_total": 43008, "num_env_steps_sampled_lifetime": 43008, "num_agent_steps_sampled_lifetime": 43008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 3232.689, "restore_workers_time_ms": 0.197, "training_step_time_ms": 3232.492, "sample_time_ms": 1302.885, "learn_time_ms": 1902.854, "learn_throughput": 538.139, "synch_weights_time_ms": 26.45}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "training_iteration": 42, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-44", "timestamp": 1744127204, "time_this_iter_s": 3.120028257369995, "time_total_s": 227.46689414978027, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA22A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.46689414978027, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 43.14, "ram_util_percent": 93.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8410997413098813, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 1e-07, "total_loss": 2.2102923937141896, "policy_loss": 5.132157821208239e-06, "vf_loss": 9.9987508893013, "vf_explained_var": -8.109956979751586e-07, "kl": 7.439062416958464e-07, "entropy": 2.8940045103430747, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "env_runners": {"episode_reward_max": 534.7948974224084, "episode_reward_min": 415.2199240768473, "episode_reward_mean": 476.3304345347951, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.2199240768473}, "policy_reward_max": {"tplp_policy": 534.7948974224084}, "policy_reward_mean": {"tplp_policy": 476.3304345347951}, "custom_metrics": {"mean_episode_reward_mean": 476.3304345347951, "mean_episode_reward_min": 415.2199240768473, "mean_episode_reward_max": 534.7948974224084}, "hist_stats": {"episode_reward": [471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.19092083075776, 472.9435257060097, 491.34761367887546, 502.40436217675926, 493.6979644570579, 456.6031330050859, 511.7589427211301, 439.0417155671754, 454.9417194382804, 455.2919786664264, 471.6348655699696, 445.65609093971574, 465.47041335250765, 446.2790931665768, 478.62633018967813, 477.33194487026014, 496.16495861246347, 512.1839062053489, 437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6031135407299495, "mean_inference_ms": 4.729463489180967, "mean_action_processing_ms": 0.8745516614022422, "mean_env_wait_ms": 4.716585217312384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012035131454467773, "StateBufferConnector_ms": 0.013962507247924805, "ViewRequirementAgentConnector_ms": 0.33544349670410156}, "num_episodes": 24, "episode_return_max": 534.7948974224084, "episode_return_min": 415.2199240768473, "episode_return_mean": 476.3304345347951, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.0983592636598, "num_env_steps_trained_throughput_per_sec": 327.0983592636598, "timesteps_total": 44032, "num_env_steps_sampled_lifetime": 44032, "num_agent_steps_sampled_lifetime": 44032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 3216.41, "restore_workers_time_ms": 0.197, "training_step_time_ms": 3216.213, "sample_time_ms": 1294.532, "learn_time_ms": 1894.971, "learn_throughput": 540.378, "synch_weights_time_ms": 26.406}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "training_iteration": 43, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-47", "timestamp": 1744127207, "time_this_iter_s": 3.1406378746032715, "time_total_s": 230.60753202438354, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA11C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 230.60753202438354, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 53.35000000000001, "ram_util_percent": 93.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5062353529036043, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 1e-07, "total_loss": 2.206158036738634, "policy_loss": -0.00025713281356729565, "vf_loss": 9.983951807022095, "vf_explained_var": -3.1616538763046266e-06, "kl": 2.001806907125925e-06, "entropy": 2.895727813243866, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "env_runners": {"episode_reward_max": 534.7948974224084, "episode_reward_min": 415.2199240768473, "episode_reward_mean": 476.5316627558334, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.2199240768473}, "policy_reward_max": {"tplp_policy": 534.7948974224084}, "policy_reward_mean": {"tplp_policy": 476.5316627558334}, "custom_metrics": {"mean_episode_reward_mean": 476.5316627558334, "mean_episode_reward_min": 415.2199240768473, "mean_episode_reward_max": 534.7948974224084}, "hist_stats": {"episode_reward": [437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [437.8638157150695, 446.5952079718436, 447.1679886390977, 453.20403123823223, 505.7359350338608, 476.11401307744046, 506.8328224452155, 490.4576155363892, 471.2220202632145, 466.97465029042604, 458.04374207440685, 519.2298177390157, 461.21398764487253, 501.19211634987306, 415.2199240768473, 500.4711870701847, 482.8040959486921, 473.04962388665535, 523.0024965361147, 471.49834104686647, 495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5896163679967672, "mean_inference_ms": 4.690264219009274, "mean_action_processing_ms": 0.8680290983422464, "mean_env_wait_ms": 4.679874688350864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009964942932128906, "StateBufferConnector_ms": 0.013895511627197266, "ViewRequirementAgentConnector_ms": 0.3270564079284668}, "num_episodes": 18, "episode_return_max": 534.7948974224084, "episode_return_min": 415.2199240768473, "episode_return_mean": 476.5316627558334, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.2792243169377, "num_env_steps_trained_throughput_per_sec": 317.2792243169377, "timesteps_total": 45056, "num_env_steps_sampled_lifetime": 45056, "num_agent_steps_sampled_lifetime": 45056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 3217.965, "restore_workers_time_ms": 0.197, "training_step_time_ms": 3217.769, "sample_time_ms": 1298.985, "learn_time_ms": 1892.867, "learn_throughput": 540.978, "synch_weights_time_ms": 25.613}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "training_iteration": 44, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-51", "timestamp": 1744127211, "time_this_iter_s": 3.2365803718566895, "time_total_s": 233.84411239624023, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA27A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.84411239624023, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 93.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.304139961767942, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 1e-07, "total_loss": 2.2080007143318654, "policy_loss": -0.00012197507021483034, "vf_loss": 9.991651940345765, "vf_explained_var": -3.061816096305847e-06, "kl": 2.063517262934633e-06, "entropy": 2.897902974486351, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "env_runners": {"episode_reward_max": 534.7948974224084, "episode_reward_min": 400.0768103445545, "episode_reward_mean": 474.9425112391724, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.0768103445545}, "policy_reward_max": {"tplp_policy": 534.7948974224084}, "policy_reward_mean": {"tplp_policy": 474.9425112391724}, "custom_metrics": {"mean_episode_reward_mean": 474.9425112391724, "mean_episode_reward_min": 400.0768103445545, "mean_episode_reward_max": 534.7948974224084}, "hist_stats": {"episode_reward": [495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.3070546325474, 436.36346323185995, 483.09892651328306, 452.0532743710285, 492.6698822032231, 433.42758623783703, 488.022823355045, 485.13305732623564, 505.4569389520217, 445.9008213917727, 504.88182906959844, 487.7982448047345, 473.0413579207588, 466.52793872006555, 469.413098373724, 432.83464421183635, 523.0116527737973, 486.50869839547346, 458.80247047542287, 473.9140407488693, 486.47310653690687, 482.67920974792395, 500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5752983393735298, "mean_inference_ms": 4.6469392866347725, "mean_action_processing_ms": 0.8604101587566055, "mean_env_wait_ms": 4.640964582320775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010448455810546875, "StateBufferConnector_ms": 0.013373851776123047, "ViewRequirementAgentConnector_ms": 0.33452725410461426}, "num_episodes": 20, "episode_return_max": 534.7948974224084, "episode_return_min": 400.0768103445545, "episode_return_mean": 474.9425112391724, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.64341950357243, "num_env_steps_trained_throughput_per_sec": 329.64341950357243, "timesteps_total": 46080, "num_env_steps_sampled_lifetime": 46080, "num_agent_steps_sampled_lifetime": 46080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 3212.202, "restore_workers_time_ms": 0.143, "training_step_time_ms": 3212.06, "sample_time_ms": 1293.301, "learn_time_ms": 1892.605, "learn_throughput": 541.053, "synch_weights_time_ms": 25.85}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "training_iteration": 45, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-54", "timestamp": 1744127214, "time_this_iter_s": 3.1165695190429688, "time_total_s": 236.9606819152832, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.9606819152832, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 44.22, "ram_util_percent": 93.86000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.177407381311059, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 1e-07, "total_loss": 2.2100017093122006, "policy_loss": -4.453467554412782e-05, "vf_loss": 10.0, "vf_explained_var": -3.2518059015274047e-06, "kl": 4.043392814040425e-07, "entropy": 2.899537540972233, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "env_runners": {"episode_reward_max": 534.7948974224084, "episode_reward_min": 400.0768103445545, "episode_reward_mean": 477.2877456960865, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.0768103445545}, "policy_reward_max": {"tplp_policy": 534.7948974224084}, "policy_reward_mean": {"tplp_policy": 477.2877456960865}, "custom_metrics": {"mean_episode_reward_mean": 477.2877456960865, "mean_episode_reward_min": 400.0768103445545, "mean_episode_reward_max": 534.7948974224084}, "hist_stats": {"episode_reward": [500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [500.8770894241974, 456.04862667938085, 460.78219793535436, 470.4207786231372, 483.45161692384625, 459.4145221617735, 480.3255361960032, 463.3629717521396, 462.38483440293345, 451.9322530859009, 509.94603264940844, 498.80777661002713, 466.5664719396053, 466.3998313891737, 447.20688461195397, 497.195098683205, 534.7948974224084, 450.4174982986667, 516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5600374994388753, "mean_inference_ms": 4.601088095298491, "mean_action_processing_ms": 0.8523083191261388, "mean_env_wait_ms": 4.599426602501466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010012626647949219, "StateBufferConnector_ms": 0.014869451522827148, "ViewRequirementAgentConnector_ms": 0.3000476360321045}, "num_episodes": 22, "episode_return_max": 534.7948974224084, "episode_return_min": 400.0768103445545, "episode_return_mean": 477.2877456960865, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 319.80234917648966, "num_env_steps_trained_throughput_per_sec": 319.80234917648966, "timesteps_total": 47104, "num_env_steps_sampled_lifetime": 47104, "num_agent_steps_sampled_lifetime": 47104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 3211.428, "restore_workers_time_ms": 0.143, "training_step_time_ms": 3211.286, "sample_time_ms": 1298.879, "learn_time_ms": 1886.131, "learn_throughput": 542.91, "synch_weights_time_ms": 26.176}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "training_iteration": 46, "trial_id": "f7884_00000", "date": "2025-04-08_23-46-57", "timestamp": 1744127217, "time_this_iter_s": 3.2104971408843994, "time_total_s": 240.1711790561676, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.1711790561676, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 53.325, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.351957160234451, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 1e-07, "total_loss": 2.2019429579377174, "policy_loss": -8.287944365292788e-05, "vf_loss": 9.968243980407715, "vf_explained_var": -2.880021929740906e-06, "kl": 9.701584088250837e-07, "entropy": 2.9003514155745505, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "env_runners": {"episode_reward_max": 527.130790012436, "episode_reward_min": 400.0768103445545, "episode_reward_mean": 477.8996909159269, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.0768103445545}, "policy_reward_max": {"tplp_policy": 527.130790012436}, "policy_reward_mean": {"tplp_policy": 477.8996909159269}, "custom_metrics": {"mean_episode_reward_mean": 477.8996909159269, "mean_episode_reward_min": 400.0768103445545, "mean_episode_reward_max": 527.130790012436}, "hist_stats": {"episode_reward": [516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [516.1789755490444, 491.57603308954367, 444.1316200088379, 476.71825597209363, 492.92234628467423, 473.95756563455484, 470.46442191888355, 476.2568705611748, 479.86953389040906, 483.5140382114788, 476.9014520423062, 491.1917355032726, 467.3415218963409, 497.15141634128236, 479.77719565609283, 457.5562711717746, 490.91104072100853, 460.027987512689, 505.2494242160228, 454.7147676084885, 471.5790050418945, 500.934024126158, 489.303866015421, 480.2684418396669, 491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5486415589878246, "mean_inference_ms": 4.566638842308449, "mean_action_processing_ms": 0.8459488519656553, "mean_env_wait_ms": 4.568638028924607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02678537368774414, "StateBufferConnector_ms": 0.015584707260131836, "ViewRequirementAgentConnector_ms": 0.31786155700683594}, "num_episodes": 18, "episode_return_max": 527.130790012436, "episode_return_min": 400.0768103445545, "episode_return_mean": 477.8996909159269, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 291.14723295494525, "num_env_steps_trained_throughput_per_sec": 291.14723295494525, "timesteps_total": 48128, "num_env_steps_sampled_lifetime": 48128, "num_agent_steps_sampled_lifetime": 48128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 3240.995, "restore_workers_time_ms": 0.143, "training_step_time_ms": 3240.852, "sample_time_ms": 1309.719, "learn_time_ms": 1904.844, "learn_throughput": 537.577, "synch_weights_time_ms": 26.289}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "training_iteration": 47, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-01", "timestamp": 1744127221, "time_this_iter_s": 3.524866819381714, "time_total_s": 243.69604587554932, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 243.69604587554932, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 49.519999999999996, "ram_util_percent": 93.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1375156816095116, "cur_kl_coeff": 1.4210854715202003e-15, "cur_lr": 1e-07, "total_loss": 2.209785541892052, "policy_loss": -2.7717516059055924e-05, "vf_loss": 10.0, "vf_explained_var": -2.2988766431808473e-06, "kl": 7.607043390200907e-07, "entropy": 2.9018673971295357, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "env_runners": {"episode_reward_max": 527.130790012436, "episode_reward_min": 400.0768103445545, "episode_reward_mean": 477.4327755740506, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.0768103445545}, "policy_reward_max": {"tplp_policy": 527.130790012436}, "policy_reward_mean": {"tplp_policy": 477.4327755740506}, "custom_metrics": {"mean_episode_reward_mean": 477.4327755740506, "mean_episode_reward_min": 400.0768103445545, "mean_episode_reward_max": 527.130790012436}, "hist_stats": {"episode_reward": [491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.45839282965613, 448.41144019120253, 494.1566809033694, 482.01909190492097, 474.9737024779091, 461.48257402113063, 458.25866092897877, 472.6708775918046, 470.050083269039, 527.130790012436, 448.73507507594894, 451.79008962135964, 475.32553101505215, 503.95600009612616, 458.9728177777454, 473.72818568615384, 490.55818301088107, 496.19431553140237, 444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.53380023092866, "mean_inference_ms": 4.522173734179122, "mean_action_processing_ms": 0.8377201914323387, "mean_env_wait_ms": 4.529146855948997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02780771255493164, "StateBufferConnector_ms": 0.0115814208984375, "ViewRequirementAgentConnector_ms": 0.320842981338501}, "num_episodes": 24, "episode_return_max": 527.130790012436, "episode_return_min": 400.0768103445545, "episode_return_mean": 477.4327755740506, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 326.38496347082315, "num_env_steps_trained_throughput_per_sec": 326.38496347082315, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 49152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 3234.574, "restore_workers_time_ms": 0.143, "training_step_time_ms": 3234.431, "sample_time_ms": 1294.597, "learn_time_ms": 1913.748, "learn_throughput": 535.076, "synch_weights_time_ms": 26.031}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "training_iteration": 48, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-04", "timestamp": 1744127224, "time_this_iter_s": 3.146106004714966, "time_total_s": 246.84215188026428, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.84215188026428, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 46.26, "ram_util_percent": 93.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1880483768880366, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 1e-07, "total_loss": 2.2039263591170313, "policy_loss": -0.00011399698269087821, "vf_loss": 9.977507603168487, "vf_explained_var": -3.3818185329437254e-06, "kl": 1.257584455682803e-06, "entropy": 2.903365467488766, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "env_runners": {"episode_reward_max": 523.2875107653638, "episode_reward_min": 400.0768103445545, "episode_reward_mean": 478.389510531095, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.0768103445545}, "policy_reward_max": {"tplp_policy": 523.2875107653638}, "policy_reward_mean": {"tplp_policy": 478.389510531095}, "custom_metrics": {"mean_episode_reward_mean": 478.389510531095, "mean_episode_reward_min": 400.0768103445545, "mean_episode_reward_max": 523.2875107653638}, "hist_stats": {"episode_reward": [444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [444.6125074379523, 433.5346232276652, 443.42343725330693, 496.29767265232374, 458.43553399183463, 479.7243462757633, 460.5945019988123, 483.3546523338244, 400.0768103445545, 449.32482835478123, 469.9854054676489, 468.9888170562391, 479.100516303719, 523.2875107653638, 470.1333774155187, 440.3229402578109, 522.264178873694, 438.7641223651054, 451.58545165126714, 456.5725891664313, 467.31188980568004, 499.45236688013944, 477.4262660418458, 477.59329992418037, 494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5229067228629143, "mean_inference_ms": 4.490689757994546, "mean_action_processing_ms": 0.8317289969634786, "mean_env_wait_ms": 4.501394383482655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028489351272583008, "StateBufferConnector_ms": 0.012425661087036133, "ViewRequirementAgentConnector_ms": 0.3213319778442383}, "num_episodes": 18, "episode_return_max": 523.2875107653638, "episode_return_min": 400.0768103445545, "episode_return_mean": 478.389510531095, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 324.3465346272958, "num_env_steps_trained_throughput_per_sec": 324.3465346272958, "timesteps_total": 50176, "num_env_steps_sampled_lifetime": 50176, "num_agent_steps_sampled_lifetime": 50176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 3223.892, "restore_workers_time_ms": 0.143, "training_step_time_ms": 3223.749, "sample_time_ms": 1303.131, "learn_time_ms": 1895.069, "learn_throughput": 540.35, "synch_weights_time_ms": 25.495}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "training_iteration": 49, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-07", "timestamp": 1744127227, "time_this_iter_s": 3.164402484893799, "time_total_s": 250.00655436515808, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.00655436515808, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 52.425, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7907257843762636, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 1e-07, "total_loss": 2.208796624839306, "policy_loss": -2.2521603386849166e-05, "vf_loss": 9.997327715158463, "vf_explained_var": -3.866851329803467e-06, "kl": 9.340662818546619e-07, "entropy": 2.9051275476813316, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "env_runners": {"episode_reward_max": 521.1129958863556, "episode_reward_min": 431.54675230209966, "episode_reward_mean": 481.69874397135834, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.54675230209966}, "policy_reward_max": {"tplp_policy": 521.1129958863556}, "policy_reward_mean": {"tplp_policy": 481.69874397135834}, "custom_metrics": {"mean_episode_reward_mean": 481.69874397135834, "mean_episode_reward_min": 431.54675230209966, "mean_episode_reward_max": 521.1129958863556}, "hist_stats": {"episode_reward": [494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [494.04288743144343, 481.39846174593686, 490.7201643703417, 517.6083323367094, 492.90137349500174, 482.73885128520783, 484.3145338478249, 492.3032935848386, 484.96357509456453, 490.993072614343, 478.3097293854043, 493.20405584502197, 514.4017062472428, 503.00901943199233, 482.1774006183583, 484.81524488161295, 475.31074503747305, 474.31829296766693, 500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5097747087623532, "mean_inference_ms": 4.4501028825026765, "mean_action_processing_ms": 0.8240630140339809, "mean_env_wait_ms": 4.466951547955834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03225278854370117, "StateBufferConnector_ms": 0.009419679641723633, "ViewRequirementAgentConnector_ms": 0.3316478729248047}, "num_episodes": 24, "episode_return_max": 521.1129958863556, "episode_return_min": 431.54675230209966, "episode_return_mean": 481.69874397135834, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.75074967923206, "num_env_steps_trained_throughput_per_sec": 317.75074967923206, "timesteps_total": 51200, "num_env_steps_sampled_lifetime": 51200, "num_agent_steps_sampled_lifetime": 51200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 3228.625, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3228.625, "sample_time_ms": 1303.864, "learn_time_ms": 1899.015, "learn_throughput": 539.227, "synch_weights_time_ms": 25.693}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "training_iteration": 50, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-11", "timestamp": 1744127231, "time_this_iter_s": 3.235403299331665, "time_total_s": 253.24195766448975, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07DF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.24195766448975, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 45.31999999999999, "ram_util_percent": 93.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.991070812754333, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 1e-07, "total_loss": 2.2022719115018843, "policy_loss": -5.26828458532691e-05, "vf_loss": 9.972267681360245, "vf_explained_var": -3.5163015127182006e-06, "kl": 1.4925892051653733e-06, "entropy": 2.9074232295155524, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "env_runners": {"episode_reward_max": 521.1129958863556, "episode_reward_min": 421.03467512322374, "episode_reward_mean": 477.5371976454725, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.03467512322374}, "policy_reward_max": {"tplp_policy": 521.1129958863556}, "policy_reward_mean": {"tplp_policy": 477.5371976454725}, "custom_metrics": {"mean_episode_reward_mean": 477.5371976454725, "mean_episode_reward_min": 421.03467512322374, "mean_episode_reward_max": 521.1129958863556}, "hist_stats": {"episode_reward": [500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [500.2329376730448, 496.4815486312134, 480.7505268134464, 480.9598371347313, 507.7805414236117, 462.0252344864054, 509.1159879244878, 486.78403534193365, 471.77463365965855, 468.2906501642929, 475.4771191437377, 485.65124292732685, 455.9969939309158, 459.66303051228243, 479.82606748219564, 451.09001551873524, 497.31731505694495, 473.143728071279, 453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4995675869757508, "mean_inference_ms": 4.421794364314723, "mean_action_processing_ms": 0.8190657242960956, "mean_env_wait_ms": 4.441489165919363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028603553771972656, "StateBufferConnector_ms": 0.010026693344116211, "ViewRequirementAgentConnector_ms": 0.3438906669616699}, "num_episodes": 18, "episode_return_max": 521.1129958863556, "episode_return_min": 421.03467512322374, "episode_return_mean": 477.5371976454725, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.14430642484473, "num_env_steps_trained_throughput_per_sec": 285.14430642484473, "timesteps_total": 52224, "num_env_steps_sampled_lifetime": 52224, "num_agent_steps_sampled_lifetime": 52224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 3240.086, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3240.086, "sample_time_ms": 1292.449, "learn_time_ms": 1921.451, "learn_throughput": 532.93, "synch_weights_time_ms": 26.131}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "training_iteration": 51, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-14", "timestamp": 1744127234, "time_this_iter_s": 3.597806930541992, "time_total_s": 256.83976459503174, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.83976459503174, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 53.32000000000001, "ram_util_percent": 94.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7831797175109387, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 1e-07, "total_loss": 2.206745008379221, "policy_loss": -2.2136193001642825e-05, "vf_loss": 9.990727066993713, "vf_explained_var": -3.832951188087464e-06, "kl": 4.709824458423717e-07, "entropy": 2.9091461330652235, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "env_runners": {"episode_reward_max": 521.1129958863556, "episode_reward_min": 411.41059321469487, "episode_reward_mean": 476.8165473791378, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.41059321469487}, "policy_reward_max": {"tplp_policy": 521.1129958863556}, "policy_reward_mean": {"tplp_policy": 476.8165473791378}, "custom_metrics": {"mean_episode_reward_mean": 476.8165473791378, "mean_episode_reward_min": 411.41059321469487, "mean_episode_reward_max": 521.1129958863556}, "hist_stats": {"episode_reward": [453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.79434499192223, 505.2120047179476, 473.99276380328456, 476.2410650817925, 511.47125031801113, 486.9121101260812, 503.19295693616886, 483.4066067712404, 462.55408248388, 435.02759708601945, 512.4196939269466, 496.0081516736221, 480.0240750047563, 512.3112055292294, 486.4948669462801, 442.034215017053, 431.54675230209966, 470.3096729304038, 480.8760522203393, 491.5621123339191, 456.4928018201581, 459.46085147609057, 488.9193611263719, 473.02627945143576, 495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4900050413390789, "mean_inference_ms": 4.393374647917994, "mean_action_processing_ms": 0.813981986811846, "mean_env_wait_ms": 4.416297964815646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014046907424926758, "StateBufferConnector_ms": 0.0074617862701416016, "ViewRequirementAgentConnector_ms": 0.3450794219970703}, "num_episodes": 18, "episode_return_max": 521.1129958863556, "episode_return_min": 411.41059321469487, "episode_return_mean": 476.8165473791378, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.64795362238596, "num_env_steps_trained_throughput_per_sec": 309.64795362238596, "timesteps_total": 53248, "num_env_steps_sampled_lifetime": 53248, "num_agent_steps_sampled_lifetime": 53248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 3259.88, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3259.78, "sample_time_ms": 1307.359, "learn_time_ms": 1926.716, "learn_throughput": 531.474, "synch_weights_time_ms": 25.651}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "training_iteration": 52, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-18", "timestamp": 1744127238, "time_this_iter_s": 3.3151662349700928, "time_total_s": 260.15493083000183, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.15493083000183, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 93.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.937731775641441, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 1e-07, "total_loss": 2.2024053327739237, "policy_loss": -3.073874395340681e-05, "vf_loss": 9.973897689580918, "vf_explained_var": -2.9653310775756836e-06, "kl": 1.1050195445672094e-06, "entropy": 2.9103834584355353, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "env_runners": {"episode_reward_max": 521.1129958863556, "episode_reward_min": 411.41059321469487, "episode_reward_mean": 475.5728580915708, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.41059321469487}, "policy_reward_max": {"tplp_policy": 521.1129958863556}, "policy_reward_mean": {"tplp_policy": 475.5728580915708}, "custom_metrics": {"mean_episode_reward_mean": 475.5728580915708, "mean_episode_reward_min": 411.41059321469487, "mean_episode_reward_max": 521.1129958863556}, "hist_stats": {"episode_reward": [495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.24931085340484, 450.8528251196202, 496.9116978765579, 492.5953252263335, 446.83110116825145, 508.71772550510315, 487.3960223317229, 471.09320638215064, 486.939968039002, 502.2512112725602, 495.7533178694477, 460.3189560163298, 468.062946445215, 499.28331722735555, 489.1107747474223, 462.2326409912803, 465.74876681623164, 470.37219262786016, 475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4779226272050017, "mean_inference_ms": 4.356810638116855, "mean_action_processing_ms": 0.8073097142643627, "mean_env_wait_ms": 4.383941455987537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01381993293762207, "StateBufferConnector_ms": 0.009566783905029297, "ViewRequirementAgentConnector_ms": 0.36260366439819336}, "num_episodes": 24, "episode_return_max": 521.1129958863556, "episode_return_min": 411.41059321469487, "episode_return_mean": 475.5728580915708, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.78966571312753, "num_env_steps_trained_throughput_per_sec": 309.78966571312753, "timesteps_total": 54272, "num_env_steps_sampled_lifetime": 54272, "num_agent_steps_sampled_lifetime": 54272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 3277.371, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3277.171, "sample_time_ms": 1308.208, "learn_time_ms": 1942.825, "learn_throughput": 527.067, "synch_weights_time_ms": 26.084}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "training_iteration": 53, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-21", "timestamp": 1744127241, "time_this_iter_s": 3.3170642852783203, "time_total_s": 263.47199511528015, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.47199511528015, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.84, "ram_util_percent": 93.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.126840555295348, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 1e-07, "total_loss": 2.2023571759462355, "policy_loss": -0.00013440613402053713, "vf_loss": 9.974999195337295, "vf_explained_var": -3.495067358016968e-06, "kl": 1.806416161898028e-06, "entropy": 2.912582112848759, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "env_runners": {"episode_reward_max": 521.1129958863556, "episode_reward_min": 411.41059321469487, "episode_reward_mean": 475.11570614202503, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.41059321469487}, "policy_reward_max": {"tplp_policy": 521.1129958863556}, "policy_reward_mean": {"tplp_policy": 475.11570614202503}, "custom_metrics": {"mean_episode_reward_mean": 475.11570614202503, "mean_episode_reward_min": 411.41059321469487, "mean_episode_reward_max": 521.1129958863556}, "hist_stats": {"episode_reward": [475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.71425452681825, 464.6389951188755, 509.12720709808406, 461.3232493953609, 513.9036474617624, 495.8283272017534, 481.29373472103543, 521.1129958863556, 494.9320958316119, 514.5140912740384, 504.68864111260785, 460.48024203797144, 443.38506873697696, 455.36355088036976, 480.2946475193545, 481.20757147263333, 448.17625383165046, 459.80563766313196, 482.3447791888709, 480.0482456662731, 503.80422311629076, 454.9825706858823, 441.04726513203525, 448.0160545632291, 452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.469213355108029, "mean_inference_ms": 4.330062077664627, "mean_action_processing_ms": 0.8025690608186881, "mean_env_wait_ms": 4.360228539097751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012269735336303711, "StateBufferConnector_ms": 0.008219242095947266, "ViewRequirementAgentConnector_ms": 0.35873889923095703}, "num_episodes": 18, "episode_return_max": 521.1129958863556, "episode_return_min": 411.41059321469487, "episode_return_mean": 475.11570614202503, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 330.3935363916443, "num_env_steps_trained_throughput_per_sec": 330.3935363916443, "timesteps_total": 55296, "num_env_steps_sampled_lifetime": 55296, "num_agent_steps_sampled_lifetime": 55296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 3264.56, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3264.361, "sample_time_ms": 1300.552, "learn_time_ms": 1937.045, "learn_throughput": 528.64, "synch_weights_time_ms": 26.709}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "training_iteration": 54, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-24", "timestamp": 1744127244, "time_this_iter_s": 3.114245653152466, "time_total_s": 266.5862407684326, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.5862407684326, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 43.620000000000005, "ram_util_percent": 93.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081170968711376, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 1e-07, "total_loss": 2.2060725316405296, "policy_loss": -3.938604495488107e-05, "vf_loss": 9.990449106693267, "vf_explained_var": -2.0887702703475954e-06, "kl": 1.6460063052115004e-06, "entropy": 2.915003626048565, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "env_runners": {"episode_reward_max": 520.9830389353018, "episode_reward_min": 411.41059321469487, "episode_reward_mean": 474.7076701213462, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.41059321469487}, "policy_reward_max": {"tplp_policy": 520.9830389353018}, "policy_reward_mean": {"tplp_policy": 474.7076701213462}, "custom_metrics": {"mean_episode_reward_mean": 474.7076701213462, "mean_episode_reward_min": 411.41059321469487, "mean_episode_reward_max": 520.9830389353018}, "hist_stats": {"episode_reward": [452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [452.5763153772494, 486.28211475791505, 518.5523126015269, 481.19291561397586, 457.4180649787887, 430.7476160313519, 494.83432047083335, 451.0821513412818, 421.03467512322374, 462.90038890565245, 462.0834642687376, 462.273478230063, 464.671111810407, 459.23937330401566, 501.84922847857723, 505.5752566435301, 430.0939713609882, 464.77543887902175, 461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4575275354519703, "mean_inference_ms": 4.295448901808161, "mean_action_processing_ms": 0.7962575392598285, "mean_env_wait_ms": 4.329545080153146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006880998611450195, "StateBufferConnector_ms": 0.01092529296875, "ViewRequirementAgentConnector_ms": 0.3394286632537842}, "num_episodes": 24, "episode_return_max": 520.9830389353018, "episode_return_min": 411.41059321469487, "episode_return_mean": 474.7076701213462, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.23683669291614, "num_env_steps_trained_throughput_per_sec": 329.23683669291614, "timesteps_total": 56320, "num_env_steps_sampled_lifetime": 56320, "num_agent_steps_sampled_lifetime": 56320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 3264.944, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3264.744, "sample_time_ms": 1299.871, "learn_time_ms": 1937.832, "learn_throughput": 528.426, "synch_weights_time_ms": 26.884}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "training_iteration": 55, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-27", "timestamp": 1744127247, "time_this_iter_s": 3.1187405586242676, "time_total_s": 269.7049813270569, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.7049813270569, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 51.85, "ram_util_percent": 93.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.244229833781719, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 1e-07, "total_loss": 2.2063570126891134, "policy_loss": -7.432433776557445e-05, "vf_loss": 9.992767918109895, "vf_explained_var": -4.069879651069641e-06, "kl": 1.511940911223808e-06, "entropy": 2.917606443166733, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "env_runners": {"episode_reward_max": 520.9830389353018, "episode_reward_min": 411.41059321469487, "episode_reward_mean": 477.6825514477694, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.41059321469487}, "policy_reward_max": {"tplp_policy": 520.9830389353018}, "policy_reward_mean": {"tplp_policy": 477.6825514477694}, "custom_metrics": {"mean_episode_reward_mean": 477.6825514477694, "mean_episode_reward_min": 411.41059321469487, "mean_episode_reward_max": 520.9830389353018}, "hist_stats": {"episode_reward": [461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [461.2560013149934, 515.043070319344, 488.71264171541935, 493.27688413079966, 470.6323942563407, 446.969729458796, 474.72861115474217, 411.41059321469487, 486.54017244948614, 492.3435673514718, 473.8714120732409, 461.0354961796196, 499.9358869248438, 508.60306795747306, 479.68296751227, 511.38451300922554, 476.35916998913746, 474.2021322373503, 495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4490063954371424, "mean_inference_ms": 4.27048978576167, "mean_action_processing_ms": 0.7916207766863157, "mean_env_wait_ms": 4.306970399312272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00806427001953125, "StateBufferConnector_ms": 0.008413314819335938, "ViewRequirementAgentConnector_ms": 0.3052947521209717}, "num_episodes": 18, "episode_return_max": 520.9830389353018, "episode_return_min": 411.41059321469487, "episode_return_mean": 477.6825514477694, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 314.33164868827197, "num_env_steps_trained_throughput_per_sec": 314.33164868827197, "timesteps_total": 57344, "num_env_steps_sampled_lifetime": 57344, "num_agent_steps_sampled_lifetime": 57344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 3270.567, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3270.317, "sample_time_ms": 1296.085, "learn_time_ms": 1946.691, "learn_throughput": 526.021, "synch_weights_time_ms": 27.266}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "training_iteration": 56, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-31", "timestamp": 1744127251, "time_this_iter_s": 3.266888380050659, "time_total_s": 272.97186970710754, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.97186970710754, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 45.96, "ram_util_percent": 93.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.175620983168483, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 1e-07, "total_loss": 2.2055647142231463, "policy_loss": -8.243031334131956e-05, "vf_loss": 9.990448552370072, "vf_explained_var": -4.201009869575501e-06, "kl": 1.3355946958171216e-06, "entropy": 2.919649948179722, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "env_runners": {"episode_reward_max": 536.033634319748, "episode_reward_min": 427.32925152443295, "episode_reward_mean": 477.53129857002835, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.32925152443295}, "policy_reward_max": {"tplp_policy": 536.033634319748}, "policy_reward_mean": {"tplp_policy": 477.53129857002835}, "custom_metrics": {"mean_episode_reward_mean": 477.53129857002835, "mean_episode_reward_min": 427.32925152443295, "mean_episode_reward_max": 536.033634319748}, "hist_stats": {"episode_reward": [495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.7434945080836, 435.1380577887966, 470.71821036705154, 487.18888925827184, 479.0850331855171, 463.2179356698859, 480.3293980195028, 440.9535272569842, 440.5285771130854, 478.632551016455, 475.2494945639737, 449.33587811988144, 490.2946295257938, 487.02169100096086, 480.02010677249217, 466.5038575838015, 471.85867161951643, 495.86794074732757, 492.7702156018226, 465.9383265003712, 489.8622459896488, 462.10191088265344, 432.915276807522, 431.6915909302808, 505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4406837342685015, "mean_inference_ms": 4.246307600217887, "mean_action_processing_ms": 0.7873416178735165, "mean_env_wait_ms": 4.285435280166342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00756382942199707, "StateBufferConnector_ms": 0.009489059448242188, "ViewRequirementAgentConnector_ms": 0.3125491142272949}, "num_episodes": 18, "episode_return_max": 536.033634319748, "episode_return_min": 427.32925152443295, "episode_return_mean": 477.53129857002835, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.75014303065166, "num_env_steps_trained_throughput_per_sec": 309.75014303065166, "timesteps_total": 58368, "num_env_steps_sampled_lifetime": 58368, "num_agent_steps_sampled_lifetime": 58368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 3249.444, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3249.194, "sample_time_ms": 1288.177, "learn_time_ms": 1933.272, "learn_throughput": 529.672, "synch_weights_time_ms": 27.471}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "training_iteration": 57, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-34", "timestamp": 1744127254, "time_this_iter_s": 3.314044952392578, "time_total_s": 276.2859146595001, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.2859146595001, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 54.425, "ram_util_percent": 93.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1953255660831927, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 1e-07, "total_loss": 2.2053044706583025, "policy_loss": -0.0001427198643796146, "vf_loss": 9.990448409318924, "vf_explained_var": -3.100931644439697e-06, "kl": 1.7834897496182834e-06, "entropy": 2.92164902985096, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "env_runners": {"episode_reward_max": 536.033634319748, "episode_reward_min": 427.32925152443295, "episode_reward_mean": 480.4886490722031, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.32925152443295}, "policy_reward_max": {"tplp_policy": 536.033634319748}, "policy_reward_mean": {"tplp_policy": 480.4886490722031}, "custom_metrics": {"mean_episode_reward_mean": 480.4886490722031, "mean_episode_reward_min": 427.32925152443295, "mean_episode_reward_max": 536.033634319748}, "hist_stats": {"episode_reward": [505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [505.39075379347395, 458.2091879949006, 458.04213796115374, 477.3597875287147, 489.4375628805598, 495.61959119399415, 508.5089697027116, 493.10531509635143, 471.71738827086733, 516.431007920034, 471.36818603231217, 488.78365926300387, 498.34234817194033, 479.32409662282873, 431.0566020922072, 496.70264929840687, 488.66012115514565, 484.35234163233906, 454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4299909786182707, "mean_inference_ms": 4.215553732170109, "mean_action_processing_ms": 0.7821278058341737, "mean_env_wait_ms": 4.259062981009891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007433652877807617, "StateBufferConnector_ms": 0.006977081298828125, "ViewRequirementAgentConnector_ms": 0.2991056442260742}, "num_episodes": 24, "episode_return_max": 536.033634319748, "episode_return_min": 427.32925152443295, "episode_return_mean": 480.4886490722031, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 305.503732259754, "num_env_steps_trained_throughput_per_sec": 305.503732259754, "timesteps_total": 59392, "num_env_steps_sampled_lifetime": 59392, "num_agent_steps_sampled_lifetime": 59392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 3270.888, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3270.638, "sample_time_ms": 1299.088, "learn_time_ms": 1943.946, "learn_throughput": 526.764, "synch_weights_time_ms": 27.384}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "training_iteration": 58, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-38", "timestamp": 1744127258, "time_this_iter_s": 3.3580830097198486, "time_total_s": 279.64399766921997, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC054720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.64399766921997, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 47.519999999999996, "ram_util_percent": 93.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3480099199339746, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 1e-07, "total_loss": 2.2046108171343803, "policy_loss": -0.00010006027878262103, "vf_loss": 9.988203513622285, "vf_explained_var": -2.9403716325759886e-06, "kl": 1.1692948480135357e-06, "entropy": 2.923399966955185, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "env_runners": {"episode_reward_max": 536.033634319748, "episode_reward_min": 426.00782198592555, "episode_reward_mean": 478.76628330454935, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.00782198592555}, "policy_reward_max": {"tplp_policy": 536.033634319748}, "policy_reward_mean": {"tplp_policy": 478.76628330454935}, "custom_metrics": {"mean_episode_reward_mean": 478.76628330454935, "mean_episode_reward_min": 426.00782198592555, "mean_episode_reward_max": 536.033634319748}, "hist_stats": {"episode_reward": [454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [454.1146529134842, 483.3585270478622, 507.6165778981117, 491.58789233487227, 481.38974560109256, 472.3579735986996, 476.1425280725746, 520.9830389353018, 485.9022284036177, 448.24061020017245, 458.15458528225713, 480.8002539003792, 473.328838538213, 509.6303722845887, 454.34021683449834, 454.08187320100984, 468.8252503040195, 490.7072434965717, 455.8606167649339, 485.9025826300782, 456.1866308453359, 452.70504617993225, 508.6051748749214, 516.1988353434044, 483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4226675574647356, "mean_inference_ms": 4.194491635854379, "mean_action_processing_ms": 0.7783286198556516, "mean_env_wait_ms": 4.240946617733069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007378101348876953, "StateBufferConnector_ms": 0.005484580993652344, "ViewRequirementAgentConnector_ms": 0.3111107349395752}, "num_episodes": 18, "episode_return_max": 536.033634319748, "episode_return_min": 426.00782198592555, "episode_return_mean": 478.76628330454935, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 301.52347358809766, "num_env_steps_trained_throughput_per_sec": 301.52347358809766, "timesteps_total": 60416, "num_env_steps_sampled_lifetime": 60416, "num_agent_steps_sampled_lifetime": 60416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 3294.785, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3294.535, "sample_time_ms": 1304.598, "learn_time_ms": 1961.845, "learn_throughput": 521.958, "synch_weights_time_ms": 27.732}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "training_iteration": 59, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-41", "timestamp": 1744127261, "time_this_iter_s": 3.405529260635376, "time_total_s": 283.04952692985535, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.04952692985535, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 50.92, "ram_util_percent": 93.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0908335492014887, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 1e-07, "total_loss": 2.2050547033548353, "policy_loss": -0.00021075799013487996, "vf_loss": 9.990554767847062, "vf_explained_var": -2.9001384973526e-06, "kl": 1.0149862466724003e-06, "entropy": 2.923732188344002, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "env_runners": {"episode_reward_max": 536.033634319748, "episode_reward_min": 426.00782198592555, "episode_reward_mean": 479.02642916745657, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.00782198592555}, "policy_reward_max": {"tplp_policy": 536.033634319748}, "policy_reward_mean": {"tplp_policy": 479.02642916745657}, "custom_metrics": {"mean_episode_reward_mean": 479.02642916745657, "mean_episode_reward_min": 426.00782198592555, "mean_episode_reward_max": 536.033634319748}, "hist_stats": {"episode_reward": [483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.3152744218727, 477.30240827675107, 505.2143639946899, 455.5087343841068, 506.2685947588598, 464.0095811513766, 483.57205228359993, 485.94454643381226, 488.5543741240055, 462.91442567732247, 460.61926383471194, 497.42693234817517, 507.00235406116275, 446.49667211531477, 477.1230283037101, 478.59371443166026, 470.0149144656417, 456.59766803776006, 507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4140560473504882, "mean_inference_ms": 4.168092284588936, "mean_action_processing_ms": 0.7733842541650671, "mean_env_wait_ms": 4.217794218905043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028253555297851562, "StateBufferConnector_ms": 0.006285429000854492, "ViewRequirementAgentConnector_ms": 0.33003783226013184}, "num_episodes": 24, "episode_return_max": 536.033634319748, "episode_return_min": 426.00782198592555, "episode_return_mean": 479.02642916745657, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 308.3039554155348, "num_env_steps_trained_throughput_per_sec": 308.3039554155348, "timesteps_total": 61440, "num_env_steps_sampled_lifetime": 61440, "num_agent_steps_sampled_lifetime": 61440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 3304.66, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3304.41, "sample_time_ms": 1311.903, "learn_time_ms": 1964.935, "learn_throughput": 521.137, "synch_weights_time_ms": 27.212}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "training_iteration": 60, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-45", "timestamp": 1744127265, "time_this_iter_s": 3.3300774097442627, "time_total_s": 286.3796043395996, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.3796043395996, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 54.5, "ram_util_percent": 93.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.157035431265831, "cur_kl_coeff": 1.734723475976807e-19, "cur_lr": 1e-07, "total_loss": 2.2074228309094908, "policy_loss": -0.00011938021052628755, "vf_loss": 10.0, "vf_explained_var": -4.007667303085327e-06, "kl": 1.811204753227047e-06, "entropy": 2.9245778143405916, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "env_runners": {"episode_reward_max": 536.033634319748, "episode_reward_min": 426.00782198592555, "episode_reward_mean": 479.67815949999124, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.00782198592555}, "policy_reward_max": {"tplp_policy": 536.033634319748}, "policy_reward_mean": {"tplp_policy": 479.67815949999124}, "custom_metrics": {"mean_episode_reward_mean": 479.67815949999124, "mean_episode_reward_min": 426.00782198592555, "mean_episode_reward_max": 536.033634319748}, "hist_stats": {"episode_reward": [507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.4885547275694, 475.9548290437074, 472.6695329339683, 471.22742780720233, 491.6803153406137, 461.51149377110704, 427.32925152443295, 482.02225580699746, 471.3042618645445, 481.5122831171518, 495.6536925846458, 484.72891678348043, 455.1000345112856, 536.033634319748, 472.2328095329741, 497.8011473023201, 458.6802770461875, 488.03478242317163, 498.10822975239677, 452.454741676202, 477.4485504503308, 508.64504420101736, 513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4076409125844516, "mean_inference_ms": 4.148932639877498, "mean_action_processing_ms": 0.76965182465986, "mean_env_wait_ms": 4.200740293630065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02606940269470215, "StateBufferConnector_ms": 0.006213188171386719, "ViewRequirementAgentConnector_ms": 0.33061981201171875}, "num_episodes": 18, "episode_return_max": 536.033634319748, "episode_return_min": 426.00782198592555, "episode_return_mean": 479.67815949999124, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 324.4031500050077, "num_env_steps_trained_throughput_per_sec": 324.4031500050077, "timesteps_total": 62464, "num_env_steps_sampled_lifetime": 62464, "num_agent_steps_sampled_lifetime": 62464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 3261.2, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3260.95, "sample_time_ms": 1303.635, "learn_time_ms": 1929.78, "learn_throughput": 530.63, "synch_weights_time_ms": 27.176}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "training_iteration": 61, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-48", "timestamp": 1744127268, "time_this_iter_s": 3.1671152114868164, "time_total_s": 289.5467195510864, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.5467195510864, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 45.18, "ram_util_percent": 93.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.892654221877456, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 1e-07, "total_loss": 2.203284649550915, "policy_loss": -7.635618967469782e-05, "vf_loss": 9.983978134393691, "vf_explained_var": -7.241964340209961e-07, "kl": 8.686907250893272e-07, "entropy": 2.9263350293040276, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "env_runners": {"episode_reward_max": 520.02802201961, "episode_reward_min": 417.53692783420126, "episode_reward_mean": 479.0098931674471, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.53692783420126}, "policy_reward_max": {"tplp_policy": 520.02802201961}, "policy_reward_mean": {"tplp_policy": 479.0098931674471}, "custom_metrics": {"mean_episode_reward_mean": 479.0098931674471, "mean_episode_reward_min": 417.53692783420126, "mean_episode_reward_max": 520.02802201961}, "hist_stats": {"episode_reward": [513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.6629522582806, 482.26249751772554, 459.29173479671357, 465.47431830350934, 469.68840099358863, 494.6197825123639, 492.4076646331276, 493.43560371757553, 495.5740724286144, 505.6854587228704, 473.87466857393036, 470.1117525549533, 461.6221374058231, 443.69176082264244, 494.5810223820567, 509.56976744024365, 444.1381709409147, 505.6391694929074, 504.9197041777071, 459.4224862302927, 491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.400484003202734, "mean_inference_ms": 4.125151553121327, "mean_action_processing_ms": 0.7647498464794711, "mean_env_wait_ms": 4.180412307267662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099513053894043, "StateBufferConnector_ms": 0.006891727447509766, "ViewRequirementAgentConnector_ms": 0.3323991298675537}, "num_episodes": 22, "episode_return_max": 520.02802201961, "episode_return_min": 417.53692783420126, "episode_return_mean": 479.0098931674471, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 320.7809530396262, "num_env_steps_trained_throughput_per_sec": 320.7809530396262, "timesteps_total": 63488, "num_env_steps_sampled_lifetime": 63488, "num_agent_steps_sampled_lifetime": 63488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 3249.723, "restore_workers_time_ms": 0.1, "training_step_time_ms": 3249.573, "sample_time_ms": 1287.779, "learn_time_ms": 1934.199, "learn_throughput": 529.418, "synch_weights_time_ms": 27.235}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "training_iteration": 62, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-51", "timestamp": 1744127271, "time_this_iter_s": 3.200329542160034, "time_total_s": 292.74704909324646, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA23E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.74704909324646, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 54.150000000000006, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.118120701611042, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 1e-07, "total_loss": 2.2063770785927774, "policy_loss": -3.3689782139845195e-05, "vf_loss": 9.996335887908936, "vf_explained_var": -3.75211238861084e-06, "kl": 2.852256866248126e-07, "entropy": 2.9267321169376372, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "env_runners": {"episode_reward_max": 520.02802201961, "episode_reward_min": 417.53692783420126, "episode_reward_mean": 476.50743959675043, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.53692783420126}, "policy_reward_max": {"tplp_policy": 520.02802201961}, "policy_reward_mean": {"tplp_policy": 476.50743959675043}, "custom_metrics": {"mean_episode_reward_mean": 476.50743959675043, "mean_episode_reward_min": 417.53692783420126, "mean_episode_reward_max": 520.02802201961}, "hist_stats": {"episode_reward": [491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.4571254879896, 426.00782198592555, 481.78031412312777, 493.5505906868233, 469.7958138130782, 451.42770976198403, 430.7682053879895, 486.3617027876585, 488.74126358888043, 460.2907355278164, 480.8736369517948, 491.01550187290087, 494.05202542036255, 474.1818583609389, 462.1213697041984, 493.40726397610115, 470.00592246865455, 453.7579761020286, 493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3932705943950163, "mean_inference_ms": 4.105684625350942, "mean_action_processing_ms": 0.760547155683391, "mean_env_wait_ms": 4.160188823593455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03157305717468262, "StateBufferConnector_ms": 0.009104728698730469, "ViewRequirementAgentConnector_ms": 0.32755017280578613}, "num_episodes": 20, "episode_return_max": 520.02802201961, "episode_return_min": 417.53692783420126, "episode_return_mean": 476.50743959675043, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 324.0291590741794, "num_env_steps_trained_throughput_per_sec": 324.0291590741794, "timesteps_total": 64512, "num_env_steps_sampled_lifetime": 64512, "num_agent_steps_sampled_lifetime": 64512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 3235.197, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3235.146, "sample_time_ms": 1284.016, "learn_time_ms": 1923.898, "learn_throughput": 532.253, "synch_weights_time_ms": 26.874}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "training_iteration": 63, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-54", "timestamp": 1744127274, "time_this_iter_s": 3.1700527667999268, "time_total_s": 295.9171018600464, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0572E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.9171018600464, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 44.419999999999995, "ram_util_percent": 93.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1258657265454532, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 1e-07, "total_loss": 2.2067960858345033, "policy_loss": -8.624534821137786e-05, "vf_loss": 9.998551601171494, "vf_explained_var": -3.731250762939453e-06, "kl": 1.1735767671994246e-06, "entropy": 2.9275555863976477, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "env_runners": {"episode_reward_max": 520.02802201961, "episode_reward_min": 414.66028261023274, "episode_reward_mean": 477.06246696097617, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.66028261023274}, "policy_reward_max": {"tplp_policy": 520.02802201961}, "policy_reward_mean": {"tplp_policy": 477.06246696097617}, "custom_metrics": {"mean_episode_reward_mean": 477.06246696097617, "mean_episode_reward_min": 414.66028261023274, "mean_episode_reward_max": 520.02802201961}, "hist_stats": {"episode_reward": [493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [493.26078239622274, 484.01717573397985, 453.4661688837022, 505.6632181635562, 490.856106865072, 471.4830139938499, 460.443605604298, 497.8128614685901, 485.94764715861805, 473.8007316734554, 489.232955681469, 506.72282752614854, 437.1012051478352, 459.580474260764, 484.48822739118674, 499.2157798039941, 464.8520027412926, 498.06438703002186, 470.6036821401678, 501.168654991256, 454.7100674898163, 506.78040706068094, 506.59118687026194, 479.53509657004736, 501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.386792341627779, "mean_inference_ms": 4.086297324652517, "mean_action_processing_ms": 0.7565421609167755, "mean_env_wait_ms": 4.14190275778884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030541181564331055, "StateBufferConnector_ms": 0.008596420288085938, "ViewRequirementAgentConnector_ms": 0.32178497314453125}, "num_episodes": 18, "episode_return_max": 520.02802201961, "episode_return_min": 414.66028261023274, "episode_return_mean": 477.06246696097617, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 335.3882596504314, "num_env_steps_trained_throughput_per_sec": 335.3882596504314, "timesteps_total": 65536, "num_env_steps_sampled_lifetime": 65536, "num_agent_steps_sampled_lifetime": 65536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 3230.581, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3230.531, "sample_time_ms": 1281.527, "learn_time_ms": 1921.874, "learn_throughput": 532.813, "synch_weights_time_ms": 26.77}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "training_iteration": 64, "trial_id": "f7884_00000", "date": "2025-04-08_23-47-57", "timestamp": 1744127277, "time_this_iter_s": 3.063692569732666, "time_total_s": 298.98079442977905, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.98079442977905, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 48.074999999999996, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.135691225528717, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 1e-07, "total_loss": 2.2070305563509462, "policy_loss": -4.1128875454887745e-05, "vf_loss": 10.0, "vf_explained_var": -3.8728117942810055e-06, "kl": 1.0105145027416995e-06, "entropy": 2.9292829811573027, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "env_runners": {"episode_reward_max": 521.872214657149, "episode_reward_min": 414.66028261023274, "episode_reward_mean": 475.75506293910024, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.66028261023274}, "policy_reward_max": {"tplp_policy": 521.872214657149}, "policy_reward_mean": {"tplp_policy": 475.75506293910024}, "custom_metrics": {"mean_episode_reward_mean": 475.75506293910024, "mean_episode_reward_min": 414.66028261023274, "mean_episode_reward_max": 521.872214657149}, "hist_stats": {"episode_reward": [501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [501.8037974155986, 450.3682275802348, 502.3390045614316, 499.5979792508249, 426.55939127164527, 450.3480242741629, 482.75048276739113, 458.47771859805044, 495.31114551447484, 493.81557327317785, 485.32727745148884, 514.3078141071986, 507.4944719807408, 504.2304027178417, 429.70181932841024, 483.0925228250201, 481.82644865466114, 517.273682883253, 487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.378285510571076, "mean_inference_ms": 4.061401451713376, "mean_action_processing_ms": 0.7514320191176048, "mean_env_wait_ms": 4.118617164568129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014847517013549805, "StateBufferConnector_ms": 0.01037907600402832, "ViewRequirementAgentConnector_ms": 0.2978997230529785}, "num_episodes": 24, "episode_return_max": 521.872214657149, "episode_return_min": 414.66028261023274, "episode_return_mean": 475.75506293910024, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 315.4214423146338, "num_env_steps_trained_throughput_per_sec": 315.4214423146338, "timesteps_total": 66560, "num_env_steps_sampled_lifetime": 66560, "num_agent_steps_sampled_lifetime": 66560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 3244.204, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3244.153, "sample_time_ms": 1293.238, "learn_time_ms": 1923.685, "learn_throughput": 532.312, "synch_weights_time_ms": 26.975}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "training_iteration": 65, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-01", "timestamp": 1744127281, "time_this_iter_s": 3.257305383682251, "time_total_s": 302.2380998134613, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07CE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.2380998134613, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 48.6, "ram_util_percent": 93.76000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.97671164534986, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 1e-07, "total_loss": 2.2069005705416203, "policy_loss": -8.613851387053728e-05, "vf_loss": 10.0, "vf_explained_var": -4.462525248527527e-06, "kl": 6.227603050801278e-07, "entropy": 2.930132918059826, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "env_runners": {"episode_reward_max": 521.872214657149, "episode_reward_min": 414.66028261023274, "episode_reward_mean": 474.3409113574906, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.66028261023274}, "policy_reward_max": {"tplp_policy": 521.872214657149}, "policy_reward_mean": {"tplp_policy": 474.3409113574906}, "custom_metrics": {"mean_episode_reward_mean": 474.3409113574906, "mean_episode_reward_min": 414.66028261023274, "mean_episode_reward_max": 521.872214657149}, "hist_stats": {"episode_reward": [487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.5032177842472, 493.1001804868915, 498.9604965423964, 477.73857090685374, 468.763167146609, 473.2521359004923, 490.9932433110604, 491.9023720738058, 417.53692783420126, 448.93350125086386, 475.16118138217325, 439.4623599171663, 520.02802201961, 453.05502241738077, 488.91747718730136, 481.9567540886763, 492.5803849301109, 478.50062655105427, 483.40069738259194, 439.94896261524025, 451.1430354594235, 466.78078524297933, 430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3722100044456442, "mean_inference_ms": 4.0436446078034125, "mean_action_processing_ms": 0.7478310783973785, "mean_env_wait_ms": 4.101662658212477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0185546875, "StateBufferConnector_ms": 0.014158487319946289, "ViewRequirementAgentConnector_ms": 0.29210615158081055}, "num_episodes": 18, "episode_return_max": 521.872214657149, "episode_return_min": 414.66028261023274, "episode_return_mean": 474.3409113574906, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 320.2703994596449, "num_env_steps_trained_throughput_per_sec": 320.2703994596449, "timesteps_total": 67584, "num_env_steps_sampled_lifetime": 67584, "num_agent_steps_sampled_lifetime": 67584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 3238.113, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3238.113, "sample_time_ms": 1289.013, "learn_time_ms": 1922.493, "learn_throughput": 532.642, "synch_weights_time_ms": 26.468}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "training_iteration": 66, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-04", "timestamp": 1744127284, "time_this_iter_s": 3.2049968242645264, "time_total_s": 305.44309663772583, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.44309663772583, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 51.375, "ram_util_percent": 93.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2189494766294957, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 1e-07, "total_loss": 2.2023146018385886, "policy_loss": -2.4214183213189245e-06, "vf_loss": 9.981618493795395, "vf_explained_var": -3.116205334663391e-06, "kl": 7.007283274074183e-07, "entropy": 2.930875913798809, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "env_runners": {"episode_reward_max": 521.872214657149, "episode_reward_min": 414.66028261023274, "episode_reward_mean": 476.78069361869086, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.66028261023274}, "policy_reward_max": {"tplp_policy": 521.872214657149}, "policy_reward_mean": {"tplp_policy": 476.78069361869086}, "custom_metrics": {"mean_episode_reward_mean": 476.78069361869086, "mean_episode_reward_min": 414.66028261023274, "mean_episode_reward_max": 521.872214657149}, "hist_stats": {"episode_reward": [430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [430.57023086872437, 497.1764041652959, 471.4420274326203, 476.5520300812699, 475.4368170265576, 485.25432804526406, 475.7156525799188, 463.4502506654313, 462.86142802210657, 473.94579271265883, 467.4963013076511, 484.402287350495, 502.74809561295183, 475.8311068446601, 444.2177986039594, 458.5653516778362, 501.72989324934, 424.108151887021, 458.28601848882744, 487.130503394856, 414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.365056288633234, "mean_inference_ms": 4.022715296124442, "mean_action_processing_ms": 0.7436566764417016, "mean_env_wait_ms": 4.081687594804707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014316558837890625, "StateBufferConnector_ms": 0.013402223587036133, "ViewRequirementAgentConnector_ms": 0.282789945602417}, "num_episodes": 22, "episode_return_max": 521.872214657149, "episode_return_min": 414.66028261023274, "episode_return_mean": 476.78069361869086, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 325.24966005661435, "num_env_steps_trained_throughput_per_sec": 325.24966005661435, "timesteps_total": 68608, "num_env_steps_sampled_lifetime": 68608, "num_agent_steps_sampled_lifetime": 68608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 3222.359, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3222.359, "sample_time_ms": 1280.851, "learn_time_ms": 1915.115, "learn_throughput": 534.694, "synch_weights_time_ms": 26.255}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "training_iteration": 67, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-07", "timestamp": 1744127287, "time_this_iter_s": 3.156885862350464, "time_total_s": 308.5999825000763, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D8A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.5999825000763, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 45.26, "ram_util_percent": 93.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.352716575935483, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 1e-07, "total_loss": 2.204584577679634, "policy_loss": -0.00011632429668679833, "vf_loss": 9.992257022857666, "vf_explained_var": -2.4922192096710205e-06, "kl": 2.580107840732815e-06, "entropy": 2.933633440732956, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "env_runners": {"episode_reward_max": 521.872214657149, "episode_reward_min": 414.66028261023274, "episode_reward_mean": 477.72368660728296, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.66028261023274}, "policy_reward_max": {"tplp_policy": 521.872214657149}, "policy_reward_mean": {"tplp_policy": 477.72368660728296}, "custom_metrics": {"mean_episode_reward_mean": 477.72368660728296, "mean_episode_reward_min": 414.66028261023274, "mean_episode_reward_max": 521.872214657149}, "hist_stats": {"episode_reward": [414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [414.66028261023274, 482.7373951051835, 504.87886100789524, 459.0229898230428, 482.9449036352289, 456.26463030254473, 485.94305383881175, 482.06872697048516, 443.94090189979005, 493.00141586931863, 487.4762445286889, 514.5545711952244, 442.5478511963404, 501.3722586914537, 464.7867454439393, 493.4822204289743, 494.16212425896896, 488.69463994160947, 474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3588084783172247, "mean_inference_ms": 4.003963261333797, "mean_action_processing_ms": 0.740057052105784, "mean_env_wait_ms": 4.064121379326457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014004707336425781, "StateBufferConnector_ms": 0.012188434600830078, "ViewRequirementAgentConnector_ms": 0.2674541473388672}, "num_episodes": 20, "episode_return_max": 521.872214657149, "episode_return_min": 414.66028261023274, "episode_return_mean": 477.72368660728296, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 323.9417880847948, "num_env_steps_trained_throughput_per_sec": 323.9417880847948, "timesteps_total": 69632, "num_env_steps_sampled_lifetime": 69632, "num_agent_steps_sampled_lifetime": 69632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 3203.281, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3203.281, "sample_time_ms": 1265.18, "learn_time_ms": 1911.223, "learn_throughput": 535.782, "synch_weights_time_ms": 26.738}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "training_iteration": 68, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-11", "timestamp": 1744127291, "time_this_iter_s": 3.1713688373565674, "time_total_s": 311.77135133743286, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.77135133743286, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 51.599999999999994, "ram_util_percent": 93.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.202138387039304, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 1e-07, "total_loss": 2.2014654614031315, "policy_loss": -0.00011569090420380235, "vf_loss": 9.980930161476135, "vf_explained_var": -3.6820769309997558e-06, "kl": 1.4702500058305644e-06, "entropy": 2.936513897776604, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "env_runners": {"episode_reward_max": 521.872214657149, "episode_reward_min": 428.2440581764971, "episode_reward_mean": 476.94206041458835, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2440581764971}, "policy_reward_max": {"tplp_policy": 521.872214657149}, "policy_reward_mean": {"tplp_policy": 476.94206041458835}, "custom_metrics": {"mean_episode_reward_mean": 476.94206041458835, "mean_episode_reward_min": 428.2440581764971, "mean_episode_reward_max": 521.872214657149}, "hist_stats": {"episode_reward": [474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.13999701927065, 465.56302640436627, 455.4769778750773, 494.50810935908964, 501.2891568654236, 435.11900438463147, 469.97956217535267, 480.47027823355313, 473.8016363759416, 521.872214657149, 482.023549005393, 442.44777275331126, 486.1674026432361, 478.15252656070123, 471.09636959397824, 506.1419365304759, 473.5665470577443, 462.66605431219256, 471.47398063021177, 467.850195816637, 481.5459032008073, 466.44889880356334, 463.2042686199081, 474.205391818101, 466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3534573343303202, "mean_inference_ms": 3.9877238200905287, "mean_action_processing_ms": 0.7367999281592561, "mean_env_wait_ms": 4.04896952466655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020608901977539, "StateBufferConnector_ms": 0.014864683151245117, "ViewRequirementAgentConnector_ms": 0.2577090263366699}, "num_episodes": 18, "episode_return_max": 521.872214657149, "episode_return_min": 428.2440581764971, "episode_return_mean": 476.94206041458835, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 333.21519783202876, "num_env_steps_trained_throughput_per_sec": 333.21519783202876, "timesteps_total": 70656, "num_env_steps_sampled_lifetime": 70656, "num_agent_steps_sampled_lifetime": 70656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 3170.981, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3170.981, "sample_time_ms": 1253.967, "learn_time_ms": 1890.664, "learn_throughput": 541.609, "synch_weights_time_ms": 26.35}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "training_iteration": 69, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-14", "timestamp": 1744127294, "time_this_iter_s": 3.0804216861724854, "time_total_s": 314.85177302360535, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.85177302360535, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 48.35, "ram_util_percent": 93.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5646229688078166, "cur_kl_coeff": 3.388131789017201e-22, "cur_lr": 1e-07, "total_loss": 2.2058533847332003, "policy_loss": -0.00025128626730293037, "vf_loss": 10.0, "vf_explained_var": -4.921481013298034e-06, "kl": 3.2381583268570326e-06, "entropy": 2.9389533579349516, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "env_runners": {"episode_reward_max": 512.1829766944742, "episode_reward_min": 428.2440581764971, "episode_reward_mean": 477.6305243313742, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2440581764971}, "policy_reward_max": {"tplp_policy": 512.1829766944742}, "policy_reward_mean": {"tplp_policy": 477.6305243313742}, "custom_metrics": {"mean_episode_reward_mean": 477.6305243313742, "mean_episode_reward_min": 428.2440581764971, "mean_episode_reward_max": 512.1829766944742}, "hist_stats": {"episode_reward": [466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.5158218291859, 506.2707279220238, 492.238357385815, 483.79819915259486, 487.99315866484073, 495.5904854424744, 482.0134079939259, 440.13662298797675, 473.83793765054634, 476.90995070174034, 451.59997867913773, 452.34893067802017, 458.7005256485275, 481.8221825645749, 474.13497175729003, 481.8897067979614, 488.75590742861243, 488.6901920987531, 480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3465384305107824, "mean_inference_ms": 3.966362060038772, "mean_action_processing_ms": 0.7326226073760183, "mean_env_wait_ms": 4.028796098256463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010643482208251953, "StateBufferConnector_ms": 0.011057138442993164, "ViewRequirementAgentConnector_ms": 0.26357483863830566}, "num_episodes": 24, "episode_return_max": 512.1829766944742, "episode_return_min": 428.2440581764971, "episode_return_mean": 477.6305243313742, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.3976843304965, "num_env_steps_trained_throughput_per_sec": 318.3976843304965, "timesteps_total": 71680, "num_env_steps_sampled_lifetime": 71680, "num_agent_steps_sampled_lifetime": 71680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 3160.452, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3160.452, "sample_time_ms": 1253.904, "learn_time_ms": 1880.411, "learn_throughput": 544.562, "synch_weights_time_ms": 26.137}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "training_iteration": 70, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-17", "timestamp": 1744127297, "time_this_iter_s": 3.2251274585723877, "time_total_s": 318.07690048217773, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.07690048217773, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 46.58, "ram_util_percent": 93.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.866613322123885, "cur_kl_coeff": 1.6940658945086005e-22, "cur_lr": 1e-07, "total_loss": 2.2039469942450522, "policy_loss": -4.975482588633895e-05, "vf_loss": 9.992488998174668, "vf_explained_var": -3.6697834730148316e-06, "kl": 8.7141792635137e-07, "entropy": 2.941255068778992, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "env_runners": {"episode_reward_max": 530.9853383656013, "episode_reward_min": 428.2440581764971, "episode_reward_mean": 476.6709954096028, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2440581764971}, "policy_reward_max": {"tplp_policy": 530.9853383656013}, "policy_reward_mean": {"tplp_policy": 476.6709954096028}, "custom_metrics": {"mean_episode_reward_mean": 476.6709954096028, "mean_episode_reward_min": 428.2440581764971, "mean_episode_reward_max": 530.9853383656013}, "hist_stats": {"episode_reward": [480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.65439902425675, 510.80265400514696, 508.08685179018494, 492.6139999514299, 480.6671751466045, 494.99680518077145, 498.4657672770871, 496.5970198158113, 463.59459183710237, 478.1858121801083, 497.8469989785397, 442.3631231479321, 498.0866680571682, 497.1544098414309, 461.723742320167, 484.52528406336825, 500.70734440162227, 464.2780788362951, 482.58997501112935, 452.21054815764455, 510.53905275380913, 465.4586585397602, 479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3416657383269708, "mean_inference_ms": 3.9507381109325195, "mean_action_processing_ms": 0.7296865336649931, "mean_env_wait_ms": 4.01442797188634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007349252700805664, "StateBufferConnector_ms": 0.009276390075683594, "ViewRequirementAgentConnector_ms": 0.2679555416107178}, "num_episodes": 18, "episode_return_max": 530.9853383656013, "episode_return_min": 428.2440581764971, "episode_return_mean": 476.6709954096028, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 307.23233250416934, "num_env_steps_trained_throughput_per_sec": 307.23233250416934, "timesteps_total": 72704, "num_env_steps_sampled_lifetime": 72704, "num_agent_steps_sampled_lifetime": 72704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 3178.093, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3178.093, "sample_time_ms": 1262.088, "learn_time_ms": 1889.599, "learn_throughput": 541.914, "synch_weights_time_ms": 26.406}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "training_iteration": 71, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-20", "timestamp": 1744127300, "time_this_iter_s": 3.3415753841400146, "time_total_s": 321.41847586631775, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0579C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.41847586631775, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 51.475, "ram_util_percent": 93.62499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2056930851191283, "cur_kl_coeff": 8.470329472543003e-23, "cur_lr": 1e-07, "total_loss": 2.2030481673777103, "policy_loss": -2.8964970260858537e-05, "vf_loss": 9.989234048128129, "vf_explained_var": -3.5390257835388184e-06, "kl": 8.180830646742354e-07, "entropy": 2.9423135623335837, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "env_runners": {"episode_reward_max": 530.9853383656013, "episode_reward_min": 428.2440581764971, "episode_reward_mean": 475.47367295407616, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2440581764971}, "policy_reward_max": {"tplp_policy": 530.9853383656013}, "policy_reward_mean": {"tplp_policy": 475.47367295407616}, "custom_metrics": {"mean_episode_reward_mean": 475.47367295407616, "mean_episode_reward_min": 428.2440581764971, "mean_episode_reward_max": 530.9853383656013}, "hist_stats": {"episode_reward": [479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [479.2231604229782, 473.33316766876715, 479.46243601915177, 432.4991808944869, 500.35267666558866, 470.2680080659295, 467.7299213566182, 491.36710544085895, 508.68872411270615, 433.25683123707313, 488.48155060873944, 463.86210133029033, 479.3577469289593, 484.46575900392276, 478.3682643131066, 473.05682018028307, 447.5852434159451, 483.86335991767436, 486.09779968857816, 494.2696366187646, 454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3360497374419078, "mean_inference_ms": 3.9332614935026733, "mean_action_processing_ms": 0.7263545802368254, "mean_env_wait_ms": 3.997969040094026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008933305740356445, "StateBufferConnector_ms": 0.010628223419189453, "ViewRequirementAgentConnector_ms": 0.2772986888885498}, "num_episodes": 22, "episode_return_max": 530.9853383656013, "episode_return_min": 428.2440581764971, "episode_return_mean": 475.47367295407616, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 315.4800129953781, "num_env_steps_trained_throughput_per_sec": 315.4800129953781, "timesteps_total": 73728, "num_env_steps_sampled_lifetime": 73728, "num_agent_steps_sampled_lifetime": 73728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 3183.457, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3183.457, "sample_time_ms": 1278.037, "learn_time_ms": 1879.566, "learn_throughput": 544.807, "synch_weights_time_ms": 25.854}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "training_iteration": 72, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-24", "timestamp": 1744127304, "time_this_iter_s": 3.2533743381500244, "time_total_s": 324.6718502044678, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA1F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 324.6718502044678, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 46.67999999999999, "ram_util_percent": 93.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.40866444632411, "cur_kl_coeff": 4.2351647362715013e-23, "cur_lr": 1e-07, "total_loss": 2.2054793179035186, "policy_loss": -0.0001569285581354052, "vf_loss": 10.0, "vf_explained_var": -3.491714596748352e-06, "kl": 1.580243501164702e-06, "entropy": 2.9436374336481093, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "env_runners": {"episode_reward_max": 530.9853383656013, "episode_reward_min": 428.2440581764971, "episode_reward_mean": 474.7968679311858, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2440581764971}, "policy_reward_max": {"tplp_policy": 530.9853383656013}, "policy_reward_mean": {"tplp_policy": 474.7968679311858}, "custom_metrics": {"mean_episode_reward_mean": 474.7968679311858, "mean_episode_reward_min": 428.2440581764971, "mean_episode_reward_max": 530.9853383656013}, "hist_stats": {"episode_reward": [454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [454.2345660446453, 459.9432971239149, 474.4577074346039, 472.7315430916975, 428.2440581764971, 510.0085746218495, 491.79395986437675, 443.3821328836663, 477.9653190910143, 473.90322963699407, 502.1727623702658, 465.5114052986359, 467.4138839958962, 498.7289885972564, 438.4279910720507, 475.0903418675576, 499.8499130726619, 508.1511105960289, 488.47564103154576, 451.880203462299, 512.1829766944742, 460.1909356782129, 456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.331613962321704, "mean_inference_ms": 3.9188418609127127, "mean_action_processing_ms": 0.7236360088162673, "mean_env_wait_ms": 3.984592761419732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013526678085327148, "StateBufferConnector_ms": 0.013837814331054688, "ViewRequirementAgentConnector_ms": 0.27678751945495605}, "num_episodes": 20, "episode_return_max": 530.9853383656013, "episode_return_min": 428.2440581764971, "episode_return_mean": 474.7968679311858, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 316.5330017093649, "num_env_steps_trained_throughput_per_sec": 316.5330017093649, "timesteps_total": 74752, "num_env_steps_sampled_lifetime": 74752, "num_agent_steps_sampled_lifetime": 74752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 3190.941, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3190.941, "sample_time_ms": 1295.592, "learn_time_ms": 1869.345, "learn_throughput": 547.786, "synch_weights_time_ms": 26.004}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "training_iteration": 73, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-27", "timestamp": 1744127307, "time_this_iter_s": 3.2452988624572754, "time_total_s": 327.91714906692505, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.91714906692505, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 50.949999999999996, "ram_util_percent": 93.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1438351031392813, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 1e-07, "total_loss": 2.205342471599579, "policy_loss": -0.00012235415051691233, "vf_loss": 10.0, "vf_explained_var": -1.7073005437850953e-06, "kl": 1.8231892099596082e-06, "entropy": 2.945351718366146, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "env_runners": {"episode_reward_max": 530.9853383656013, "episode_reward_min": 406.4359449815939, "episode_reward_mean": 475.16687021030964, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.4359449815939}, "policy_reward_max": {"tplp_policy": 530.9853383656013}, "policy_reward_mean": {"tplp_policy": 475.16687021030964}, "custom_metrics": {"mean_episode_reward_mean": 475.16687021030964, "mean_episode_reward_min": 406.4359449815939, "mean_episode_reward_max": 530.9853383656013}, "hist_stats": {"episode_reward": [456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [456.44314672557897, 454.98643668913263, 471.88588040101655, 454.63926892428805, 488.25525090840716, 495.19447348303913, 455.02862448252563, 474.1532346499064, 467.18816861963137, 489.690722298337, 466.5480903944755, 450.8591024566945, 485.34784097828185, 479.8370571087476, 506.77697156638993, 468.01275518369846, 504.75538154088656, 477.723965428439, 522.8123128122812, 428.92643084774824, 478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3270747847772189, "mean_inference_ms": 3.902638880414559, "mean_action_processing_ms": 0.720832475512238, "mean_env_wait_ms": 3.9709094378798127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015556812286376953, "StateBufferConnector_ms": 0.013646125793457031, "ViewRequirementAgentConnector_ms": 0.29087162017822266}, "num_episodes": 22, "episode_return_max": 530.9853383656013, "episode_return_min": 406.4359449815939, "episode_return_mean": 475.16687021030964, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 319.7088651588749, "num_env_steps_trained_throughput_per_sec": 319.7088651588749, "timesteps_total": 75776, "num_env_steps_sampled_lifetime": 75776, "num_agent_steps_sampled_lifetime": 75776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 3205.915, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3205.915, "sample_time_ms": 1299.15, "learn_time_ms": 1880.842, "learn_throughput": 544.437, "synch_weights_time_ms": 25.922}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "training_iteration": 74, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-30", "timestamp": 1744127310, "time_this_iter_s": 3.2137582302093506, "time_total_s": 331.1309072971344, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 331.1309072971344, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 45.14, "ram_util_percent": 93.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0566664081066848, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 1e-07, "total_loss": 2.2006747730076315, "policy_loss": -5.667491932399571e-05, "vf_loss": 9.981776523590089, "vf_explained_var": -3.5550445318222044e-06, "kl": 8.269245979519723e-07, "entropy": 2.9471268713474275, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "env_runners": {"episode_reward_max": 530.9853383656013, "episode_reward_min": 406.4359449815939, "episode_reward_mean": 477.4137876697893, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.4359449815939}, "policy_reward_max": {"tplp_policy": 530.9853383656013}, "policy_reward_mean": {"tplp_policy": 477.4137876697893}, "custom_metrics": {"mean_episode_reward_mean": 477.4137876697893, "mean_episode_reward_min": 406.4359449815939, "mean_episode_reward_max": 530.9853383656013}, "hist_stats": {"episode_reward": [478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.2895235553519, 464.1757465351008, 436.1720059699369, 474.81477271093877, 481.3344735860742, 446.3891960533282, 530.9853383656013, 480.5133615905528, 465.3623307480152, 455.82031777355286, 515.3251887723571, 468.00506960568566, 469.6541976253507, 475.52872204234745, 443.2092807128382, 449.9759038998086, 496.17494657506603, 475.3097890408158, 473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3227530447856954, "mean_inference_ms": 3.8905881869177956, "mean_action_processing_ms": 0.7185766980322742, "mean_env_wait_ms": 3.9582719338501637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018602848052978516, "StateBufferConnector_ms": 0.01267242431640625, "ViewRequirementAgentConnector_ms": 0.2912874221801758}, "num_episodes": 20, "episode_return_max": 530.9853383656013, "episode_return_min": 406.4359449815939, "episode_return_mean": 477.4137876697893, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 308.421625841721, "num_env_steps_trained_throughput_per_sec": 308.421625841721, "timesteps_total": 76800, "num_env_steps_sampled_lifetime": 76800, "num_agent_steps_sampled_lifetime": 76800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 3213.283, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3213.283, "sample_time_ms": 1295.072, "learn_time_ms": 1892.456, "learn_throughput": 541.096, "synch_weights_time_ms": 25.755}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "training_iteration": 75, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-34", "timestamp": 1744127314, "time_this_iter_s": 3.3288426399230957, "time_total_s": 334.4597499370575, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.4597499370575, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 47.775, "ram_util_percent": 93.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.15626789778471, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 1e-07, "total_loss": 2.2026236809790136, "policy_loss": -0.00012188119580969214, "vf_loss": 9.990486764907837, "vf_explained_var": -4.580616950988769e-06, "kl": 1.9154789018038797e-06, "entropy": 2.948761135339737, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "env_runners": {"episode_reward_max": 523.4486960032577, "episode_reward_min": 406.4359449815939, "episode_reward_mean": 478.36269883795416, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.4359449815939}, "policy_reward_max": {"tplp_policy": 523.4486960032577}, "policy_reward_mean": {"tplp_policy": 478.36269883795416}, "custom_metrics": {"mean_episode_reward_mean": 478.36269883795416, "mean_episode_reward_min": 406.4359449815939, "mean_episode_reward_max": 523.4486960032577}, "hist_stats": {"episode_reward": [473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.58115151788473, 509.47576300626747, 505.28324989115333, 476.244068747833, 499.130696545144, 511.02751710457204, 483.76415457439697, 462.8762058551278, 460.57245451535124, 460.48175899133815, 457.3768230522036, 460.8633005179174, 510.53651326188947, 512.2526875468767, 459.0348733209811, 440.83573551418135, 519.3197895761228, 458.7700488502106, 449.4118830357623, 460.09330372360466, 481.4397457155461, 478.5523426474602, 475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319266045435104, "mean_inference_ms": 3.878848248255884, "mean_action_processing_ms": 0.7165522760463112, "mean_env_wait_ms": 3.9476065906636393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01959824562072754, "StateBufferConnector_ms": 0.017385244369506836, "ViewRequirementAgentConnector_ms": 0.29784417152404785}, "num_episodes": 18, "episode_return_max": 523.4486960032577, "episode_return_min": 406.4359449815939, "episode_return_mean": 478.36269883795416, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 299.0375995821936, "num_env_steps_trained_throughput_per_sec": 299.0375995821936, "timesteps_total": 77824, "num_env_steps_sampled_lifetime": 77824, "num_agent_steps_sampled_lifetime": 77824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 3235.985, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3235.985, "sample_time_ms": 1303.126, "learn_time_ms": 1907.431, "learn_throughput": 536.848, "synch_weights_time_ms": 25.327}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "training_iteration": 76, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-37", "timestamp": 1744127317, "time_this_iter_s": 3.4339752197265625, "time_total_s": 337.89372515678406, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.89372515678406, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 49.760000000000005, "ram_util_percent": 93.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0700382808223368, "cur_kl_coeff": 2.6469779601696883e-24, "cur_lr": 1e-07, "total_loss": 2.198338335007429, "policy_loss": -0.0001345400349237025, "vf_loss": 9.973707419633865, "vf_explained_var": -4.700571298599243e-06, "kl": 6.717660982591412e-07, "entropy": 2.9495395541191103, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "env_runners": {"episode_reward_max": 523.4486960032577, "episode_reward_min": 406.4359449815939, "episode_reward_mean": 479.7274642080224, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.4359449815939}, "policy_reward_max": {"tplp_policy": 523.4486960032577}, "policy_reward_mean": {"tplp_policy": 479.7274642080224}, "custom_metrics": {"mean_episode_reward_mean": 479.7274642080224, "mean_episode_reward_min": 406.4359449815939, "mean_episode_reward_max": 523.4486960032577}, "hist_stats": {"episode_reward": [475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.3918062460688, 510.04715711070907, 500.6796929706719, 464.57748083941067, 475.1993442775154, 462.7359925286513, 434.05380108974384, 454.2511907232674, 486.25361391414083, 470.228359520541, 469.0058865676207, 456.8646721281125, 487.60913360522545, 473.7482270850992, 439.98808157917034, 458.369030529015, 476.37398765213663, 492.5394448712826, 406.4359449815939, 446.295113390273, 446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.314733224844403, "mean_inference_ms": 3.8633410610072976, "mean_action_processing_ms": 0.7140699667496897, "mean_env_wait_ms": 3.9334155865984544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02052164077758789, "StateBufferConnector_ms": 0.015982866287231445, "ViewRequirementAgentConnector_ms": 0.2883598804473877}, "num_episodes": 22, "episode_return_max": 523.4486960032577, "episode_return_min": 406.4359449815939, "episode_return_mean": 479.7274642080224, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.3239128497097, "num_env_steps_trained_throughput_per_sec": 328.3239128497097, "timesteps_total": 78848, "num_env_steps_sampled_lifetime": 78848, "num_agent_steps_sampled_lifetime": 78848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 3233.037, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3233.037, "sample_time_ms": 1294.22, "learn_time_ms": 1911.082, "learn_throughput": 535.822, "synch_weights_time_ms": 27.635}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "training_iteration": 77, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-40", "timestamp": 1744127320, "time_this_iter_s": 3.130094289779663, "time_total_s": 341.0238194465637, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA0E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 341.0238194465637, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 47.35999999999999, "ram_util_percent": 93.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8644373912364243, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 1e-07, "total_loss": 2.205052803456783, "policy_loss": -1.1604407336562873e-05, "vf_loss": 10.0, "vf_explained_var": -4.319474101066589e-06, "kl": 3.778031254175751e-07, "entropy": 2.949355864524841, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "env_runners": {"episode_reward_max": 523.4486960032577, "episode_reward_min": 440.2815117956985, "episode_reward_mean": 482.446089277568, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.2815117956985}, "policy_reward_max": {"tplp_policy": 523.4486960032577}, "policy_reward_mean": {"tplp_policy": 482.446089277568}, "custom_metrics": {"mean_episode_reward_mean": 482.446089277568, "mean_episode_reward_min": 440.2815117956985, "mean_episode_reward_max": 523.4486960032577}, "hist_stats": {"episode_reward": [446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [446.50904565904506, 477.8501584127841, 460.27820204744046, 454.4887771772225, 518.4651590545852, 489.54895166768307, 450.1645277577465, 489.97433567886185, 477.79443046455145, 520.1433088237582, 476.29881453423513, 488.7091705250625, 507.18657581759675, 451.5727219650972, 477.22549696406116, 523.4486960032577, 474.54745751191575, 482.3679079728984, 486.1941626530573, 486.241810555806, 467.25362844709946, 492.4413058436504, 502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3106764805398654, "mean_inference_ms": 3.849410039741142, "mean_action_processing_ms": 0.711839886668044, "mean_env_wait_ms": 3.920701043709944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014158248901367188, "StateBufferConnector_ms": 0.016546249389648438, "ViewRequirementAgentConnector_ms": 0.2950925827026367}, "num_episodes": 20, "episode_return_max": 523.4486960032577, "episode_return_min": 440.2815117956985, "episode_return_mean": 482.446089277568, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.2964851721916, "num_env_steps_trained_throughput_per_sec": 329.2964851721916, "timesteps_total": 79872, "num_env_steps_sampled_lifetime": 79872, "num_agent_steps_sampled_lifetime": 79872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 3227.897, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3227.897, "sample_time_ms": 1308.37, "learn_time_ms": 1892.265, "learn_throughput": 541.15, "synch_weights_time_ms": 27.162}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "training_iteration": 78, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-44", "timestamp": 1744127324, "time_this_iter_s": 3.118140935897827, "time_total_s": 344.14196038246155, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC055120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 344.14196038246155, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 52.825, "ram_util_percent": 93.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.063039830699563, "cur_kl_coeff": 6.617444900424221e-25, "cur_lr": 1e-07, "total_loss": 2.204866202175617, "policy_loss": -0.0001215300231706351, "vf_loss": 10.0, "vf_explained_var": -3.3926218748092653e-06, "kl": 8.759983085693257e-07, "entropy": 2.9501225486397744, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "env_runners": {"episode_reward_max": 533.7924516809292, "episode_reward_min": 423.1337149050425, "episode_reward_mean": 482.5369682786851, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.1337149050425}, "policy_reward_max": {"tplp_policy": 533.7924516809292}, "policy_reward_mean": {"tplp_policy": 482.5369682786851}, "custom_metrics": {"mean_episode_reward_mean": 482.5369682786851, "mean_episode_reward_min": 423.1337149050425, "mean_episode_reward_max": 533.7924516809292}, "hist_stats": {"episode_reward": [502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.0854656290353, 489.4799351059051, 517.4541893664352, 448.78594154073267, 452.2304436772714, 466.3470866069621, 508.2375322913879, 499.2867977306669, 510.3376383273556, 457.7383745352664, 479.8476345730738, 516.9029461580932, 521.7166185305133, 483.712743012789, 477.07126559559396, 446.16316613434407, 487.8163015813705, 498.8478467599199, 445.89642836962577, 510.43424698323133, 499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3060751038053104, "mean_inference_ms": 3.833847882601881, "mean_action_processing_ms": 0.7094227901292857, "mean_env_wait_ms": 3.906409183785936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010131359100341797, "StateBufferConnector_ms": 0.015061140060424805, "ViewRequirementAgentConnector_ms": 0.288769006729126}, "num_episodes": 22, "episode_return_max": 533.7924516809292, "episode_return_min": 423.1337149050425, "episode_return_mean": 482.5369682786851, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 333.5764275626476, "num_env_steps_trained_throughput_per_sec": 333.5764275626476, "timesteps_total": 80896, "num_env_steps_sampled_lifetime": 80896, "num_agent_steps_sampled_lifetime": 80896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 3227.564, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3227.564, "sample_time_ms": 1298.741, "learn_time_ms": 1901.354, "learn_throughput": 538.564, "synch_weights_time_ms": 27.259}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "training_iteration": 79, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-47", "timestamp": 1744127327, "time_this_iter_s": 3.0779037475585938, "time_total_s": 347.21986413002014, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.21986413002014, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 45.1, "ram_util_percent": 93.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2556737311184407, "cur_kl_coeff": 3.3087224502121104e-25, "cur_lr": 1e-07, "total_loss": 2.2032076373696325, "policy_loss": -0.00010263603762723505, "vf_loss": 9.993594843149186, "vf_explained_var": -4.21479344367981e-06, "kl": 1.1009861760766238e-06, "entropy": 2.9508842706680296, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "env_runners": {"episode_reward_max": 533.7924516809292, "episode_reward_min": 423.1337149050425, "episode_reward_mean": 482.053253780756, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.1337149050425}, "policy_reward_max": {"tplp_policy": 533.7924516809292}, "policy_reward_mean": {"tplp_policy": 482.053253780756}, "custom_metrics": {"mean_episode_reward_mean": 482.053253780756, "mean_episode_reward_min": 423.1337149050425, "mean_episode_reward_max": 533.7924516809292}, "hist_stats": {"episode_reward": [499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.3191569944156, 452.4524732290516, 451.2541421215587, 477.004200799153, 453.15773959649715, 477.82988886227963, 507.25983714208, 489.8888914333578, 440.2815117956985, 446.73457678336547, 504.5441242878321, 487.3422034812187, 505.60636986587457, 480.93453954008714, 513.1677626044044, 458.82318808947167, 508.4503577395306, 481.84363965990445, 478.08356129526277, 468.0473869083995, 472.20953739814905, 489.7665247507279, 468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3015718479265752, "mean_inference_ms": 3.8191107081207893, "mean_action_processing_ms": 0.7069338502256833, "mean_env_wait_ms": 3.8931010535884787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008141279220581055, "StateBufferConnector_ms": 0.017707109451293945, "ViewRequirementAgentConnector_ms": 0.289539098739624}, "num_episodes": 20, "episode_return_max": 533.7924516809292, "episode_return_min": 423.1337149050425, "episode_return_mean": 482.053253780756, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 334.6086705051001, "num_env_steps_trained_throughput_per_sec": 334.6086705051001, "timesteps_total": 81920, "num_env_steps_sampled_lifetime": 81920, "num_agent_steps_sampled_lifetime": 81920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 3211.983, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3211.983, "sample_time_ms": 1283.284, "learn_time_ms": 1900.715, "learn_throughput": 538.745, "synch_weights_time_ms": 27.775}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "training_iteration": 80, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-50", "timestamp": 1744127330, "time_this_iter_s": 3.0696804523468018, "time_total_s": 350.28954458236694, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.28954458236694, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 40.72, "ram_util_percent": 93.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1314944837242367, "cur_kl_coeff": 1.6543612251060552e-25, "cur_lr": 1e-07, "total_loss": 2.200605644285679, "policy_loss": -9.124932112172245e-05, "vf_loss": 9.983946615457535, "vf_explained_var": -1.0289251804351806e-06, "kl": 2.0759383189350445e-06, "entropy": 2.9528974786400797, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "env_runners": {"episode_reward_max": 533.7924516809292, "episode_reward_min": 423.1337149050425, "episode_reward_mean": 481.97124413996926, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.1337149050425}, "policy_reward_max": {"tplp_policy": 533.7924516809292}, "policy_reward_mean": {"tplp_policy": 481.97124413996926}, "custom_metrics": {"mean_episode_reward_mean": 481.97124413996926, "mean_episode_reward_min": 423.1337149050425, "mean_episode_reward_max": 533.7924516809292}, "hist_stats": {"episode_reward": [468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.45080185016405, 477.1921095729148, 489.1987329091967, 490.1123200818562, 492.74666803524735, 513.0720722478176, 507.72179542288904, 477.4587433230144, 460.9096002208011, 497.20436981122486, 498.611934082264, 454.7151256302962, 460.59318277433454, 490.9845674044254, 485.6135885155077, 504.41398488473254, 460.2859724668933, 502.66231821458734, 463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2973018158167546, "mean_inference_ms": 3.803239298718943, "mean_action_processing_ms": 0.7042277972803954, "mean_env_wait_ms": 3.879756914332935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006771087646484375, "StateBufferConnector_ms": 0.012962818145751953, "ViewRequirementAgentConnector_ms": 0.298673152923584}, "num_episodes": 22, "episode_return_max": 533.7924516809292, "episode_return_min": 423.1337149050425, "episode_return_mean": 481.97124413996926, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 303.02128248613957, "num_env_steps_trained_throughput_per_sec": 303.02128248613957, "timesteps_total": 82944, "num_env_steps_sampled_lifetime": 82944, "num_agent_steps_sampled_lifetime": 82944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 3216.614, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3216.614, "sample_time_ms": 1294.507, "learn_time_ms": 1894.446, "learn_throughput": 540.527, "synch_weights_time_ms": 27.452}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "training_iteration": 81, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-54", "timestamp": 1744127334, "time_this_iter_s": 3.38657808303833, "time_total_s": 353.6761226654053, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA0E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 353.6761226654053, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 56.975, "ram_util_percent": 93.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2282535007223485, "cur_kl_coeff": 8.271806125530276e-26, "cur_lr": 1e-07, "total_loss": 2.2026572950184344, "policy_loss": -0.00013449672260321677, "vf_loss": 9.993203175067901, "vf_explained_var": -4.510954022407532e-06, "kl": 1.6444011619931586e-06, "entropy": 2.9550899758934976, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "env_runners": {"episode_reward_max": 533.7924516809292, "episode_reward_min": 423.1337149050425, "episode_reward_mean": 479.9516993240746, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.1337149050425}, "policy_reward_max": {"tplp_policy": 533.7924516809292}, "policy_reward_mean": {"tplp_policy": 479.9516993240746}, "custom_metrics": {"mean_episode_reward_mean": 479.9516993240746, "mean_episode_reward_min": 423.1337149050425, "mean_episode_reward_max": 533.7924516809292}, "hist_stats": {"episode_reward": [463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.3669066709512, 480.6047513576567, 460.2283398391831, 458.73048300906436, 485.44900830139017, 509.1595004783674, 486.3417843167572, 473.33360563161744, 455.1074154170057, 483.65327453599275, 498.4584135912135, 486.81865666912597, 512.5711364989018, 448.70939439773036, 503.9741632564668, 491.48873626194114, 475.8931343390306, 475.6734733109255, 492.680678984593, 458.67367558897854, 458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2933670541878326, "mean_inference_ms": 3.792381371372355, "mean_action_processing_ms": 0.7022455587709256, "mean_env_wait_ms": 3.8680887509757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057680606842041016, "StateBufferConnector_ms": 0.01081991195678711, "ViewRequirementAgentConnector_ms": 0.3084712028503418}, "num_episodes": 18, "episode_return_max": 533.7924516809292, "episode_return_min": 423.1337149050425, "episode_return_mean": 479.9516993240746, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.7163769644183, "num_env_steps_trained_throughput_per_sec": 329.7163769644183, "timesteps_total": 83968, "num_env_steps_sampled_lifetime": 83968, "num_agent_steps_sampled_lifetime": 83968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 3202.6, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3202.6, "sample_time_ms": 1270.092, "learn_time_ms": 1903.974, "learn_throughput": 537.823, "synch_weights_time_ms": 28.324}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "training_iteration": 82, "trial_id": "f7884_00000", "date": "2025-04-08_23-48-57", "timestamp": 1744127337, "time_this_iter_s": 3.1142983436584473, "time_total_s": 356.7904210090637, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07EF20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 356.7904210090637, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 43.1, "ram_util_percent": 93.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9296409841626883, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 1e-07, "total_loss": 2.2043272346258163, "policy_loss": -3.3661985071375966e-05, "vf_loss": 10.0, "vf_explained_var": -4.040822386741638e-06, "kl": 9.667671467705751e-07, "entropy": 2.9563910201191903, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "env_runners": {"episode_reward_max": 533.7924516809292, "episode_reward_min": 423.1337149050425, "episode_reward_mean": 480.2492852006325, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.1337149050425}, "policy_reward_max": {"tplp_policy": 533.7924516809292}, "policy_reward_mean": {"tplp_policy": 480.2492852006325}, "custom_metrics": {"mean_episode_reward_mean": 480.2492852006325, "mean_episode_reward_min": 423.1337149050425, "mean_episode_reward_max": 533.7924516809292}, "hist_stats": {"episode_reward": [458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.21406891968996, 494.8165765474857, 423.1337149050425, 449.97976436371545, 473.1480672669737, 461.0997790267886, 506.66948928929685, 481.5166691242151, 533.7924516809292, 497.9142184635274, 527.3209523815021, 481.0006789917669, 461.77552974065617, 508.7050043913566, 469.535435237655, 491.0028776814807, 480.8411542155332, 486.5763589279966, 466.45492578498244, 502.94047413496605, 532.2741945562841, 467.20921381615824, 507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2888302002411747, "mean_inference_ms": 3.77852423507058, "mean_action_processing_ms": 0.6997242094071785, "mean_env_wait_ms": 3.8552380434532396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005262613296508789, "StateBufferConnector_ms": 0.009884357452392578, "ViewRequirementAgentConnector_ms": 0.3032097816467285}, "num_episodes": 20, "episode_return_max": 533.7924516809292, "episode_return_min": 423.1337149050425, "episode_return_mean": 480.2492852006325, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 346.95824327766314, "num_env_steps_trained_throughput_per_sec": 346.95824327766314, "timesteps_total": 84992, "num_env_steps_sampled_lifetime": 84992, "num_agent_steps_sampled_lifetime": 84992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 3174.231, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3174.231, "sample_time_ms": 1247.675, "learn_time_ms": 1898.212, "learn_throughput": 539.455, "synch_weights_time_ms": 28.135}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "training_iteration": 83, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-00", "timestamp": 1744127340, "time_this_iter_s": 2.962963342666626, "time_total_s": 359.75338435173035, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 359.75338435173035, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 46.775, "ram_util_percent": 93.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0674071308225392, "cur_kl_coeff": 2.067951531382569e-26, "cur_lr": 1e-07, "total_loss": 2.2025799356400966, "policy_loss": -0.00017516828374937178, "vf_loss": 9.993931531906128, "vf_explained_var": -3.854185342788696e-06, "kl": 1.0976703017723245e-06, "entropy": 2.9572777658700944, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "env_runners": {"episode_reward_max": 531.894914110604, "episode_reward_min": 448.42172310891556, "episode_reward_mean": 481.2247209258644, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 448.42172310891556}, "policy_reward_max": {"tplp_policy": 531.894914110604}, "policy_reward_mean": {"tplp_policy": 481.2247209258644}, "custom_metrics": {"mean_episode_reward_mean": 481.2247209258644, "mean_episode_reward_min": 448.42172310891556, "mean_episode_reward_max": 531.894914110604}, "hist_stats": {"episode_reward": [507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.6384013102016, 448.42172310891556, 456.6831518626389, 492.1288134312242, 468.02369110752215, 495.5821735731568, 489.840265761059, 500.1399717168029, 479.1750509960673, 489.5555770984815, 455.24196183193413, 506.07897919874944, 468.5361401658459, 483.2503926350826, 479.13926585989236, 457.42697399140434, 507.2926798021851, 488.38253089305175, 505.7884004905435, 477.0041930091172, 469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2842579692666445, "mean_inference_ms": 3.764235994100267, "mean_action_processing_ms": 0.6971392131250185, "mean_env_wait_ms": 3.842520311948403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0087738037109375, "StateBufferConnector_ms": 0.006787776947021484, "ViewRequirementAgentConnector_ms": 0.33232855796813965}, "num_episodes": 22, "episode_return_max": 531.894914110604, "episode_return_min": 448.42172310891556, "episode_return_mean": 481.2247209258644, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 316.1075344933354, "num_env_steps_trained_throughput_per_sec": 316.1075344933354, "timesteps_total": 86016, "num_env_steps_sampled_lifetime": 86016, "num_agent_steps_sampled_lifetime": 86016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 3177.88, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3177.88, "sample_time_ms": 1256.355, "learn_time_ms": 1893.306, "learn_throughput": 540.853, "synch_weights_time_ms": 28.009}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "training_iteration": 84, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-03", "timestamp": 1744127343, "time_this_iter_s": 3.247612237930298, "time_total_s": 363.00099658966064, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.00099658966064, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 47.04, "ram_util_percent": 93.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.355192582309246, "cur_kl_coeff": 1.0339757656912845e-26, "cur_lr": 1e-07, "total_loss": 2.204171224683523, "policy_loss": -1.5450583305209875e-05, "vf_loss": 10.0, "vf_explained_var": -4.26657497882843e-06, "kl": 7.973621768853078e-07, "entropy": 2.9581330478191377, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "env_runners": {"episode_reward_max": 531.894914110604, "episode_reward_min": 450.43397641967783, "episode_reward_mean": 480.7519784115952, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 450.43397641967783}, "policy_reward_max": {"tplp_policy": 531.894914110604}, "policy_reward_mean": {"tplp_policy": 480.7519784115952}, "custom_metrics": {"mean_episode_reward_mean": 480.7519784115952, "mean_episode_reward_min": 450.43397641967783, "mean_episode_reward_max": 531.894914110604}, "hist_stats": {"episode_reward": [469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.8484886020461, 463.60622469681397, 452.54265332428395, 465.2465743179376, 497.0418683195577, 456.07691483080794, 468.10392096255913, 503.3691376517674, 476.90320769253134, 466.5758525290736, 501.37468499122593, 475.377615076126, 494.63618462846574, 484.8841826338576, 457.41934768034236, 499.48016752715586, 500.52548058952243, 475.8035902933891, 472.3533538313723, 471.8386066211526, 466.3872609807759, 474.0200971234573, 473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2801552414759165, "mean_inference_ms": 3.751631128532218, "mean_action_processing_ms": 0.694907603362232, "mean_env_wait_ms": 3.8313464834208832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062580108642578125, "StateBufferConnector_ms": 0.008539199829101562, "ViewRequirementAgentConnector_ms": 0.3296380043029785}, "num_episodes": 20, "episode_return_max": 531.894914110604, "episode_return_min": 450.43397641967783, "episode_return_mean": 480.7519784115952, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 338.9356358299441, "num_env_steps_trained_throughput_per_sec": 338.9356358299441, "timesteps_total": 87040, "num_env_steps_sampled_lifetime": 87040, "num_agent_steps_sampled_lifetime": 87040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 3147.989, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3147.989, "sample_time_ms": 1242.441, "learn_time_ms": 1877.674, "learn_throughput": 545.356, "synch_weights_time_ms": 27.665}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "training_iteration": 85, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-06", "timestamp": 1744127346, "time_this_iter_s": 3.028712272644043, "time_total_s": 366.0297088623047, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E5C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 366.0297088623047, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 48.625, "ram_util_percent": 93.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1237322203814983, "cur_kl_coeff": 5.1698788284564225e-27, "cur_lr": 1e-07, "total_loss": 2.201579100638628, "policy_loss": -8.747898391447961e-05, "vf_loss": 9.990435713529587, "vf_explained_var": -3.2041221857070924e-06, "kl": 1.0429277822687767e-06, "entropy": 2.9594233229756357, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "env_runners": {"episode_reward_max": 531.894914110604, "episode_reward_min": 419.77897911337124, "episode_reward_mean": 479.1939481564646, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.77897911337124}, "policy_reward_max": {"tplp_policy": 531.894914110604}, "policy_reward_mean": {"tplp_policy": 479.1939481564646}, "custom_metrics": {"mean_episode_reward_mean": 479.1939481564646, "mean_episode_reward_min": 419.77897911337124, "mean_episode_reward_max": 531.894914110604}, "hist_stats": {"episode_reward": [473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.4707641417564, 462.36370951803616, 478.7390258155394, 507.0823193610776, 460.64582531188995, 485.98758949282654, 459.05705769429795, 465.5213977006896, 456.095877933702, 484.281220233602, 486.6251222137961, 451.43647829712944, 510.25276412038437, 482.4142396696897, 465.9613056738221, 459.65135057621706, 462.90096941604, 462.75564180591374, 465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.275883683023579, "mean_inference_ms": 3.737962890154729, "mean_action_processing_ms": 0.6924496406494837, "mean_env_wait_ms": 3.819922663186814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071790218353271484, "StateBufferConnector_ms": 0.01352238655090332, "ViewRequirementAgentConnector_ms": 0.32047200202941895}, "num_episodes": 22, "episode_return_max": 531.894914110604, "episode_return_min": 419.77897911337124, "episode_return_mean": 479.1939481564646, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 312.5093759711421, "num_env_steps_trained_throughput_per_sec": 312.5093759711421, "timesteps_total": 88064, "num_env_steps_sampled_lifetime": 88064, "num_agent_steps_sampled_lifetime": 88064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 3133.228, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3133.228, "sample_time_ms": 1251.731, "learn_time_ms": 1853.548, "learn_throughput": 552.454, "synch_weights_time_ms": 27.839}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "done": false, "training_iteration": 86, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-10", "timestamp": 1744127350, "time_this_iter_s": 3.284543037414551, "time_total_s": 369.31425189971924, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F6A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 369.31425189971924, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 51.225, "ram_util_percent": 93.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0524954237043858, "cur_kl_coeff": 2.5849394142282113e-27, "cur_lr": 1e-07, "total_loss": 2.203880360722542, "policy_loss": -1.9942258950322868e-05, "vf_loss": 9.999925220012665, "vf_explained_var": -4.487484693527221e-06, "kl": 9.455793692048076e-07, "entropy": 2.960809995234013, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "env_runners": {"episode_reward_max": 531.894914110604, "episode_reward_min": 419.77897911337124, "episode_reward_mean": 480.16677302421124, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.77897911337124}, "policy_reward_max": {"tplp_policy": 531.894914110604}, "policy_reward_mean": {"tplp_policy": 480.16677302421124}, "custom_metrics": {"mean_episode_reward_mean": 480.16677302421124, "mean_episode_reward_min": 419.77897911337124, "mean_episode_reward_max": 531.894914110604}, "hist_stats": {"episode_reward": [465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.4549974217087, 483.0959881299774, 476.1698252731715, 466.16624333079676, 488.9250384275626, 484.12085281718646, 508.57986095529964, 482.19147146034936, 494.8099676918276, 465.0306697991869, 478.90433661961714, 490.2166084661121, 531.894914110604, 471.8897577017276, 469.82488733412765, 486.06975579221427, 463.6284775896791, 498.0448559695858, 508.7362744559083, 474.9915501180741, 514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2725990160009264, "mean_inference_ms": 3.727444683749797, "mean_action_processing_ms": 0.6903971233438594, "mean_env_wait_ms": 3.8112426261896637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009862184524536133, "StateBufferConnector_ms": 0.012525081634521484, "ViewRequirementAgentConnector_ms": 0.3188638687133789}, "num_episodes": 18, "episode_return_max": 531.894914110604, "episode_return_min": 419.77897911337124, "episode_return_mean": 480.16677302421124, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.59691815505766, "num_env_steps_trained_throughput_per_sec": 317.59691815505766, "timesteps_total": 89088, "num_env_steps_sampled_lifetime": 89088, "num_agent_steps_sampled_lifetime": 89088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 3143.762, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3143.762, "sample_time_ms": 1256.284, "learn_time_ms": 1861.611, "learn_throughput": 550.061, "synch_weights_time_ms": 25.637}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "done": false, "training_iteration": 87, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-13", "timestamp": 1744127353, "time_this_iter_s": 3.235410451889038, "time_total_s": 372.5496623516083, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.5496623516083, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 44.580000000000005, "ram_util_percent": 93.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0303246453404427, "cur_kl_coeff": 1.2924697071141056e-27, "cur_lr": 1e-07, "total_loss": 2.2022796742618085, "policy_loss": -9.328898740932346e-05, "vf_loss": 9.994726741313935, "vf_explained_var": -4.217773675918579e-06, "kl": 2.093323851415363e-06, "entropy": 2.9630871534347536, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "env_runners": {"episode_reward_max": 533.3480100623863, "episode_reward_min": 419.77897911337124, "episode_reward_mean": 479.5778991299565, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.77897911337124}, "policy_reward_max": {"tplp_policy": 533.3480100623863}, "policy_reward_mean": {"tplp_policy": 479.5778991299565}, "custom_metrics": {"mean_episode_reward_mean": 479.5778991299565, "mean_episode_reward_min": 419.77897911337124, "mean_episode_reward_max": 533.3480100623863}, "hist_stats": {"episode_reward": [514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [514.8231383624271, 463.32785073414675, 459.69132808573636, 499.7006372114104, 484.54712498278326, 458.0997938971885, 510.7278993015861, 501.3423647499068, 506.29291880239896, 492.0159560214759, 455.7974937293723, 490.2676338863922, 509.44358148220095, 470.97439064795486, 472.12347021235735, 507.22397603583556, 510.774917628846, 521.499512609146, 483.3140217348901, 457.74933728116196, 503.97204074707275, 467.0712619241134, 493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2691520401538277, "mean_inference_ms": 3.716122358004552, "mean_action_processing_ms": 0.688212572550045, "mean_env_wait_ms": 3.8019737971740697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012741804122924805, "StateBufferConnector_ms": 0.010833263397216797, "ViewRequirementAgentConnector_ms": 0.3262302875518799}, "num_episodes": 20, "episode_return_max": 533.3480100623863, "episode_return_min": 419.77897911337124, "episode_return_mean": 479.5778991299565, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 335.23438533468357, "num_env_steps_trained_throughput_per_sec": 335.23438533468357, "timesteps_total": 90112, "num_env_steps_sampled_lifetime": 90112, "num_agent_steps_sampled_lifetime": 90112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 3138.254, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3138.254, "sample_time_ms": 1243.896, "learn_time_ms": 1868.276, "learn_throughput": 548.099, "synch_weights_time_ms": 25.852}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "training_iteration": 88, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-16", "timestamp": 1744127356, "time_this_iter_s": 3.0633623600006104, "time_total_s": 375.6130247116089, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 375.6130247116089, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 52.3, "ram_util_percent": 93.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.206848078221083, "cur_kl_coeff": 6.462348535570528e-28, "cur_lr": 1e-07, "total_loss": 2.202169658243656, "policy_loss": -2.692361013032496e-05, "vf_loss": 9.994912558794022, "vf_explained_var": -4.671886563301086e-06, "kl": 6.865150699031375e-07, "entropy": 2.965315356850624, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "env_runners": {"episode_reward_max": 533.3480100623863, "episode_reward_min": 419.77897911337124, "episode_reward_mean": 478.1844500600971, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.77897911337124}, "policy_reward_max": {"tplp_policy": 533.3480100623863}, "policy_reward_mean": {"tplp_policy": 478.1844500600971}, "custom_metrics": {"mean_episode_reward_mean": 478.1844500600971, "mean_episode_reward_min": 419.77897911337124, "mean_episode_reward_max": 533.3480100623863}, "hist_stats": {"episode_reward": [493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [493.9529298369599, 476.0238461065025, 483.97517976788737, 491.69193211992746, 464.0326835198652, 479.3641238988941, 499.660279090626, 470.1495564375842, 450.43397641967783, 487.7009394780361, 454.3322041599351, 464.45830304646074, 512.2696559231645, 494.45679057961786, 513.0446274028335, 455.8455367462449, 469.51455560139823, 476.1056636101462, 446.73445770786975, 419.77897911337124, 470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2654516912740383, "mean_inference_ms": 3.7036227784797933, "mean_action_processing_ms": 0.6857193451425215, "mean_env_wait_ms": 3.790965928637105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014943122863769531, "StateBufferConnector_ms": 0.01247859001159668, "ViewRequirementAgentConnector_ms": 0.3002042770385742}, "num_episodes": 22, "episode_return_max": 533.3480100623863, "episode_return_min": 419.77897911337124, "episode_return_mean": 478.1844500600971, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 332.3275451415664, "num_env_steps_trained_throughput_per_sec": 332.3275451415664, "timesteps_total": 91136, "num_env_steps_sampled_lifetime": 91136, "num_agent_steps_sampled_lifetime": 91136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 3139.407, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3139.407, "sample_time_ms": 1248.563, "learn_time_ms": 1864.795, "learn_throughput": 549.122, "synch_weights_time_ms": 25.928}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "done": false, "training_iteration": 89, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-19", "timestamp": 1744127359, "time_this_iter_s": 3.093076705932617, "time_total_s": 378.7061014175415, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 378.7061014175415, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 43.519999999999996, "ram_util_percent": 93.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.240873408317566, "cur_kl_coeff": 3.231174267785264e-28, "cur_lr": 1e-07, "total_loss": 2.200648985058069, "policy_loss": -2.5279610417783262e-05, "vf_loss": 9.98951240181923, "vf_explained_var": -4.782527685165405e-06, "kl": 1.0953423013493335e-06, "entropy": 2.9670383289456366, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "env_runners": {"episode_reward_max": 533.3480100623863, "episode_reward_min": 430.5832755502648, "episode_reward_mean": 479.62172219069856, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.5832755502648}, "policy_reward_max": {"tplp_policy": 533.3480100623863}, "policy_reward_mean": {"tplp_policy": 479.62172219069856}, "custom_metrics": {"mean_episode_reward_mean": 479.62172219069856, "mean_episode_reward_min": 430.5832755502648, "mean_episode_reward_max": 533.3480100623863}, "hist_stats": {"episode_reward": [470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.35502297626635, 489.2325928070936, 453.1698880822807, 481.1552581276594, 482.7265183674603, 465.3018145714249, 504.12883641536206, 497.2708174856024, 434.7685905409699, 474.8520205432802, 479.34438343670155, 494.2557295099242, 506.3101554048423, 469.64381670236884, 455.124496959628, 459.4795063029258, 446.68376269195886, 474.14559804958003, 451.143967628267, 482.00617596633145, 488.25170879833144, 505.62906398704695, 472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2619825644708604, "mean_inference_ms": 3.6927008977174034, "mean_action_processing_ms": 0.6835711168060763, "mean_env_wait_ms": 3.7812899919642793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228475570678711, "StateBufferConnector_ms": 0.0036499500274658203, "ViewRequirementAgentConnector_ms": 0.3033432960510254}, "num_episodes": 20, "episode_return_max": 533.3480100623863, "episode_return_min": 430.5832755502648, "episode_return_mean": 479.62172219069856, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.2035687172723, "num_env_steps_trained_throughput_per_sec": 327.2035687172723, "timesteps_total": 92160, "num_env_steps_sampled_lifetime": 92160, "num_agent_steps_sampled_lifetime": 92160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 3146.333, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3146.333, "sample_time_ms": 1255.305, "learn_time_ms": 1865.385, "learn_throughput": 548.948, "synch_weights_time_ms": 25.523}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "training_iteration": 90, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-22", "timestamp": 1744127362, "time_this_iter_s": 3.1373391151428223, "time_total_s": 381.8434405326843, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.8434405326843, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 48.20000000000001, "ram_util_percent": 93.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1777953121811153, "cur_kl_coeff": 1.615587133892632e-28, "cur_lr": 1e-07, "total_loss": 2.1976003497838974, "policy_loss": -0.00010003848583437503, "vf_loss": 9.978232502937317, "vf_explained_var": -4.352629184722901e-06, "kl": 1.0687237955053774e-06, "entropy": 2.9685773506760595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "env_runners": {"episode_reward_max": 533.3480100623863, "episode_reward_min": 418.2111905847743, "episode_reward_mean": 481.071773995359, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2111905847743}, "policy_reward_max": {"tplp_policy": 533.3480100623863}, "policy_reward_mean": {"tplp_policy": 481.071773995359}, "custom_metrics": {"mean_episode_reward_mean": 481.071773995359, "mean_episode_reward_min": 418.2111905847743, "mean_episode_reward_max": 533.3480100623863}, "hist_stats": {"episode_reward": [472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [472.1562967662743, 494.6836895789521, 447.4369418047683, 515.2829781271847, 488.60495400861583, 487.3132119741913, 474.9871364383414, 479.90014204177606, 473.2084288812939, 499.39356412592997, 485.68096564807126, 442.6792395417176, 498.8822429498598, 430.5832755502648, 462.16042940957163, 465.69087611887363, 497.25733628556367, 478.61805280745136, 488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2580927523411702, "mean_inference_ms": 3.6803577770129703, "mean_action_processing_ms": 0.6813645490306375, "mean_env_wait_ms": 3.770275849970622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013799428939819336, "StateBufferConnector_ms": 0.004069805145263672, "ViewRequirementAgentConnector_ms": 0.29537153244018555}, "num_episodes": 22, "episode_return_max": 533.3480100623863, "episode_return_min": 418.2111905847743, "episode_return_mean": 481.071773995359, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 313.23197443832595, "num_env_steps_trained_throughput_per_sec": 313.23197443832595, "timesteps_total": 93184, "num_env_steps_sampled_lifetime": 93184, "num_agent_steps_sampled_lifetime": 93184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 3135.317, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3135.317, "sample_time_ms": 1242.021, "learn_time_ms": 1868.082, "learn_throughput": 548.156, "synch_weights_time_ms": 25.094}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "done": false, "training_iteration": 91, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-26", "timestamp": 1744127366, "time_this_iter_s": 3.27766489982605, "time_total_s": 385.1211054325104, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC057A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 385.1211054325104, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 49.675000000000004, "ram_util_percent": 93.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9367206070572136, "cur_kl_coeff": 8.07793566946316e-29, "cur_lr": 1e-07, "total_loss": 2.2004235610365868, "policy_loss": -2.9322935733944178e-05, "vf_loss": 9.989517563581467, "vf_explained_var": -4.941597580909729e-06, "kl": 4.338035219264569e-07, "entropy": 2.9692650347948075, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "env_runners": {"episode_reward_max": 533.3480100623863, "episode_reward_min": 418.2111905847743, "episode_reward_mean": 482.31361370073466, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2111905847743}, "policy_reward_max": {"tplp_policy": 533.3480100623863}, "policy_reward_mean": {"tplp_policy": 482.31361370073466}, "custom_metrics": {"mean_episode_reward_mean": 482.31361370073466, "mean_episode_reward_min": 418.2111905847743, "mean_episode_reward_max": 533.3480100623863}, "hist_stats": {"episode_reward": [488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [488.4513950034022, 482.59255775193907, 496.73601513576904, 488.29640973749406, 533.3480100623863, 501.46047667868925, 455.7959534052722, 464.68669432451276, 453.1209160978806, 471.1101414732271, 442.85351829775607, 497.89606207733635, 500.5427956363657, 460.9531626890161, 492.38819182600025, 446.5031822917945, 484.46075074138594, 492.7873217159995, 484.2041936960383, 478.1710848830012, 487.05225082654874, 501.5705274445124, 479.39512862602317, 491.0153010263919, 470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2548831388107435, "mean_inference_ms": 3.670503168559414, "mean_action_processing_ms": 0.6796170160595986, "mean_env_wait_ms": 3.761558577793229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013634920120239258, "StateBufferConnector_ms": 0.0051648616790771484, "ViewRequirementAgentConnector_ms": 0.2916562557220459}, "num_episodes": 18, "episode_return_max": 533.3480100623863, "episode_return_min": 418.2111905847743, "episode_return_mean": 482.31361370073466, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 321.1902043046994, "num_env_steps_trained_throughput_per_sec": 321.1902043046994, "timesteps_total": 94208, "num_env_steps_sampled_lifetime": 94208, "num_agent_steps_sampled_lifetime": 94208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 3143.562, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3143.562, "sample_time_ms": 1247.466, "learn_time_ms": 1871.552, "learn_throughput": 547.14, "synch_weights_time_ms": 24.423}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "training_iteration": 92, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-29", "timestamp": 1744127369, "time_this_iter_s": 3.1957061290740967, "time_total_s": 388.3168115615845, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0572E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 388.3168115615845, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 44.86, "ram_util_percent": 93.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.042366302758455, "cur_kl_coeff": 4.03896783473158e-29, "cur_lr": 1e-07, "total_loss": 2.200530356168747, "policy_loss": -2.2756808903068304e-05, "vf_loss": 9.990428936481475, "vf_explained_var": -1.6644597053527832e-06, "kl": 1.1703779306593275e-06, "entropy": 2.970541055500507, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "env_runners": {"episode_reward_max": 522.3405631917648, "episode_reward_min": 418.2111905847743, "episode_reward_mean": 480.84109835343156, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2111905847743}, "policy_reward_max": {"tplp_policy": 522.3405631917648}, "policy_reward_mean": {"tplp_policy": 480.84109835343156}, "custom_metrics": {"mean_episode_reward_mean": 480.84109835343156, "mean_episode_reward_min": 418.2111905847743, "mean_episode_reward_max": 522.3405631917648}, "hist_stats": {"episode_reward": [470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.1976426358742, 448.62686322772987, 476.0000095074802, 484.1966528125632, 445.1586712054126, 470.96114671294185, 514.9887632772264, 500.79111115982005, 493.31376600940155, 479.14107078564996, 478.83292408650794, 461.8345265997052, 514.6181199301702, 490.0774389834917, 508.98305050540495, 442.3054991405797, 475.77735164002047, 469.8333323915991, 467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.251060022173794, "mean_inference_ms": 3.657628109926802, "mean_action_processing_ms": 0.6773920867413117, "mean_env_wait_ms": 3.7511453441624316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009650707244873047, "StateBufferConnector_ms": 0.00889897346496582, "ViewRequirementAgentConnector_ms": 0.2958354949951172}, "num_episodes": 24, "episode_return_max": 522.3405631917648, "episode_return_min": 418.2111905847743, "episode_return_mean": 480.84109835343156, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 300.5663774582598, "num_env_steps_trained_throughput_per_sec": 300.5663774582598, "timesteps_total": 95232, "num_env_steps_sampled_lifetime": 95232, "num_agent_steps_sampled_lifetime": 95232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 3189.115, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3189.115, "sample_time_ms": 1259.981, "learn_time_ms": 1904.583, "learn_throughput": 537.65, "synch_weights_time_ms": 24.43}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "done": false, "training_iteration": 93, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-33", "timestamp": 1744127373, "time_this_iter_s": 3.4154300689697266, "time_total_s": 391.7322416305542, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 391.7322416305542, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 51.839999999999996, "ram_util_percent": 92.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3560952547937632, "cur_kl_coeff": 2.01948391736579e-29, "cur_lr": 1e-07, "total_loss": 2.2021408684551718, "policy_loss": -0.00012798444367945194, "vf_loss": 9.998352128267289, "vf_explained_var": -4.819035530090332e-06, "kl": 2.5319860728068022e-06, "entropy": 2.9731917276978495, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "env_runners": {"episode_reward_max": 522.3405631917648, "episode_reward_min": 418.2111905847743, "episode_reward_mean": 479.7785768265075, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2111905847743}, "policy_reward_max": {"tplp_policy": 522.3405631917648}, "policy_reward_mean": {"tplp_policy": 479.7785768265075}, "custom_metrics": {"mean_episode_reward_mean": 479.7785768265075, "mean_episode_reward_min": 418.2111905847743, "mean_episode_reward_max": 522.3405631917648}, "hist_stats": {"episode_reward": [467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.92000072380847, 430.73439252565015, 490.45905397321786, 473.627884294771, 495.24571492149676, 474.1533326670716, 494.30894483487253, 475.45097522327995, 484.2228665118301, 493.67003548747834, 464.23823609326536, 495.2027621618979, 475.47571470927414, 518.6150358850513, 494.1949138412324, 522.3405631917648, 446.3328869600305, 505.44943558953673, 471.90598114900894, 418.2111905847743, 487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2478489292183843, "mean_inference_ms": 3.649502376519603, "mean_action_processing_ms": 0.6758740895298321, "mean_env_wait_ms": 3.743108078474519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007045269012451172, "StateBufferConnector_ms": 0.008371591567993164, "ViewRequirementAgentConnector_ms": 0.2883880138397217}, "num_episodes": 18, "episode_return_max": 522.3405631917648, "episode_return_min": 418.2111905847743, "episode_return_mean": 479.7785768265075, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 332.5363211400872, "num_env_steps_trained_throughput_per_sec": 332.5363211400872, "timesteps_total": 96256, "num_env_steps_sampled_lifetime": 96256, "num_agent_steps_sampled_lifetime": 96256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 3173.111, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3173.111, "sample_time_ms": 1248.003, "learn_time_ms": 1900.369, "learn_throughput": 538.843, "synch_weights_time_ms": 24.618}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "done": false, "training_iteration": 94, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-36", "timestamp": 1744127376, "time_this_iter_s": 3.0879695415496826, "time_total_s": 394.8202111721039, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 394.8202111721039, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 51.400000000000006, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.51708876080811, "cur_kl_coeff": 1.009741958682895e-29, "cur_lr": 1e-07, "total_loss": 2.1999527625739574, "policy_loss": -0.0001479114405810833, "vf_loss": 9.9904281437397, "vf_explained_var": -5.709379911422729e-06, "kl": 1.2444861783311723e-06, "entropy": 2.975063569843769, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "env_runners": {"episode_reward_max": 521.4351443325377, "episode_reward_min": 429.939147465014, "episode_reward_mean": 480.78141705186994, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.939147465014}, "policy_reward_max": {"tplp_policy": 521.4351443325377}, "policy_reward_mean": {"tplp_policy": 480.78141705186994}, "custom_metrics": {"mean_episode_reward_mean": 480.78141705186994, "mean_episode_reward_min": 429.939147465014, "mean_episode_reward_max": 521.4351443325377}, "hist_stats": {"episode_reward": [487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.8390811741168, 494.7023338336145, 477.99629320407206, 475.66155824264155, 493.0962762336168, 480.1977228538335, 462.35621436023115, 511.1791987618173, 497.615737544166, 496.2060317606249, 489.91490838678834, 469.715314669086, 484.72083892126176, 497.1455804107096, 465.81863582369374, 472.29902094834387, 489.08153202507197, 475.19893577458436, 510.02673307712536, 489.0957860821707, 471.2725871445726, 455.1464196707909, 481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2445900369347949, "mean_inference_ms": 3.6394673822098933, "mean_action_processing_ms": 0.6741660965275968, "mean_env_wait_ms": 3.7344383232675176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011507034301757812, "StateBufferConnector_ms": 0.010396242141723633, "ViewRequirementAgentConnector_ms": 0.28717517852783203}, "num_episodes": 20, "episode_return_max": 521.4351443325377, "episode_return_min": 429.939147465014, "episode_return_mean": 480.78141705186994, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.84661143780215, "num_env_steps_trained_throughput_per_sec": 322.84661143780215, "timesteps_total": 97280, "num_env_steps_sampled_lifetime": 97280, "num_agent_steps_sampled_lifetime": 97280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 3188.168, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3188.168, "sample_time_ms": 1255.16, "learn_time_ms": 1908.232, "learn_throughput": 536.622, "synch_weights_time_ms": 24.655}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "training_iteration": 95, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-39", "timestamp": 1744127379, "time_this_iter_s": 3.1796677112579346, "time_total_s": 397.9998788833618, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.9998788833618, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 46.75, "ram_util_percent": 92.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1713725866749884, "cur_kl_coeff": 5.048709793414475e-30, "cur_lr": 1e-07, "total_loss": 2.195418394356966, "policy_loss": -8.549503982067109e-05, "vf_loss": 9.972185111045837, "vf_explained_var": -5.036592483520508e-06, "kl": 6.030715744675952e-07, "entropy": 2.9754241302609445, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "env_runners": {"episode_reward_max": 521.4351443325377, "episode_reward_min": 429.939147465014, "episode_reward_mean": 479.9953667707464, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.939147465014}, "policy_reward_max": {"tplp_policy": 521.4351443325377}, "policy_reward_mean": {"tplp_policy": 479.9953667707464}, "custom_metrics": {"mean_episode_reward_mean": 479.9953667707464, "mean_episode_reward_min": 429.939147465014, "mean_episode_reward_max": 521.4351443325377}, "hist_stats": {"episode_reward": [481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.6120083631038, 509.9241719711494, 514.6569599004782, 494.4146669146755, 481.66018746229275, 466.9684764365274, 480.6594216742548, 482.29081029142, 439.00718561230616, 498.7807223785726, 473.00780928955845, 491.1416236361902, 518.3170277309475, 482.5229712346686, 488.0214493314694, 489.29923355328424, 485.6357977444744, 484.8910018890307, 470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2411396117993403, "mean_inference_ms": 3.628551866336356, "mean_action_processing_ms": 0.6720622984385055, "mean_env_wait_ms": 3.725022854455091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010162591934204102, "StateBufferConnector_ms": 0.012498140335083008, "ViewRequirementAgentConnector_ms": 0.2977292537689209}, "num_episodes": 22, "episode_return_max": 521.4351443325377, "episode_return_min": 429.939147465014, "episode_return_mean": 479.9953667707464, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.15892333311604, "num_env_steps_trained_throughput_per_sec": 318.15892333311604, "timesteps_total": 98304, "num_env_steps_sampled_lifetime": 98304, "num_agent_steps_sampled_lifetime": 98304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 3182.349, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3182.349, "sample_time_ms": 1243.455, "learn_time_ms": 1913.864, "learn_throughput": 535.043, "synch_weights_time_ms": 24.909}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "training_iteration": 96, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-42", "timestamp": 1744127382, "time_this_iter_s": 3.2271881103515625, "time_total_s": 401.2270669937134, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144FE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.2270669937134, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 45.459999999999994, "ram_util_percent": 92.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4853214882314205, "cur_kl_coeff": 2.5243548967072376e-30, "cur_lr": 1e-07, "total_loss": 2.199850384145975, "policy_loss": -0.0002560999593697488, "vf_loss": 9.991261917352677, "vf_explained_var": -4.691630601882935e-06, "kl": 3.060613135563717e-06, "entropy": 2.9770899280905723, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "env_runners": {"episode_reward_max": 521.4351443325377, "episode_reward_min": 429.939147465014, "episode_reward_mean": 479.3555503706673, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.939147465014}, "policy_reward_max": {"tplp_policy": 521.4351443325377}, "policy_reward_mean": {"tplp_policy": 479.3555503706673}, "custom_metrics": {"mean_episode_reward_mean": 479.3555503706673, "mean_episode_reward_min": 429.939147465014, "mean_episode_reward_max": 521.4351443325377}, "hist_stats": {"episode_reward": [470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.1119868809875, 481.25121562110365, 463.7109296719923, 475.70658768724223, 483.9118968891715, 458.56979328913764, 472.6745270167242, 476.24488846479676, 480.30872605986764, 499.5697088781419, 496.61632442383, 483.56164705584536, 477.7601858737664, 479.1479532561622, 492.65489700242625, 435.21721908159486, 429.939147465014, 463.09880599758566, 488.6996599910098, 487.10081845486445, 468.49399723798535, 493.2627907856784, 465.9294742208538, 476.4742480100466, 517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.238292827466918, "mean_inference_ms": 3.6197739088477174, "mean_action_processing_ms": 0.6705200014580595, "mean_env_wait_ms": 3.717470901229732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00867319107055664, "StateBufferConnector_ms": 0.012392044067382812, "ViewRequirementAgentConnector_ms": 0.29642653465270996}, "num_episodes": 18, "episode_return_max": 521.4351443325377, "episode_return_min": 429.939147465014, "episode_return_mean": 479.3555503706673, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.12798662725027, "num_env_steps_trained_throughput_per_sec": 328.12798662725027, "timesteps_total": 99328, "num_env_steps_sampled_lifetime": 99328, "num_agent_steps_sampled_lifetime": 99328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 3172.001, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3172.001, "sample_time_ms": 1241.962, "learn_time_ms": 1905.268, "learn_throughput": 537.457, "synch_weights_time_ms": 24.772}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "done": false, "training_iteration": 97, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-45", "timestamp": 1744127385, "time_this_iter_s": 3.1285359859466553, "time_total_s": 404.35560297966003, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 404.35560297966003, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 49.175000000000004, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3950048718601464, "cur_kl_coeff": 1.2621774483536188e-30, "cur_lr": 1e-07, "total_loss": 2.199575028568506, "policy_loss": -6.123489583842456e-05, "vf_loss": 9.990493023395539, "vf_explained_var": -3.7498772144317628e-06, "kl": 1.7792996748866586e-06, "entropy": 2.979869915544987, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "env_runners": {"episode_reward_max": 524.3876486895003, "episode_reward_min": 430.43136104690814, "episode_reward_mean": 482.6954985936256, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.43136104690814}, "policy_reward_max": {"tplp_policy": 524.3876486895003}, "policy_reward_mean": {"tplp_policy": 482.6954985936256}, "custom_metrics": {"mean_episode_reward_mean": 482.6954985936256, "mean_episode_reward_min": 430.43136104690814, "mean_episode_reward_max": 524.3876486895003}, "hist_stats": {"episode_reward": [517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [517.6277597240089, 475.74344650065717, 464.05292941539017, 487.99571049573217, 478.8421806080209, 430.43136104690814, 443.2997980451133, 480.0217086874169, 478.760045909776, 457.8672349139958, 483.1509248287201, 501.5225074016308, 474.3813311352433, 454.02240988032094, 484.9755577715276, 464.287159323807, 472.8385589129726, 478.95565934473973, 521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2343918784924515, "mean_inference_ms": 3.6077938872245316, "mean_action_processing_ms": 0.6684524554294486, "mean_env_wait_ms": 3.7071117110379905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008665323257446289, "StateBufferConnector_ms": 0.013239145278930664, "ViewRequirementAgentConnector_ms": 0.2883002758026123}, "num_episodes": 24, "episode_return_max": 524.3876486895003, "episode_return_min": 430.43136104690814, "episode_return_mean": 482.6954985936256, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 339.2507939476882, "num_env_steps_trained_throughput_per_sec": 339.2507939476882, "timesteps_total": 100352, "num_env_steps_sampled_lifetime": 100352, "num_agent_steps_sampled_lifetime": 100352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 3168.385, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3168.385, "sample_time_ms": 1242.584, "learn_time_ms": 1901.308, "learn_throughput": 538.577, "synch_weights_time_ms": 24.493}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "done": false, "training_iteration": 98, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-49", "timestamp": 1744127389, "time_this_iter_s": 3.0274887084960938, "time_total_s": 407.3830916881561, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 407.3830916881561, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 40.199999999999996, "ram_util_percent": 92.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5101647190749645, "cur_kl_coeff": 6.310887241768094e-31, "cur_lr": 1e-07, "total_loss": 2.198479487001896, "policy_loss": -0.00015311440220102667, "vf_loss": 9.987564527988434, "vf_explained_var": -4.583597183227539e-06, "kl": 2.6964504046878e-06, "entropy": 2.9825852170586584, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "env_runners": {"episode_reward_max": 524.3876486895003, "episode_reward_min": 438.12327827835514, "episode_reward_mean": 485.0584665710945, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.12327827835514}, "policy_reward_max": {"tplp_policy": 524.3876486895003}, "policy_reward_mean": {"tplp_policy": 485.0584665710945}, "custom_metrics": {"mean_episode_reward_mean": 485.0584665710945, "mean_episode_reward_min": 438.12327827835514, "mean_episode_reward_max": 524.3876486895003}, "hist_stats": {"episode_reward": [521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [521.4351443325377, 458.89049699742577, 492.6451093382907, 485.1290824748554, 438.12327827835514, 482.0055378430823, 505.89390496550993, 484.76647719968645, 484.2782146155964, 498.8623002767105, 494.1209057244641, 494.5288079727923, 473.2358986337226, 476.3631329726131, 483.6693713761159, 488.22996401916134, 474.6197652038403, 503.45233338308566, 443.3544449213991, 480.25194104358843, 471.0949482996053, 483.864241898228, 470.90794283553504, 514.0575125928988, 497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2315920266293636, "mean_inference_ms": 3.5992030458682507, "mean_action_processing_ms": 0.6669530364367892, "mean_env_wait_ms": 3.699477389691403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009667158126831055, "StateBufferConnector_ms": 0.014249086380004883, "ViewRequirementAgentConnector_ms": 0.2919905185699463}, "num_episodes": 18, "episode_return_max": 524.3876486895003, "episode_return_min": 438.12327827835514, "episode_return_mean": 485.0584665710945, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 320.4812983747632, "num_env_steps_trained_throughput_per_sec": 320.4812983747632, "timesteps_total": 101376, "num_env_steps_sampled_lifetime": 101376, "num_agent_steps_sampled_lifetime": 101376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 101376, "timers": {"training_iteration_time_ms": 3179.774, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3179.774, "sample_time_ms": 1247.662, "learn_time_ms": 1907.363, "learn_throughput": 536.867, "synch_weights_time_ms": 24.595}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "done": false, "training_iteration": 99, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-52", "timestamp": 1744127392, "time_this_iter_s": 3.2038042545318604, "time_total_s": 410.586895942688, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07EAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 410.586895942688, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 51.675000000000004, "ram_util_percent": 92.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081844583898783, "cur_kl_coeff": 3.155443620884047e-31, "cur_lr": 1e-07, "total_loss": 2.2009476989507677, "policy_loss": -2.5023595662787555e-05, "vf_loss": 9.997974240779877, "vf_explained_var": -5.431473255157471e-06, "kl": 1.3127537722201764e-06, "entropy": 2.985208220779896, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "env_runners": {"episode_reward_max": 524.3876486895003, "episode_reward_min": 444.14396975373506, "episode_reward_mean": 484.18436771353504, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.14396975373506}, "policy_reward_max": {"tplp_policy": 524.3876486895003}, "policy_reward_mean": {"tplp_policy": 484.18436771353504}, "custom_metrics": {"mean_episode_reward_mean": 484.18436771353504, "mean_episode_reward_min": 444.14396975373506, "mean_episode_reward_max": 524.3876486895003}, "hist_stats": {"episode_reward": [497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.80197705174305, 474.4718705441765, 488.39609855685603, 475.3901339017568, 505.1290185450584, 518.7231751590015, 468.30345104418615, 450.48897024385053, 492.88014674783517, 490.3571044772807, 452.6611226269971, 456.49822747593834, 460.6383013602477, 500.043724862064, 493.16099919744175, 479.2063594048961, 486.4467599259543, 498.9505173311629, 463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2279294434329813, "mean_inference_ms": 3.5872933869843404, "mean_action_processing_ms": 0.6649701211577671, "mean_env_wait_ms": 3.689924991816472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072057247161865234, "StateBufferConnector_ms": 0.01340937614440918, "ViewRequirementAgentConnector_ms": 0.28697872161865234}, "num_episodes": 24, "episode_return_max": 524.3876486895003, "episode_return_min": 444.14396975373506, "episode_return_mean": 484.18436771353504, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 292.4363665876753, "num_env_steps_trained_throughput_per_sec": 292.4363665876753, "timesteps_total": 102400, "num_env_steps_sampled_lifetime": 102400, "num_agent_steps_sampled_lifetime": 102400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 3216.981, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3216.981, "sample_time_ms": 1246.381, "learn_time_ms": 1944.999, "learn_throughput": 526.478, "synch_weights_time_ms": 25.32}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "training_iteration": 100, "trial_id": "f7884_00000", "date": "2025-04-08_23-49-55", "timestamp": 1744127395, "time_this_iter_s": 3.514756917953491, "time_total_s": 414.1016528606415, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07DF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 414.1016528606415, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 44.779999999999994, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.96597607024014, "cur_kl_coeff": 1.5777218104420235e-31, "cur_lr": 1e-07, "total_loss": 2.199144298583269, "policy_loss": -4.134702612645924e-05, "vf_loss": 9.991597324609756, "vf_explained_var": -7.5180083513259884e-06, "kl": 1.0518029891048997e-06, "entropy": 2.987136721611023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "env_runners": {"episode_reward_max": 524.3876486895003, "episode_reward_min": 441.52619515416075, "episode_reward_mean": 482.8588046973431, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.52619515416075}, "policy_reward_max": {"tplp_policy": 524.3876486895003}, "policy_reward_mean": {"tplp_policy": 482.8588046973431}, "custom_metrics": {"mean_episode_reward_mean": 482.8588046973431, "mean_episode_reward_min": 441.52619515416075, "mean_episode_reward_max": 524.3876486895003}, "hist_stats": {"episode_reward": [463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.4494692300832, 505.14833010614444, 462.27305490480614, 476.20680807682777, 449.6105525110969, 506.68788541001993, 477.28117431915547, 492.21788553542257, 475.51623781591394, 479.70431229100836, 498.45321883241655, 496.3938978847861, 506.9872288801386, 466.47684956704035, 481.2101441413984, 475.8155586431044, 524.3876486895003, 494.11543165894966, 475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.225918667406516, "mean_inference_ms": 3.5823151954136363, "mean_action_processing_ms": 0.6640467030591931, "mean_env_wait_ms": 3.684869955353159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012336015701293945, "StateBufferConnector_ms": 0.013469934463500977, "ViewRequirementAgentConnector_ms": 0.30060458183288574}, "num_episodes": 18, "episode_return_max": 524.3876486895003, "episode_return_min": 441.52619515416075, "episode_return_mean": 482.8588046973431, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 243.00194589745377, "num_env_steps_trained_throughput_per_sec": 243.00194589745377, "timesteps_total": 103424, "num_env_steps_sampled_lifetime": 103424, "num_agent_steps_sampled_lifetime": 103424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 103424, "timers": {"training_iteration_time_ms": 3311.463, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3311.463, "sample_time_ms": 1301.244, "learn_time_ms": 1983.429, "learn_throughput": 516.278, "synch_weights_time_ms": 26.508}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "done": false, "training_iteration": 101, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-00", "timestamp": 1744127400, "time_this_iter_s": 4.224769592285156, "time_total_s": 418.32642245292664, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 418.32642245292664, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 92.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.324157763272524, "cur_kl_coeff": 7.888609052210117e-32, "cur_lr": 1e-07, "total_loss": 2.2009970478713514, "policy_loss": -9.85986611340195e-05, "vf_loss": 10.0, "vf_explained_var": -5.254894495010376e-06, "kl": 1.501632563005728e-06, "entropy": 2.9890436261892317, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "env_runners": {"episode_reward_max": 525.2013086058297, "episode_reward_min": 441.52619515416075, "episode_reward_mean": 485.2359146991845, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.52619515416075}, "policy_reward_max": {"tplp_policy": 525.2013086058297}, "policy_reward_mean": {"tplp_policy": 485.2359146991845}, "custom_metrics": {"mean_episode_reward_mean": 485.2359146991845, "mean_episode_reward_min": 441.52619515416075, "mean_episode_reward_max": 525.2013086058297}, "hist_stats": {"episode_reward": [475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.33016192466374, 482.84623106580887, 478.5206905739786, 476.4625205641913, 482.31535149898576, 496.56815973814867, 504.9506081117238, 480.5425330100591, 497.45338909393456, 485.48794000909527, 514.4031587973141, 496.41830085194925, 497.4664807754733, 446.4522718959872, 524.0994964656478, 483.26559067658206, 500.8394176336527, 470.9070412530112, 461.2789360637472, 522.2356532230381, 456.1459173306891, 481.51932070553426, 450.62088495605076, 483.1781606033467, 491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2251152635695863, "mean_inference_ms": 3.5802973446238435, "mean_action_processing_ms": 0.6637178088707242, "mean_env_wait_ms": 3.6835693438109227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013552665710449219, "StateBufferConnector_ms": 0.014516592025756836, "ViewRequirementAgentConnector_ms": 0.3247213363647461}, "num_episodes": 18, "episode_return_max": 525.2013086058297, "episode_return_min": 441.52619515416075, "episode_return_mean": 485.2359146991845, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 215.40589128314178, "num_env_steps_trained_throughput_per_sec": 215.40589128314178, "timesteps_total": 104448, "num_env_steps_sampled_lifetime": 104448, "num_agent_steps_sampled_lifetime": 104448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 104448, "timers": {"training_iteration_time_ms": 3468.03, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3468.03, "sample_time_ms": 1396.094, "learn_time_ms": 2044.15, "learn_throughput": 500.942, "synch_weights_time_ms": 27.505}, "counters": {"num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "done": false, "training_iteration": 102, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-05", "timestamp": 1744127405, "time_this_iter_s": 4.764686107635498, "time_total_s": 423.09110856056213, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07DEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 423.09110856056213, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 60.78333333333334, "ram_util_percent": 92.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.876895533502102, "cur_kl_coeff": 3.9443045261050587e-32, "cur_lr": 1e-07, "total_loss": 2.2009223267436027, "policy_loss": -7.3869538027793166e-06, "vf_loss": 9.999770456552506, "vf_explained_var": -3.905594348907471e-06, "kl": 2.8028439231775336e-07, "entropy": 2.990128922462463, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "env_runners": {"episode_reward_max": 528.341370169876, "episode_reward_min": 441.52619515416075, "episode_reward_mean": 486.3975302812453, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.52619515416075}, "policy_reward_max": {"tplp_policy": 528.341370169876}, "policy_reward_mean": {"tplp_policy": 486.3975302812453}, "custom_metrics": {"mean_episode_reward_mean": 486.3975302812453, "mean_episode_reward_min": 441.52619515416075, "mean_episode_reward_max": 528.341370169876}, "hist_stats": {"episode_reward": [491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.1419517981276, 503.1947439600364, 486.0643304696813, 472.2188455660236, 469.6995557103702, 467.5681914958913, 519.039481165861, 507.2144062983195, 502.5731040915053, 473.9356140812457, 497.28736312140086, 490.87745520038783, 501.96042467018555, 485.57984251879367, 495.4907658030487, 467.42796018260714, 472.36520858681877, 500.1607107653108, 472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2249919875710578, "mean_inference_ms": 3.5809131346373984, "mean_action_processing_ms": 0.6640568613094299, "mean_env_wait_ms": 3.6851619981063846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013607978820800781, "StateBufferConnector_ms": 0.01264810562133789, "ViewRequirementAgentConnector_ms": 0.355776309967041}, "num_episodes": 24, "episode_return_max": 528.341370169876, "episode_return_min": 441.52619515416075, "episode_return_mean": 486.3975302812453, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 221.650563342485, "num_env_steps_trained_throughput_per_sec": 221.650563342485, "timesteps_total": 105472, "num_env_steps_sampled_lifetime": 105472, "num_agent_steps_sampled_lifetime": 105472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 105472, "timers": {"training_iteration_time_ms": 3589.328, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3589.328, "sample_time_ms": 1455.632, "learn_time_ms": 2104.816, "learn_throughput": 486.503, "synch_weights_time_ms": 28.47}, "counters": {"num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "done": false, "training_iteration": 103, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-09", "timestamp": 1744127409, "time_this_iter_s": 4.640008926391602, "time_total_s": 427.73111748695374, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.73111748695374, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 54.91428571428571, "ram_util_percent": 92.75714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.585618519410491, "cur_kl_coeff": 1.9721522630525293e-32, "cur_lr": 1e-07, "total_loss": 2.195958483964205, "policy_loss": -0.00019650788162834943, "vf_loss": 9.980848014354706, "vf_explained_var": -5.322694778442383e-06, "kl": 1.5048151703778156e-06, "entropy": 2.990570232272148, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "env_runners": {"episode_reward_max": 528.341370169876, "episode_reward_min": 432.8103963279718, "episode_reward_mean": 484.07201962205744, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.8103963279718}, "policy_reward_max": {"tplp_policy": 528.341370169876}, "policy_reward_mean": {"tplp_policy": 484.07201962205744}, "custom_metrics": {"mean_episode_reward_mean": 484.07201962205744, "mean_episode_reward_min": 432.8103963279718, "mean_episode_reward_max": 528.341370169876}, "hist_stats": {"episode_reward": [472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [472.2997747042647, 501.8470989848508, 467.447744383829, 478.24903585888393, 467.5948749204691, 458.80557082693537, 478.03558637985947, 511.4147629520315, 498.5846881381684, 492.8363570586253, 446.71128320119624, 444.14396975373506, 493.17540960726154, 488.41447084246374, 484.9661271020225, 454.2143976855607, 460.48570006564734, 468.8979507875656, 517.3849524606003, 493.2047226210076, 504.3398665278325, 460.7906072282112, 472.7953604367328, 486.34180089843824, 473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2257840785540757, "mean_inference_ms": 3.5833616447043277, "mean_action_processing_ms": 0.6647254171340796, "mean_env_wait_ms": 3.6887499036367224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017955303192138672, "StateBufferConnector_ms": 0.01367330551147461, "ViewRequirementAgentConnector_ms": 0.3613274097442627}, "num_episodes": 18, "episode_return_max": 528.341370169876, "episode_return_min": 432.8103963279718, "episode_return_mean": 484.07201962205744, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 236.97344023390534, "num_env_steps_trained_throughput_per_sec": 236.97344023390534, "timesteps_total": 106496, "num_env_steps_sampled_lifetime": 106496, "num_agent_steps_sampled_lifetime": 106496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 3713.508, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3713.508, "sample_time_ms": 1512.71, "learn_time_ms": 2171.011, "learn_throughput": 471.67, "synch_weights_time_ms": 29.276}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "training_iteration": 104, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-14", "timestamp": 1744127414, "time_this_iter_s": 4.339980125427246, "time_total_s": 432.071097612381, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.071097612381, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 56.65, "ram_util_percent": 92.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.885711778700352, "cur_kl_coeff": 9.860761315262647e-33, "cur_lr": 1e-07, "total_loss": 2.198947088420391, "policy_loss": -3.668640565592796e-05, "vf_loss": 9.992654484510421, "vf_explained_var": -1.6510486602783203e-06, "kl": 1.1767348438107562e-06, "entropy": 2.9917982175946234, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "env_runners": {"episode_reward_max": 534.3925770809456, "episode_reward_min": 418.1445268626365, "episode_reward_mean": 485.41321225569015, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.1445268626365}, "policy_reward_max": {"tplp_policy": 534.3925770809456}, "policy_reward_mean": {"tplp_policy": 485.41321225569015}, "custom_metrics": {"mean_episode_reward_mean": 485.41321225569015, "mean_episode_reward_min": 418.1445268626365, "mean_episode_reward_max": 534.3925770809456}, "hist_stats": {"episode_reward": [473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.4536969922953, 484.1799995290517, 453.94090138124625, 516.5287299783813, 455.1646678662225, 485.1705276427676, 453.42823163520995, 464.8104689778518, 495.11948271042996, 462.967366894023, 501.84267283747175, 462.29045096376234, 489.99216029461263, 468.1986708108111, 441.52619515416075, 489.2402718337773, 499.0126784408844, 511.5099905266486, 505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2277782627853757, "mean_inference_ms": 3.588889816790821, "mean_action_processing_ms": 0.6663476316230844, "mean_env_wait_ms": 3.6956893208916726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030040979385375977, "StateBufferConnector_ms": 0.02236485481262207, "ViewRequirementAgentConnector_ms": 0.40998077392578125}, "num_episodes": 24, "episode_return_max": 534.3925770809456, "episode_return_min": 418.1445268626365, "episode_return_mean": 485.41321225569015, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 244.13152212701053, "num_env_steps_trained_throughput_per_sec": 244.13152212701053, "timesteps_total": 107520, "num_env_steps_sampled_lifetime": 107520, "num_agent_steps_sampled_lifetime": 107520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 3815.776, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3815.776, "sample_time_ms": 1566.455, "learn_time_ms": 2219.209, "learn_throughput": 461.426, "synch_weights_time_ms": 29.602}, "counters": {"num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "done": false, "training_iteration": 105, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-18", "timestamp": 1744127418, "time_this_iter_s": 4.206795930862427, "time_total_s": 436.2778935432434, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.2778935432434, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 61.760000000000005, "ram_util_percent": 92.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.338993891328573, "cur_kl_coeff": 4.9303806576313234e-33, "cur_lr": 1e-07, "total_loss": 2.195261911302805, "policy_loss": -0.00014724864740855992, "vf_loss": 9.979159259796143, "vf_explained_var": -5.076825618743896e-06, "kl": 2.0848100987458374e-06, "entropy": 2.9938065126538276, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "env_runners": {"episode_reward_max": 534.3925770809456, "episode_reward_min": 418.1445268626365, "episode_reward_mean": 485.9766211525815, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.1445268626365}, "policy_reward_max": {"tplp_policy": 534.3925770809456}, "policy_reward_mean": {"tplp_policy": 485.9766211525815}, "custom_metrics": {"mean_episode_reward_mean": 485.9766211525815, "mean_episode_reward_min": 418.1445268626365, "mean_episode_reward_max": 534.3925770809456}, "hist_stats": {"episode_reward": [505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [505.38849663238375, 508.6102015866016, 486.5913940532168, 487.62974152949374, 502.7580108560949, 511.3854227035099, 525.2013086058297, 518.8272575301413, 483.4932157329153, 518.8306075211704, 461.3773250841304, 507.023594602428, 472.4485601317743, 478.1921142790951, 479.3320870565913, 512.034681809045, 470.4963823561374, 519.0072553998854, 474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.228931967341431, "mean_inference_ms": 3.592516394736038, "mean_action_processing_ms": 0.6673190109292197, "mean_env_wait_ms": 3.7001395926510323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027751922607421875, "StateBufferConnector_ms": 0.021581649780273438, "ViewRequirementAgentConnector_ms": 0.4551236629486084}, "num_episodes": 18, "episode_return_max": 534.3925770809456, "episode_return_min": 418.1445268626365, "episode_return_mean": 485.9766211525815, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.16772863042243, "num_env_steps_trained_throughput_per_sec": 219.16772863042243, "timesteps_total": 108544, "num_env_steps_sampled_lifetime": 108544, "num_agent_steps_sampled_lifetime": 108544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 108544, "timers": {"training_iteration_time_ms": 3961.146, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3961.146, "sample_time_ms": 1621.527, "learn_time_ms": 2307.376, "learn_throughput": 443.794, "synch_weights_time_ms": 31.733}, "counters": {"num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "done": false, "training_iteration": 106, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-23", "timestamp": 1744127423, "time_this_iter_s": 4.721447706222534, "time_total_s": 440.99934124946594, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07DEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 440.99934124946594, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.58571428571428, "ram_util_percent": 92.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2298862881958486, "cur_kl_coeff": 2.4651903288156617e-33, "cur_lr": 1e-07, "total_loss": 2.1962429016828535, "policy_loss": -7.038966869004071e-05, "vf_loss": 9.983766269683837, "vf_explained_var": -5.003809928894043e-06, "kl": 2.1739824551669784e-06, "entropy": 2.9962825924158096, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "env_runners": {"episode_reward_max": 534.3925770809456, "episode_reward_min": 418.1445268626365, "episode_reward_mean": 482.62944738751867, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.1445268626365}, "policy_reward_max": {"tplp_policy": 534.3925770809456}, "policy_reward_mean": {"tplp_policy": 482.62944738751867}, "custom_metrics": {"mean_episode_reward_mean": 482.62944738751867, "mean_episode_reward_min": 418.1445268626365, "mean_episode_reward_max": 534.3925770809456}, "hist_stats": {"episode_reward": [474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.0775971917294, 511.86624616618576, 509.0439794857163, 484.5559648154185, 478.2158282488378, 506.7581213886418, 493.58118929885603, 508.6874183594342, 459.27256375034324, 528.341370169876, 477.3740588563657, 490.86182481777047, 517.2680568159436, 464.94013774044777, 496.5445293935883, 465.76225532410984, 483.8755987683463, 510.14432397892614, 463.76921288401473, 476.3298716416049, 502.78308100004585, 471.9129071764721, 485.96563096711884, 453.4719524584319, 470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2298237732420012, "mean_inference_ms": 3.595497193779071, "mean_action_processing_ms": 0.6681583160630011, "mean_env_wait_ms": 3.7034283439839313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03114771842956543, "StateBufferConnector_ms": 0.021221637725830078, "ViewRequirementAgentConnector_ms": 0.44089245796203613}, "num_episodes": 18, "episode_return_max": 534.3925770809456, "episode_return_min": 418.1445268626365, "episode_return_mean": 482.62944738751867, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 255.230075233723, "num_env_steps_trained_throughput_per_sec": 255.230075233723, "timesteps_total": 109568, "num_env_steps_sampled_lifetime": 109568, "num_agent_steps_sampled_lifetime": 109568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 109568, "timers": {"training_iteration_time_ms": 4050.279, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4050.279, "sample_time_ms": 1690.825, "learn_time_ms": 2326.472, "learn_throughput": 440.151, "synch_weights_time_ms": 32.472}, "counters": {"num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "done": false, "training_iteration": 107, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-27", "timestamp": 1744127427, "time_this_iter_s": 4.034966230392456, "time_total_s": 445.0343074798584, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E5C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.0343074798584, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 61.79999999999999, "ram_util_percent": 92.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.99361616615206, "cur_kl_coeff": 1.2325951644078308e-33, "cur_lr": 1e-07, "total_loss": 2.1945418737828732, "policy_loss": -5.26163843460381e-05, "vf_loss": 9.977603286504745, "vf_explained_var": -4.79966402053833e-06, "kl": 7.747238605748663e-07, "entropy": 2.9980632305145263, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "env_runners": {"episode_reward_max": 534.3925770809456, "episode_reward_min": 418.1445268626365, "episode_reward_mean": 480.6039103124668, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.1445268626365}, "policy_reward_max": {"tplp_policy": 534.3925770809456}, "policy_reward_mean": {"tplp_policy": 480.6039103124668}, "custom_metrics": {"mean_episode_reward_mean": 480.6039103124668, "mean_episode_reward_min": 418.1445268626365, "mean_episode_reward_max": 534.3925770809456}, "hist_stats": {"episode_reward": [470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.98063906460754, 485.89084590276815, 505.2379619712717, 491.60903596249074, 434.1405992917506, 476.06009680283836, 474.8611541329293, 477.62608184561356, 494.3336266517176, 432.8103963279718, 463.4792300186584, 504.6432381348751, 485.94890771421905, 492.91578888583973, 458.6431068857544, 482.6305965479621, 482.01293630538595, 497.13372753799956, 436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2320484674492271, "mean_inference_ms": 3.600430130552135, "mean_action_processing_ms": 0.669188205415509, "mean_env_wait_ms": 3.709216208326252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03360891342163086, "StateBufferConnector_ms": 0.019475460052490234, "ViewRequirementAgentConnector_ms": 0.4786336421966553}, "num_episodes": 24, "episode_return_max": 534.3925770809456, "episode_return_min": 418.1445268626365, "episode_return_mean": 480.6039103124668, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 245.3876649566149, "num_env_steps_trained_throughput_per_sec": 245.3876649566149, "timesteps_total": 110592, "num_env_steps_sampled_lifetime": 110592, "num_agent_steps_sampled_lifetime": 110592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 4165.737, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4165.737, "sample_time_ms": 1780.919, "learn_time_ms": 2351.663, "learn_throughput": 435.437, "synch_weights_time_ms": 32.644}, "counters": {"num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "training_iteration": 108, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-31", "timestamp": 1744127431, "time_this_iter_s": 4.180950880050659, "time_total_s": 449.21525835990906, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 449.21525835990906, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 58.720000000000006, "ram_util_percent": 93.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9297256603837014, "cur_kl_coeff": 6.162975822039154e-34, "cur_lr": 1e-07, "total_loss": 2.199573762714863, "policy_loss": -4.4898665510118005e-05, "vf_loss": 9.998088043928146, "vf_explained_var": -6.078556180000305e-06, "kl": 1.0579709634583879e-06, "entropy": 2.9990336403250692, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "env_runners": {"episode_reward_max": 537.7891108757486, "episode_reward_min": 418.1445268626365, "episode_reward_mean": 482.72457427658105, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.1445268626365}, "policy_reward_max": {"tplp_policy": 537.7891108757486}, "policy_reward_mean": {"tplp_policy": 482.72457427658105}, "custom_metrics": {"mean_episode_reward_mean": 482.72457427658105, "mean_episode_reward_min": 418.1445268626365, "mean_episode_reward_max": 537.7891108757486}, "hist_stats": {"episode_reward": [436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [436.6976621509509, 534.3925770809456, 487.0500066898472, 500.70941311415123, 465.0561705044266, 492.2624055366934, 485.9059827214951, 495.73291852932016, 494.0471069054864, 491.0536512114259, 500.6446503088376, 499.94071889776404, 512.104914973161, 478.5756043536611, 472.51970137584516, 526.3068733552739, 418.1445268626365, 500.7949202936798, 465.5133930990466, 427.70492008471, 495.4463459767388, 477.3502489199914, 475.4887772274507, 455.0050978101845, 491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2329913448827907, "mean_inference_ms": 3.602193858947152, "mean_action_processing_ms": 0.6695664311751941, "mean_env_wait_ms": 3.7113256478381644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0423429012298584, "StateBufferConnector_ms": 0.016878366470336914, "ViewRequirementAgentConnector_ms": 0.46576881408691406}, "num_episodes": 18, "episode_return_max": 537.7891108757486, "episode_return_min": 418.1445268626365, "episode_return_mean": 482.72457427658105, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 313.2802055658974, "num_env_steps_trained_throughput_per_sec": 313.2802055658974, "timesteps_total": 111616, "num_env_steps_sampled_lifetime": 111616, "num_agent_steps_sampled_lifetime": 111616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 111616, "timers": {"training_iteration_time_ms": 4173.081, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4173.081, "sample_time_ms": 1778.094, "learn_time_ms": 2361.61, "learn_throughput": 433.603, "synch_weights_time_ms": 32.97}, "counters": {"num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "done": false, "training_iteration": 109, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-35", "timestamp": 1744127435, "time_this_iter_s": 3.276606798171997, "time_total_s": 452.49186515808105, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.49186515808105, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 43.58, "ram_util_percent": 93.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.077166822552681, "cur_kl_coeff": 3.081487911019577e-34, "cur_lr": 1e-07, "total_loss": 2.195229471474886, "policy_loss": -6.547640659846366e-05, "vf_loss": 9.98143728375435, "vf_explained_var": -4.643574357032776e-06, "kl": 1.1189161033264838e-06, "entropy": 3.000643701851368, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "env_runners": {"episode_reward_max": 537.7891108757486, "episode_reward_min": 423.80851301503805, "episode_reward_mean": 483.3118363049211, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.80851301503805}, "policy_reward_max": {"tplp_policy": 537.7891108757486}, "policy_reward_mean": {"tplp_policy": 483.3118363049211}, "custom_metrics": {"mean_episode_reward_mean": 483.3118363049211, "mean_episode_reward_min": 423.80851301503805, "mean_episode_reward_max": 537.7891108757486}, "hist_stats": {"episode_reward": [491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.2972530496495, 434.4304119104111, 499.0530098980543, 493.8535946710392, 479.0713566720364, 503.4401406490284, 506.80826106963747, 505.90803786211717, 487.175159925045, 474.82346171494436, 480.9731786377878, 484.42473546157265, 453.9825540062576, 500.8556891815922, 457.70841058631623, 480.4189238256158, 466.1153025871429, 492.55608210322134, 474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.233350094046709, "mean_inference_ms": 3.6021638972261876, "mean_action_processing_ms": 0.6694279280022911, "mean_env_wait_ms": 3.711618709162592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030760526657104492, "StateBufferConnector_ms": 0.0075304508209228516, "ViewRequirementAgentConnector_ms": 0.4253718852996826}, "num_episodes": 24, "episode_return_max": 537.7891108757486, "episode_return_min": 423.80851301503805, "episode_return_mean": 483.3118363049211, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 345.8723382323832, "num_env_steps_trained_throughput_per_sec": 345.8723382323832, "timesteps_total": 112640, "num_env_steps_sampled_lifetime": 112640, "num_agent_steps_sampled_lifetime": 112640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 112640, "timers": {"training_iteration_time_ms": 4118.982, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4118.982, "sample_time_ms": 1778.626, "learn_time_ms": 2307.838, "learn_throughput": 443.705, "synch_weights_time_ms": 32.124}, "counters": {"num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "done": false, "training_iteration": 110, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-38", "timestamp": 1744127438, "time_this_iter_s": 2.9708924293518066, "time_total_s": 455.46275758743286, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.46275758743286, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 52.375, "ram_util_percent": 93.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7915506906807424, "cur_kl_coeff": 1.5407439555097886e-34, "cur_lr": 1e-07, "total_loss": 2.1996601022779942, "policy_loss": -8.165889303199947e-05, "vf_loss": 10.0, "vf_explained_var": -5.83939254283905e-06, "kl": 1.9663185415921823e-06, "entropy": 3.002582351863384, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "env_runners": {"episode_reward_max": 537.7891108757486, "episode_reward_min": 423.80851301503805, "episode_reward_mean": 485.2780904035937, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.80851301503805}, "policy_reward_max": {"tplp_policy": 537.7891108757486}, "policy_reward_mean": {"tplp_policy": 485.2780904035937}, "custom_metrics": {"mean_episode_reward_mean": 485.2780904035937, "mean_episode_reward_min": 423.80851301503805, "mean_episode_reward_max": 537.7891108757486}, "hist_stats": {"episode_reward": [474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.9118178453151, 506.0210376992371, 457.0603325953788, 473.64714306867245, 499.934725974657, 504.31080099092827, 440.7152828708648, 475.59714410647274, 492.4849180628753, 444.89310167124546, 478.8046665141332, 504.3924758163509, 475.9751747075877, 482.528949653429, 484.3325567910566, 459.628767905593, 452.70533124857326, 468.2439038438843, 481.0509826267996, 470.2553881312774, 473.4129629168016, 476.8593894352661, 500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2331037785723067, "mean_inference_ms": 3.6004946564534297, "mean_action_processing_ms": 0.6691204981546534, "mean_env_wait_ms": 3.710446368391621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02773571014404297, "StateBufferConnector_ms": 0.007232666015625, "ViewRequirementAgentConnector_ms": 0.373157262802124}, "num_episodes": 18, "episode_return_max": 537.7891108757486, "episode_return_min": 423.80851301503805, "episode_return_mean": 485.2780904035937, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 312.8042797486418, "num_env_steps_trained_throughput_per_sec": 312.8042797486418, "timesteps_total": 113664, "num_env_steps_sampled_lifetime": 113664, "num_agent_steps_sampled_lifetime": 113664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 113664, "timers": {"training_iteration_time_ms": 4024.948, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4024.948, "sample_time_ms": 1730.779, "learn_time_ms": 2262.649, "learn_throughput": 452.567, "synch_weights_time_ms": 31.124}, "counters": {"num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "done": false, "training_iteration": 111, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-41", "timestamp": 1744127441, "time_this_iter_s": 3.281805992126465, "time_total_s": 458.7445635795593, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 458.7445635795593, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 48.06, "ram_util_percent": 93.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.134731300920248, "cur_kl_coeff": 7.703719777548943e-35, "cur_lr": 1e-07, "total_loss": 2.1971467316150664, "policy_loss": -5.1273911958560346e-05, "vf_loss": 9.99048655629158, "vf_explained_var": -1.2442469596862793e-06, "kl": 8.847930375033286e-07, "entropy": 3.0042362615466116, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "env_runners": {"episode_reward_max": 537.7891108757486, "episode_reward_min": 423.80851301503805, "episode_reward_mean": 486.6708966386263, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.80851301503805}, "policy_reward_max": {"tplp_policy": 537.7891108757486}, "policy_reward_mean": {"tplp_policy": 486.6708966386263}, "custom_metrics": {"mean_episode_reward_mean": 486.6708966386263, "mean_episode_reward_min": 423.80851301503805, "mean_episode_reward_max": 537.7891108757486}, "hist_stats": {"episode_reward": [500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [500.8710907880112, 489.20238158641763, 501.7663008447098, 474.7333953271033, 515.9628782951336, 492.87432089758954, 492.4927600832681, 489.3778641063494, 462.66752614607947, 456.8358445673974, 483.75790906564794, 478.19298939628123, 474.0531131865554, 486.1080140788504, 481.93867053519386, 486.0019457832897, 423.80851301503805, 499.6765372875086, 537.7891108757486, 472.6797749827398, 509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2317981363087114, "mean_inference_ms": 3.59420870615557, "mean_action_processing_ms": 0.6682086841481504, "mean_env_wait_ms": 3.706673390391192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0239260196685791, "StateBufferConnector_ms": 0.010707378387451172, "ViewRequirementAgentConnector_ms": 0.31199026107788086}, "num_episodes": 22, "episode_return_max": 537.7891108757486, "episode_return_min": 423.80851301503805, "episode_return_mean": 486.6708966386263, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.86914981738624, "num_env_steps_trained_throughput_per_sec": 328.86914981738624, "timesteps_total": 114688, "num_env_steps_sampled_lifetime": 114688, "num_agent_steps_sampled_lifetime": 114688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 3860.936, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3860.936, "sample_time_ms": 1644.55, "learn_time_ms": 2185.511, "learn_throughput": 468.54, "synch_weights_time_ms": 30.43}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "training_iteration": 112, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-44", "timestamp": 1744127444, "time_this_iter_s": 3.122706174850464, "time_total_s": 461.8672697544098, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC056FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.8672697544098, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 53.925000000000004, "ram_util_percent": 93.37500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2836155600845816, "cur_kl_coeff": 3.8518598887744714e-35, "cur_lr": 1e-07, "total_loss": 2.1949810720980167, "policy_loss": -6.646673427894712e-05, "vf_loss": 9.982557970285416, "vf_explained_var": -4.082173109054565e-06, "kl": 1.7979717866101197e-06, "entropy": 3.0059194684028627, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "env_runners": {"episode_reward_max": 528.7526916744363, "episode_reward_min": 425.57368231012333, "episode_reward_mean": 487.6869334570744, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.57368231012333}, "policy_reward_max": {"tplp_policy": 528.7526916744363}, "policy_reward_mean": {"tplp_policy": 487.6869334570744}, "custom_metrics": {"mean_episode_reward_mean": 487.6869334570744, "mean_episode_reward_min": 425.57368231012333, "mean_episode_reward_max": 528.7526916744363}, "hist_stats": {"episode_reward": [509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.44692150504494, 493.49485745610247, 489.65369635699926, 483.7940835321449, 448.7256334764852, 458.62938985330914, 503.395838170881, 528.7526916744363, 463.43754633986333, 500.8596482263989, 484.03411104034586, 468.22177472002755, 479.9519061036008, 494.68885193989905, 508.3690863086343, 497.09944383341883, 509.6636592664432, 474.01781808702054, 510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2293183929448714, "mean_inference_ms": 3.5881156020709, "mean_action_processing_ms": 0.6670030889925523, "mean_env_wait_ms": 3.6999679976941993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022800922393798828, "StateBufferConnector_ms": 0.02838897705078125, "ViewRequirementAgentConnector_ms": 0.30857396125793457}, "num_episodes": 20, "episode_return_max": 528.7526916744363, "episode_return_min": 425.57368231012333, "episode_return_mean": 487.6869334570744, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 334.08988058548863, "num_env_steps_trained_throughput_per_sec": 334.08988058548863, "timesteps_total": 115712, "num_env_steps_sampled_lifetime": 115712, "num_agent_steps_sampled_lifetime": 115712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 115712, "timers": {"training_iteration_time_ms": 3705.452, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3705.452, "sample_time_ms": 1589.208, "learn_time_ms": 2086.739, "learn_throughput": 490.718, "synch_weights_time_ms": 29.188}, "counters": {"num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "done": false, "training_iteration": 113, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-48", "timestamp": 1744127448, "time_this_iter_s": 3.0723512172698975, "time_total_s": 464.9396209716797, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E0C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 464.9396209716797, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 52.37499999999999, "ram_util_percent": 93.37500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.391442441754043, "cur_kl_coeff": 1.9259299443872357e-35, "cur_lr": 1e-07, "total_loss": 2.196821001172066, "policy_loss": -2.0484987180680038e-05, "vf_loss": 9.990418195724487, "vf_explained_var": -5.790218710899353e-06, "kl": 3.8303967655473057e-07, "entropy": 3.0076305508613586, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "env_runners": {"episode_reward_max": 526.9414516781371, "episode_reward_min": 425.57368231012333, "episode_reward_mean": 487.3363840019167, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.57368231012333}, "policy_reward_max": {"tplp_policy": 526.9414516781371}, "policy_reward_mean": {"tplp_policy": 487.3363840019167}, "custom_metrics": {"mean_episode_reward_mean": 487.3363840019167, "mean_episode_reward_min": 425.57368231012333, "mean_episode_reward_max": 526.9414516781371}, "hist_stats": {"episode_reward": [510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [510.63486410569885, 490.87445332823484, 485.900303504768, 425.57368231012333, 488.7932859680747, 478.25686437328864, 486.5590153051209, 451.7560162284039, 495.97744874915105, 497.80532115808626, 516.8999844205464, 486.74225558496505, 472.3519495968472, 467.44801465861946, 487.3278301574066, 484.43119797037036, 462.74204649146805, 498.75831629918287, 511.1173211175956, 494.4773407296522, 460.2125861334391, 508.8532152732202, 464.06802185400744, 454.13381299181015, 507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.227151559586687, "mean_inference_ms": 3.582133943917418, "mean_action_processing_ms": 0.6660435861381383, "mean_env_wait_ms": 3.694406865617279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934995651245117, "StateBufferConnector_ms": 0.033641815185546875, "ViewRequirementAgentConnector_ms": 0.2938809394836426}, "num_episodes": 18, "episode_return_max": 526.9414516781371, "episode_return_min": 425.57368231012333, "episode_return_mean": 487.3363840019167, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 331.7778380140887, "num_env_steps_trained_throughput_per_sec": 331.7778380140887, "timesteps_total": 116736, "num_env_steps_sampled_lifetime": 116736, "num_agent_steps_sampled_lifetime": 116736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 116736, "timers": {"training_iteration_time_ms": 3581.976, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3581.976, "sample_time_ms": 1536.12, "learn_time_ms": 2017.162, "learn_throughput": 507.644, "synch_weights_time_ms": 28.477}, "counters": {"num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "done": false, "training_iteration": 114, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-51", "timestamp": 1744127451, "time_this_iter_s": 3.0939784049987793, "time_total_s": 468.03359937667847, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07DEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.03359937667847, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 51.875, "ram_util_percent": 93.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.005591554939747, "cur_kl_coeff": 9.629649721936178e-36, "cur_lr": 1e-07, "total_loss": 2.1982307866215707, "policy_loss": -6.06536166742444e-05, "vf_loss": 9.996693229675293, "vf_explained_var": -5.172193050384522e-06, "kl": 1.567080851766489e-06, "entropy": 3.0088185712695124, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "env_runners": {"episode_reward_max": 526.9414516781371, "episode_reward_min": 451.56112620122974, "episode_reward_mean": 488.64981223255063, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 451.56112620122974}, "policy_reward_max": {"tplp_policy": 526.9414516781371}, "policy_reward_mean": {"tplp_policy": 488.64981223255063}, "custom_metrics": {"mean_episode_reward_mean": 488.64981223255063, "mean_episode_reward_min": 451.56112620122974, "mean_episode_reward_max": 526.9414516781371}, "hist_stats": {"episode_reward": [507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.4813211243762, 495.5390976030093, 489.7837564870562, 460.5221049869353, 495.26868658186623, 497.1130016670816, 491.7844438330435, 505.59990702610713, 501.55651098835324, 496.87822756132863, 507.51421113509736, 504.39677899630595, 499.4643503637228, 508.7295844793803, 499.93054243352003, 509.75661356574375, 484.0467101882389, 462.8448953054264, 475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2242374033332157, "mean_inference_ms": 3.5740982959379335, "mean_action_processing_ms": 0.6647279712882185, "mean_env_wait_ms": 3.6872421564554543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011444568634033203, "StateBufferConnector_ms": 0.03514862060546875, "ViewRequirementAgentConnector_ms": 0.30210208892822266}, "num_episodes": 24, "episode_return_max": 526.9414516781371, "episode_return_min": 451.56112620122974, "episode_return_mean": 488.64981223255063, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 342.6382979673935, "num_env_steps_trained_throughput_per_sec": 342.6382979673935, "timesteps_total": 117760, "num_env_steps_sampled_lifetime": 117760, "num_agent_steps_sampled_lifetime": 117760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 117760, "timers": {"training_iteration_time_ms": 3461.388, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3461.388, "sample_time_ms": 1479.804, "learn_time_ms": 1953.161, "learn_throughput": 524.278, "synch_weights_time_ms": 28.206}, "counters": {"num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "done": false, "training_iteration": 115, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-54", "timestamp": 1744127454, "time_this_iter_s": 2.9973936080932617, "time_total_s": 471.03099298477173, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0547C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 471.03099298477173, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 44.82, "ram_util_percent": 93.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1763279233127832, "cur_kl_coeff": 4.814824860968089e-36, "cur_lr": 1e-07, "total_loss": 2.1947087034583093, "policy_loss": -9.626497630961239e-05, "vf_loss": 9.98367303609848, "vf_explained_var": -6.1407685279846195e-06, "kl": 1.610116475525558e-06, "entropy": 3.011133003234863, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "env_runners": {"episode_reward_max": 535.5756166438536, "episode_reward_min": 419.8279826705514, "episode_reward_mean": 485.9254783289751, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.8279826705514}, "policy_reward_max": {"tplp_policy": 535.5756166438536}, "policy_reward_mean": {"tplp_policy": 485.9254783289751}, "custom_metrics": {"mean_episode_reward_mean": 485.9254783289751, "mean_episode_reward_min": 419.8279826705514, "mean_episode_reward_max": 535.5756166438536}, "hist_stats": {"episode_reward": [475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.9506040399915, 461.26415221904455, 483.8678582455399, 451.56112620122974, 478.31805701720737, 507.4825028046193, 477.9472281523081, 509.93108892810125, 500.68438614581794, 461.2490704156693, 503.9692689700387, 458.3645493317067, 478.00318024190136, 469.70071345649524, 526.9414516781371, 482.22758001187975, 481.13127209960766, 496.4371355034542, 486.4905385438582, 478.6341084793851, 491.8466787899445, 502.2603346456744, 494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2221789188155339, "mean_inference_ms": 3.568379059714831, "mean_action_processing_ms": 0.663734403466335, "mean_env_wait_ms": 3.6821181664529585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011455535888671875, "StateBufferConnector_ms": 0.03515172004699707, "ViewRequirementAgentConnector_ms": 0.30248022079467773}, "num_episodes": 18, "episode_return_max": 535.5756166438536, "episode_return_min": 419.8279826705514, "episode_return_mean": 485.9254783289751, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 310.5467838496222, "num_env_steps_trained_throughput_per_sec": 310.5467838496222, "timesteps_total": 118784, "num_env_steps_sampled_lifetime": 118784, "num_agent_steps_sampled_lifetime": 118784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 3323.907, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3323.907, "sample_time_ms": 1439.83, "learn_time_ms": 1858.064, "learn_throughput": 551.111, "synch_weights_time_ms": 25.689}, "counters": {"num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "training_iteration": 116, "trial_id": "f7884_00000", "date": "2025-04-08_23-50-57", "timestamp": 1744127457, "time_this_iter_s": 3.3049373626708984, "time_total_s": 474.3359303474426, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F6A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.3359303474426, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 58.85, "ram_util_percent": 93.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.125558418780565, "cur_kl_coeff": 2.4074124304840446e-36, "cur_lr": 1e-07, "total_loss": 2.1950014866888523, "policy_loss": -3.0911096837371586e-05, "vf_loss": 9.985162395238877, "vf_explained_var": -3.641471266746521e-06, "kl": 6.788862865869661e-07, "entropy": 3.0125818625092506, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "env_runners": {"episode_reward_max": 535.5756166438536, "episode_reward_min": 419.8279826705514, "episode_reward_mean": 485.1796620294218, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.8279826705514}, "policy_reward_max": {"tplp_policy": 535.5756166438536}, "policy_reward_mean": {"tplp_policy": 485.1796620294218}, "custom_metrics": {"mean_episode_reward_mean": 485.1796620294218, "mean_episode_reward_min": 419.8279826705514, "mean_episode_reward_max": 535.5756166438536}, "hist_stats": {"episode_reward": [494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [494.3437794591226, 469.89168299912734, 495.47415971092283, 468.63853497684426, 495.6948489739995, 526.6669904548401, 493.60777231230264, 458.6614714004045, 495.01865812800094, 483.8838138187907, 486.3080120438106, 487.3925258863179, 503.6719452333013, 461.6099742828574, 454.1037004340949, 511.89441506567783, 517.9020097576177, 503.52331432005417, 486.87663352536833, 475.3632233212494, 475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2196639554675506, "mean_inference_ms": 3.5613078774520215, "mean_action_processing_ms": 0.662573718203419, "mean_env_wait_ms": 3.6757250592599444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01234126091003418, "StateBufferConnector_ms": 0.02994394302368164, "ViewRequirementAgentConnector_ms": 0.31511569023132324}, "num_episodes": 22, "episode_return_max": 535.5756166438536, "episode_return_min": 419.8279826705514, "episode_return_mean": 485.1796620294218, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 330.45218097407275, "num_env_steps_trained_throughput_per_sec": 330.45218097407275, "timesteps_total": 119808, "num_env_steps_sampled_lifetime": 119808, "num_agent_steps_sampled_lifetime": 119808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 119808, "timers": {"training_iteration_time_ms": 3232.579, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3232.579, "sample_time_ms": 1373.93, "learn_time_ms": 1832.991, "learn_throughput": 558.65, "synch_weights_time_ms": 25.334}, "counters": {"num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "done": false, "training_iteration": 117, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-00", "timestamp": 1744127460, "time_this_iter_s": 3.1099801063537598, "time_total_s": 477.4459104537964, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 477.4459104537964, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 47.36, "ram_util_percent": 93.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.022182860597968, "cur_kl_coeff": 1.2037062152420223e-36, "cur_lr": 1e-07, "total_loss": 2.1985721051692964, "policy_loss": -4.468377446755767e-05, "vf_loss": 10.0, "vf_explained_var": -4.646182060241699e-06, "kl": 1.0729715675561468e-06, "entropy": 3.013831879198551, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "env_runners": {"episode_reward_max": 535.5756166438536, "episode_reward_min": 419.8279826705514, "episode_reward_mean": 484.22394123493666, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.8279826705514}, "policy_reward_max": {"tplp_policy": 535.5756166438536}, "policy_reward_mean": {"tplp_policy": 484.22394123493666}, "custom_metrics": {"mean_episode_reward_mean": 484.22394123493666, "mean_episode_reward_min": 419.8279826705514, "mean_episode_reward_max": 535.5756166438536}, "hist_stats": {"episode_reward": [475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.0437170986013, 485.5076247590939, 505.9144401635577, 479.4730596779149, 477.0677742199849, 463.38779802100663, 506.6895012121801, 470.9995608412065, 453.2031933146132, 498.39093095571144, 487.29105081218876, 510.0442187938215, 485.08136035339516, 504.5926331986809, 494.8080369481941, 501.44725515852906, 491.43085426588937, 461.62684336838345, 496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2173254871200945, "mean_inference_ms": 3.5547815050474263, "mean_action_processing_ms": 0.6615915741525636, "mean_env_wait_ms": 3.669978865616832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012257814407348633, "StateBufferConnector_ms": 0.01233053207397461, "ViewRequirementAgentConnector_ms": 0.33010053634643555}, "num_episodes": 20, "episode_return_max": 535.5756166438536, "episode_return_min": 419.8279826705514, "episode_return_mean": 484.22394123493666, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.3756543754802, "num_env_steps_trained_throughput_per_sec": 329.3756543754802, "timesteps_total": 120832, "num_env_steps_sampled_lifetime": 120832, "num_agent_steps_sampled_lifetime": 120832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 120832, "timers": {"training_iteration_time_ms": 3126.171, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3126.171, "sample_time_ms": 1293.338, "learn_time_ms": 1806.616, "learn_throughput": 566.806, "synch_weights_time_ms": 25.76}, "counters": {"num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "done": false, "training_iteration": 118, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-04", "timestamp": 1744127464, "time_this_iter_s": 3.117910146713257, "time_total_s": 480.56382060050964, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.56382060050964, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 55.7, "ram_util_percent": 92.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.995719810947776, "cur_kl_coeff": 6.0185310762101115e-37, "cur_lr": 1e-07, "total_loss": 2.1961241967976095, "policy_loss": -2.5395461125299335e-05, "vf_loss": 9.990486508607864, "vf_explained_var": -6.0856342315673825e-06, "kl": 3.9223136717447814e-07, "entropy": 3.014720256626606, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "env_runners": {"episode_reward_max": 535.5756166438536, "episode_reward_min": 419.8279826705514, "episode_reward_mean": 484.40930176398547, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.8279826705514}, "policy_reward_max": {"tplp_policy": 535.5756166438536}, "policy_reward_mean": {"tplp_policy": 484.40930176398547}, "custom_metrics": {"mean_episode_reward_mean": 484.40930176398547, "mean_episode_reward_min": 419.8279826705514, "mean_episode_reward_max": 535.5756166438536}, "hist_stats": {"episode_reward": [496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [496.73223536627813, 456.91461877581816, 492.3370327876444, 511.7530916982825, 487.9096001498348, 505.0990246675103, 493.8232304805036, 476.93639614072237, 485.9777846047076, 485.1384400717193, 494.6553664339905, 492.6566928050722, 480.81172895198125, 514.5820321609829, 500.5157977150847, 479.1656133183663, 457.16892941236176, 482.8255306171467, 496.30084297786766, 492.899695780768, 477.69876389249686, 498.077824930054, 498.9152809679109, 525.7027945186667, 439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.215484676004766, "mean_inference_ms": 3.5491656732084595, "mean_action_processing_ms": 0.6607437354258865, "mean_env_wait_ms": 3.665091360063818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012126445770263672, "StateBufferConnector_ms": 0.0065724849700927734, "ViewRequirementAgentConnector_ms": 0.3379392623901367}, "num_episodes": 18, "episode_return_max": 535.5756166438536, "episode_return_min": 419.8279826705514, "episode_return_mean": 484.40930176398547, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.54603282425524, "num_env_steps_trained_throughput_per_sec": 328.54603282425524, "timesteps_total": 121856, "num_env_steps_sampled_lifetime": 121856, "num_agent_steps_sampled_lifetime": 121856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 121856, "timers": {"training_iteration_time_ms": 3110.983, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3110.881, "sample_time_ms": 1302.992, "learn_time_ms": 1782.231, "learn_throughput": 574.561, "synch_weights_time_ms": 25.251}, "counters": {"num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "done": false, "training_iteration": 119, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-07", "timestamp": 1744127467, "time_this_iter_s": 3.1235921382904053, "time_total_s": 483.68741273880005, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 483.68741273880005, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 48.56, "ram_util_percent": 92.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0157294955104588, "cur_kl_coeff": 3.0092655381050558e-37, "cur_lr": 1e-07, "total_loss": 2.196100467443466, "policy_loss": -9.36630996875465e-05, "vf_loss": 9.99060361981392, "vf_explained_var": -5.9656798839569095e-06, "kl": 5.948863736615628e-07, "entropy": 3.0145677447319033, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "env_runners": {"episode_reward_max": 537.6976375565887, "episode_reward_min": 419.8279826705514, "episode_reward_mean": 484.6438949875051, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.8279826705514}, "policy_reward_max": {"tplp_policy": 537.6976375565887}, "policy_reward_mean": {"tplp_policy": 484.6438949875051}, "custom_metrics": {"mean_episode_reward_mean": 484.6438949875051, "mean_episode_reward_min": 419.8279826705514, "mean_episode_reward_max": 537.6976375565887}, "hist_stats": {"episode_reward": [439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [439.15903753250103, 452.8843144428439, 494.9590606305684, 499.4761375997659, 442.5188285312824, 511.06770875123345, 463.02679744797445, 453.82446112937293, 511.78363865526825, 495.2560876196008, 535.5756166438536, 508.83192287460776, 419.8279826705514, 474.5780867233985, 460.0621489318303, 458.32744829780796, 453.90020959598786, 502.93947348247735, 489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2130591011569398, "mean_inference_ms": 3.5417067008588714, "mean_action_processing_ms": 0.6596114377028442, "mean_env_wait_ms": 3.658542292670628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014647483825683594, "StateBufferConnector_ms": 0.009092092514038086, "ViewRequirementAgentConnector_ms": 0.34195566177368164}, "num_episodes": 24, "episode_return_max": 537.6976375565887, "episode_return_min": 419.8279826705514, "episode_return_mean": 484.6438949875051, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 351.39955005788113, "num_env_steps_trained_throughput_per_sec": 351.39955005788113, "timesteps_total": 122880, "num_env_steps_sampled_lifetime": 122880, "num_agent_steps_sampled_lifetime": 122880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 3106.326, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3106.224, "sample_time_ms": 1304.631, "learn_time_ms": 1776.137, "learn_throughput": 576.532, "synch_weights_time_ms": 25.165}, "counters": {"num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "training_iteration": 120, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-10", "timestamp": 1744127470, "time_this_iter_s": 2.9233529567718506, "time_total_s": 486.6107656955719, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 486.6107656955719, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 49.550000000000004, "ram_util_percent": 92.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0850202003493905, "cur_kl_coeff": 1.5046327690525279e-37, "cur_lr": 1e-07, "total_loss": 2.196368344128132, "policy_loss": -4.569806042127311e-05, "vf_loss": 9.991739863157273, "vf_explained_var": -6.12214207649231e-06, "kl": 9.77303544069663e-07, "entropy": 3.01520926207304, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "env_runners": {"episode_reward_max": 537.6976375565887, "episode_reward_min": 426.35711074394396, "episode_reward_mean": 486.24638883989707, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.35711074394396}, "policy_reward_max": {"tplp_policy": 537.6976375565887}, "policy_reward_mean": {"tplp_policy": 486.24638883989707}, "custom_metrics": {"mean_episode_reward_mean": 486.24638883989707, "mean_episode_reward_min": 426.35711074394396, "mean_episode_reward_max": 537.6976375565887}, "hist_stats": {"episode_reward": [489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.1903991038719, 465.92819423010974, 452.0164978846969, 477.21280304610394, 505.35004039028024, 501.85456751391007, 493.4337471198421, 477.1311197814344, 461.46124348564905, 482.7877429116328, 498.863989796692, 491.42460647404585, 484.87123192406983, 481.3020475011347, 463.06719620393955, 495.72598193985243, 493.05000233243476, 491.8643840734819, 475.97776643365313, 450.32801074099996, 519.0890463409858, 493.80823916802234, 515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2113273256392019, "mean_inference_ms": 3.5365385333029047, "mean_action_processing_ms": 0.6589144079321473, "mean_env_wait_ms": 3.6537667277305452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563549041748047, "StateBufferConnector_ms": 0.010595083236694336, "ViewRequirementAgentConnector_ms": 0.34037256240844727}, "num_episodes": 18, "episode_return_max": 537.6976375565887, "episode_return_min": 426.35711074394396, "episode_return_mean": 486.24638883989707, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 315.57901629708005, "num_env_steps_trained_throughput_per_sec": 315.57901629708005, "timesteps_total": 123904, "num_env_steps_sampled_lifetime": 123904, "num_agent_steps_sampled_lifetime": 123904, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 123904, "timers": {"training_iteration_time_ms": 3103.448, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3103.346, "sample_time_ms": 1311.835, "learn_time_ms": 1766.269, "learn_throughput": 579.753, "synch_weights_time_ms": 24.951}, "counters": {"num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "done": false, "training_iteration": 121, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-13", "timestamp": 1744127473, "time_this_iter_s": 3.252784252166748, "time_total_s": 489.86354994773865, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.86354994773865, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 55.175000000000004, "ram_util_percent": 92.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8844881024211646, "cur_kl_coeff": 7.523163845262639e-38, "cur_lr": 1e-07, "total_loss": 2.1958518385887147, "policy_loss": -8.251258987002075e-05, "vf_loss": 9.990486478805542, "vf_explained_var": -5.749240517616272e-06, "kl": 1.4859828661784035e-06, "entropy": 3.0168726220726967, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "env_runners": {"episode_reward_max": 537.6976375565887, "episode_reward_min": 426.35711074394396, "episode_reward_mean": 487.20696992262873, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.35711074394396}, "policy_reward_max": {"tplp_policy": 537.6976375565887}, "policy_reward_mean": {"tplp_policy": 487.20696992262873}, "custom_metrics": {"mean_episode_reward_mean": 487.20696992262873, "mean_episode_reward_min": 426.35711074394396, "mean_episode_reward_max": 537.6976375565887}, "hist_stats": {"episode_reward": [515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [515.6765287466321, 465.1852890474615, 495.87690440514433, 426.35711074394396, 484.52028568724387, 509.3395305294664, 460.2870455482732, 497.3079630561094, 473.1172036079077, 486.9229106838868, 493.1777815942539, 487.0587641320286, 461.49025168239746, 490.9853388259189, 486.89549242103243, 469.5894144028053, 472.3188761229229, 485.9514099097387, 500.0686048533586, 473.10633334692244, 439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2095666744408964, "mean_inference_ms": 3.5308389401922535, "mean_action_processing_ms": 0.6581508869122428, "mean_env_wait_ms": 3.648719413584092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01253652572631836, "StateBufferConnector_ms": 0.011099576950073242, "ViewRequirementAgentConnector_ms": 0.3099172115325928}, "num_episodes": 22, "episode_return_max": 537.6976375565887, "episode_return_min": 426.35711074394396, "episode_return_mean": 487.20696992262873, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 316.56153446614826, "num_env_steps_trained_throughput_per_sec": 316.56153446614826, "timesteps_total": 124928, "num_env_steps_sampled_lifetime": 124928, "num_agent_steps_sampled_lifetime": 124928, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 124928, "timers": {"training_iteration_time_ms": 3115.554, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3115.452, "sample_time_ms": 1323.546, "learn_time_ms": 1766.161, "learn_throughput": 579.789, "synch_weights_time_ms": 25.504}, "counters": {"num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "done": false, "training_iteration": 122, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-16", "timestamp": 1744127476, "time_this_iter_s": 3.247143030166626, "time_total_s": 493.1106929779053, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07CAE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.1106929779053, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 46.64, "ram_util_percent": 92.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.358858836069703, "cur_kl_coeff": 3.7615819226313197e-38, "cur_lr": 1e-07, "total_loss": 2.195605826377869, "policy_loss": -0.0001273943082196638, "vf_loss": 9.990413641929626, "vf_explained_var": -5.251914262771606e-06, "kl": 2.21103851145571e-06, "entropy": 3.018701834976673, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "env_runners": {"episode_reward_max": 537.6976375565887, "episode_reward_min": 439.46277583185855, "episode_reward_mean": 486.3419338159345, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.46277583185855}, "policy_reward_max": {"tplp_policy": 537.6976375565887}, "policy_reward_mean": {"tplp_policy": 486.3419338159345}, "custom_metrics": {"mean_episode_reward_mean": 486.3419338159345, "mean_episode_reward_min": 439.46277583185855, "mean_episode_reward_max": 537.6976375565887}, "hist_stats": {"episode_reward": [439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [439.594929401433, 511.19388965993716, 488.5293288438246, 505.27997379132796, 497.18747017691123, 507.06018552071026, 491.9583731863312, 473.2729830409965, 482.2381485147558, 498.1772966310607, 480.05015333738334, 486.85878233973324, 472.05543108058407, 470.05382561710536, 478.20906848693846, 515.6411282385264, 507.70117358987665, 475.37809042841593, 537.6976375565887, 506.88970911293154, 489.1297891325692, 502.5524489491482, 471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2079157307716237, "mean_inference_ms": 3.525861032941963, "mean_action_processing_ms": 0.6573587285249836, "mean_env_wait_ms": 3.644053172282377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013039588928222656, "StateBufferConnector_ms": 0.013031721115112305, "ViewRequirementAgentConnector_ms": 0.3056974411010742}, "num_episodes": 20, "episode_return_max": 537.6976375565887, "episode_return_min": 439.46277583185855, "episode_return_mean": 486.3419338159345, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 340.77089358028763, "num_env_steps_trained_throughput_per_sec": 340.77089358028763, "timesteps_total": 125952, "num_env_steps_sampled_lifetime": 125952, "num_agent_steps_sampled_lifetime": 125952, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 125952, "timers": {"training_iteration_time_ms": 3109.545, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3109.443, "sample_time_ms": 1318.619, "learn_time_ms": 1765.194, "learn_throughput": 580.106, "synch_weights_time_ms": 25.39}, "counters": {"num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "done": false, "training_iteration": 123, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-20", "timestamp": 1744127480, "time_this_iter_s": 3.0145633220672607, "time_total_s": 496.12525629997253, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07C400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 496.12525629997253, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 54.175, "ram_util_percent": 92.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.358702125400305, "cur_kl_coeff": 1.8807909613156599e-38, "cur_lr": 1e-07, "total_loss": 2.1954768016934394, "policy_loss": -5.612263339571655e-05, "vf_loss": 9.990413492918014, "vf_explained_var": -3.267824649810791e-06, "kl": 1.588638895544392e-06, "entropy": 3.020704436302185, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "env_runners": {"episode_reward_max": 529.082432798147, "episode_reward_min": 439.46277583185855, "episode_reward_mean": 483.4030679108328, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.46277583185855}, "policy_reward_max": {"tplp_policy": 529.082432798147}, "policy_reward_mean": {"tplp_policy": 483.4030679108328}, "custom_metrics": {"mean_episode_reward_mean": 483.4030679108328, "mean_episode_reward_min": 439.46277583185855, "mean_episode_reward_max": 529.082432798147}, "hist_stats": {"episode_reward": [471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.27249340997025, 472.20546293422353, 523.984838810833, 484.1723444061638, 480.09595765012773, 500.27384555253974, 514.7870347864322, 514.7094101991528, 501.54988530475947, 487.23936914180905, 487.6276629517361, 507.9504388663261, 483.4146816042461, 485.60716174378564, 445.6627666678048, 504.98237689633237, 439.46277583185855, 483.7103160501056, 500.84700152968657, 446.95275575094144, 507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2061512297640693, "mean_inference_ms": 3.519753098461139, "mean_action_processing_ms": 0.6565585398501369, "mean_env_wait_ms": 3.639640677236382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01687145233154297, "StateBufferConnector_ms": 0.012509346008300781, "ViewRequirementAgentConnector_ms": 0.29950928688049316}, "num_episodes": 22, "episode_return_max": 529.082432798147, "episode_return_min": 439.46277583185855, "episode_return_mean": 483.4030679108328, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.0225430992405, "num_env_steps_trained_throughput_per_sec": 322.0225430992405, "timesteps_total": 126976, "num_env_steps_sampled_lifetime": 126976, "num_agent_steps_sampled_lifetime": 126976, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 126976, "timers": {"training_iteration_time_ms": 3118.895, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3118.793, "sample_time_ms": 1320.074, "learn_time_ms": 1773.311, "learn_throughput": 577.451, "synch_weights_time_ms": 25.167}, "counters": {"num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "done": false, "training_iteration": 124, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-23", "timestamp": 1744127483, "time_this_iter_s": 3.1872472763061523, "time_total_s": 499.3125035762787, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.3125035762787, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 55.45, "ram_util_percent": 92.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3974979512393473, "cur_kl_coeff": 9.403954806578299e-39, "cur_lr": 1e-07, "total_loss": 2.197578889876604, "policy_loss": -6.761767435818911e-05, "vf_loss": 9.999665021896362, "vf_explained_var": -5.857273936271667e-06, "kl": 1.378186850242713e-06, "entropy": 3.0226973459124564, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 529.082432798147, "episode_reward_min": 441.01448184253906, "episode_reward_mean": 482.7270460308427, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.01448184253906}, "policy_reward_max": {"tplp_policy": 529.082432798147}, "policy_reward_mean": {"tplp_policy": 482.7270460308427}, "custom_metrics": {"mean_episode_reward_mean": 482.7270460308427, "mean_episode_reward_min": 441.01448184253906, "mean_episode_reward_max": 529.082432798147}, "hist_stats": {"episode_reward": [507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.49522389129334, 494.31887965003136, 494.45024910746196, 489.9295210897918, 489.7439679592664, 441.41794661823593, 463.53649624407296, 483.2709152204199, 463.03226006680393, 469.5019058633406, 499.32366469829094, 519.6100865728346, 481.8458585199111, 527.4183240916318, 501.6294196108743, 463.92387031521923, 498.35316108121566, 463.76011359412973, 519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2044022342909286, "mean_inference_ms": 3.5156591259028995, "mean_action_processing_ms": 0.6556851666311385, "mean_env_wait_ms": 3.634719516301088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016603469848632812, "StateBufferConnector_ms": 0.012514352798461914, "ViewRequirementAgentConnector_ms": 0.2991316318511963}, "num_episodes": 20, "episode_return_max": 529.082432798147, "episode_return_min": 441.01448184253906, "episode_return_mean": 482.7270460308427, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 330.81009161006074, "num_env_steps_trained_throughput_per_sec": 330.81009161006074, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 3129.58, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3129.478, "sample_time_ms": 1321.24, "learn_time_ms": 1782.825, "learn_throughput": 574.369, "synch_weights_time_ms": 25.173}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 125, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-26", "timestamp": 1744127486, "time_this_iter_s": 3.103883743286133, "time_total_s": 502.4163873195648, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 502.4163873195648, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 45.580000000000005, "ram_util_percent": 92.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.370471412688494, "cur_kl_coeff": 4.7019774032891496e-39, "cur_lr": 1e-07, "total_loss": 2.1974392108619214, "policy_loss": -8.838654612191022e-05, "vf_loss": 10.0, "vf_explained_var": -5.7872384786605835e-06, "kl": 1.691903249212423e-06, "entropy": 3.0247240528464316, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "env_runners": {"episode_reward_max": 529.082432798147, "episode_reward_min": 441.01448184253906, "episode_reward_mean": 481.6933769308808, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.01448184253906}, "policy_reward_max": {"tplp_policy": 529.082432798147}, "policy_reward_mean": {"tplp_policy": 481.6933769308808}, "custom_metrics": {"mean_episode_reward_mean": 481.6933769308808, "mean_episode_reward_min": 441.01448184253906, "mean_episode_reward_max": 529.082432798147}, "hist_stats": {"episode_reward": [519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [519.1439682329085, 498.80103375320306, 474.3564566114809, 464.97267055574645, 529.082432798147, 503.10101832974584, 495.1717135712515, 472.63115846142335, 493.9746886997988, 441.01448184253906, 471.7130768972352, 491.7783206201868, 460.97865110719465, 473.8911777488307, 477.43054280296496, 497.94962503084065, 495.58566834399585, 502.5488864461294, 514.3667600560133, 501.1913600850388, 492.00923390244594, 480.72968103614835, 454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2028790311614288, "mean_inference_ms": 3.5109885949712605, "mean_action_processing_ms": 0.6549693393530645, "mean_env_wait_ms": 3.630892948404795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020116806030273438, "StateBufferConnector_ms": 0.007522106170654297, "ViewRequirementAgentConnector_ms": 0.29926133155822754}, "num_episodes": 18, "episode_return_max": 529.082432798147, "episode_return_min": 441.01448184253906, "episode_return_mean": 481.6933769308808, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 274.74112542625977, "num_env_steps_trained_throughput_per_sec": 274.74112542625977, "timesteps_total": 129024, "num_env_steps_sampled_lifetime": 129024, "num_agent_steps_sampled_lifetime": 129024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 3172.554, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3172.452, "sample_time_ms": 1319.995, "learn_time_ms": 1826.86, "learn_throughput": 560.525, "synch_weights_time_ms": 25.462}, "counters": {"num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "done": false, "training_iteration": 126, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-30", "timestamp": 1744127490, "time_this_iter_s": 3.734739303588867, "time_total_s": 506.1511266231537, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.1511266231537, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 59.220000000000006, "ram_util_percent": 93.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.147790277004242, "cur_kl_coeff": 2.3509887016445748e-39, "cur_lr": 1e-07, "total_loss": 2.197146175801754, "policy_loss": 6.096321158111095e-07, "vf_loss": 9.999172198772431, "vf_explained_var": -6.16610050201416e-06, "kl": 5.667631475247958e-07, "entropy": 3.0264748871326446, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "env_runners": {"episode_reward_max": 535.5257035612274, "episode_reward_min": 441.74559244507384, "episode_reward_mean": 480.46751137358655, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.74559244507384}, "policy_reward_max": {"tplp_policy": 535.5257035612274}, "policy_reward_mean": {"tplp_policy": 480.46751137358655}, "custom_metrics": {"mean_episode_reward_mean": 480.46751137358655, "mean_episode_reward_min": 441.74559244507384, "mean_episode_reward_max": 535.5257035612274}, "hist_stats": {"episode_reward": [454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [454.337168361623, 496.04636758628465, 466.78493313956403, 463.8386963593889, 452.33922993430525, 521.29422995043, 459.8940443423996, 460.58884390880803, 472.979496876444, 457.9192841082239, 493.1604848514662, 448.7409631747518, 505.699463118522, 499.61292050081505, 476.50240993649015, 480.81457289746794, 484.3515480103272, 481.08585668212027, 477.432929977715, 457.0888081123849, 466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2010715983446794, "mean_inference_ms": 3.5063146217728156, "mean_action_processing_ms": 0.6541408364698481, "mean_env_wait_ms": 3.6268055828561203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02271747589111328, "StateBufferConnector_ms": 0.012009143829345703, "ViewRequirementAgentConnector_ms": 0.3907332420349121}, "num_episodes": 22, "episode_return_max": 535.5257035612274, "episode_return_min": 441.74559244507384, "episode_return_mean": 480.46751137358655, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 235.98576184586116, "num_env_steps_trained_throughput_per_sec": 235.98576184586116, "timesteps_total": 130048, "num_env_steps_sampled_lifetime": 130048, "num_agent_steps_sampled_lifetime": 130048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 130048, "timers": {"training_iteration_time_ms": 3296.6, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3296.498, "sample_time_ms": 1351.889, "learn_time_ms": 1919.302, "learn_throughput": 533.527, "synch_weights_time_ms": 25.172}, "counters": {"num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "done": false, "training_iteration": 127, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-34", "timestamp": 1744127494, "time_this_iter_s": 4.351519584655762, "time_total_s": 510.50264620780945, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 510.50264620780945, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 62.48333333333333, "ram_util_percent": 93.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6046788901090623, "cur_kl_coeff": 1.1754943508222874e-39, "cur_lr": 1e-07, "total_loss": 2.195001073181629, "policy_loss": -0.00019938998739235103, "vf_loss": 9.992287087440491, "vf_explained_var": -4.456564784049988e-06, "kl": 3.2403607736375408e-06, "entropy": 3.028712899982929, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "env_runners": {"episode_reward_max": 535.5257035612274, "episode_reward_min": 441.74559244507384, "episode_reward_mean": 482.34015267412053, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.74559244507384}, "policy_reward_max": {"tplp_policy": 535.5257035612274}, "policy_reward_mean": {"tplp_policy": 482.34015267412053}, "custom_metrics": {"mean_episode_reward_mean": 482.34015267412053, "mean_episode_reward_min": 441.74559244507384, "mean_episode_reward_max": 535.5257035612274}, "hist_stats": {"episode_reward": [466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.40490440810277, 482.38046191616115, 501.6106489060605, 479.16267435826194, 442.24107449851215, 462.16028819882916, 521.1572144644244, 452.9284590022991, 483.65428191494595, 478.84847908730916, 450.9502516480737, 468.044228000359, 493.0087826157358, 482.0789144626987, 507.41589863175756, 461.07793498361605, 490.4753890792511, 487.8443732917524, 462.1884648488473, 514.6687637198274, 479.1780119944624, 447.2536269030594, 494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2002608679613287, "mean_inference_ms": 3.5049683640526093, "mean_action_processing_ms": 0.6538693979899612, "mean_env_wait_ms": 3.6259514665145764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021695852279663086, "StateBufferConnector_ms": 0.010506868362426758, "ViewRequirementAgentConnector_ms": 0.495513916015625}, "num_episodes": 20, "episode_return_max": 535.5257035612274, "episode_return_min": 441.74559244507384, "episode_return_mean": 482.34015267412053, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 262.5179406554576, "num_env_steps_trained_throughput_per_sec": 262.5179406554576, "timesteps_total": 131072, "num_env_steps_sampled_lifetime": 131072, "num_agent_steps_sampled_lifetime": 131072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 131072, "timers": {"training_iteration_time_ms": 3375.777, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3375.524, "sample_time_ms": 1428.671, "learn_time_ms": 1921.445, "learn_throughput": 532.932, "synch_weights_time_ms": 25.407}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "done": false, "training_iteration": 128, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-38", "timestamp": 1744127498, "time_this_iter_s": 3.908719539642334, "time_total_s": 514.4113657474518, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07C540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 514.4113657474518, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 60.56, "ram_util_percent": 93.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1501372631639244, "cur_kl_coeff": 5.877471754111437e-40, "cur_lr": 1e-07, "total_loss": 2.193476591259241, "policy_loss": -0.00014850122970528902, "vf_loss": 9.987149667739867, "vf_explained_var": -4.110857844352722e-06, "kl": 2.4050718982593365e-06, "entropy": 3.0316229298710824, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "env_runners": {"episode_reward_max": 535.5257035612274, "episode_reward_min": 414.10375528288534, "episode_reward_mean": 482.5790151640576, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.10375528288534}, "policy_reward_max": {"tplp_policy": 535.5257035612274}, "policy_reward_mean": {"tplp_policy": 482.5790151640576}, "custom_metrics": {"mean_episode_reward_mean": 482.5790151640576, "mean_episode_reward_min": 414.10375528288534, "mean_episode_reward_max": 535.5257035612274}, "hist_stats": {"episode_reward": [494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [494.07921010815016, 487.6849486581031, 468.8971539018877, 473.3430193619745, 499.0668494212804, 486.6893615691131, 479.56027037135806, 472.1025684826693, 476.4875173249927, 491.0916058448018, 500.55030784062865, 477.00300229117033, 516.1955515992398, 497.4999372191849, 457.435737223865, 497.63381754493156, 497.2656313702846, 469.88826305865507, 494.8481353320771, 475.70529401815656, 488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1994893203051062, "mean_inference_ms": 3.5037758453677825, "mean_action_processing_ms": 0.6535957821040748, "mean_env_wait_ms": 3.6253037153406757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02085590362548828, "StateBufferConnector_ms": 0.01250314712524414, "ViewRequirementAgentConnector_ms": 0.4899752140045166}, "num_episodes": 22, "episode_return_max": 535.5257035612274, "episode_return_min": 414.10375528288534, "episode_return_mean": 482.5790151640576, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.7570391253646, "num_env_steps_trained_throughput_per_sec": 322.7570391253646, "timesteps_total": 132096, "num_env_steps_sampled_lifetime": 132096, "num_agent_steps_sampled_lifetime": 132096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 132096, "timers": {"training_iteration_time_ms": 3381.367, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3381.217, "sample_time_ms": 1431.405, "learn_time_ms": 1923.958, "learn_throughput": 532.236, "synch_weights_time_ms": 25.751}, "counters": {"num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "done": false, "training_iteration": 129, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-41", "timestamp": 1744127501, "time_this_iter_s": 3.1802263259887695, "time_total_s": 517.5915920734406, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA11C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.5915920734406, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 50.56, "ram_util_percent": 93.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193246617168188, "cur_kl_coeff": 2.9387358770557185e-40, "cur_lr": 1e-07, "total_loss": 2.1965898290276527, "policy_loss": -1.7219310393556952e-05, "vf_loss": 10.0, "vf_explained_var": -4.976987838745117e-06, "kl": 1.4457469561079961e-06, "entropy": 3.033929553627968, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "env_runners": {"episode_reward_max": 535.5257035612274, "episode_reward_min": 414.10375528288534, "episode_reward_mean": 483.3616820436585, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.10375528288534}, "policy_reward_max": {"tplp_policy": 535.5257035612274}, "policy_reward_mean": {"tplp_policy": 483.3616820436585}, "custom_metrics": {"mean_episode_reward_mean": 483.3616820436585, "mean_episode_reward_min": 414.10375528288534, "mean_episode_reward_max": 535.5257035612274}, "hist_stats": {"episode_reward": [488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [488.0657978784017, 487.30324678691414, 483.3568988270655, 483.6893952476364, 481.376838858346, 456.4842375833151, 493.919753709464, 472.5348572982161, 477.5074334460157, 443.7286811041774, 504.23550662252785, 479.70512810612445, 481.5196868251835, 486.1858392079461, 456.54385540640874, 502.4843679406694, 475.7355376645106, 523.2603656181145, 462.3365419495347, 471.0691171425645, 535.5257035612274, 488.25099999617646, 497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1990359888053117, "mean_inference_ms": 3.5032344702507077, "mean_action_processing_ms": 0.6534464136390424, "mean_env_wait_ms": 3.6248603972180313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018602848052978516, "StateBufferConnector_ms": 0.012011528015136719, "ViewRequirementAgentConnector_ms": 0.49128150939941406}, "num_episodes": 20, "episode_return_max": 535.5257035612274, "episode_return_min": 414.10375528288534, "episode_return_mean": 483.3616820436585, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.16884859607313, "num_env_steps_trained_throughput_per_sec": 327.16884859607313, "timesteps_total": 133120, "num_env_steps_sampled_lifetime": 133120, "num_agent_steps_sampled_lifetime": 133120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 133120, "timers": {"training_iteration_time_ms": 3402.95, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3402.799, "sample_time_ms": 1442.501, "learn_time_ms": 1934.187, "learn_throughput": 529.421, "synch_weights_time_ms": 26.008}, "counters": {"num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "done": false, "training_iteration": 130, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-45", "timestamp": 1744127505, "time_this_iter_s": 3.138511896133423, "time_total_s": 520.730103969574, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA3920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.730103969574, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 55.175, "ram_util_percent": 92.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.23568232357502, "cur_kl_coeff": 1.4693679385278593e-40, "cur_lr": 1e-07, "total_loss": 2.19631707444787, "policy_loss": -8.75938916578889e-05, "vf_loss": 10.0, "vf_explained_var": -1.7758458852767944e-06, "kl": 1.7228476682618066e-06, "entropy": 3.035953241586685, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "env_runners": {"episode_reward_max": 533.0893988234689, "episode_reward_min": 414.10375528288534, "episode_reward_mean": 482.0389875077589, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.10375528288534}, "policy_reward_max": {"tplp_policy": 533.0893988234689}, "policy_reward_mean": {"tplp_policy": 482.0389875077589}, "custom_metrics": {"mean_episode_reward_mean": 482.0389875077589, "mean_episode_reward_min": 414.10375528288534, "mean_episode_reward_max": 533.0893988234689}, "hist_stats": {"episode_reward": [497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.6068390309783, 498.46387536060524, 479.30293285219756, 476.78755066801205, 481.09520761252315, 472.9822517511732, 464.21495751536287, 441.74559244507384, 474.0417822971097, 476.8913862726091, 511.34738337188537, 477.2638561554577, 446.9081459725719, 479.10246120941997, 496.4747177430337, 499.4288450136938, 457.9345451473346, 511.3668925656816, 473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1984979279573473, "mean_inference_ms": 3.501747457071372, "mean_action_processing_ms": 0.6532036784572333, "mean_env_wait_ms": 3.624744442849781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011327028274536133, "StateBufferConnector_ms": 0.013504266738891602, "ViewRequirementAgentConnector_ms": 0.4557926654815674}, "num_episodes": 22, "episode_return_max": 533.0893988234689, "episode_return_min": 414.10375528288534, "episode_return_mean": 482.0389875077589, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 290.8886608569313, "num_env_steps_trained_throughput_per_sec": 290.8886608569313, "timesteps_total": 134144, "num_env_steps_sampled_lifetime": 134144, "num_agent_steps_sampled_lifetime": 134144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 134144, "timers": {"training_iteration_time_ms": 3430.491, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3430.34, "sample_time_ms": 1449.32, "learn_time_ms": 1954.55, "learn_throughput": 523.906, "synch_weights_time_ms": 26.368}, "counters": {"num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "done": false, "training_iteration": 131, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-48", "timestamp": 1744127508, "time_this_iter_s": 3.5301907062530518, "time_total_s": 524.260294675827, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA11C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.260294675827, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 57.17999999999999, "ram_util_percent": 93.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0206435713917017, "cur_kl_coeff": 7.346839692639296e-41, "cur_lr": 1e-07, "total_loss": 2.1915376968681812, "policy_loss": -7.643618737347424e-05, "vf_loss": 9.981532204151154, "vf_explained_var": -5.78463077545166e-06, "kl": 1.2301258323049736e-06, "entropy": 3.0376891404390336, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "env_runners": {"episode_reward_max": 533.0893988234689, "episode_reward_min": 414.10375528288534, "episode_reward_mean": 484.1772559334594, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.10375528288534}, "policy_reward_max": {"tplp_policy": 533.0893988234689}, "policy_reward_mean": {"tplp_policy": 484.1772559334594}, "custom_metrics": {"mean_episode_reward_mean": 484.1772559334594, "mean_episode_reward_min": 414.10375528288534, "mean_episode_reward_max": 533.0893988234689}, "hist_stats": {"episode_reward": [473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.01037015930194, 473.4496635995541, 465.3282618129509, 445.9553141594092, 487.7306221470564, 482.61802587286365, 512.5116848500782, 506.6821872460869, 483.50117524553167, 484.68175807687595, 509.2441486582657, 477.30246985790484, 477.43153645529964, 501.580409750622, 466.12950994194586, 505.659349729935, 481.444645782286, 494.21381082395095, 469.15770618356544, 533.0893988234689, 497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1977500767050329, "mean_inference_ms": 3.5012626756914416, "mean_action_processing_ms": 0.6528795522943354, "mean_env_wait_ms": 3.622742222140542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009837865829467773, "StateBufferConnector_ms": 0.009509086608886719, "ViewRequirementAgentConnector_ms": 0.398540735244751}, "num_episodes": 18, "episode_return_max": 533.0893988234689, "episode_return_min": 414.10375528288534, "episode_return_mean": 484.1772559334594, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 337.68327976223145, "num_env_steps_trained_throughput_per_sec": 337.68327976223145, "timesteps_total": 135168, "num_env_steps_sampled_lifetime": 135168, "num_agent_steps_sampled_lifetime": 135168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 135168, "timers": {"training_iteration_time_ms": 3410.258, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3410.107, "sample_time_ms": 1440.154, "learn_time_ms": 1944.184, "learn_throughput": 526.699, "synch_weights_time_ms": 25.667}, "counters": {"num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "done": false, "training_iteration": 132, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-51", "timestamp": 1744127511, "time_this_iter_s": 3.0405654907226562, "time_total_s": 527.3008601665497, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.3008601665497, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 52.175000000000004, "ram_util_percent": 92.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.380651307851076, "cur_kl_coeff": 3.673419846319648e-41, "cur_lr": 1e-07, "total_loss": 2.1941278144717216, "policy_loss": -9.881459409371019e-05, "vf_loss": 9.992451292276382, "vf_explained_var": -5.711987614631653e-06, "kl": 1.2364565949329886e-06, "entropy": 3.038861906528473, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "env_runners": {"episode_reward_max": 520.359703737037, "episode_reward_min": 414.10375528288534, "episode_reward_mean": 483.36031225123605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.10375528288534}, "policy_reward_max": {"tplp_policy": 520.359703737037}, "policy_reward_mean": {"tplp_policy": 483.36031225123605}, "custom_metrics": {"mean_episode_reward_mean": 483.36031225123605, "mean_episode_reward_min": 414.10375528288534, "mean_episode_reward_max": 520.359703737037}, "hist_stats": {"episode_reward": [497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.8139673481054, 480.21672410657413, 478.72175362454476, 476.7315001631493, 471.0310157974023, 507.48965897993094, 484.13188554518, 500.62916029841386, 435.4112390997794, 493.7673358760693, 414.10375528288534, 496.9806232769998, 508.4101656706547, 479.81139813728385, 447.990858662266, 475.86902550731804, 482.2335833268768, 499.7613804205943, 481.95086811561083, 423.3163716813775, 488.2728453278241, 508.9512564963519, 468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1962027918279967, "mean_inference_ms": 3.4969511612586475, "mean_action_processing_ms": 0.6520263140576649, "mean_env_wait_ms": 3.618703915736292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007852554321289062, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.293323278427124}, "num_episodes": 20, "episode_return_max": 520.359703737037, "episode_return_min": 414.10375528288534, "episode_return_mean": 483.36031225123605, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 336.13639274303, "num_env_steps_trained_throughput_per_sec": 336.13639274303, "timesteps_total": 136192, "num_env_steps_sampled_lifetime": 136192, "num_agent_steps_sampled_lifetime": 136192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 136192, "timers": {"training_iteration_time_ms": 3414.401, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3414.25, "sample_time_ms": 1437.585, "learn_time_ms": 1950.051, "learn_throughput": 525.114, "synch_weights_time_ms": 26.512}, "counters": {"num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "done": false, "training_iteration": 133, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-55", "timestamp": 1744127515, "time_this_iter_s": 3.0543150901794434, "time_total_s": 530.3551752567291, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 530.3551752567291, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 44.3, "ram_util_percent": 92.88000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.482524022459984, "cur_kl_coeff": 1.836709923159824e-41, "cur_lr": 1e-07, "total_loss": 2.1947478339076043, "policy_loss": -7.481530192308128e-05, "vf_loss": 9.99578679203987, "vf_explained_var": -5.5979937314987184e-06, "kl": 2.857138188039343e-06, "entropy": 3.0412404268980024, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "env_runners": {"episode_reward_max": 520.359703737037, "episode_reward_min": 433.44002873266055, "episode_reward_mean": 483.603815983119, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.44002873266055}, "policy_reward_max": {"tplp_policy": 520.359703737037}, "policy_reward_mean": {"tplp_policy": 483.603815983119}, "custom_metrics": {"mean_episode_reward_mean": 483.603815983119, "mean_episode_reward_min": 433.44002873266055, "mean_episode_reward_max": 520.359703737037}, "hist_stats": {"episode_reward": [468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.29549003280505, 498.0125006386938, 452.8139273580959, 468.44539311414906, 485.6949289561487, 499.6390939319528, 489.92696971104226, 491.0742984186807, 477.6834433790067, 490.57742249970664, 492.4622299966524, 479.2214081759437, 520.359703737037, 496.30745064509546, 509.6625514895361, 469.4435960769716, 502.91392866905767, 501.5364318478763, 501.398282548889, 463.52575337482426, 492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1945030682414959, "mean_inference_ms": 3.492401719287948, "mean_action_processing_ms": 0.6512193490198065, "mean_env_wait_ms": 3.614571733605948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006684541702270508, "StateBufferConnector_ms": 0.007824897766113281, "ViewRequirementAgentConnector_ms": 0.31635165214538574}, "num_episodes": 22, "episode_return_max": 520.359703737037, "episode_return_min": 433.44002873266055, "episode_return_mean": 483.603815983119, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.8977100519848, "num_env_steps_trained_throughput_per_sec": 318.8977100519848, "timesteps_total": 137216, "num_env_steps_sampled_lifetime": 137216, "num_agent_steps_sampled_lifetime": 137216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 137216, "timers": {"training_iteration_time_ms": 3417.517, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3417.366, "sample_time_ms": 1450.095, "learn_time_ms": 1940.573, "learn_throughput": 527.679, "synch_weights_time_ms": 26.596}, "counters": {"num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "done": false, "training_iteration": 134, "trial_id": "f7884_00000", "date": "2025-04-08_23-51-58", "timestamp": 1744127518, "time_this_iter_s": 3.2184526920318604, "time_total_s": 533.573627948761, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.573627948761, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 57.925000000000004, "ram_util_percent": 92.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.527163053303957, "cur_kl_coeff": 9.18354961579912e-42, "cur_lr": 1e-07, "total_loss": 2.192934227734804, "policy_loss": -0.0001745481160469353, "vf_loss": 9.990407627820968, "vf_explained_var": -6.384402513504028e-06, "kl": 3.091360571261248e-06, "entropy": 3.0449311837553976, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "env_runners": {"episode_reward_max": 528.0396068126203, "episode_reward_min": 433.44002873266055, "episode_reward_mean": 482.66838940999713, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.44002873266055}, "policy_reward_max": {"tplp_policy": 528.0396068126203}, "policy_reward_mean": {"tplp_policy": 482.66838940999713}, "custom_metrics": {"mean_episode_reward_mean": 482.66838940999713, "mean_episode_reward_min": 433.44002873266055, "mean_episode_reward_max": 528.0396068126203}, "hist_stats": {"episode_reward": [492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [492.7506484803224, 491.02362408040153, 474.27191657649917, 473.16995660043045, 464.83329603980394, 479.1323806870714, 480.47139655603536, 490.00855777641607, 497.2416788636862, 470.8310836227571, 477.7587208471601, 495.27261621784487, 455.2741281169695, 491.8462214656345, 444.2500170696057, 464.7313588749767, 484.9428421487742, 451.9133494750163, 490.2478223146654, 467.65468545278196, 512.0350892777645, 488.3865934684168, 498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1929296943669871, "mean_inference_ms": 3.488352844274908, "mean_action_processing_ms": 0.6503719177225711, "mean_env_wait_ms": 3.611166719664064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00968623161315918, "StateBufferConnector_ms": 0.008320808410644531, "ViewRequirementAgentConnector_ms": 0.31289052963256836}, "num_episodes": 20, "episode_return_max": 528.0396068126203, "episode_return_min": 433.44002873266055, "episode_return_mean": 482.66838940999713, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 329.7306280629387, "num_env_steps_trained_throughput_per_sec": 329.7306280629387, "timesteps_total": 138240, "num_env_steps_sampled_lifetime": 138240, "num_agent_steps_sampled_lifetime": 138240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 138240, "timers": {"training_iteration_time_ms": 3418.531, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3418.38, "sample_time_ms": 1462.645, "learn_time_ms": 1929.548, "learn_throughput": 530.694, "synch_weights_time_ms": 26.084}, "counters": {"num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "done": false, "training_iteration": 135, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-01", "timestamp": 1744127521, "time_this_iter_s": 3.114382743835449, "time_total_s": 536.6880106925964, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.6880106925964, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 51.775, "ram_util_percent": 92.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4940617825835942, "cur_kl_coeff": 4.59177480789956e-42, "cur_lr": 1e-07, "total_loss": 2.1904544219374658, "policy_loss": -6.23736937996e-05, "vf_loss": 9.980893731117249, "vf_explained_var": -4.407018423080444e-06, "kl": 1.2282111558903352e-06, "entropy": 3.0470665246248245, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "env_runners": {"episode_reward_max": 528.0396068126203, "episode_reward_min": 433.44002873266055, "episode_reward_mean": 483.28859374678126, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.44002873266055}, "policy_reward_max": {"tplp_policy": 528.0396068126203}, "policy_reward_mean": {"tplp_policy": 483.28859374678126}, "custom_metrics": {"mean_episode_reward_mean": 483.28859374678126, "mean_episode_reward_min": 433.44002873266055, "mean_episode_reward_max": 528.0396068126203}, "hist_stats": {"episode_reward": [498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [498.8679286018305, 515.9667357262873, 497.325152808271, 480.4828150596676, 489.32295889296535, 480.60608317986373, 519.628240604266, 497.01003920641426, 494.11775344208644, 493.0554046444608, 510.10437022649546, 433.44002873266055, 506.55981798307107, 486.6426662251146, 507.2418580828262, 445.9925293923175, 455.90335337571855, 493.7316286509887, 497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1910308230682454, "mean_inference_ms": 3.483222666062834, "mean_action_processing_ms": 0.6494833411947741, "mean_env_wait_ms": 3.606851242127161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00784611701965332, "StateBufferConnector_ms": 0.00867152214050293, "ViewRequirementAgentConnector_ms": 0.3255918025970459}, "num_episodes": 22, "episode_return_max": 528.0396068126203, "episode_return_min": 433.44002873266055, "episode_return_mean": 483.28859374678126, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 331.15578149195954, "num_env_steps_trained_throughput_per_sec": 331.15578149195954, "timesteps_total": 139264, "num_env_steps_sampled_lifetime": 139264, "num_agent_steps_sampled_lifetime": 139264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 139264, "timers": {"training_iteration_time_ms": 3355.036, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3354.885, "sample_time_ms": 1446.938, "learn_time_ms": 1881.587, "learn_throughput": 544.222, "synch_weights_time_ms": 26.258}, "counters": {"num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "done": false, "training_iteration": 136, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-04", "timestamp": 1744127524, "time_this_iter_s": 3.109682083129883, "time_total_s": 539.7976927757263, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1451C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.7976927757263, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 49.199999999999996, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.286969096586108, "cur_kl_coeff": 2.29588740394978e-42, "cur_lr": 1e-07, "total_loss": 2.194153141975403, "policy_loss": -5.946945457253605e-05, "vf_loss": 9.996171915531159, "vf_explained_var": -5.856156349182129e-06, "kl": 9.983153928472267e-07, "entropy": 3.0483035549521444, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "env_runners": {"episode_reward_max": 528.0396068126203, "episode_reward_min": 437.9864266452309, "episode_reward_mean": 483.36882562741016, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.9864266452309}, "policy_reward_max": {"tplp_policy": 528.0396068126203}, "policy_reward_mean": {"tplp_policy": 483.36882562741016}, "custom_metrics": {"mean_episode_reward_mean": 483.36882562741016, "mean_episode_reward_min": 437.9864266452309, "mean_episode_reward_max": 528.0396068126203}, "hist_stats": {"episode_reward": [497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.3946643309902, 472.72627314734206, 485.18171264570856, 504.2699561856604, 481.1944902897624, 488.5270333423312, 482.36131914660143, 478.4315747930882, 500.787634694593, 477.9903155389373, 481.3039822483649, 473.21745972545915, 493.3841863387073, 469.22520846778616, 504.8004661196445, 487.0437104004922, 441.74229883725445, 479.8104126751804, 471.41566425500974, 451.444456428814, 497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1894692454349292, "mean_inference_ms": 3.4791340123655248, "mean_action_processing_ms": 0.6488282504087068, "mean_env_wait_ms": 3.603473398107779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009840250015258789, "StateBufferConnector_ms": 0.009676694869995117, "ViewRequirementAgentConnector_ms": 0.3364219665527344}, "num_episodes": 18, "episode_return_max": 528.0396068126203, "episode_return_min": 437.9864266452309, "episode_return_mean": 483.36882562741016, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.580054426692, "num_env_steps_trained_throughput_per_sec": 322.580054426692, "timesteps_total": 140288, "num_env_steps_sampled_lifetime": 140288, "num_agent_steps_sampled_lifetime": 140288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 140288, "timers": {"training_iteration_time_ms": 3238.552, "restore_workers_time_ms": 0.151, "training_step_time_ms": 3238.401, "sample_time_ms": 1423.247, "learn_time_ms": 1788.998, "learn_throughput": 572.388, "synch_weights_time_ms": 26.054}, "counters": {"num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "done": false, "training_iteration": 137, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-07", "timestamp": 1744127527, "time_this_iter_s": 3.1829233169555664, "time_total_s": 542.9806160926819, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07FB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 542.9806160926819, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 50.32, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3236334484070538, "cur_kl_coeff": 1.14794370197489e-42, "cur_lr": 1e-07, "total_loss": 2.192122908681631, "policy_loss": -0.00010909593547694385, "vf_loss": 9.989211368560792, "vf_explained_var": -5.3960829973220825e-06, "kl": 2.991642175920184e-06, "entropy": 3.050708344578743, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "env_runners": {"episode_reward_max": 530.3051369540736, "episode_reward_min": 437.9864266452309, "episode_reward_mean": 485.2309534907939, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.9864266452309}, "policy_reward_max": {"tplp_policy": 530.3051369540736}, "policy_reward_mean": {"tplp_policy": 485.2309534907939}, "custom_metrics": {"mean_episode_reward_mean": 485.2309534907939, "mean_episode_reward_min": 437.9864266452309, "mean_episode_reward_max": 530.3051369540736}, "hist_stats": {"episode_reward": [497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.06065625317115, 490.0482823825172, 470.6737378787452, 471.2561772733875, 499.39967426174803, 488.5585913167666, 471.81204383757955, 475.080376560824, 473.75519900574557, 462.9177144743311, 449.36934761707755, 490.1730806044684, 515.4500058572147, 494.1602433117383, 480.1191322590123, 473.05835227626653, 482.70480646165566, 467.52375417559404, 505.0575144716062, 476.90793497021593, 477.13057592129405, 499.9215179153036, 470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1877859552566883, "mean_inference_ms": 3.474693448908297, "mean_action_processing_ms": 0.6480572544877735, "mean_env_wait_ms": 3.5997799178480783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012333869934082031, "StateBufferConnector_ms": 0.009696722030639648, "ViewRequirementAgentConnector_ms": 0.3380250930786133}, "num_episodes": 20, "episode_return_max": 530.3051369540736, "episode_return_min": 437.9864266452309, "episode_return_mean": 485.2309534907939, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 341.2280056020611, "num_env_steps_trained_throughput_per_sec": 341.2280056020611, "timesteps_total": 141312, "num_env_steps_sampled_lifetime": 141312, "num_agent_steps_sampled_lifetime": 141312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 141312, "timers": {"training_iteration_time_ms": 3148.576, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3148.576, "sample_time_ms": 1339.854, "learn_time_ms": 1783.438, "learn_throughput": 574.172, "synch_weights_time_ms": 25.182}, "counters": {"num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "done": false, "training_iteration": 138, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-11", "timestamp": 1744127531, "time_this_iter_s": 3.010931968688965, "time_total_s": 545.9915480613708, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 545.9915480613708, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 52.75, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5845505889505147, "cur_kl_coeff": 5.73971850987445e-43, "cur_lr": 1e-07, "total_loss": 2.1930938117206096, "policy_loss": -0.00016613452462479472, "vf_loss": 9.994796627759934, "vf_explained_var": -6.943568587303162e-06, "kl": 3.106705878241911e-06, "entropy": 3.0543920770287514, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "env_runners": {"episode_reward_max": 530.3051369540736, "episode_reward_min": 437.9864266452309, "episode_reward_mean": 486.3614162559276, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.9864266452309}, "policy_reward_max": {"tplp_policy": 530.3051369540736}, "policy_reward_mean": {"tplp_policy": 486.3614162559276}, "custom_metrics": {"mean_episode_reward_mean": 486.3614162559276, "mean_episode_reward_min": 437.9864266452309, "mean_episode_reward_max": 530.3051369540736}, "hist_stats": {"episode_reward": [470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.4557731175059, 474.4079465806004, 497.5548122784194, 472.23453739316756, 528.0396068126203, 499.9241798571753, 470.7804572981528, 524.7444559499002, 471.5277496398107, 460.66338489335374, 496.4307064455812, 499.0173503169047, 457.97428851206956, 507.7238449548762, 466.2878878048022, 443.65544366514297, 468.75772966823416, 478.21989826506484, 473.73136169029726, 479.49081176595604, 491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1857769048765623, "mean_inference_ms": 3.469428558887481, "mean_action_processing_ms": 0.6471186340155917, "mean_env_wait_ms": 3.5952083844404426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999917984008789, "StateBufferConnector_ms": 0.00837397575378418, "ViewRequirementAgentConnector_ms": 0.3515357971191406}, "num_episodes": 22, "episode_return_max": 530.3051369540736, "episode_return_min": 437.9864266452309, "episode_return_mean": 486.3614162559276, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 334.48697531288207, "num_env_steps_trained_throughput_per_sec": 334.48697531288207, "timesteps_total": 142336, "num_env_steps_sampled_lifetime": 142336, "num_agent_steps_sampled_lifetime": 142336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 142336, "timers": {"training_iteration_time_ms": 3137.45, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3137.45, "sample_time_ms": 1331.088, "learn_time_ms": 1780.769, "learn_throughput": 575.032, "synch_weights_time_ms": 25.593}, "counters": {"num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "done": false, "training_iteration": 139, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-14", "timestamp": 1744127534, "time_this_iter_s": 3.072828769683838, "time_total_s": 549.0643768310547, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.0643768310547, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 47.86, "ram_util_percent": 92.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.363943811133504, "cur_kl_coeff": 2.869859254937225e-43, "cur_lr": 1e-07, "total_loss": 2.191734989732504, "policy_loss": -0.00012154326541349291, "vf_loss": 9.99040400981903, "vf_explained_var": -5.957484245300293e-06, "kl": 2.474478531233615e-06, "entropy": 3.0574444741010667, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "env_runners": {"episode_reward_max": 530.3051369540736, "episode_reward_min": 437.9864266452309, "episode_reward_mean": 487.1778419033385, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.9864266452309}, "policy_reward_max": {"tplp_policy": 530.3051369540736}, "policy_reward_mean": {"tplp_policy": 487.1778419033385}, "custom_metrics": {"mean_episode_reward_mean": 487.1778419033385, "mean_episode_reward_min": 437.9864266452309, "mean_episode_reward_max": 530.3051369540736}, "hist_stats": {"episode_reward": [491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.5457046902236, 461.3378437809882, 499.0801001667714, 486.7263266734087, 464.6402369389846, 462.1262418374093, 468.8132635580063, 471.7707050008507, 480.8778084701694, 527.1613730313804, 437.9864266452309, 474.9862893345549, 482.9068481904209, 473.38019235219934, 468.1665046394041, 526.5214591531638, 478.35794118895484, 507.1622279959218, 495.38666465131104, 487.91208593584645, 482.4622796623519, 500.5867967932673, 500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.184029701668227, "mean_inference_ms": 3.46452186523046, "mean_action_processing_ms": 0.646280335788569, "mean_env_wait_ms": 3.5910475256981673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010994911193847656, "StateBufferConnector_ms": 0.0073680877685546875, "ViewRequirementAgentConnector_ms": 0.34808945655822754}, "num_episodes": 20, "episode_return_max": 530.3051369540736, "episode_return_min": 437.9864266452309, "episode_return_mean": 487.1778419033385, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.2205652879999, "num_env_steps_trained_throughput_per_sec": 328.2205652879999, "timesteps_total": 143360, "num_env_steps_sampled_lifetime": 143360, "num_agent_steps_sampled_lifetime": 143360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 143360, "timers": {"training_iteration_time_ms": 3136.447, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3136.447, "sample_time_ms": 1326.681, "learn_time_ms": 1783.411, "learn_throughput": 574.18, "synch_weights_time_ms": 26.205}, "counters": {"num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "done": false, "training_iteration": 140, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-17", "timestamp": 1744127537, "time_this_iter_s": 3.128535509109497, "time_total_s": 552.1929123401642, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07CCC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 552.1929123401642, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1607589162886143, "cur_kl_coeff": 1.4349296274686126e-43, "cur_lr": 1e-07, "total_loss": 2.1940244920551777, "policy_loss": -3.295873175375163e-05, "vf_loss": 10.0, "vf_explained_var": -5.99399209022522e-06, "kl": 1.091000241881801e-06, "entropy": 3.059425288438797, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "env_runners": {"episode_reward_max": 530.3051369540736, "episode_reward_min": 445.54378431092476, "episode_reward_mean": 488.9511727685925, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.54378431092476}, "policy_reward_max": {"tplp_policy": 530.3051369540736}, "policy_reward_mean": {"tplp_policy": 488.9511727685925}, "custom_metrics": {"mean_episode_reward_mean": 488.9511727685925, "mean_episode_reward_min": 445.54378431092476, "mean_episode_reward_max": 530.3051369540736}, "hist_stats": {"episode_reward": [500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [500.72794483196316, 484.4193524666172, 494.8111908745686, 510.6457823987652, 496.3370295394725, 507.22455051932474, 481.23805439340987, 480.7078928011248, 506.36370323195797, 496.58012968443614, 475.9232065094857, 460.08478132014244, 488.77240278393, 476.1362903171751, 471.1002106458689, 499.9009541243335, 473.01256121837304, 457.76009016246036, 467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1821206605976007, "mean_inference_ms": 3.459278353910477, "mean_action_processing_ms": 0.645311074918366, "mean_env_wait_ms": 3.586696975880155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014010190963745117, "StateBufferConnector_ms": 0.0060176849365234375, "ViewRequirementAgentConnector_ms": 0.31325531005859375}, "num_episodes": 22, "episode_return_max": 530.3051369540736, "episode_return_min": 445.54378431092476, "episode_return_mean": 488.9511727685925, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.8812697517261, "num_env_steps_trained_throughput_per_sec": 322.8812697517261, "timesteps_total": 144384, "num_env_steps_sampled_lifetime": 144384, "num_agent_steps_sampled_lifetime": 144384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 144384, "timers": {"training_iteration_time_ms": 3101.567, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3101.567, "sample_time_ms": 1302.847, "learn_time_ms": 1771.725, "learn_throughput": 577.968, "synch_weights_time_ms": 26.845}, "counters": {"num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "done": false, "training_iteration": 141, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-20", "timestamp": 1744127540, "time_this_iter_s": 3.1853771209716797, "time_total_s": 555.3782894611359, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 555.3782894611359, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 52.55, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3170712433755396, "cur_kl_coeff": 7.174648137343063e-44, "cur_lr": 1e-07, "total_loss": 2.1937275275588037, "policy_loss": -0.0001256120565813035, "vf_loss": 10.0, "vf_explained_var": -6.0301274061203005e-06, "kl": 2.2737411623743877e-06, "entropy": 3.061468669772148, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "env_runners": {"episode_reward_max": 530.3051369540736, "episode_reward_min": 445.54378431092476, "episode_reward_mean": 490.51668980412194, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.54378431092476}, "policy_reward_max": {"tplp_policy": 530.3051369540736}, "policy_reward_mean": {"tplp_policy": 490.51668980412194}, "custom_metrics": {"mean_episode_reward_mean": 490.51668980412194, "mean_episode_reward_min": 445.54378431092476, "mean_episode_reward_max": 530.3051369540736}, "hist_stats": {"episode_reward": [467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.262347188711, 478.17797455846875, 483.9896937605652, 474.72834647589974, 503.6422565290362, 477.80360270440315, 497.05521467325417, 497.722335594119, 490.80071560321807, 474.0296217110005, 530.3051369540736, 525.6492666366474, 522.310442302975, 498.6359973402301, 515.542604037192, 460.01805494912367, 483.3887465469399, 496.6305970034074, 507.45941400263746, 472.88178316066126, 511.0050625065772, 508.3749611434606, 490.1924182621324, 447.95436805934224, 501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.180644779557254, "mean_inference_ms": 3.4549708916316364, "mean_action_processing_ms": 0.6444685376859376, "mean_env_wait_ms": 3.583040183819135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012687444686889648, "StateBufferConnector_ms": 0.005016803741455078, "ViewRequirementAgentConnector_ms": 0.3236398696899414}, "num_episodes": 18, "episode_return_max": 530.3051369540736, "episode_return_min": 445.54378431092476, "episode_return_mean": 490.51668980412194, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 341.46136528026204, "num_env_steps_trained_throughput_per_sec": 341.46136528026204, "timesteps_total": 145408, "num_env_steps_sampled_lifetime": 145408, "num_agent_steps_sampled_lifetime": 145408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 145408, "timers": {"training_iteration_time_ms": 3098.212, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3098.212, "sample_time_ms": 1296.172, "learn_time_ms": 1774.841, "learn_throughput": 576.953, "synch_weights_time_ms": 27.049}, "counters": {"num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "done": false, "training_iteration": 142, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-23", "timestamp": 1744127543, "time_this_iter_s": 3.0081889629364014, "time_total_s": 558.3864784240723, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1463E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 558.3864784240723, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 50.8, "ram_util_percent": 92.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5909989366307853, "cur_kl_coeff": 3.5873240686715314e-44, "cur_lr": 1e-07, "total_loss": 2.1883967719972133, "policy_loss": -0.00017741527408361436, "vf_loss": 9.979720187187194, "vf_explained_var": -3.2860785722732545e-06, "kl": 2.0267763591874655e-06, "entropy": 3.0635585978627207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "env_runners": {"episode_reward_max": 533.3254585045675, "episode_reward_min": 445.54378431092476, "episode_reward_mean": 488.46371961445584, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.54378431092476}, "policy_reward_max": {"tplp_policy": 533.3254585045675}, "policy_reward_mean": {"tplp_policy": 488.46371961445584}, "custom_metrics": {"mean_episode_reward_mean": 488.46371961445584, "mean_episode_reward_min": 445.54378431092476, "mean_episode_reward_max": 533.3254585045675}, "hist_stats": {"episode_reward": [501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [501.8607533158561, 476.7706749654178, 513.9687817832842, 459.6246557317504, 507.62480681124447, 493.2701219954635, 495.6215488793812, 499.5361486632766, 473.06199087039187, 452.1590382306448, 480.3300688499875, 476.51718233497, 488.6772192600294, 501.21332706993985, 445.54378431092476, 521.536885392253, 499.17062862568093, 475.4031276521157, 477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.178904282516079, "mean_inference_ms": 3.4486124183491724, "mean_action_processing_ms": 0.6434178635312992, "mean_env_wait_ms": 3.5788865026142385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012691974639892578, "StateBufferConnector_ms": 0.008578777313232422, "ViewRequirementAgentConnector_ms": 0.3237946033477783}, "num_episodes": 24, "episode_return_max": 533.3254585045675, "episode_return_min": 445.54378431092476, "episode_return_mean": 488.46371961445584, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 333.75692131257375, "num_env_steps_trained_throughput_per_sec": 333.75692131257375, "timesteps_total": 146432, "num_env_steps_sampled_lifetime": 146432, "num_agent_steps_sampled_lifetime": 146432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 146432, "timers": {"training_iteration_time_ms": 3100.384, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3100.384, "sample_time_ms": 1295.358, "learn_time_ms": 1778.609, "learn_throughput": 575.731, "synch_weights_time_ms": 26.267}, "counters": {"num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "done": false, "training_iteration": 143, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-26", "timestamp": 1744127546, "time_this_iter_s": 3.077221393585205, "time_total_s": 561.4636998176575, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 561.4636998176575, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 52.474999999999994, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.410070157237351, "cur_kl_coeff": 1.7936620343357657e-44, "cur_lr": 1e-07, "total_loss": 2.190985814481974, "policy_loss": -0.00013329950743354858, "vf_loss": 9.99040247797966, "vf_explained_var": -6.866455078125e-06, "kl": 1.5430573259589408e-06, "entropy": 3.0648149713873862, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "env_runners": {"episode_reward_max": 533.3254585045675, "episode_reward_min": 438.3335459370572, "episode_reward_mean": 488.08373823512693, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.3335459370572}, "policy_reward_max": {"tplp_policy": 533.3254585045675}, "policy_reward_mean": {"tplp_policy": 488.08373823512693}, "custom_metrics": {"mean_episode_reward_mean": 488.08373823512693, "mean_episode_reward_min": 438.3335459370572, "mean_episode_reward_max": 533.3254585045675}, "hist_stats": {"episode_reward": [477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.6387645509991, 528.8907366349118, 502.45761945196693, 463.02821840269127, 471.05788282057983, 471.42503453337224, 506.20741143000345, 481.69314214219776, 476.3019070538494, 488.79690852542024, 492.5011031428049, 474.79645739567263, 478.9860218423962, 476.6373680531574, 512.1004980177652, 447.4371630415772, 499.30477074289627, 499.4300275906667, 493.7315326927167, 450.2169102945725, 483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.177480839545183, "mean_inference_ms": 3.445205679776173, "mean_action_processing_ms": 0.6426527847455006, "mean_env_wait_ms": 3.5748931107910953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015738964080810547, "StateBufferConnector_ms": 0.007576942443847656, "ViewRequirementAgentConnector_ms": 0.2989234924316406}, "num_episodes": 18, "episode_return_max": 533.3254585045675, "episode_return_min": 438.3335459370572, "episode_return_mean": 488.08373823512693, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 342.78123527007136, "num_env_steps_trained_throughput_per_sec": 342.78123527007136, "timesteps_total": 147456, "num_env_steps_sampled_lifetime": 147456, "num_agent_steps_sampled_lifetime": 147456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 147456, "timers": {"training_iteration_time_ms": 3078.01, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3078.01, "sample_time_ms": 1285.301, "learn_time_ms": 1766.303, "learn_throughput": 579.742, "synch_weights_time_ms": 26.257}, "counters": {"num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "done": false, "training_iteration": 144, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-30", "timestamp": 1744127550, "time_this_iter_s": 2.99698805809021, "time_total_s": 564.4606878757477, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 564.4606878757477, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 52.95, "ram_util_percent": 92.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3161839451640844, "cur_kl_coeff": 8.968310171678829e-45, "cur_lr": 1e-07, "total_loss": 2.186656413972378, "policy_loss": -0.00015289041039068252, "vf_loss": 9.973870307207108, "vf_explained_var": -5.756691098213196e-06, "kl": 2.4569813417196772e-06, "entropy": 3.066582630574703, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "env_runners": {"episode_reward_max": 533.3254585045675, "episode_reward_min": 438.3335459370572, "episode_reward_mean": 488.69874000371107, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.3335459370572}, "policy_reward_max": {"tplp_policy": 533.3254585045675}, "policy_reward_mean": {"tplp_policy": 488.69874000371107}, "custom_metrics": {"mean_episode_reward_mean": 488.69874000371107, "mean_episode_reward_min": 438.3335459370572, "mean_episode_reward_max": 533.3254585045675}, "hist_stats": {"episode_reward": [483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.32817364747683, 498.82603665826093, 509.0087158984541, 489.761230526689, 527.6826216404963, 507.49769154507663, 480.88789983435214, 507.95672591660366, 493.49057657614424, 463.0099351639741, 488.1855518739021, 482.21492968261134, 492.26201109294277, 483.5169926694885, 494.1642610985046, 474.6732919761099, 519.7692598145298, 508.8865146350386, 501.5474109465841, 456.61013303169557, 507.31607790246534, 491.0590661972239, 490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.175876098483607, "mean_inference_ms": 3.440609917400156, "mean_action_processing_ms": 0.6418589789632424, "mean_env_wait_ms": 3.570994272961647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017963886260986328, "StateBufferConnector_ms": 0.007601737976074219, "ViewRequirementAgentConnector_ms": 0.30144548416137695}, "num_episodes": 20, "episode_return_max": 533.3254585045675, "episode_return_min": 438.3335459370572, "episode_return_mean": 488.69874000371107, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 337.56339744309696, "num_env_steps_trained_throughput_per_sec": 337.56339744309696, "timesteps_total": 148480, "num_env_steps_sampled_lifetime": 148480, "num_agent_steps_sampled_lifetime": 148480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 148480, "timers": {"training_iteration_time_ms": 3070.804, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3070.804, "sample_time_ms": 1279.611, "learn_time_ms": 1764.663, "learn_throughput": 580.281, "synch_weights_time_ms": 26.331}, "counters": {"num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "done": false, "training_iteration": 145, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-33", "timestamp": 1744127553, "time_this_iter_s": 3.0423381328582764, "time_total_s": 567.503026008606, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E5C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 567.503026008606, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 44.3, "ram_util_percent": 92.55999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.607092800736427, "cur_kl_coeff": 4.484155085839414e-45, "cur_lr": 1e-07, "total_loss": 2.192982332408428, "policy_loss": -8.234495471697301e-05, "vf_loss": 10.0, "vf_explained_var": -6.526336073875428e-06, "kl": 2.09082484605716e-06, "entropy": 3.0693531706929207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "env_runners": {"episode_reward_max": 533.3254585045675, "episode_reward_min": 438.3335459370572, "episode_reward_mean": 487.4722224575972, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.3335459370572}, "policy_reward_max": {"tplp_policy": 533.3254585045675}, "policy_reward_mean": {"tplp_policy": 487.4722224575972}, "custom_metrics": {"mean_episode_reward_mean": 487.4722224575972, "mean_episode_reward_min": 438.3335459370572, "mean_episode_reward_max": 533.3254585045675}, "hist_stats": {"episode_reward": [490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [490.47280524648505, 500.162470066788, 465.94636061740465, 506.2515450584101, 512.8365198934684, 480.8761798492434, 515.7627461870829, 508.3618437698243, 491.9923505104785, 480.5713784414915, 482.9620136549586, 503.063192018124, 503.2131449867591, 486.8989994285639, 492.5948253640935, 497.95631218347137, 533.3254585045675, 496.52972099315525, 486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1740617997963099, "mean_inference_ms": 3.4354904816434577, "mean_action_processing_ms": 0.6410299297418998, "mean_env_wait_ms": 3.566395762025347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021883010864257812, "StateBufferConnector_ms": 0.013101339340209961, "ViewRequirementAgentConnector_ms": 0.3100559711456299}, "num_episodes": 22, "episode_return_max": 533.3254585045675, "episode_return_min": 438.3335459370572, "episode_return_mean": 487.4722224575972, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 346.82378827163024, "num_env_steps_trained_throughput_per_sec": 346.82378827163024, "timesteps_total": 149504, "num_env_steps_sampled_lifetime": 149504, "num_agent_steps_sampled_lifetime": 149504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 149504, "timers": {"training_iteration_time_ms": 3056.835, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3056.835, "sample_time_ms": 1272.731, "learn_time_ms": 1758.002, "learn_throughput": 582.479, "synch_weights_time_ms": 25.902}, "counters": {"num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "done": false, "training_iteration": 146, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-36", "timestamp": 1744127556, "time_this_iter_s": 2.9605844020843506, "time_total_s": 570.4636104106903, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 570.4636104106903, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 49.050000000000004, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2497856631875037, "cur_kl_coeff": 2.242077542919707e-45, "cur_lr": 1e-07, "total_loss": 2.192746940255165, "policy_loss": -8.689573733136057e-05, "vf_loss": 10.0, "vf_explained_var": -6.899237632751465e-06, "kl": 1.4020682676196828e-06, "entropy": 3.0716615974903108, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "env_runners": {"episode_reward_max": 545.5932757809285, "episode_reward_min": 431.46398000810757, "episode_reward_mean": 485.04130458045336, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.46398000810757}, "policy_reward_max": {"tplp_policy": 545.5932757809285}, "policy_reward_mean": {"tplp_policy": 485.04130458045336}, "custom_metrics": {"mean_episode_reward_mean": 485.04130458045336, "mean_episode_reward_min": 431.46398000810757, "mean_episode_reward_max": 545.5932757809285}, "hist_stats": {"episode_reward": [486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [486.68593608900534, 492.95308538587904, 475.5991118192836, 487.7903719928079, 489.1459943908375, 518.6169877436799, 503.95758416115314, 466.7562781799773, 469.3894721108511, 498.0780795210184, 459.7521390479944, 489.36974949052427, 485.0247499408996, 465.7163256112246, 493.10946086763187, 487.1499951437979, 469.8937485900812, 464.8426067529472, 478.00452299002865, 458.8469918622358, 470.8359731422138, 468.88959840568094, 482.4662463835375, 438.3335459370572, 513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1727004889817914, "mean_inference_ms": 3.4315366059931534, "mean_action_processing_ms": 0.6404021205712586, "mean_env_wait_ms": 3.56308613851215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022208213806152344, "StateBufferConnector_ms": 0.015242576599121094, "ViewRequirementAgentConnector_ms": 0.31615138053894043}, "num_episodes": 18, "episode_return_max": 545.5932757809285, "episode_return_min": 431.46398000810757, "episode_return_mean": 485.04130458045336, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 276.5519622557463, "num_env_steps_trained_throughput_per_sec": 276.5519622557463, "timesteps_total": 150528, "num_env_steps_sampled_lifetime": 150528, "num_agent_steps_sampled_lifetime": 150528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 3109.668, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3109.668, "sample_time_ms": 1277.559, "learn_time_ms": 1806.216, "learn_throughput": 566.931, "synch_weights_time_ms": 25.594}, "counters": {"num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "done": false, "training_iteration": 147, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-39", "timestamp": 1744127559, "time_this_iter_s": 3.71266770362854, "time_total_s": 574.1762781143188, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 574.1762781143188, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 62.29999999999999, "ram_util_percent": 92.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.627750514447689, "cur_kl_coeff": 1.1210387714598536e-45, "cur_lr": 1e-07, "total_loss": 2.1925155624747275, "policy_loss": -6.734359776601195e-05, "vf_loss": 10.0, "vf_explained_var": -4.207342863082886e-06, "kl": 2.590555756620816e-06, "entropy": 3.0741709917783737, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "env_runners": {"episode_reward_max": 545.5932757809285, "episode_reward_min": 431.46398000810757, "episode_reward_mean": 489.0738376453556, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.46398000810757}, "policy_reward_max": {"tplp_policy": 545.5932757809285}, "policy_reward_mean": {"tplp_policy": 489.0738376453556}, "custom_metrics": {"mean_episode_reward_mean": 489.0738376453556, "mean_episode_reward_min": 431.46398000810757, "mean_episode_reward_max": 545.5932757809285}, "hist_stats": {"episode_reward": [513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.5584814141148, 473.2580390241601, 488.3964455058688, 477.4718963225509, 514.6053647955532, 504.2842592914253, 461.72557845327736, 500.46129785861325, 484.5419526908232, 502.56070170017216, 467.4288340729212, 478.52890099296394, 486.1574729044712, 454.9130543410015, 489.5876757784364, 505.612859342788, 497.49341914149676, 511.5049493202044, 487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1710393263029226, "mean_inference_ms": 3.4267660309763737, "mean_action_processing_ms": 0.6396127349061862, "mean_env_wait_ms": 3.5586974177643174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022243499755859375, "StateBufferConnector_ms": 0.017610549926757812, "ViewRequirementAgentConnector_ms": 0.32338643074035645}, "num_episodes": 24, "episode_return_max": 545.5932757809285, "episode_return_min": 431.46398000810757, "episode_return_mean": 489.0738376453556, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 303.2075434375469, "num_env_steps_trained_throughput_per_sec": 303.2075434375469, "timesteps_total": 151552, "num_env_steps_sampled_lifetime": 151552, "num_agent_steps_sampled_lifetime": 151552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 151552, "timers": {"training_iteration_time_ms": 3147.298, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3147.298, "sample_time_ms": 1284.402, "learn_time_ms": 1835.989, "learn_throughput": 557.738, "synch_weights_time_ms": 26.507}, "counters": {"num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "done": false, "training_iteration": 148, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-43", "timestamp": 1744127563, "time_this_iter_s": 3.386021852493286, "time_total_s": 577.5622999668121, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 577.5622999668121, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 52.94, "ram_util_percent": 91.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.272656111419201, "cur_kl_coeff": 5.605193857299268e-46, "cur_lr": 1e-07, "total_loss": 2.189778884500265, "policy_loss": -4.6761971316300335e-05, "vf_loss": 9.990400671958923, "vf_explained_var": -6.983429193496704e-06, "kl": 2.260013451316212e-06, "entropy": 3.077745282649994, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "env_runners": {"episode_reward_max": 545.5932757809285, "episode_reward_min": 431.46398000810757, "episode_reward_mean": 488.6576276372978, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.46398000810757}, "policy_reward_max": {"tplp_policy": 545.5932757809285}, "policy_reward_mean": {"tplp_policy": 488.6576276372978}, "custom_metrics": {"mean_episode_reward_mean": 488.6576276372978, "mean_episode_reward_min": 431.46398000810757, "mean_episode_reward_max": 545.5932757809285}, "hist_stats": {"episode_reward": [487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.928885522982, 488.01098804722164, 485.42306642791596, 484.5457307754356, 506.01756296149716, 470.73236926165856, 477.5844982824868, 515.4588932004549, 483.462922378135, 471.7697575034684, 488.28922437158076, 459.5806525842947, 498.4722310408202, 503.71665647282765, 458.99445264113893, 490.5032924320703, 506.28118165524955, 468.36892119767145, 466.8304899664524, 490.51996577638937, 448.81160243913956, 468.7751952468994, 455.0799136097457, 488.1260773264908, 488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.169941688062556, "mean_inference_ms": 3.423516276838277, "mean_action_processing_ms": 0.63904055622864, "mean_env_wait_ms": 3.555724886642714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0212094783782959, "StateBufferConnector_ms": 0.021601200103759766, "ViewRequirementAgentConnector_ms": 0.3439178466796875}, "num_episodes": 18, "episode_return_max": 545.5932757809285, "episode_return_min": 431.46398000810757, "episode_return_mean": 488.6576276372978, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.09549218444084, "num_env_steps_trained_throughput_per_sec": 285.09549218444084, "timesteps_total": 152576, "num_env_steps_sampled_lifetime": 152576, "num_agent_steps_sampled_lifetime": 152576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 152576, "timers": {"training_iteration_time_ms": 3200.336, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3200.336, "sample_time_ms": 1298.752, "learn_time_ms": 1874.401, "learn_throughput": 546.308, "synch_weights_time_ms": 26.783}, "counters": {"num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "done": false, "training_iteration": 149, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-47", "timestamp": 1744127567, "time_this_iter_s": 3.609995126724243, "time_total_s": 581.1722950935364, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.1722950935364, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 58.78000000000001, "ram_util_percent": 91.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.192599243298173, "cur_kl_coeff": 2.802596928649634e-46, "cur_lr": 1e-07, "total_loss": 2.1918275959789755, "policy_loss": -0.00011975838569924235, "vf_loss": 10.0, "vf_explained_var": -7.4375420808792114e-06, "kl": 2.103834954070294e-06, "entropy": 3.080526328086853, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "env_runners": {"episode_reward_max": 545.5932757809285, "episode_reward_min": 431.46398000810757, "episode_reward_mean": 489.396164759832, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.46398000810757}, "policy_reward_max": {"tplp_policy": 545.5932757809285}, "policy_reward_mean": {"tplp_policy": 489.396164759832}, "custom_metrics": {"mean_episode_reward_mean": 489.396164759832, "mean_episode_reward_min": 431.46398000810757, "mean_episode_reward_max": 545.5932757809285}, "hist_stats": {"episode_reward": [488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [488.7018241442674, 531.7246103398886, 480.5409884584305, 472.85022936258895, 486.9584182416669, 477.2620227267319, 466.6137245311197, 516.7863734821215, 498.7728842265944, 493.74865682776823, 487.3873487119631, 485.98072209297356, 502.76094586426626, 495.747307094354, 524.0296021836268, 510.99445106376305, 475.6850177860162, 545.5932757809285, 450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1687794813421595, "mean_inference_ms": 3.4194201361292533, "mean_action_processing_ms": 0.6383378703360566, "mean_env_wait_ms": 3.5532078903806195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02050471305847168, "StateBufferConnector_ms": 0.022905826568603516, "ViewRequirementAgentConnector_ms": 0.3234279155731201}, "num_episodes": 24, "episode_return_max": 545.5932757809285, "episode_return_min": 431.46398000810757, "episode_return_mean": 489.396164759832, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 316.33378911769597, "num_env_steps_trained_throughput_per_sec": 316.33378911769597, "timesteps_total": 153600, "num_env_steps_sampled_lifetime": 153600, "num_agent_steps_sampled_lifetime": 153600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 3212.059, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3212.059, "sample_time_ms": 1324.422, "learn_time_ms": 1861.604, "learn_throughput": 550.063, "synch_weights_time_ms": 25.782}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "training_iteration": 150, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-50", "timestamp": 1744127570, "time_this_iter_s": 3.244047164916992, "time_total_s": 584.4163422584534, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA11C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 584.4163422584534, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 53.8, "ram_util_percent": 91.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4902860287576916, "cur_kl_coeff": 1.401298464324817e-46, "cur_lr": 1e-07, "total_loss": 2.1870106674730776, "policy_loss": -3.735331119969487e-05, "vf_loss": 9.981141203641892, "vf_explained_var": -7.966905832290649e-06, "kl": 9.924393022053835e-07, "entropy": 3.0823728516697884, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "env_runners": {"episode_reward_max": 540.5687730525915, "episode_reward_min": 431.46398000810757, "episode_reward_mean": 488.16664137550856, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.46398000810757}, "policy_reward_max": {"tplp_policy": 540.5687730525915}, "policy_reward_mean": {"tplp_policy": 488.16664137550856}, "custom_metrics": {"mean_episode_reward_mean": 488.16664137550856, "mean_episode_reward_min": 431.46398000810757, "mean_episode_reward_max": 540.5687730525915}, "hist_stats": {"episode_reward": [450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.18841255555265, 498.51558181228177, 522.5538393253502, 498.63753630298095, 460.4238840045241, 502.28859765236126, 457.08044475714473, 506.70108656646437, 494.163190447263, 473.16757819898055, 455.61429032085374, 489.0737411103252, 469.7074304991433, 431.46398000810757, 490.3379172130047, 485.49027471870494, 518.6808359142433, 487.16069826318164, 489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1679341962514327, "mean_inference_ms": 3.417633109028119, "mean_action_processing_ms": 0.6378038722967463, "mean_env_wait_ms": 3.550257214689103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01657414436340332, "StateBufferConnector_ms": 0.023427724838256836, "ViewRequirementAgentConnector_ms": 0.33539319038391113}, "num_episodes": 18, "episode_return_max": 540.5687730525915, "episode_return_min": 431.46398000810757, "episode_return_mean": 488.16664137550856, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 293.158902071622, "num_env_steps_trained_throughput_per_sec": 293.158902071622, "timesteps_total": 154624, "num_env_steps_sampled_lifetime": 154624, "num_agent_steps_sampled_lifetime": 154624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 154624, "timers": {"training_iteration_time_ms": 3244.213, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3244.213, "sample_time_ms": 1325.514, "learn_time_ms": 1892.588, "learn_throughput": 541.058, "synch_weights_time_ms": 25.862}, "counters": {"num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "done": false, "training_iteration": 151, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-54", "timestamp": 1744127574, "time_this_iter_s": 3.504985809326172, "time_total_s": 587.9213280677795, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 587.9213280677795, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 47.18333333333334, "ram_util_percent": 91.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9720592606812715, "cur_kl_coeff": 7.006492321624085e-47, "cur_lr": 1e-07, "total_loss": 2.1915133975446226, "policy_loss": -3.98119620513171e-05, "vf_loss": 10.0, "vf_explained_var": -8.011236786842346e-06, "kl": 1.7149253545234445e-06, "entropy": 3.084467904269695, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "env_runners": {"episode_reward_max": 540.5687730525915, "episode_reward_min": 444.5491024026567, "episode_reward_mean": 489.6906003595779, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.5491024026567}, "policy_reward_max": {"tplp_policy": 540.5687730525915}, "policy_reward_mean": {"tplp_policy": 489.6906003595779}, "custom_metrics": {"mean_episode_reward_mean": 489.6906003595779, "mean_episode_reward_min": 444.5491024026567, "mean_episode_reward_max": 540.5687730525915}, "hist_stats": {"episode_reward": [489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.8265049320298, 515.4817790463602, 487.7288925624357, 517.2496826171168, 514.614022355752, 503.76306891522063, 521.2688452029006, 486.97320571611135, 518.8264045100487, 511.8028873683468, 508.1058035643506, 503.24192399096574, 496.1632582683465, 485.62244975195097, 484.1530867145281, 472.27465354077634, 480.05843333633663, 489.0403772535342, 498.285737214792, 473.31705564208653, 482.90749194373984, 457.91476342542, 502.8279386008636, 452.662262177011, 476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1670462319710422, "mean_inference_ms": 3.4151387633579855, "mean_action_processing_ms": 0.6373036530949262, "mean_env_wait_ms": 3.5476260742992243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018576860427856445, "StateBufferConnector_ms": 0.02327895164489746, "ViewRequirementAgentConnector_ms": 0.3177454471588135}, "num_episodes": 18, "episode_return_max": 540.5687730525915, "episode_return_min": 444.5491024026567, "episode_return_mean": 489.6906003595779, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 287.70118611494604, "num_env_steps_trained_throughput_per_sec": 287.70118611494604, "timesteps_total": 155648, "num_env_steps_sampled_lifetime": 155648, "num_agent_steps_sampled_lifetime": 155648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 155648, "timers": {"training_iteration_time_ms": 3300.251, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3300.251, "sample_time_ms": 1330.531, "learn_time_ms": 1943.357, "learn_throughput": 526.923, "synch_weights_time_ms": 26.112}, "counters": {"num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "done": false, "training_iteration": 152, "trial_id": "f7884_00000", "date": "2025-04-08_23-52-58", "timestamp": 1744127578, "time_this_iter_s": 3.5696778297424316, "time_total_s": 591.491005897522, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07E5C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 591.491005897522, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 56.15999999999999, "ram_util_percent": 91.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.422914567030966, "cur_kl_coeff": 3.5032461608120424e-47, "cur_lr": 1e-07, "total_loss": 2.1878629453480243, "policy_loss": -2.7815671637654303e-05, "vf_loss": 9.986552917957306, "vf_explained_var": -6.509944796562195e-06, "kl": 2.2177482254637225e-06, "entropy": 3.0874745681881905, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "env_runners": {"episode_reward_max": 540.5687730525915, "episode_reward_min": 444.5491024026567, "episode_reward_mean": 489.0410017937624, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.5491024026567}, "policy_reward_max": {"tplp_policy": 540.5687730525915}, "policy_reward_mean": {"tplp_policy": 489.0410017937624}, "custom_metrics": {"mean_episode_reward_mean": 489.0410017937624, "mean_episode_reward_min": 444.5491024026567, "mean_episode_reward_max": 540.5687730525915}, "hist_stats": {"episode_reward": [476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.6952983946768, 513.4873100739104, 492.65260406965285, 468.9180604432645, 483.9710947042294, 516.9223582362754, 511.7532211638754, 483.5852503759239, 500.0539507605713, 470.6023097064933, 452.3308640835353, 474.6961022141252, 495.13200993728054, 491.8504770292927, 461.73050808529393, 520.5985620887914, 486.6418947002664, 500.5273594876972, 487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1656737363407705, "mean_inference_ms": 3.4115242102904357, "mean_action_processing_ms": 0.636584693557862, "mean_env_wait_ms": 3.5442721257783405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017100811004638672, "StateBufferConnector_ms": 0.017328500747680664, "ViewRequirementAgentConnector_ms": 0.3166801929473877}, "num_episodes": 24, "episode_return_max": 540.5687730525915, "episode_return_min": 444.5491024026567, "episode_return_mean": 489.0410017937624, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 315.9644940012636, "num_env_steps_trained_throughput_per_sec": 315.9644940012636, "timesteps_total": 156672, "num_env_steps_sampled_lifetime": 156672, "num_agent_steps_sampled_lifetime": 156672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 156672, "timers": {"training_iteration_time_ms": 3317.528, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3317.528, "sample_time_ms": 1338.441, "learn_time_ms": 1952.512, "learn_throughput": 524.453, "synch_weights_time_ms": 26.325}, "counters": {"num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "done": false, "training_iteration": 153, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-01", "timestamp": 1744127581, "time_this_iter_s": 3.2491300106048584, "time_total_s": 594.7401359081268, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.7401359081268, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 52.85, "ram_util_percent": 91.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2526260470971464, "cur_kl_coeff": 1.7516230804060212e-47, "cur_lr": 1e-07, "total_loss": 2.186140078306198, "policy_loss": -5.085385637357831e-05, "vf_loss": 9.980885112285614, "vf_explained_var": -6.3445419073104855e-06, "kl": 1.614214922796009e-06, "entropy": 3.090303657948971, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "env_runners": {"episode_reward_max": 540.5687730525915, "episode_reward_min": 443.65858815150466, "episode_reward_mean": 488.2970032237795, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 443.65858815150466}, "policy_reward_max": {"tplp_policy": 540.5687730525915}, "policy_reward_mean": {"tplp_policy": 488.2970032237795}, "custom_metrics": {"mean_episode_reward_mean": 488.2970032237795, "mean_episode_reward_min": 443.65858815150466, "mean_episode_reward_max": 540.5687730525915}, "hist_stats": {"episode_reward": [487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.6573652014725, 501.93832423851876, 488.15440470564164, 487.2207083011237, 478.91247941832324, 484.27674997575974, 475.716821843905, 473.8057321729464, 476.00789483253607, 467.8134276342894, 496.928623015187, 519.5997855782613, 462.4526899175238, 457.2991375964698, 469.1976513686598, 482.0271266990333, 514.5171894122154, 448.9257678472284, 525.463431925802, 459.5253590081921, 474.6812511003666, 517.8470673940247, 482.82719498230836, 494.3311983320877, 492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1645355202215668, "mean_inference_ms": 3.4086314375773026, "mean_action_processing_ms": 0.6360559042164118, "mean_env_wait_ms": 3.5415147202519224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01816582679748535, "StateBufferConnector_ms": 0.017327308654785156, "ViewRequirementAgentConnector_ms": 0.2945694923400879}, "num_episodes": 18, "episode_return_max": 540.5687730525915, "episode_return_min": 443.65858815150466, "episode_return_mean": 488.2970032237795, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 339.6502403073403, "num_env_steps_trained_throughput_per_sec": 339.6502403073403, "timesteps_total": 157696, "num_env_steps_sampled_lifetime": 157696, "num_agent_steps_sampled_lifetime": 157696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 157696, "timers": {"training_iteration_time_ms": 3320.281, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3320.281, "sample_time_ms": 1340.603, "learn_time_ms": 1953.266, "learn_throughput": 524.25, "synch_weights_time_ms": 26.041}, "counters": {"num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "done": false, "training_iteration": 154, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-05", "timestamp": 1744127585, "time_this_iter_s": 3.0245440006256104, "time_total_s": 597.7646799087524, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1467A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 597.7646799087524, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 51.02499999999999, "ram_util_percent": 92.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.306433110125363, "cur_kl_coeff": 8.758115402030106e-48, "cur_lr": 1e-07, "total_loss": 2.1884251475334167, "policy_loss": -8.947716560214758e-06, "vf_loss": 9.990398705005646, "vf_explained_var": -4.151090979576111e-06, "kl": 4.6617867277554126e-07, "entropy": 3.091655734181404, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "env_runners": {"episode_reward_max": 540.5687730525915, "episode_reward_min": 440.8332443172501, "episode_reward_mean": 488.18556090515943, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.8332443172501}, "policy_reward_max": {"tplp_policy": 540.5687730525915}, "policy_reward_mean": {"tplp_policy": 488.18556090515943}, "custom_metrics": {"mean_episode_reward_mean": 488.18556090515943, "mean_episode_reward_min": 440.8332443172501, "mean_episode_reward_max": 540.5687730525915}, "hist_stats": {"episode_reward": [492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [492.88805154706915, 479.68596424900215, 444.5491024026567, 448.6355373423174, 504.92175025788106, 473.3022187599558, 532.1874504089726, 487.56848241207376, 516.3423716826201, 484.1943943562111, 468.8063505848998, 540.5687730525915, 511.1011040417441, 497.0549998787267, 470.2514854379069, 489.9696347577134, 481.9885614120878, 478.27676207857974, 513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1628623166371472, "mean_inference_ms": 3.4039250068605305, "mean_action_processing_ms": 0.635230892043878, "mean_env_wait_ms": 3.5372230649041034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014400720596313477, "StateBufferConnector_ms": 0.0170438289642334, "ViewRequirementAgentConnector_ms": 0.28884387016296387}, "num_episodes": 24, "episode_return_max": 540.5687730525915, "episode_return_min": 440.8332443172501, "episode_return_mean": 488.18556090515943, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 340.8206496829034, "num_env_steps_trained_throughput_per_sec": 340.8206496829034, "timesteps_total": 158720, "num_env_steps_sampled_lifetime": 158720, "num_agent_steps_sampled_lifetime": 158720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 158720, "timers": {"training_iteration_time_ms": 3317.382, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3317.382, "sample_time_ms": 1333.925, "learn_time_ms": 1956.863, "learn_throughput": 523.287, "synch_weights_time_ms": 26.273}, "counters": {"num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "done": false, "training_iteration": 155, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-08", "timestamp": 1744127588, "time_this_iter_s": 3.0116167068481445, "time_total_s": 600.7762966156006, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 600.7762966156006, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 44.62, "ram_util_percent": 92.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.254866082966328, "cur_kl_coeff": 4.379057701015053e-48, "cur_lr": 1e-07, "total_loss": 2.1906470082700253, "policy_loss": -9.101036703214049e-05, "vf_loss": 10.0, "vf_explained_var": -7.902830839157105e-06, "kl": 1.3693846987572478e-06, "entropy": 3.0926198229193687, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "env_runners": {"episode_reward_max": 529.6839274032551, "episode_reward_min": 440.8332443172501, "episode_reward_mean": 488.667992608543, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.8332443172501}, "policy_reward_max": {"tplp_policy": 529.6839274032551}, "policy_reward_mean": {"tplp_policy": 488.667992608543}, "custom_metrics": {"mean_episode_reward_mean": 488.667992608543, "mean_episode_reward_min": 440.8332443172501, "mean_episode_reward_max": 529.6839274032551}, "hist_stats": {"episode_reward": [513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.9080253124114, 486.6481494446335, 468.6222932899611, 497.30623746205896, 520.942884282549, 479.8607573790186, 482.87474066353025, 505.7705548974036, 493.23584544449784, 525.2762336745055, 524.818232381911, 449.4631940391407, 479.46240305625327, 487.01365137283597, 502.28928391263605, 465.8874079733756, 457.0427842849404, 485.81073080938654, 485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1616359458824044, "mean_inference_ms": 3.4009291090641436, "mean_action_processing_ms": 0.6346392790187244, "mean_env_wait_ms": 3.534539337715153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01338505744934082, "StateBufferConnector_ms": 0.013020515441894531, "ViewRequirementAgentConnector_ms": 0.28769946098327637}, "num_episodes": 18, "episode_return_max": 529.6839274032551, "episode_return_min": 440.8332443172501, "episode_return_mean": 488.667992608543, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 284.0126254657644, "num_env_steps_trained_throughput_per_sec": 284.0126254657644, "timesteps_total": 159744, "num_env_steps_sampled_lifetime": 159744, "num_agent_steps_sampled_lifetime": 159744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 159744, "timers": {"training_iteration_time_ms": 3382.679, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3382.679, "sample_time_ms": 1353.974, "learn_time_ms": 2002.063, "learn_throughput": 511.472, "synch_weights_time_ms": 26.321}, "counters": {"num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "done": false, "training_iteration": 156, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-11", "timestamp": 1744127591, "time_this_iter_s": 3.612250804901123, "time_total_s": 604.3885474205017, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 604.3885474205017, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 49.300000000000004, "ram_util_percent": 91.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.983650994673371, "cur_kl_coeff": 2.1895288505075265e-48, "cur_lr": 1e-07, "total_loss": 2.1905224241316317, "policy_loss": -2.0387422409839928e-05, "vf_loss": 9.999747759103775, "vf_explained_var": -6.734207272529602e-06, "kl": 8.938446780515363e-07, "entropy": 3.093941259384155, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "env_runners": {"episode_reward_max": 529.6839274032551, "episode_reward_min": 440.8332443172501, "episode_reward_mean": 488.9882869443687, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.8332443172501}, "policy_reward_max": {"tplp_policy": 529.6839274032551}, "policy_reward_mean": {"tplp_policy": 488.9882869443687}, "custom_metrics": {"mean_episode_reward_mean": 488.9882869443687, "mean_episode_reward_min": 440.8332443172501, "mean_episode_reward_max": 529.6839274032551}, "hist_stats": {"episode_reward": [485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.3517175529943, 466.352734091301, 503.2997807276942, 486.6807056636772, 504.18168482447356, 476.22236231181046, 484.1016888904139, 468.91375648196066, 460.2883256844544, 498.63411176399705, 515.381438230555, 493.89310340280576, 508.6681302438211, 476.3957454954857, 514.1433744033812, 508.97119588561054, 487.53737650321256, 502.7098878884478, 490.81504574123295, 497.3511665687325, 512.1495013006128, 504.25432331847475, 463.97747824518075, 481.5454742269276, 465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.16041354876485, "mean_inference_ms": 3.3977653162443477, "mean_action_processing_ms": 0.6340475604392958, "mean_env_wait_ms": 3.531738517363475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188516616821289, "StateBufferConnector_ms": 0.013020515441894531, "ViewRequirementAgentConnector_ms": 0.28362345695495605}, "num_episodes": 18, "episode_return_max": 529.6839274032551, "episode_return_min": 440.8332443172501, "episode_return_mean": 488.9882869443687, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.1434545616795, "num_env_steps_trained_throughput_per_sec": 328.1434545616795, "timesteps_total": 160768, "num_env_steps_sampled_lifetime": 160768, "num_agent_steps_sampled_lifetime": 160768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 160768, "timers": {"training_iteration_time_ms": 3324.463, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3324.463, "sample_time_ms": 1343.546, "learn_time_ms": 1953.825, "learn_throughput": 524.1, "synch_weights_time_ms": 26.77}, "counters": {"num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "done": false, "training_iteration": 157, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-14", "timestamp": 1744127594, "time_this_iter_s": 3.13014554977417, "time_total_s": 607.5186929702759, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 607.5186929702759, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 51.62500000000001, "ram_util_percent": 91.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1367039900273084, "cur_kl_coeff": 1.0947644252537632e-48, "cur_lr": 1e-07, "total_loss": 2.190393003821373, "policy_loss": -3.874680842272937e-05, "vf_loss": 10.0, "vf_explained_var": -6.51627779006958e-06, "kl": 1.7048316151707654e-06, "entropy": 3.0956825852394103, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "env_runners": {"episode_reward_max": 529.6839274032551, "episode_reward_min": 440.8332443172501, "episode_reward_mean": 488.0199443552293, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.8332443172501}, "policy_reward_max": {"tplp_policy": 529.6839274032551}, "policy_reward_mean": {"tplp_policy": 488.0199443552293}, "custom_metrics": {"mean_episode_reward_mean": 488.0199443552293, "mean_episode_reward_min": 440.8332443172501, "mean_episode_reward_max": 529.6839274032551}, "hist_stats": {"episode_reward": [465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.71048048721235, 480.7647478086574, 489.7748628432358, 477.6522541854416, 524.3713444668518, 499.21726962639156, 474.980405206509, 529.6839274032551, 505.07693432646187, 479.6362844539356, 483.2966932979083, 474.8151061161577, 491.7315429852831, 500.52652292187065, 443.65858815150466, 461.3294618040714, 440.8332443172501, 465.45263772161604, 467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1589576097175678, "mean_inference_ms": 3.393619437374174, "mean_action_processing_ms": 0.6333583716934043, "mean_env_wait_ms": 3.528229672399704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012836694717407227, "StateBufferConnector_ms": 0.020519495010375977, "ViewRequirementAgentConnector_ms": 0.3048386573791504}, "num_episodes": 24, "episode_return_max": 529.6839274032551, "episode_return_min": 440.8332443172501, "episode_return_mean": 488.0199443552293, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.61198476822824, "num_env_steps_trained_throughput_per_sec": 318.61198476822824, "timesteps_total": 161792, "num_env_steps_sampled_lifetime": 161792, "num_agent_steps_sampled_lifetime": 161792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 161792, "timers": {"training_iteration_time_ms": 3308.135, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3308.135, "sample_time_ms": 1344.889, "learn_time_ms": 1936.955, "learn_throughput": 528.665, "synch_weights_time_ms": 26.069}, "counters": {"num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "done": false, "training_iteration": 158, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-18", "timestamp": 1744127598, "time_this_iter_s": 3.227808713912964, "time_total_s": 610.7465016841888, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 610.7465016841888, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 46.339999999999996, "ram_util_percent": 91.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2034234654158356, "cur_kl_coeff": 5.473822126268816e-49, "cur_lr": 1e-07, "total_loss": 2.187735491991043, "policy_loss": -8.796759066171944e-05, "vf_loss": 9.99050167798996, "vf_explained_var": -6.5319240093231205e-06, "kl": 1.7733224499494327e-06, "entropy": 3.0980196237564086, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "env_runners": {"episode_reward_max": 525.7149038826427, "episode_reward_min": 448.3780845092676, "episode_reward_mean": 487.1852846789092, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 448.3780845092676}, "policy_reward_max": {"tplp_policy": 525.7149038826427}, "policy_reward_mean": {"tplp_policy": 487.1852846789092}, "custom_metrics": {"mean_episode_reward_mean": 487.1852846789092, "mean_episode_reward_min": 448.3780845092676, "mean_episode_reward_max": 525.7149038826427}, "hist_stats": {"episode_reward": [467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.1342360450924, 475.47465028132956, 492.2121180125559, 482.06357366364176, 489.7178496711119, 504.2723786328121, 486.72721750977695, 496.4619180085124, 504.53000851984893, 493.12449452968684, 451.3045410983058, 458.38270517196077, 484.39764891839206, 474.37450123413, 480.77370428658844, 493.34515304017435, 508.7116412801331, 470.97455221557834, 507.18572923296585, 472.9895530328818, 510.5739124450822, 504.96518177045306, 498.31748836997645, 494.02445230916993, 482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.158060670138359, "mean_inference_ms": 3.3910002455355994, "mean_action_processing_ms": 0.6328604754265104, "mean_env_wait_ms": 3.526030670443142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013266324996948242, "StateBufferConnector_ms": 0.017523765563964844, "ViewRequirementAgentConnector_ms": 0.31005406379699707}, "num_episodes": 18, "episode_return_max": 525.7149038826427, "episode_return_min": 448.3780845092676, "episode_return_mean": 487.1852846789092, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 323.9953781839389, "num_env_steps_trained_throughput_per_sec": 323.9953781839389, "timesteps_total": 162816, "num_env_steps_sampled_lifetime": 162816, "num_agent_steps_sampled_lifetime": 162816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 162816, "timers": {"training_iteration_time_ms": 3265.011, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3265.011, "sample_time_ms": 1352.372, "learn_time_ms": 1887.126, "learn_throughput": 542.624, "synch_weights_time_ms": 25.292}, "counters": {"num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "done": false, "training_iteration": 159, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-21", "timestamp": 1744127601, "time_this_iter_s": 3.1705093383789062, "time_total_s": 613.9170110225677, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.9170110225677, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 51.550000000000004, "ram_util_percent": 91.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.594669730216265, "cur_kl_coeff": 2.736911063134408e-49, "cur_lr": 1e-07, "total_loss": 2.1837358973920344, "policy_loss": -0.000113238490303047, "vf_loss": 9.97543722987175, "vf_explained_var": -5.9623271226882935e-06, "kl": 2.2260533616494382e-06, "entropy": 3.100101712346077, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "env_runners": {"episode_reward_max": 525.7149038826427, "episode_reward_min": 431.7297199050269, "episode_reward_mean": 484.1860774343671, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.7297199050269}, "policy_reward_max": {"tplp_policy": 525.7149038826427}, "policy_reward_mean": {"tplp_policy": 484.1860774343671}, "custom_metrics": {"mean_episode_reward_mean": 484.1860774343671, "mean_episode_reward_min": 431.7297199050269, "mean_episode_reward_max": 525.7149038826427}, "hist_stats": {"episode_reward": [482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.91271040293094, 487.6186798668019, 490.2152094516976, 490.3847412619724, 517.152030774991, 486.90094313237483, 485.05611059962234, 483.7949551430181, 518.2489545645572, 498.5749991237503, 510.97431829977654, 491.16502074093626, 460.9210043424682, 457.55005723413433, 510.47407754005377, 486.25041184313153, 492.5886082364645, 510.6393135467464, 523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1568414467377428, "mean_inference_ms": 3.3874551488237636, "mean_action_processing_ms": 0.632233500015069, "mean_env_wait_ms": 3.5229728478841618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013035058975219727, "StateBufferConnector_ms": 0.016504526138305664, "ViewRequirementAgentConnector_ms": 0.3165781497955322}, "num_episodes": 24, "episode_return_max": 525.7149038826427, "episode_return_min": 431.7297199050269, "episode_return_mean": 484.1860774343671, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 353.62337004732086, "num_env_steps_trained_throughput_per_sec": 353.62337004732086, "timesteps_total": 163840, "num_env_steps_sampled_lifetime": 163840, "num_agent_steps_sampled_lifetime": 163840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 3230.876, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3230.876, "sample_time_ms": 1317.713, "learn_time_ms": 1887.593, "learn_throughput": 542.49, "synch_weights_time_ms": 25.348}, "counters": {"num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "training_iteration": 160, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-24", "timestamp": 1744127604, "time_this_iter_s": 2.9036812782287598, "time_total_s": 616.8206923007965, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1467A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 616.8206923007965, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 50.85, "ram_util_percent": 91.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.508248244225979, "cur_kl_coeff": 1.368455531567204e-49, "cur_lr": 1e-07, "total_loss": 2.1872532680630683, "policy_loss": -0.0001610034960322082, "vf_loss": 9.99048615694046, "vf_explained_var": -7.64690339565277e-06, "kl": 2.0056244713462233e-06, "entropy": 3.102072627842426, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "env_runners": {"episode_reward_max": 528.2244792865947, "episode_reward_min": 426.06351851771865, "episode_reward_mean": 482.2704863396191, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.06351851771865}, "policy_reward_max": {"tplp_policy": 528.2244792865947}, "policy_reward_mean": {"tplp_policy": 482.2704863396191}, "custom_metrics": {"mean_episode_reward_mean": 482.2704863396191, "mean_episode_reward_min": 426.06351851771865, "mean_episode_reward_max": 528.2244792865947}, "hist_stats": {"episode_reward": [523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [523.1919777149863, 525.7149038826427, 488.2221985784643, 491.44806218835237, 459.1352604580502, 495.4195359492129, 496.33054395607894, 523.4586941173628, 515.3961640961529, 473.78045204524585, 465.8047613147748, 492.8964544834579, 463.20507844118396, 487.9814175181191, 503.1107165369814, 449.9387001993433, 455.05795967510994, 487.8921846361395, 479.19502053958803, 484.0982380759285, 472.6919528527808, 472.3909465665357, 492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1560358024731783, "mean_inference_ms": 3.384786150312867, "mean_action_processing_ms": 0.6317603074557756, "mean_env_wait_ms": 3.520508691287022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012038707733154297, "StateBufferConnector_ms": 0.018048763275146484, "ViewRequirementAgentConnector_ms": 0.31229162216186523}, "num_episodes": 18, "episode_return_max": 528.2244792865947, "episode_return_min": 426.06351851771865, "episode_return_mean": 482.2704863396191, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 326.4951994577782, "num_env_steps_trained_throughput_per_sec": 326.4951994577782, "timesteps_total": 164864, "num_env_steps_sampled_lifetime": 164864, "num_agent_steps_sampled_lifetime": 164864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 164864, "timers": {"training_iteration_time_ms": 3195.211, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3195.211, "sample_time_ms": 1328.116, "learn_time_ms": 1841.922, "learn_throughput": 555.941, "synch_weights_time_ms": 24.705}, "counters": {"num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "done": false, "training_iteration": 161, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-27", "timestamp": 1744127607, "time_this_iter_s": 3.1440274715423584, "time_total_s": 619.9647197723389, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA23E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 619.9647197723389, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 50.974999999999994, "ram_util_percent": 91.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1218548640608788, "cur_kl_coeff": 6.84227765783602e-50, "cur_lr": 1e-07, "total_loss": 2.1847743436694147, "policy_loss": -7.118633948266506e-05, "vf_loss": 9.980791223049163, "vf_explained_var": -2.3987144231796264e-06, "kl": 1.2671723076132514e-06, "entropy": 3.1035226732492447, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "env_runners": {"episode_reward_max": 528.2244792865947, "episode_reward_min": 426.06351851771865, "episode_reward_mean": 481.05076697525624, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.06351851771865}, "policy_reward_max": {"tplp_policy": 528.2244792865947}, "policy_reward_mean": {"tplp_policy": 481.05076697525624}, "custom_metrics": {"mean_episode_reward_mean": 481.05076697525624, "mean_episode_reward_min": 426.06351851771865, "mean_episode_reward_max": 528.2244792865947}, "hist_stats": {"episode_reward": [492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [492.0544751591724, 498.4042977675235, 473.54772252960953, 525.3170750954281, 477.51949979591546, 481.6880271369799, 490.6180625987901, 491.92735212994495, 489.46379754965574, 498.1439376986231, 516.9710894267615, 496.2654545505272, 461.9448240876773, 496.01907325026383, 477.9393955274945, 481.10824524166964, 489.57490849159325, 505.1523101496134, 499.5136490017254, 456.85201362493444, 470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.155117950894337, "mean_inference_ms": 3.381312007963511, "mean_action_processing_ms": 0.6312122774016972, "mean_env_wait_ms": 3.5181991129467667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015034675598144531, "StateBufferConnector_ms": 0.014104604721069336, "ViewRequirementAgentConnector_ms": 0.32027435302734375}, "num_episodes": 22, "episode_return_max": 528.2244792865947, "episode_return_min": 426.06351851771865, "episode_return_mean": 481.05076697525624, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 324.9444296156684, "num_env_steps_trained_throughput_per_sec": 324.9444296156684, "timesteps_total": 165888, "num_env_steps_sampled_lifetime": 165888, "num_agent_steps_sampled_lifetime": 165888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 165888, "timers": {"training_iteration_time_ms": 3154.417, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3154.417, "sample_time_ms": 1329.592, "learn_time_ms": 1799.887, "learn_throughput": 568.925, "synch_weights_time_ms": 24.47}, "counters": {"num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "done": false, "training_iteration": 162, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-31", "timestamp": 1744127611, "time_this_iter_s": 3.1598711013793945, "time_total_s": 623.1245908737183, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 623.1245908737183, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 91.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.246560153737664, "cur_kl_coeff": 3.42113882891801e-50, "cur_lr": 1e-07, "total_loss": 2.1865920536220074, "policy_loss": -4.2130029760301114e-05, "vf_loss": 9.988430619239807, "vf_explained_var": -5.939975380897522e-06, "kl": 8.879674461725883e-07, "entropy": 3.1047347083687784, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "env_runners": {"episode_reward_max": 528.2244792865947, "episode_reward_min": 426.06351851771865, "episode_reward_mean": 479.7271795207331, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.06351851771865}, "policy_reward_max": {"tplp_policy": 528.2244792865947}, "policy_reward_mean": {"tplp_policy": 479.7271795207331}, "custom_metrics": {"mean_episode_reward_mean": 479.7271795207331, "mean_episode_reward_min": 426.06351851771865, "mean_episode_reward_max": 528.2244792865947}, "hist_stats": {"episode_reward": [470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.44384122420064, 448.3780845092676, 458.5081302998892, 475.76375631372383, 497.03431774761236, 456.0841682745858, 508.5747790697263, 472.92741884308333, 488.74183517629444, 463.81622662454475, 515.7295750423019, 466.22606419551994, 474.71679875928, 460.78109113796864, 492.69798528885735, 498.2566053580842, 485.3549661848476, 491.32467236295264, 473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1540942254010575, "mean_inference_ms": 3.3792796526373343, "mean_action_processing_ms": 0.6306290396462149, "mean_env_wait_ms": 3.5149778549075537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017589092254638672, "StateBufferConnector_ms": 0.014709234237670898, "ViewRequirementAgentConnector_ms": 0.297076940536499}, "num_episodes": 20, "episode_return_max": 528.2244792865947, "episode_return_min": 426.06351851771865, "episode_return_mean": 479.7271795207331, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.42539797545123, "num_env_steps_trained_throughput_per_sec": 327.42539797545123, "timesteps_total": 166912, "num_env_steps_sampled_lifetime": 166912, "num_agent_steps_sampled_lifetime": 166912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 166912, "timers": {"training_iteration_time_ms": 3143.073, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3143.073, "sample_time_ms": 1325.237, "learn_time_ms": 1792.775, "learn_throughput": 571.182, "synch_weights_time_ms": 24.593}, "counters": {"num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "done": false, "training_iteration": 163, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-34", "timestamp": 1744127614, "time_this_iter_s": 3.135824680328369, "time_total_s": 626.2604155540466, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1467A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 626.2604155540466, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 46.260000000000005, "ram_util_percent": 91.94000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.089207765832543, "cur_kl_coeff": 1.710569414459005e-50, "cur_lr": 1e-07, "total_loss": 2.187021192163229, "policy_loss": 1.215750235132873e-05, "vf_loss": 9.990486121177673, "vf_explained_var": -7.101520895957947e-06, "kl": 9.045221025516526e-07, "entropy": 3.10612496137619, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "env_runners": {"episode_reward_max": 528.2244792865947, "episode_reward_min": 426.06351851771865, "episode_reward_mean": 480.8189396154639, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.06351851771865}, "policy_reward_max": {"tplp_policy": 528.2244792865947}, "policy_reward_mean": {"tplp_policy": 480.8189396154639}, "custom_metrics": {"mean_episode_reward_mean": 480.8189396154639, "mean_episode_reward_min": 426.06351851771865, "mean_episode_reward_max": 528.2244792865947}, "hist_stats": {"episode_reward": [473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.9058906245963, 525.16231476901, 451.41036573994097, 491.1860918729737, 485.44757456429875, 478.23627780859755, 464.26677932594345, 474.72184670947865, 457.2076877438397, 487.8903110012125, 481.63977585810017, 456.0832090497457, 442.08237435647254, 443.5455751939664, 469.6700191444431, 431.7297199050269, 486.6989085235118, 480.7083342690748, 502.613988197904, 489.99970009421503, 468.5850091155752, 482.6470924102195, 455.6097899251837, 491.21303503263505, 471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1530954971398866, "mean_inference_ms": 3.3762922627410874, "mean_action_processing_ms": 0.6301274386092234, "mean_env_wait_ms": 3.512049556093375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017526865005493164, "StateBufferConnector_ms": 0.015192270278930664, "ViewRequirementAgentConnector_ms": 0.28240251541137695}, "num_episodes": 18, "episode_return_max": 528.2244792865947, "episode_return_min": 426.06351851771865, "episode_return_mean": 480.8189396154639, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 334.4397543270176, "num_env_steps_trained_throughput_per_sec": 334.4397543270176, "timesteps_total": 167936, "num_env_steps_sampled_lifetime": 167936, "num_agent_steps_sampled_lifetime": 167936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 167936, "timers": {"training_iteration_time_ms": 3147.77, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3147.77, "sample_time_ms": 1324.558, "learn_time_ms": 1798.255, "learn_throughput": 569.441, "synch_weights_time_ms": 24.61}, "counters": {"num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "done": false, "training_iteration": 164, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-37", "timestamp": 1744127617, "time_this_iter_s": 3.0705435276031494, "time_total_s": 629.3309590816498, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 629.3309590816498, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 53.925, "ram_util_percent": 91.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4134742435067893, "cur_kl_coeff": 8.552847072295025e-51, "cur_lr": 1e-07, "total_loss": 2.1868347227573395, "policy_loss": -2.9522250406444074e-05, "vf_loss": 9.990486198663712, "vf_explained_var": -7.012858986854553e-06, "kl": 7.226706047580578e-07, "entropy": 3.107573063671589, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "env_runners": {"episode_reward_max": 539.6186311744658, "episode_reward_min": 426.06351851771865, "episode_reward_mean": 485.5268075688003, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.06351851771865}, "policy_reward_max": {"tplp_policy": 539.6186311744658}, "policy_reward_mean": {"tplp_policy": 485.5268075688003}, "custom_metrics": {"mean_episode_reward_mean": 485.5268075688003, "mean_episode_reward_min": 426.06351851771865, "mean_episode_reward_max": 539.6186311744658}, "hist_stats": {"episode_reward": [471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.7994428110649, 469.7111425304564, 484.3567206077106, 426.06351851771865, 471.4111796540361, 490.5820492073189, 500.92640901769107, 486.70238604127053, 481.5710437236845, 480.99704337334776, 488.6922069870837, 486.0981244656588, 523.9518468378232, 528.2244792865947, 430.5030425008015, 501.4495761105424, 482.60177480373295, 487.79576353006223, 458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1518953128524076, "mean_inference_ms": 3.372470140287502, "mean_action_processing_ms": 0.629512483136939, "mean_env_wait_ms": 3.508208529158316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018562793731689453, "StateBufferConnector_ms": 0.014652013778686523, "ViewRequirementAgentConnector_ms": 0.2936882972717285}, "num_episodes": 24, "episode_return_max": 539.6186311744658, "episode_return_min": 426.06351851771865, "episode_return_mean": 485.5268075688003, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 318.4828456195484, "num_env_steps_trained_throughput_per_sec": 318.4828456195484, "timesteps_total": 168960, "num_env_steps_sampled_lifetime": 168960, "num_agent_steps_sampled_lifetime": 168960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 168960, "timers": {"training_iteration_time_ms": 3168.843, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3168.843, "sample_time_ms": 1330.46, "learn_time_ms": 1813.447, "learn_throughput": 564.671, "synch_weights_time_ms": 24.589}, "counters": {"num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "done": false, "training_iteration": 165, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-40", "timestamp": 1744127620, "time_this_iter_s": 3.2231862545013428, "time_total_s": 632.5541453361511, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07CFE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 632.5541453361511, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 47.36, "ram_util_percent": 91.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6814602140337227, "cur_kl_coeff": 4.2764235361475127e-51, "cur_lr": 1e-07, "total_loss": 2.1890319414436816, "policy_loss": -9.28783614654094e-05, "vf_loss": 10.0, "vf_explained_var": -6.582215428352356e-06, "kl": 1.4042283511095377e-06, "entropy": 3.1087516441941263, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "env_runners": {"episode_reward_max": 539.6186311744658, "episode_reward_min": 430.8844921339204, "episode_reward_mean": 487.2990005835992, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.8844921339204}, "policy_reward_max": {"tplp_policy": 539.6186311744658}, "policy_reward_mean": {"tplp_policy": 487.2990005835992}, "custom_metrics": {"mean_episode_reward_mean": 487.2990005835992, "mean_episode_reward_min": 430.8844921339204, "mean_episode_reward_max": 539.6186311744658}, "hist_stats": {"episode_reward": [458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.2152872739601, 497.6763862940158, 462.42760528360645, 466.34730639504085, 505.45737116012225, 459.34847325505785, 492.8549612385134, 490.14114134554706, 507.1665364815418, 480.26824474786406, 513.9545348019851, 479.39749558529604, 496.80651431607083, 459.4969820710812, 485.5797404459421, 512.3618328425091, 491.84123323983135, 430.8844921339204, 455.76041681765673, 468.00519332686036, 460.4193630077159, 492.17804356509083, 473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1508807264690122, "mean_inference_ms": 3.3695837540875426, "mean_action_processing_ms": 0.6290317777901515, "mean_env_wait_ms": 3.505443252218748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019568681716918945, "StateBufferConnector_ms": 0.012653350830078125, "ViewRequirementAgentConnector_ms": 0.29875707626342773}, "num_episodes": 18, "episode_return_max": 539.6186311744658, "episode_return_min": 430.8844921339204, "episode_return_mean": 487.2990005835992, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 331.37272571071503, "num_env_steps_trained_throughput_per_sec": 331.37272571071503, "timesteps_total": 169984, "num_env_steps_sampled_lifetime": 169984, "num_agent_steps_sampled_lifetime": 169984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 169984, "timers": {"training_iteration_time_ms": 3117.314, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3117.314, "sample_time_ms": 1322.784, "learn_time_ms": 1769.693, "learn_throughput": 578.631, "synch_weights_time_ms": 24.489}, "counters": {"num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "done": false, "training_iteration": 166, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-43", "timestamp": 1744127623, "time_this_iter_s": 3.0998759269714355, "time_total_s": 635.6540212631226, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 635.6540212631226, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 52.775, "ram_util_percent": 91.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.506697113066912, "cur_kl_coeff": 2.1382117680737563e-51, "cur_lr": 1e-07, "total_loss": 2.186516583710909, "policy_loss": -0.00012911159719806165, "vf_loss": 9.990571182966232, "vf_explained_var": -6.264448165893554e-06, "kl": 1.5607452028887358e-06, "entropy": 3.1099710777401923, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "env_runners": {"episode_reward_max": 539.6186311744658, "episode_reward_min": 439.9081103858533, "episode_reward_mean": 488.40547789796307, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.9081103858533}, "policy_reward_max": {"tplp_policy": 539.6186311744658}, "policy_reward_mean": {"tplp_policy": 488.40547789796307}, "custom_metrics": {"mean_episode_reward_mean": 488.40547789796307, "mean_episode_reward_min": 439.9081103858533, "mean_episode_reward_max": 539.6186311744658}, "hist_stats": {"episode_reward": [473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.86839845176723, 492.2066934436859, 474.5162619492969, 480.21832677064555, 462.6054160384887, 523.622052944237, 445.3805926633127, 500.1558564626803, 512.1685401338823, 483.0469281126254, 462.77223693175625, 510.7419374892286, 480.53920580164424, 505.78716226248, 470.0534434438891, 465.81946474527166, 477.18734801822677, 494.37919312565936, 489.4797274036628, 457.79590235134145, 460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.149686852607556, "mean_inference_ms": 3.365741853253151, "mean_action_processing_ms": 0.6283886910210194, "mean_env_wait_ms": 3.5019213660001647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013564109802246094, "StateBufferConnector_ms": 0.00861048698425293, "ViewRequirementAgentConnector_ms": 0.2871077060699463}, "num_episodes": 22, "episode_return_max": 539.6186311744658, "episode_return_min": 439.9081103858533, "episode_return_mean": 488.40547789796307, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.0592885176236, "num_env_steps_trained_throughput_per_sec": 328.0592885176236, "timesteps_total": 171008, "num_env_steps_sampled_lifetime": 171008, "num_agent_steps_sampled_lifetime": 171008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 171008, "timers": {"training_iteration_time_ms": 3117.394, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3117.394, "sample_time_ms": 1319.0, "learn_time_ms": 1773.745, "learn_throughput": 577.309, "synch_weights_time_ms": 24.402}, "counters": {"num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "done": false, "training_iteration": 167, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-47", "timestamp": 1744127627, "time_this_iter_s": 3.130171537399292, "time_total_s": 638.7841928005219, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 638.7841928005219, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 47.86, "ram_util_percent": 91.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2850300002843142, "cur_kl_coeff": 1.0691058840368782e-51, "cur_lr": 1e-07, "total_loss": 2.1880228593945503, "policy_loss": -5.614838446490467e-05, "vf_loss": 9.997048848867417, "vf_explained_var": -6.7099928855896e-06, "kl": 1.8298519666837266e-06, "entropy": 3.1118321463465692, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "env_runners": {"episode_reward_max": 539.6186311744658, "episode_reward_min": 439.9081103858533, "episode_reward_mean": 489.3862677618652, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.9081103858533}, "policy_reward_max": {"tplp_policy": 539.6186311744658}, "policy_reward_mean": {"tplp_policy": 489.3862677618652}, "custom_metrics": {"mean_episode_reward_mean": 489.3862677618652, "mean_episode_reward_min": 439.9081103858533, "mean_episode_reward_max": 539.6186311744658}, "hist_stats": {"episode_reward": [460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [460.1184406633629, 500.0984799949758, 464.9743019767513, 500.479251834543, 478.7144550519014, 489.79862966917835, 516.4626584334316, 497.6693186425139, 491.5520525518534, 497.6472757550277, 464.4452446378878, 470.30122233029533, 500.5793797545756, 475.7888837203857, 460.2444923493747, 518.386608764752, 465.2175238859578, 521.6864812388818, 481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1485680248817465, "mean_inference_ms": 3.362150667868066, "mean_action_processing_ms": 0.6278764969195523, "mean_env_wait_ms": 3.498722323807391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010831594467163086, "StateBufferConnector_ms": 0.0049936771392822266, "ViewRequirementAgentConnector_ms": 0.2945988178253174}, "num_episodes": 20, "episode_return_max": 539.6186311744658, "episode_return_min": 439.9081103858533, "episode_return_mean": 489.3862677618652, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 333.9780152923438, "num_env_steps_trained_throughput_per_sec": 333.9780152923438, "timesteps_total": 172032, "num_env_steps_sampled_lifetime": 172032, "num_agent_steps_sampled_lifetime": 172032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 3102.607, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3102.607, "sample_time_ms": 1312.086, "learn_time_ms": 1765.768, "learn_throughput": 579.918, "synch_weights_time_ms": 24.405}, "counters": {"num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "done": false, "training_iteration": 168, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-50", "timestamp": 1744127630, "time_this_iter_s": 3.074113607406616, "time_total_s": 641.8583064079285, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07F060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 641.8583064079285, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 53.12499999999999, "ram_util_percent": 91.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4518739391118287, "cur_kl_coeff": 5.345529420184391e-52, "cur_lr": 1e-07, "total_loss": 2.1884786620736123, "policy_loss": -7.046880782581865e-05, "vf_loss": 10.0, "vf_explained_var": -7.166340947151184e-06, "kl": 2.3089422984234885e-06, "entropy": 3.114508657157421, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "env_runners": {"episode_reward_max": 539.6186311744658, "episode_reward_min": 439.9081103858533, "episode_reward_mean": 490.7061954928413, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.9081103858533}, "policy_reward_max": {"tplp_policy": 539.6186311744658}, "policy_reward_mean": {"tplp_policy": 490.7061954928413}, "custom_metrics": {"mean_episode_reward_mean": 490.7061954928413, "mean_episode_reward_min": 439.9081103858533, "mean_episode_reward_max": 539.6186311744658}, "hist_stats": {"episode_reward": [481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.4625623923372, 469.47714713315384, 458.07688343169167, 539.6186311744658, 460.20841765284695, 473.4528693929458, 501.57591239039726, 474.28702266825263, 498.40531833251555, 489.65415278296047, 533.2253789185202, 439.9081103858533, 508.4307842841584, 521.995751926676, 497.5103249140866, 504.19919286282203, 489.56279212880935, 503.2523302262256, 521.4214435307252, 502.0833041182266, 510.8913437918729, 477.4447870052272, 506.2576964318064, 507.0511231240464, 492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.147552298599273, "mean_inference_ms": 3.3589060752490196, "mean_action_processing_ms": 0.6273741816215347, "mean_env_wait_ms": 3.4958400104850136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010390520095825195, "StateBufferConnector_ms": 0.0049936771392822266, "ViewRequirementAgentConnector_ms": 0.3069636821746826}, "num_episodes": 18, "episode_return_max": 539.6186311744658, "episode_return_min": 439.9081103858533, "episode_return_mean": 490.7061954928413, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 343.84211674501444, "num_env_steps_trained_throughput_per_sec": 343.84211674501444, "timesteps_total": 173056, "num_env_steps_sampled_lifetime": 173056, "num_agent_steps_sampled_lifetime": 173056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 173056, "timers": {"training_iteration_time_ms": 3084.364, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3084.364, "sample_time_ms": 1285.391, "learn_time_ms": 1774.379, "learn_throughput": 577.103, "synch_weights_time_ms": 24.247}, "counters": {"num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "done": false, "training_iteration": 169, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-53", "timestamp": 1744127633, "time_this_iter_s": 2.9841513633728027, "time_total_s": 644.8424577713013, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.8424577713013, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 52.875, "ram_util_percent": 91.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.791334036178887, "cur_kl_coeff": 2.6727647100921954e-52, "cur_lr": 1e-07, "total_loss": 2.1858055613934995, "policy_loss": -8.589851204305887e-05, "vf_loss": 9.990392249822616, "vf_explained_var": -7.23227858543396e-06, "kl": 1.928706830689464e-06, "entropy": 3.1170658081769944, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "env_runners": {"episode_reward_max": 538.947036900077, "episode_reward_min": 446.22249594854384, "episode_reward_mean": 488.3671100566098, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 446.22249594854384}, "policy_reward_max": {"tplp_policy": 538.947036900077}, "policy_reward_mean": {"tplp_policy": 488.3671100566098}, "custom_metrics": {"mean_episode_reward_mean": 488.3671100566098, "mean_episode_reward_min": 446.22249594854384, "mean_episode_reward_max": 538.947036900077}, "hist_stats": {"episode_reward": [492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [492.0686183862159, 494.70377482521866, 479.36645889639885, 483.9056699229785, 495.4445684898723, 483.56318328121193, 486.81832007092385, 479.8467433697489, 502.65540805892385, 517.7626736800318, 502.4484266504384, 538.947036900077, 491.25000446627894, 499.97630762363565, 446.22249594854384, 462.3685413601308, 489.8738552033278, 491.08712466171545, 467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1460520117334558, "mean_inference_ms": 3.3543482724697644, "mean_action_processing_ms": 0.6266251280695404, "mean_env_wait_ms": 3.4917661075770288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010330438613891602, "StateBufferConnector_ms": 0.003242969512939453, "ViewRequirementAgentConnector_ms": 0.31630802154541016}, "num_episodes": 24, "episode_return_max": 538.947036900077, "episode_return_min": 446.22249594854384, "episode_return_mean": 488.3671100566098, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 358.0713136756938, "num_env_steps_trained_throughput_per_sec": 358.0713136756938, "timesteps_total": 174080, "num_env_steps_sampled_lifetime": 174080, "num_agent_steps_sampled_lifetime": 174080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 174080, "timers": {"training_iteration_time_ms": 3080.767, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3080.767, "sample_time_ms": 1282.066, "learn_time_ms": 1773.895, "learn_throughput": 577.261, "synch_weights_time_ms": 24.459}, "counters": {"num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "done": false, "training_iteration": 170, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-56", "timestamp": 1744127636, "time_this_iter_s": 2.867685556411743, "time_total_s": 647.710143327713, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 647.710143327713, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 49.0, "ram_util_percent": 91.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5248631201684475, "cur_kl_coeff": 1.3363823550460977e-52, "cur_lr": 1e-07, "total_loss": 2.187495092302561, "policy_loss": -0.0001767089415807277, "vf_loss": 9.99862473011017, "vf_explained_var": -8.37668776512146e-06, "kl": 3.1769854119900743e-06, "entropy": 3.119843815267086, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "env_runners": {"episode_reward_max": 529.6756822526098, "episode_reward_min": 449.3306713407799, "episode_reward_mean": 487.45229649386715, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 449.3306713407799}, "policy_reward_max": {"tplp_policy": 529.6756822526098}, "policy_reward_mean": {"tplp_policy": 487.45229649386715}, "custom_metrics": {"mean_episode_reward_mean": 487.45229649386715, "mean_episode_reward_min": 449.3306713407799, "mean_episode_reward_max": 529.6756822526098}, "hist_stats": {"episode_reward": [467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.43765465064735, 491.8978327877446, 489.43021515495906, 464.03062347200387, 512.9759366845228, 512.9566011534301, 488.4776965109698, 499.6238442096103, 500.857209137124, 491.61984346619914, 503.6321782179253, 505.6853963421382, 456.40214553063527, 511.26935243854786, 451.5998470963507, 465.95879095169295, 486.71549182072744, 464.7675558087746, 458.5400819241857, 472.39760984238984, 463.13144201484727, 506.72270942148606, 489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1450870682662475, "mean_inference_ms": 3.3507722996147566, "mean_action_processing_ms": 0.6260915935491602, "mean_env_wait_ms": 3.4886992371040066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01032114028930664, "StateBufferConnector_ms": 0.007745265960693359, "ViewRequirementAgentConnector_ms": 0.3597066402435303}, "num_episodes": 18, "episode_return_max": 529.6756822526098, "episode_return_min": 449.3306713407799, "episode_return_mean": 487.45229649386715, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.46384268440966, "num_env_steps_trained_throughput_per_sec": 327.46384268440966, "timesteps_total": 175104, "num_env_steps_sampled_lifetime": 175104, "num_agent_steps_sampled_lifetime": 175104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 175104, "timers": {"training_iteration_time_ms": 3079.839, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3079.839, "sample_time_ms": 1274.51, "learn_time_ms": 1781.091, "learn_throughput": 574.929, "synch_weights_time_ms": 24.139}, "counters": {"num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "done": false, "training_iteration": 171, "trial_id": "f7884_00000", "date": "2025-04-08_23-53-59", "timestamp": 1744127639, "time_this_iter_s": 3.1355783939361572, "time_total_s": 650.8457217216492, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 650.8457217216492, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 49.16, "ram_util_percent": 91.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4548588868230583, "cur_kl_coeff": 6.681911775230489e-53, "cur_lr": 1e-07, "total_loss": 2.1857091851532457, "policy_loss": -7.222936837933958e-05, "vf_loss": 9.992239850759507, "vf_explained_var": -6.686896085739136e-06, "kl": 2.1095144196792147e-06, "entropy": 3.122785320878029, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "env_runners": {"episode_reward_max": 529.6756822526098, "episode_reward_min": 449.3306713407799, "episode_reward_mean": 487.7240864079347, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 449.3306713407799}, "policy_reward_max": {"tplp_policy": 529.6756822526098}, "policy_reward_mean": {"tplp_policy": 487.7240864079347}, "custom_metrics": {"mean_episode_reward_mean": 487.7240864079347, "mean_episode_reward_min": 449.3306713407799, "mean_episode_reward_max": 529.6756822526098}, "hist_stats": {"episode_reward": [489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.3233300282826, 488.4137146951648, 458.49725682473206, 514.9216715613405, 480.6815727887226, 529.6756822526098, 497.3786986539018, 491.5824242598969, 484.98224987318434, 495.4425589478365, 518.0206330112425, 449.3306713407799, 476.18680361421264, 487.76527006054164, 455.4002578901142, 517.1030149246146, 477.56807632615164, 478.29563644433347, 482.076699947228, 492.67342044535997, 484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144268201936546, "mean_inference_ms": 3.3470838891796126, "mean_action_processing_ms": 0.6256828099433469, "mean_env_wait_ms": 3.485381585575268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01282811164855957, "StateBufferConnector_ms": 0.008794307708740234, "ViewRequirementAgentConnector_ms": 0.3960139751434326}, "num_episodes": 22, "episode_return_max": 529.6756822526098, "episode_return_min": 449.3306713407799, "episode_return_mean": 487.7240864079347, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.30758701885145, "num_env_steps_trained_throughput_per_sec": 317.30758701885145, "timesteps_total": 176128, "num_env_steps_sampled_lifetime": 176128, "num_agent_steps_sampled_lifetime": 176128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 176128, "timers": {"training_iteration_time_ms": 3087.424, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3087.424, "sample_time_ms": 1290.691, "learn_time_ms": 1772.282, "learn_throughput": 577.786, "synch_weights_time_ms": 24.351}, "counters": {"num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "done": false, "training_iteration": 172, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-02", "timestamp": 1744127642, "time_this_iter_s": 3.23425030708313, "time_total_s": 654.0799720287323, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 654.0799720287323, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 54.15, "ram_util_percent": 91.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.016841545328498, "cur_kl_coeff": 3.3409558876152443e-53, "cur_lr": 1e-07, "total_loss": 2.1875240214169027, "policy_loss": -3.3097260165959595e-05, "vf_loss": 10.0, "vf_explained_var": -6.715580821037293e-06, "kl": 7.886414040481071e-07, "entropy": 3.1244287490844727, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "env_runners": {"episode_reward_max": 531.0701894192038, "episode_reward_min": 447.7541554333401, "episode_reward_mean": 488.6030911077042, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 447.7541554333401}, "policy_reward_max": {"tplp_policy": 531.0701894192038}, "policy_reward_mean": {"tplp_policy": 488.6030911077042}, "custom_metrics": {"mean_episode_reward_mean": 488.6030911077042, "mean_episode_reward_min": 447.7541554333401, "mean_episode_reward_max": 531.0701894192038}, "hist_stats": {"episode_reward": [484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.3057213583368, 508.5504505503791, 498.1926756293869, 460.9336945041553, 509.71660729957375, 498.4644134628947, 510.7797763796693, 494.9377519315303, 498.69114076171843, 526.6676426983055, 479.78478485995055, 490.6922479753051, 495.220841610602, 526.6145074092248, 459.36596846413556, 488.48912906550254, 492.55675973458676, 479.8551091172093, 453.1872416504617, 491.1440277404221, 480.1097210721932, 484.2464130126439, 455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1435190260073873, "mean_inference_ms": 3.3438298884868196, "mean_action_processing_ms": 0.6252200943992319, "mean_env_wait_ms": 3.482413283670334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012513399124145508, "StateBufferConnector_ms": 0.008794069290161133, "ViewRequirementAgentConnector_ms": 0.41139674186706543}, "num_episodes": 20, "episode_return_max": 531.0701894192038, "episode_return_min": 447.7541554333401, "episode_return_mean": 488.6030911077042, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 345.27231348360147, "num_env_steps_trained_throughput_per_sec": 345.27231348360147, "timesteps_total": 177152, "num_env_steps_sampled_lifetime": 177152, "num_agent_steps_sampled_lifetime": 177152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 177152, "timers": {"training_iteration_time_ms": 3071.258, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3071.258, "sample_time_ms": 1284.94, "learn_time_ms": 1761.463, "learn_throughput": 581.335, "synch_weights_time_ms": 24.755}, "counters": {"num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "done": false, "training_iteration": 173, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-05", "timestamp": 1744127645, "time_this_iter_s": 2.9749088287353516, "time_total_s": 657.0548808574677, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 657.0548808574677, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 45.839999999999996, "ram_util_percent": 91.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.565880061779171, "cur_kl_coeff": 1.6704779438076221e-53, "cur_lr": 1e-07, "total_loss": 2.1874411433935164, "policy_loss": -3.342233248986304e-05, "vf_loss": 10.0, "vf_explained_var": -3.831088542938233e-06, "kl": 1.0147157438758493e-06, "entropy": 3.125254361331463, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "env_runners": {"episode_reward_max": 531.0701894192038, "episode_reward_min": 442.42705219882816, "episode_reward_mean": 487.7370117752434, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 442.42705219882816}, "policy_reward_max": {"tplp_policy": 531.0701894192038}, "policy_reward_mean": {"tplp_policy": 487.7370117752434}, "custom_metrics": {"mean_episode_reward_mean": 487.7370117752434, "mean_episode_reward_min": 442.42705219882816, "mean_episode_reward_max": 531.0701894192038}, "hist_stats": {"episode_reward": [455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [455.25221512807474, 501.3424903324428, 492.2448201682319, 503.49332232075335, 504.5523689780599, 495.0248305300068, 468.70971378761215, 491.18364693019976, 481.8865798402009, 515.3812940721613, 500.5195293587599, 505.9300447079725, 468.46359547334225, 469.4074615817458, 466.81345627945086, 493.40855796934966, 459.8315822636966, 480.9999553278978, 484.2492496760304, 488.1817527302177, 451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.142860033915716, "mean_inference_ms": 3.340169062089891, "mean_action_processing_ms": 0.6247792263669848, "mean_env_wait_ms": 3.4796854927025866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00950479507446289, "StateBufferConnector_ms": 0.01155853271484375, "ViewRequirementAgentConnector_ms": 0.4136042594909668}, "num_episodes": 22, "episode_return_max": 531.0701894192038, "episode_return_min": 442.42705219882816, "episode_return_mean": 487.7370117752434, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 336.780884688954, "num_env_steps_trained_throughput_per_sec": 336.780884688954, "timesteps_total": 178176, "num_env_steps_sampled_lifetime": 178176, "num_agent_steps_sampled_lifetime": 178176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 178176, "timers": {"training_iteration_time_ms": 3069.13, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3069.13, "sample_time_ms": 1281.912, "learn_time_ms": 1762.176, "learn_throughput": 581.1, "synch_weights_time_ms": 24.942}, "counters": {"num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "done": false, "training_iteration": 174, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-08", "timestamp": 1744127648, "time_this_iter_s": 3.0505611896514893, "time_total_s": 660.1054420471191, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 660.1054420471191, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 52.25000000000001, "ram_util_percent": 91.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2365197502076626, "cur_kl_coeff": 8.352389719038111e-54, "cur_lr": 1e-07, "total_loss": 2.1872966289520264, "policy_loss": -3.2111600739881395e-05, "vf_loss": 10.0, "vf_explained_var": -7.322430610656738e-06, "kl": 1.0734231116860116e-06, "entropy": 3.1267126113176347, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "env_runners": {"episode_reward_max": 531.0701894192038, "episode_reward_min": 442.42705219882816, "episode_reward_mean": 488.64620212845324, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 442.42705219882816}, "policy_reward_max": {"tplp_policy": 531.0701894192038}, "policy_reward_mean": {"tplp_policy": 488.64620212845324}, "custom_metrics": {"mean_episode_reward_mean": 488.64620212845324, "mean_episode_reward_min": 442.42705219882816, "mean_episode_reward_max": 531.0701894192038}, "hist_stats": {"episode_reward": [451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [451.1190225394231, 521.7880456010993, 462.04386643133313, 518.6668366350665, 509.2432266605005, 452.98441255235997, 450.55078519876247, 497.26340737716714, 495.0881872330227, 497.30288458717337, 496.00780458974043, 488.46716999294154, 469.93435050926234, 484.2633459061275, 486.24458044819454, 493.4289268529836, 474.40933784697495, 516.4989255849592, 491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.142213509835889, "mean_inference_ms": 3.3378835804189704, "mean_action_processing_ms": 0.624319361686561, "mean_env_wait_ms": 3.4768040560970075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009017705917358398, "StateBufferConnector_ms": 0.014557123184204102, "ViewRequirementAgentConnector_ms": 0.41114234924316406}, "num_episodes": 20, "episode_return_max": 531.0701894192038, "episode_return_min": 442.42705219882816, "episode_return_mean": 488.64620212845324, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 344.56569598147496, "num_env_steps_trained_throughput_per_sec": 344.56569598147496, "timesteps_total": 179200, "num_env_steps_sampled_lifetime": 179200, "num_agent_steps_sampled_lifetime": 179200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 179200, "timers": {"training_iteration_time_ms": 3044.791, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3044.791, "sample_time_ms": 1279.635, "learn_time_ms": 1740.051, "learn_throughput": 588.489, "synch_weights_time_ms": 25.006}, "counters": {"num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "done": false, "training_iteration": 175, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-11", "timestamp": 1744127651, "time_this_iter_s": 2.9805057048797607, "time_total_s": 663.0859477519989, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 663.0859477519989, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 52.65, "ram_util_percent": 91.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.314446538314223, "cur_kl_coeff": 4.1761948595190553e-54, "cur_lr": 1e-07, "total_loss": 2.1871064975857735, "policy_loss": -3.24897700920701e-05, "vf_loss": 10.0, "vf_explained_var": -8.200854063034058e-06, "kl": 1.5655819314064345e-06, "entropy": 3.128610035777092, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "env_runners": {"episode_reward_max": 534.950252503517, "episode_reward_min": 442.42705219882816, "episode_reward_mean": 489.1530134939935, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 442.42705219882816}, "policy_reward_max": {"tplp_policy": 534.950252503517}, "policy_reward_mean": {"tplp_policy": 489.1530134939935}, "custom_metrics": {"mean_episode_reward_mean": 489.1530134939935, "mean_episode_reward_min": 442.42705219882816, "mean_episode_reward_max": 534.950252503517}, "hist_stats": {"episode_reward": [491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.13209065333024, 463.6672067667548, 487.8182858845573, 501.3089815302386, 460.3079046794971, 473.5618604449255, 485.8903365776601, 501.97338827177873, 492.152242930419, 512.4246182400668, 498.57609719823745, 490.9368331139445, 477.0294625369648, 501.7853651494645, 491.6611426657256, 500.9726039352003, 467.0407588058295, 477.4793252578951, 464.46054974504597, 462.2217322241877, 471.37118306390647, 462.18422916082375, 531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1416272223309227, "mean_inference_ms": 3.3353503315630544, "mean_action_processing_ms": 0.6238939538921585, "mean_env_wait_ms": 3.4742849222347063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012028217315673828, "StateBufferConnector_ms": 0.010054826736450195, "ViewRequirementAgentConnector_ms": 0.39903998374938965}, "num_episodes": 18, "episode_return_max": 534.950252503517, "episode_return_min": 442.42705219882816, "episode_return_mean": 489.1530134939935, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 303.7829788994768, "num_env_steps_trained_throughput_per_sec": 303.7829788994768, "timesteps_total": 180224, "num_env_steps_sampled_lifetime": 180224, "num_agent_steps_sampled_lifetime": 180224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 180224, "timers": {"training_iteration_time_ms": 3072.856, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3072.856, "sample_time_ms": 1272.614, "learn_time_ms": 1774.651, "learn_throughput": 577.015, "synch_weights_time_ms": 25.491}, "counters": {"num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "done": false, "training_iteration": 176, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-15", "timestamp": 1744127655, "time_this_iter_s": 3.3796777725219727, "time_total_s": 666.4656255245209, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 666.4656255245209, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 91.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.971887534111738, "cur_kl_coeff": 2.0880974297595277e-54, "cur_lr": 1e-07, "total_loss": 2.1822558298707007, "policy_loss": -2.607907517813146e-05, "vf_loss": 9.981351029872894, "vf_explained_var": -7.293745875358582e-06, "kl": 9.751962389170643e-07, "entropy": 3.130558229982853, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "env_runners": {"episode_reward_max": 534.950252503517, "episode_reward_min": 431.5367791694873, "episode_reward_mean": 490.276181652761, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.5367791694873}, "policy_reward_max": {"tplp_policy": 534.950252503517}, "policy_reward_mean": {"tplp_policy": 490.276181652761}, "custom_metrics": {"mean_episode_reward_mean": 490.276181652761, "mean_episode_reward_min": 431.5367791694873, "mean_episode_reward_max": 534.950252503517}, "hist_stats": {"episode_reward": [531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [531.0701894192038, 509.3489155239924, 499.8470351747821, 501.38522648932815, 469.37897494117215, 459.9894107261947, 487.71988058466104, 504.71428827154097, 507.53940326237154, 514.596095268929, 482.4621448670747, 500.08235818880974, 524.5885217454206, 527.5534019879445, 473.9090375855093, 447.7541554333401, 496.3690232775359, 481.3566388946739, 442.42705219882816, 499.5433515012354, 455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1406556005796984, "mean_inference_ms": 3.3319802884874337, "mean_action_processing_ms": 0.6231435710700243, "mean_env_wait_ms": 3.470869646543917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0213015079498291, "StateBufferConnector_ms": 0.011013984680175781, "ViewRequirementAgentConnector_ms": 0.3666365146636963}, "num_episodes": 22, "episode_return_max": 534.950252503517, "episode_return_min": 431.5367791694873, "episode_return_mean": 490.276181652761, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 314.98544169472405, "num_env_steps_trained_throughput_per_sec": 314.98544169472405, "timesteps_total": 181248, "num_env_steps_sampled_lifetime": 181248, "num_agent_steps_sampled_lifetime": 181248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 181248, "timers": {"training_iteration_time_ms": 3085.812, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3085.812, "sample_time_ms": 1279.252, "learn_time_ms": 1780.556, "learn_throughput": 575.101, "synch_weights_time_ms": 25.784}, "counters": {"num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "done": false, "training_iteration": 177, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-18", "timestamp": 1744127658, "time_this_iter_s": 3.260136842727661, "time_total_s": 669.7257623672485, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 669.7257623672485, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 52.65, "ram_util_percent": 91.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1903815891593696, "cur_kl_coeff": 1.0440487148797638e-54, "cur_lr": 1e-07, "total_loss": 2.176312831789255, "policy_loss": -7.939960050862283e-05, "vf_loss": 9.958628964424133, "vf_explained_var": -6.371736526489258e-06, "kl": 2.231350085057926e-06, "entropy": 3.1326498836278915, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "env_runners": {"episode_reward_max": 534.950252503517, "episode_reward_min": 431.5367791694873, "episode_reward_mean": 488.63514677901776, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.5367791694873}, "policy_reward_max": {"tplp_policy": 534.950252503517}, "policy_reward_mean": {"tplp_policy": 488.63514677901776}, "custom_metrics": {"mean_episode_reward_mean": 488.63514677901776, "mean_episode_reward_min": 431.5367791694873, "mean_episode_reward_max": 534.950252503517}, "hist_stats": {"episode_reward": [455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [455.0528142058938, 491.3596678117247, 486.86524746626094, 496.4768499728774, 525.2929930359281, 502.2202957083441, 461.90772760567495, 454.6209188728231, 493.0237541446767, 471.44532639559884, 501.3332265427522, 495.64897454972237, 510.9249985743909, 460.8622465895857, 478.011399926629, 495.1969102421594, 505.33135488968907, 505.8346208465459, 511.43389578007486, 481.08506618068884, 463.4404760772584, 496.75628068563555, 466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139776094354218, "mean_inference_ms": 3.329455438659877, "mean_action_processing_ms": 0.6225158011933773, "mean_env_wait_ms": 3.468222335269354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019293546676635742, "StateBufferConnector_ms": 0.010016918182373047, "ViewRequirementAgentConnector_ms": 0.3640415668487549}, "num_episodes": 20, "episode_return_max": 534.950252503517, "episode_return_min": 431.5367791694873, "episode_return_mean": 488.63514677901776, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 317.59301967376183, "num_env_steps_trained_throughput_per_sec": 317.59301967376183, "timesteps_total": 182272, "num_env_steps_sampled_lifetime": 182272, "num_agent_steps_sampled_lifetime": 182272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 182272, "timers": {"training_iteration_time_ms": 3101.63, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3101.63, "sample_time_ms": 1293.383, "learn_time_ms": 1782.388, "learn_throughput": 574.51, "synch_weights_time_ms": 25.738}, "counters": {"num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "done": false, "training_iteration": 178, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-22", "timestamp": 1744127662, "time_this_iter_s": 3.2319157123565674, "time_total_s": 672.9576780796051, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BBFA2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 672.9576780796051, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 49.940000000000005, "ram_util_percent": 91.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4222774513065817, "cur_kl_coeff": 5.220243574398819e-55, "cur_lr": 1e-07, "total_loss": 2.181742414832115, "policy_loss": 5.002212128601969e-06, "vf_loss": 9.980794805288316, "vf_explained_var": -6.713345646858215e-06, "kl": 4.6797874208026614e-07, "entropy": 3.13461292386055, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "env_runners": {"episode_reward_max": 534.950252503517, "episode_reward_min": 431.5367791694873, "episode_reward_mean": 489.09412901730406, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.5367791694873}, "policy_reward_max": {"tplp_policy": 534.950252503517}, "policy_reward_mean": {"tplp_policy": 489.09412901730406}, "custom_metrics": {"mean_episode_reward_mean": 489.09412901730406, "mean_episode_reward_min": 431.5367791694873, "mean_episode_reward_max": 534.950252503517}, "hist_stats": {"episode_reward": [466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.16761080756953, 485.89709996393975, 474.5049072891105, 494.5637473276244, 513.1853665962926, 483.3968738630065, 473.44952011140924, 507.93638558166117, 492.2790125430534, 495.53284419417093, 496.1807757854155, 514.6968862382997, 500.21782244428664, 490.9555349446568, 485.4349705984318, 493.03189535606265, 513.8796566208517, 476.2878357484455, 494.7411120209413, 534.950252503517, 481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1388033258615304, "mean_inference_ms": 3.32661062996217, "mean_action_processing_ms": 0.6217986329844938, "mean_env_wait_ms": 3.4651905745096245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029789209365844727, "StateBufferConnector_ms": 0.008688926696777344, "ViewRequirementAgentConnector_ms": 0.3548166751861572}, "num_episodes": 22, "episode_return_max": 534.950252503517, "episode_return_min": 431.5367791694873, "episode_return_mean": 489.09412901730406, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 348.5717818646338, "num_env_steps_trained_throughput_per_sec": 348.5717818646338, "timesteps_total": 183296, "num_env_steps_sampled_lifetime": 183296, "num_agent_steps_sampled_lifetime": 183296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 183296, "timers": {"training_iteration_time_ms": 3097.589, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3097.589, "sample_time_ms": 1294.751, "learn_time_ms": 1777.039, "learn_throughput": 576.24, "synch_weights_time_ms": 25.679}, "counters": {"num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "done": false, "training_iteration": 179, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-25", "timestamp": 1744127665, "time_this_iter_s": 2.945920467376709, "time_total_s": 675.9035985469818, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 675.9035985469818, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 50.050000000000004, "ram_util_percent": 91.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6041078858077524, "cur_kl_coeff": 2.6101217871994096e-55, "cur_lr": 1e-07, "total_loss": 2.184415089339018, "policy_loss": -0.0001015940448269248, "vf_loss": 9.992078429460525, "vf_explained_var": -6.8675726652145386e-06, "kl": 7.615510788427926e-07, "entropy": 3.135029159486294, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "env_runners": {"episode_reward_max": 534.5153647886626, "episode_reward_min": 431.5367791694873, "episode_reward_mean": 488.38016524385034, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.5367791694873}, "policy_reward_max": {"tplp_policy": 534.5153647886626}, "policy_reward_mean": {"tplp_policy": 488.38016524385034}, "custom_metrics": {"mean_episode_reward_mean": 488.38016524385034, "mean_episode_reward_min": 431.5367791694873, "mean_episode_reward_max": 534.5153647886626}, "hist_stats": {"episode_reward": [481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.7899896030312, 502.85687467903495, 472.3011863130428, 484.0627974322673, 524.3537507072605, 478.74117993853633, 472.1428904806797, 459.3704410674766, 506.2846779701441, 511.22689614341675, 488.9260079865305, 476.7310306346943, 500.6452169132881, 487.99079841372287, 486.0850700942923, 452.78608019924076, 474.4301343713168, 497.9969008896966, 508.97267149012856, 501.09570269831255, 506.85789788944555, 500.42762444624924, 496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1378071778686953, "mean_inference_ms": 3.32396054928987, "mean_action_processing_ms": 0.6211539118965588, "mean_env_wait_ms": 3.462424624397983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03028130531311035, "StateBufferConnector_ms": 0.009196996688842773, "ViewRequirementAgentConnector_ms": 0.3403947353363037}, "num_episodes": 20, "episode_return_max": 534.5153647886626, "episode_return_min": 431.5367791694873, "episode_return_mean": 488.38016524385034, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 348.9676609734265, "num_env_steps_trained_throughput_per_sec": 348.9676609734265, "timesteps_total": 184320, "num_env_steps_sampled_lifetime": 184320, "num_agent_steps_sampled_lifetime": 184320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 184320, "timers": {"training_iteration_time_ms": 3105.049, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3105.049, "sample_time_ms": 1297.926, "learn_time_ms": 1780.919, "learn_throughput": 574.984, "synch_weights_time_ms": 26.084}, "counters": {"num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "done": false, "training_iteration": 180, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-28", "timestamp": 1744127668, "time_this_iter_s": 2.941507339477539, "time_total_s": 678.8451058864594, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.8451058864594, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 52.400000000000006, "ram_util_percent": 91.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2682164572179317, "cur_kl_coeff": 1.3050608935997048e-55, "cur_lr": 1e-07, "total_loss": 2.1803972646594048, "policy_loss": -2.707586972974241e-05, "vf_loss": 9.976174461841584, "vf_explained_var": -2.2858381271362306e-06, "kl": 1.739695591956858e-06, "entropy": 3.1361926198005676, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "env_runners": {"episode_reward_max": 534.5153647886626, "episode_reward_min": 431.5367791694873, "episode_reward_mean": 487.56861211723424, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.5367791694873}, "policy_reward_max": {"tplp_policy": 534.5153647886626}, "policy_reward_mean": {"tplp_policy": 487.56861211723424}, "custom_metrics": {"mean_episode_reward_mean": 487.56861211723424, "mean_episode_reward_min": 431.5367791694873, "mean_episode_reward_max": 534.5153647886626}, "hist_stats": {"episode_reward": [496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [496.01187747519185, 502.33960886499636, 474.86274314678934, 507.2593508108298, 501.08320467711394, 476.14977841597556, 491.41242404171015, 534.5153647886626, 469.12536269971315, 451.98811240174194, 483.7097676686159, 488.5310440687031, 464.02932040674153, 477.8040229693104, 431.5367791694873, 508.1333213224815, 492.5917962803716, 467.58024909393515, 496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1367825939465073, "mean_inference_ms": 3.320965668718859, "mean_action_processing_ms": 0.6205587630057053, "mean_env_wait_ms": 3.4602288062691056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024017810821533203, "StateBufferConnector_ms": 0.014723539352416992, "ViewRequirementAgentConnector_ms": 0.30408525466918945}, "num_episodes": 22, "episode_return_max": 534.5153647886626, "episode_return_min": 431.5367791694873, "episode_return_mean": 487.56861211723424, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 293.0782440937972, "num_env_steps_trained_throughput_per_sec": 293.0782440937972, "timesteps_total": 185344, "num_env_steps_sampled_lifetime": 185344, "num_agent_steps_sampled_lifetime": 185344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 185344, "timers": {"training_iteration_time_ms": 3141.738, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3141.636, "sample_time_ms": 1314.681, "learn_time_ms": 1800.718, "learn_throughput": 568.662, "synch_weights_time_ms": 26.117}, "counters": {"num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "done": false, "training_iteration": 181, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-31", "timestamp": 1744127671, "time_this_iter_s": 3.500887870788574, "time_total_s": 682.3459937572479, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC07D080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 682.3459937572479, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 57.120000000000005, "ram_util_percent": 91.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5890391640365125, "cur_kl_coeff": 6.525304467998524e-56, "cur_lr": 1e-07, "total_loss": 2.1836364060640334, "policy_loss": -0.00016067972173914314, "vf_loss": 9.990486085414886, "vf_explained_var": -7.439777255058288e-06, "kl": 1.656094564683741e-06, "entropy": 3.1382443383336067, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "env_runners": {"episode_reward_max": 526.6231176976785, "episode_reward_min": 429.50244120903983, "episode_reward_mean": 487.3755874889817, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.50244120903983}, "policy_reward_max": {"tplp_policy": 526.6231176976785}, "policy_reward_mean": {"tplp_policy": 487.3755874889817}, "custom_metrics": {"mean_episode_reward_mean": 487.3755874889817, "mean_episode_reward_min": 429.50244120903983, "mean_episode_reward_max": 526.6231176976785}, "hist_stats": {"episode_reward": [496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [496.1347885726682, 481.3126133363399, 462.34996382854115, 488.6168121043636, 486.0512600442895, 461.9020230429543, 474.05252314622044, 487.000304267396, 502.7921939483324, 436.26746271729286, 520.4245664165428, 498.7590344391686, 496.04340590531996, 481.8631148096477, 493.5290367026032, 520.7247369842088, 474.7615703939141, 474.77416193411034, 500.409023932481, 466.3734803002361, 461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1360142264042103, "mean_inference_ms": 3.3197709365065875, "mean_action_processing_ms": 0.6201510715578066, "mean_env_wait_ms": 3.4582895523357875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020479679107666016, "StateBufferConnector_ms": 0.01573801040649414, "ViewRequirementAgentConnector_ms": 0.30259180068969727}, "num_episodes": 18, "episode_return_max": 526.6231176976785, "episode_return_min": 429.50244120903983, "episode_return_mean": 487.3755874889817, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 248.97936788787484, "num_env_steps_trained_throughput_per_sec": 248.97936788787484, "timesteps_total": 186368, "num_env_steps_sampled_lifetime": 186368, "num_agent_steps_sampled_lifetime": 186368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 186368, "timers": {"training_iteration_time_ms": 3230.302, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3230.2, "sample_time_ms": 1313.215, "learn_time_ms": 1890.194, "learn_throughput": 541.743, "synch_weights_time_ms": 26.565}, "counters": {"num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "done": false, "training_iteration": 182, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-35", "timestamp": 1744127675, "time_this_iter_s": 4.124331474304199, "time_total_s": 686.4703252315521, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 686.4703252315521, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 60.23333333333333, "ram_util_percent": 91.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1909751541912557, "cur_kl_coeff": 3.262652233999262e-56, "cur_lr": 1e-07, "total_loss": 2.1835302032530306, "policy_loss": -6.975842406973243e-05, "vf_loss": 9.99042280316353, "vf_explained_var": -7.517635822296143e-06, "kl": 2.2118071623999923e-06, "entropy": 3.1400573283433912, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "env_runners": {"episode_reward_max": 536.5418407173071, "episode_reward_min": 429.50244120903983, "episode_reward_mean": 490.8030128091465, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.50244120903983}, "policy_reward_max": {"tplp_policy": 536.5418407173071}, "policy_reward_mean": {"tplp_policy": 490.8030128091465}, "custom_metrics": {"mean_episode_reward_mean": 490.8030128091465, "mean_episode_reward_min": 429.50244120903983, "mean_episode_reward_max": 536.5418407173071}, "hist_stats": {"episode_reward": [461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [461.5204640106597, 483.90048096594836, 489.6847880995517, 497.3748665515814, 495.8408138427327, 472.06038591458554, 485.27794926111636, 475.23348309381726, 513.6528960715192, 480.7290560225529, 515.5266175243928, 498.4501629592651, 486.605899740706, 504.2559227698819, 482.8647826363865, 489.97641689763515, 472.5321055605045, 476.45533670401267, 514.6752193763256, 526.6231176976785, 499.24389394890704, 511.96470573394873, 489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.13521544034824, "mean_inference_ms": 3.317728512698953, "mean_action_processing_ms": 0.6197968691638885, "mean_env_wait_ms": 3.456476085271494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022808313369750977, "StateBufferConnector_ms": 0.016735315322875977, "ViewRequirementAgentConnector_ms": 0.31324243545532227}, "num_episodes": 20, "episode_return_max": 536.5418407173071, "episode_return_min": 429.50244120903983, "episode_return_mean": 490.8030128091465, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 281.7907526002694, "num_env_steps_trained_throughput_per_sec": 281.7907526002694, "timesteps_total": 187392, "num_env_steps_sampled_lifetime": 187392, "num_agent_steps_sampled_lifetime": 187392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 187392, "timers": {"training_iteration_time_ms": 3297.114, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3297.013, "sample_time_ms": 1331.265, "learn_time_ms": 1939.57, "learn_throughput": 527.952, "synch_weights_time_ms": 25.952}, "counters": {"num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "done": false, "training_iteration": 183, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-39", "timestamp": 1744127679, "time_this_iter_s": 3.643038272857666, "time_total_s": 690.1133635044098, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 690.1133635044098, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 60.61999999999999, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.290636122226715, "cur_kl_coeff": 1.631326116999631e-56, "cur_lr": 1e-07, "total_loss": 2.181642109155655, "policy_loss": -6.236868211999536e-05, "vf_loss": 9.98395733833313, "vf_explained_var": -6.290525197982788e-06, "kl": 1.765488506455526e-06, "entropy": 3.1428485408425333, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "env_runners": {"episode_reward_max": 536.5418407173071, "episode_reward_min": 429.50244120903983, "episode_reward_mean": 491.47085833773855, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.50244120903983}, "policy_reward_max": {"tplp_policy": 536.5418407173071}, "policy_reward_mean": {"tplp_policy": 491.47085833773855}, "custom_metrics": {"mean_episode_reward_mean": 491.47085833773855, "mean_episode_reward_min": 429.50244120903983, "mean_episode_reward_max": 536.5418407173071}, "hist_stats": {"episode_reward": [489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.36806416736727, 467.04127363336255, 492.6448269107599, 495.79323904486034, 505.86297105682, 463.17519312166445, 486.04276272915536, 489.7517394912823, 498.78056179775984, 480.3823435312515, 474.81682345280933, 493.7700248400826, 485.39566996037547, 508.4204416543509, 507.82789083323956, 512.5574170475032, 514.4319926080321, 438.62189762983036, 506.2554430335767, 484.58577698548936, 472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1346831946387477, "mean_inference_ms": 3.316108785340104, "mean_action_processing_ms": 0.6194836313350136, "mean_env_wait_ms": 3.455110306889132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013818979263305664, "StateBufferConnector_ms": 0.012052536010742188, "ViewRequirementAgentConnector_ms": 0.3302004337310791}, "num_episodes": 22, "episode_return_max": 536.5418407173071, "episode_return_min": 429.50244120903983, "episode_return_mean": 491.47085833773855, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.39772274338384, "num_env_steps_trained_throughput_per_sec": 309.39772274338384, "timesteps_total": 188416, "num_env_steps_sampled_lifetime": 188416, "num_agent_steps_sampled_lifetime": 188416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 188416, "timers": {"training_iteration_time_ms": 3324.025, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3323.923, "sample_time_ms": 1351.572, "learn_time_ms": 1946.208, "learn_throughput": 526.151, "synch_weights_time_ms": 25.918}, "counters": {"num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "done": false, "training_iteration": 184, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-42", "timestamp": 1744127682, "time_this_iter_s": 3.3164422512054443, "time_total_s": 693.4298057556152, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 693.4298057556152, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 58.15, "ram_util_percent": 92.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5284042857587337, "cur_kl_coeff": 8.156630584998155e-57, "cur_lr": 1e-07, "total_loss": 2.1852242879569532, "policy_loss": -0.00012220408534631134, "vf_loss": 9.999728399515153, "vf_explained_var": -9.117275476455689e-06, "kl": 3.0940612794072564e-06, "entropy": 3.1458561077713965, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "env_runners": {"episode_reward_max": 536.5418407173071, "episode_reward_min": 429.50244120903983, "episode_reward_mean": 490.96019037551844, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.50244120903983}, "policy_reward_max": {"tplp_policy": 536.5418407173071}, "policy_reward_mean": {"tplp_policy": 490.96019037551844}, "custom_metrics": {"mean_episode_reward_mean": 490.96019037551844, "mean_episode_reward_min": 429.50244120903983, "mean_episode_reward_max": 536.5418407173071}, "hist_stats": {"episode_reward": [472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [472.3687330734302, 472.4526910091913, 442.7551623466044, 497.6025345274182, 511.5533557115227, 467.86630432841264, 496.51094831129683, 466.9455849749656, 496.3179750561303, 518.8789718163613, 473.043486793968, 500.8819954073763, 463.9154340441194, 501.7077172710142, 478.09042808557166, 467.5484839333302, 478.19790502879545, 483.7229996560794, 521.1632644081167, 492.5553118974343, 490.6901781572825, 507.0394629538461, 487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1341320261923082, "mean_inference_ms": 3.3145747215753056, "mean_action_processing_ms": 0.6192485798766308, "mean_env_wait_ms": 3.4539033525827483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010839462280273438, "StateBufferConnector_ms": 0.011542320251464844, "ViewRequirementAgentConnector_ms": 0.344771146774292}, "num_episodes": 20, "episode_return_max": 536.5418407173071, "episode_return_min": 429.50244120903983, "episode_return_mean": 490.96019037551844, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 324.5017780112899, "num_env_steps_trained_throughput_per_sec": 324.5017780112899, "timesteps_total": 189440, "num_env_steps_sampled_lifetime": 189440, "num_agent_steps_sampled_lifetime": 189440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 189440, "timers": {"training_iteration_time_ms": 3342.4, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3342.298, "sample_time_ms": 1349.15, "learn_time_ms": 1966.352, "learn_throughput": 520.761, "synch_weights_time_ms": 26.57}, "counters": {"num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "done": false, "training_iteration": 185, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-46", "timestamp": 1744127686, "time_this_iter_s": 3.164030075073242, "time_total_s": 696.5938358306885, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 696.5938358306885, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 47.95, "ram_util_percent": 92.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6303008146584035, "cur_kl_coeff": 4.0783152924990775e-57, "cur_lr": 1e-07, "total_loss": 2.184892674535513, "policy_loss": -0.00013793176622129978, "vf_loss": 10.0, "vf_explained_var": -4.838034510612488e-06, "kl": 4.0713830526506454e-06, "entropy": 3.1496939197182656, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "env_runners": {"episode_reward_max": 536.5418407173071, "episode_reward_min": 429.50244120903983, "episode_reward_mean": 493.0035181976731, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.50244120903983}, "policy_reward_max": {"tplp_policy": 536.5418407173071}, "policy_reward_mean": {"tplp_policy": 493.0035181976731}, "custom_metrics": {"mean_episode_reward_mean": 493.0035181976731, "mean_episode_reward_min": 429.50244120903983, "mean_episode_reward_max": 536.5418407173071}, "hist_stats": {"episode_reward": [487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.5086441811966, 506.35669144894854, 509.20331652037004, 429.50244120903983, 446.19645770921085, 470.5504804059738, 489.62000240342434, 493.6327959432401, 493.5918821823132, 485.6052241978099, 464.64427754787107, 481.87251526858773, 494.9521422430308, 478.5376874762847, 484.11134986454897, 485.74611576413344, 506.35104532098114, 508.11522274655016, 523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1334631783945406, "mean_inference_ms": 3.3126660866283295, "mean_action_processing_ms": 0.6188985603724434, "mean_env_wait_ms": 3.4523093726887284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011356353759765625, "StateBufferConnector_ms": 0.005011558532714844, "ViewRequirementAgentConnector_ms": 0.333585262298584}, "num_episodes": 22, "episode_return_max": 536.5418407173071, "episode_return_min": 429.50244120903983, "episode_return_mean": 493.0035181976731, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 323.274633338291, "num_env_steps_trained_throughput_per_sec": 323.274633338291, "timesteps_total": 190464, "num_env_steps_sampled_lifetime": 190464, "num_agent_steps_sampled_lifetime": 190464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 190464, "timers": {"training_iteration_time_ms": 3322.076, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3321.974, "sample_time_ms": 1354.529, "learn_time_ms": 1940.932, "learn_throughput": 527.582, "synch_weights_time_ms": 26.287}, "counters": {"num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "done": false, "training_iteration": 186, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-49", "timestamp": 1744127689, "time_this_iter_s": 3.174752950668335, "time_total_s": 699.7685887813568, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 699.7685887813568, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 51.779999999999994, "ram_util_percent": 92.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2377339985221623, "cur_kl_coeff": 2.0391576462495387e-57, "cur_lr": 1e-07, "total_loss": 2.184597796946764, "policy_loss": -5.11788937728852e-05, "vf_loss": 10.0, "vf_explained_var": -7.361546158790588e-06, "kl": 2.3752513895303194e-06, "entropy": 3.153510168194771, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "env_runners": {"episode_reward_max": 536.5418407173071, "episode_reward_min": 445.03340832419826, "episode_reward_mean": 494.63027273529946, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.03340832419826}, "policy_reward_max": {"tplp_policy": 536.5418407173071}, "policy_reward_mean": {"tplp_policy": 494.63027273529946}, "custom_metrics": {"mean_episode_reward_mean": 494.63027273529946, "mean_episode_reward_min": 445.03340832419826, "mean_episode_reward_max": 536.5418407173071}, "hist_stats": {"episode_reward": [523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [523.389977345697, 511.55721351883096, 493.3957240811525, 499.6863785504298, 496.176709830524, 478.8303207535129, 494.3616108549959, 494.7879385572482, 525.4982231334236, 521.8334349772764, 481.2212397965787, 497.99670805679176, 536.5418407173071, 445.03340832419826, 500.56503035544006, 515.1177432342789, 520.0772604590219, 496.3475782288662, 472.0100591083667, 505.404094914568, 480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1327924482339358, "mean_inference_ms": 3.310902983209967, "mean_action_processing_ms": 0.6185870931445052, "mean_env_wait_ms": 3.450930150787522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00935816764831543, "StateBufferConnector_ms": 0.005574464797973633, "ViewRequirementAgentConnector_ms": 0.34951186180114746}, "num_episodes": 18, "episode_return_max": 536.5418407173071, "episode_return_min": 445.03340832419826, "episode_return_mean": 494.63027273529946, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 310.78335991715085, "num_env_steps_trained_throughput_per_sec": 310.78335991715085, "timesteps_total": 191488, "num_env_steps_sampled_lifetime": 191488, "num_agent_steps_sampled_lifetime": 191488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 191488, "timers": {"training_iteration_time_ms": 3326.471, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3326.37, "sample_time_ms": 1366.606, "learn_time_ms": 1933.553, "learn_throughput": 529.595, "synch_weights_time_ms": 25.986}, "counters": {"num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "done": false, "training_iteration": 187, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-52", "timestamp": 1744127692, "time_this_iter_s": 3.3018884658813477, "time_total_s": 703.0704772472382, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 703.0704772472382, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 50.980000000000004, "ram_util_percent": 92.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.482150040194392, "cur_kl_coeff": 1.0195788231247694e-57, "cur_lr": 1e-07, "total_loss": 2.182562579959631, "policy_loss": -3.098941524513066e-05, "vf_loss": 9.992605328559875, "vf_explained_var": -8.647888898849488e-06, "kl": 8.713430053819415e-07, "entropy": 3.155577677488327, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "env_runners": {"episode_reward_max": 536.4239312930997, "episode_reward_min": 454.5394552534253, "episode_reward_mean": 492.5529320277736, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 454.5394552534253}, "policy_reward_max": {"tplp_policy": 536.4239312930997}, "policy_reward_mean": {"tplp_policy": 492.5529320277736}, "custom_metrics": {"mean_episode_reward_mean": 492.5529320277736, "mean_episode_reward_min": 454.5394552534253, "mean_episode_reward_max": 536.4239312930997}, "hist_stats": {"episode_reward": [480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.1669198606719, 497.394070092406, 518.2989792920046, 502.159735484298, 454.5394552534253, 531.8813755416539, 530.3938704973663, 476.36094405890594, 477.2055282380071, 505.41667466418863, 466.36305623621234, 502.98256981010366, 480.93185117896894, 508.1324685790379, 499.85945888968774, 489.38191862131293, 502.11234371338924, 493.6969992806207, 473.23064753743085, 533.3108973902993, 499.16869955492075, 480.7359848184401, 484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1319696428375894, "mean_inference_ms": 3.3086057328980796, "mean_action_processing_ms": 0.6181613899565179, "mean_env_wait_ms": 3.4490293002960413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008531808853149414, "StateBufferConnector_ms": 0.006094217300415039, "ViewRequirementAgentConnector_ms": 0.33844947814941406}, "num_episodes": 20, "episode_return_max": 536.4239312930997, "episode_return_min": 454.5394552534253, "episode_return_mean": 492.5529320277736, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.31685289956164, "num_env_steps_trained_throughput_per_sec": 327.31685289956164, "timesteps_total": 192512, "num_env_steps_sampled_lifetime": 192512, "num_agent_steps_sampled_lifetime": 192512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 192512, "timers": {"training_iteration_time_ms": 3316.893, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3316.791, "sample_time_ms": 1352.153, "learn_time_ms": 1938.333, "learn_throughput": 528.289, "synch_weights_time_ms": 26.08}, "counters": {"num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "done": false, "training_iteration": 188, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-56", "timestamp": 1744127696, "time_this_iter_s": 3.1377406120300293, "time_total_s": 706.2082178592682, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 706.2082178592682, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 55.225, "ram_util_percent": 92.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.529471279680729, "cur_kl_coeff": 5.097894115623847e-58, "cur_lr": 1e-07, "total_loss": 2.181771270185709, "policy_loss": -7.889743137639016e-05, "vf_loss": 9.990382605791092, "vf_explained_var": -9.591132402420044e-06, "kl": 2.3592937518052136e-06, "entropy": 3.1574548959732054, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "env_runners": {"episode_reward_max": 536.4239312930997, "episode_reward_min": 455.97829037448935, "episode_reward_mean": 489.74224776330766, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 455.97829037448935}, "policy_reward_max": {"tplp_policy": 536.4239312930997}, "policy_reward_mean": {"tplp_policy": 489.74224776330766}, "custom_metrics": {"mean_episode_reward_mean": 489.74224776330766, "mean_episode_reward_min": 455.97829037448935, "mean_episode_reward_max": 536.4239312930997}, "hist_stats": {"episode_reward": [484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.00306845797775, 502.5056933236066, 476.3353217940455, 479.33285222428077, 487.3273275109933, 469.4565942774602, 472.48524706399655, 479.36881970722953, 466.69775285534985, 496.54105370175216, 519.2705144322316, 474.92415657249074, 498.0439586852069, 480.6155067212497, 490.70958738543175, 488.2001352425656, 482.91093350080604, 515.8263494775208, 498.59884895989796, 490.8569370497562, 512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1308040036669886, "mean_inference_ms": 3.305587735791881, "mean_action_processing_ms": 0.6176510013504913, "mean_env_wait_ms": 3.4465186588923995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009390592575073242, "StateBufferConnector_ms": 0.009105920791625977, "ViewRequirementAgentConnector_ms": 0.3237643241882324}, "num_episodes": 22, "episode_return_max": 536.4239312930997, "episode_return_min": 455.97829037448935, "episode_return_mean": 489.74224776330766, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 346.8728344814414, "num_env_steps_trained_throughput_per_sec": 346.8728344814414, "timesteps_total": 193536, "num_env_steps_sampled_lifetime": 193536, "num_agent_steps_sampled_lifetime": 193536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 3318.331, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3318.23, "sample_time_ms": 1355.039, "learn_time_ms": 1936.566, "learn_throughput": 528.771, "synch_weights_time_ms": 26.4}, "counters": {"num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "done": false, "training_iteration": 189, "trial_id": "f7884_00000", "date": "2025-04-08_23-54-59", "timestamp": 1744127699, "time_this_iter_s": 2.95995831489563, "time_total_s": 709.1681761741638, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 709.1681761741638, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 52.324999999999996, "ram_util_percent": 92.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5393448203802107, "cur_kl_coeff": 2.5489470578119234e-58, "cur_lr": 1e-07, "total_loss": 2.1838693410158156, "policy_loss": -0.00011145035969093443, "vf_loss": 10.0, "vf_explained_var": -7.958710193634034e-06, "kl": 2.354939472579143e-06, "entropy": 3.1601920276880264, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "env_runners": {"episode_reward_max": 536.4239312930997, "episode_reward_min": 454.2523612906031, "episode_reward_mean": 489.71052886358814, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 454.2523612906031}, "policy_reward_max": {"tplp_policy": 536.4239312930997}, "policy_reward_mean": {"tplp_policy": 489.71052886358814}, "custom_metrics": {"mean_episode_reward_mean": 489.71052886358814, "mean_episode_reward_min": 454.2523612906031, "mean_episode_reward_max": 536.4239312930997}, "hist_stats": {"episode_reward": [512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [512.0826508309317, 501.67029440586117, 501.0711613959233, 473.9564848836039, 494.89783702691415, 487.34070683942235, 498.42677637782595, 504.33461460998194, 477.0726106830889, 518.8244424575826, 481.24767075603586, 500.775793180564, 508.5511285045932, 463.4944208937514, 509.7622279812366, 481.77594990216295, 491.9565880438438, 487.7432748369726, 518.0625565416804, 503.6387348461046, 486.2904485127045, 495.41685712813745, 504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1297727813941907, "mean_inference_ms": 3.3028584984226304, "mean_action_processing_ms": 0.6171737790846238, "mean_env_wait_ms": 3.444215928682307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01088404655456543, "StateBufferConnector_ms": 0.008107900619506836, "ViewRequirementAgentConnector_ms": 0.31172776222229004}, "num_episodes": 20, "episode_return_max": 536.4239312930997, "episode_return_min": 454.2523612906031, "episode_return_mean": 489.71052886358814, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.1563333454596, "num_env_steps_trained_throughput_per_sec": 322.1563333454596, "timesteps_total": 194560, "num_env_steps_sampled_lifetime": 194560, "num_agent_steps_sampled_lifetime": 194560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 194560, "timers": {"training_iteration_time_ms": 3342.753, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3342.651, "sample_time_ms": 1355.68, "learn_time_ms": 1960.59, "learn_throughput": 522.292, "synch_weights_time_ms": 26.156}, "counters": {"num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "done": false, "training_iteration": 190, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-02", "timestamp": 1744127702, "time_this_iter_s": 3.186444044113159, "time_total_s": 712.354620218277, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1454E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.354620218277, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 92.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.33319979198277, "cur_kl_coeff": 1.2744735289059617e-58, "cur_lr": 1e-07, "total_loss": 2.1837915785610678, "policy_loss": -3.0358554795384406e-06, "vf_loss": 10.0, "vf_explained_var": -7.826834917068481e-06, "kl": 8.76642357638957e-07, "entropy": 3.1620538920164107, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "env_runners": {"episode_reward_max": 536.4239312930997, "episode_reward_min": 432.32514667919537, "episode_reward_mean": 488.5800996154554, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.32514667919537}, "policy_reward_max": {"tplp_policy": 536.4239312930997}, "policy_reward_mean": {"tplp_policy": 488.5800996154554}, "custom_metrics": {"mean_episode_reward_mean": 488.5800996154554, "mean_episode_reward_min": 432.32514667919537, "mean_episode_reward_max": 536.4239312930997}, "hist_stats": {"episode_reward": [504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [504.0550140319483, 479.3528390516612, 526.4565979029521, 513.7152573357281, 480.24220455757904, 529.2503233441347, 472.57996099609363, 501.4790484206056, 490.90460391010004, 456.3974783312616, 475.87286677913073, 502.23648268614073, 502.0264247203404, 485.52650265924456, 485.6566929826224, 491.31414284576965, 480.8215752120769, 472.6013124607706, 477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.128681527466629, "mean_inference_ms": 3.2997614372144444, "mean_action_processing_ms": 0.6166530396134775, "mean_env_wait_ms": 3.441582019244544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012736797332763672, "StateBufferConnector_ms": 0.013554811477661133, "ViewRequirementAgentConnector_ms": 0.3171975612640381}, "num_episodes": 22, "episode_return_max": 536.4239312930997, "episode_return_min": 432.32514667919537, "episode_return_mean": 488.5800996154554, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 322.3519650935571, "num_env_steps_trained_throughput_per_sec": 322.3519650935571, "timesteps_total": 195584, "num_env_steps_sampled_lifetime": 195584, "num_agent_steps_sampled_lifetime": 195584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 195584, "timers": {"training_iteration_time_ms": 3311.023, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3311.023, "sample_time_ms": 1333.194, "learn_time_ms": 1951.398, "learn_throughput": 524.752, "synch_weights_time_ms": 26.206}, "counters": {"num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "done": false, "training_iteration": 191, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-05", "timestamp": 1744127705, "time_this_iter_s": 3.188884973526001, "time_total_s": 715.543505191803, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 715.543505191803, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 47.78, "ram_util_percent": 92.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6413834042847157, "cur_kl_coeff": 6.372367644529809e-59, "cur_lr": 1e-07, "total_loss": 2.1816616244614124, "policy_loss": -0.00013284089509397746, "vf_loss": 9.992939394712447, "vf_explained_var": -7.773935794830323e-06, "kl": 3.0742324516275233e-06, "entropy": 3.164403718709946, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "env_runners": {"episode_reward_max": 536.4239312930997, "episode_reward_min": 432.32514667919537, "episode_reward_mean": 489.06171463217294, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.32514667919537}, "policy_reward_max": {"tplp_policy": 536.4239312930997}, "policy_reward_mean": {"tplp_policy": 489.06171463217294}, "custom_metrics": {"mean_episode_reward_mean": 489.06171463217294, "mean_episode_reward_min": 432.32514667919537, "mean_episode_reward_max": 536.4239312930997}, "hist_stats": {"episode_reward": [477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.01581991490224, 489.2609335042355, 485.19016971808816, 472.59372358590844, 490.4051343917997, 487.5280410915712, 468.93232089004204, 466.44977468842984, 529.717813945273, 490.32019281424175, 504.67410443172366, 536.4239312930997, 488.055746602969, 486.5898388291472, 480.55540810159243, 511.0183737756823, 513.6443780809482, 470.29983071342184, 496.20038925956686, 469.5637376735634, 477.0141107331878, 508.3319236292326, 472.61118036563505, 523.7151672601055, 512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1278048497639088, "mean_inference_ms": 3.2973117322103978, "mean_action_processing_ms": 0.6162540573547268, "mean_env_wait_ms": 3.4394231790688745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014758825302124023, "StateBufferConnector_ms": 0.016668319702148438, "ViewRequirementAgentConnector_ms": 0.3055400848388672}, "num_episodes": 18, "episode_return_max": 536.4239312930997, "episode_return_min": 432.32514667919537, "episode_return_mean": 489.06171463217294, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 326.3173402936073, "num_env_steps_trained_throughput_per_sec": 326.3173402936073, "timesteps_total": 196608, "num_env_steps_sampled_lifetime": 196608, "num_agent_steps_sampled_lifetime": 196608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 196608, "timers": {"training_iteration_time_ms": 3213.549, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3213.549, "sample_time_ms": 1324.085, "learn_time_ms": 1864.033, "learn_throughput": 549.347, "synch_weights_time_ms": 25.312}, "counters": {"num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "done": false, "training_iteration": 192, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-08", "timestamp": 1744127708, "time_this_iter_s": 3.1450490951538086, "time_total_s": 718.6885542869568, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 718.6885542869568, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 55.1, "ram_util_percent": 92.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.77137598618865, "cur_kl_coeff": 3.1861838222649043e-59, "cur_lr": 1e-07, "total_loss": 2.183085487782955, "policy_loss": -9.874578681774437e-05, "vf_loss": 10.0, "vf_explained_var": -3.610923886299133e-06, "kl": 3.775013764339974e-06, "entropy": 3.1681575372815134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "env_runners": {"episode_reward_max": 533.2777334259439, "episode_reward_min": 432.32514667919537, "episode_reward_mean": 488.1373167703444, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.32514667919537}, "policy_reward_max": {"tplp_policy": 533.2777334259439}, "policy_reward_mean": {"tplp_policy": 488.1373167703444}, "custom_metrics": {"mean_episode_reward_mean": 488.1373167703444, "mean_episode_reward_min": 432.32514667919537, "mean_episode_reward_max": 533.2777334259439}, "hist_stats": {"episode_reward": [512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [512.2848040130257, 478.88681481935635, 464.46602685804567, 486.6941447112611, 490.9768879082018, 455.97829037448935, 469.0670221070118, 461.9964610246444, 485.55337037478364, 465.8706014672575, 482.42669563375773, 483.1147987889601, 466.82188850558344, 499.18416865928015, 487.0434948286948, 484.8540431511126, 480.41903183764583, 486.8440938881831, 513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1266743157013088, "mean_inference_ms": 3.2937222554285652, "mean_action_processing_ms": 0.6157291818782439, "mean_env_wait_ms": 3.4369540911659584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013956308364868164, "StateBufferConnector_ms": 0.016169071197509766, "ViewRequirementAgentConnector_ms": 0.29942870140075684}, "num_episodes": 24, "episode_return_max": 533.2777334259439, "episode_return_min": 432.32514667919537, "episode_return_mean": 488.1373167703444, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 327.35257749245255, "num_env_steps_trained_throughput_per_sec": 327.35257749245255, "timesteps_total": 197632, "num_env_steps_sampled_lifetime": 197632, "num_agent_steps_sampled_lifetime": 197632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 197632, "timers": {"training_iteration_time_ms": 3162.971, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3162.971, "sample_time_ms": 1306.768, "learn_time_ms": 1830.591, "learn_throughput": 559.382, "synch_weights_time_ms": 25.493}, "counters": {"num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "done": false, "training_iteration": 193, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-12", "timestamp": 1744127712, "time_this_iter_s": 3.139125108718872, "time_total_s": 721.8276793956757, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 721.8276793956757, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 55.15, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.296419592946768, "cur_kl_coeff": 1.5930919111324521e-59, "cur_lr": 1e-07, "total_loss": 2.1818892493844033, "policy_loss": -5.443131667561829e-05, "vf_loss": 9.996443349123002, "vf_explained_var": -6.020814180374146e-06, "kl": 1.845284042543971e-06, "entropy": 3.171671484410763, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "env_runners": {"episode_reward_max": 553.9262879471393, "episode_reward_min": 432.07622412334365, "episode_reward_mean": 490.86207517640963, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.07622412334365}, "policy_reward_max": {"tplp_policy": 553.9262879471393}, "policy_reward_mean": {"tplp_policy": 490.86207517640963}, "custom_metrics": {"mean_episode_reward_mean": 490.86207517640963, "mean_episode_reward_min": 432.07622412334365, "mean_episode_reward_max": 553.9262879471393}, "hist_stats": {"episode_reward": [513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.4801434550376, 474.71375911301504, 483.213869546877, 491.552698047088, 520.5976344949506, 479.3296236562866, 526.2670013214772, 477.3512052405734, 497.7172496967179, 458.010662922719, 488.85261854659785, 508.7883949632842, 465.4333482201749, 522.7384225583731, 454.2523612906031, 473.66686923815485, 480.19542203306776, 467.4143589010684, 482.88513489622255, 523.8407417565512, 499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.125816681693478, "mean_inference_ms": 3.291816373267463, "mean_action_processing_ms": 0.615312438064468, "mean_env_wait_ms": 3.4346364608913844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013956308364868164, "StateBufferConnector_ms": 0.0161592960357666, "ViewRequirementAgentConnector_ms": 0.29561471939086914}, "num_episodes": 18, "episode_return_max": 553.9262879471393, "episode_return_min": 432.07622412334365, "episode_return_mean": 490.86207517640963, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 331.58153211906915, "num_env_steps_trained_throughput_per_sec": 331.58153211906915, "timesteps_total": 198656, "num_env_steps_sampled_lifetime": 198656, "num_agent_steps_sampled_lifetime": 198656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 198656, "timers": {"training_iteration_time_ms": 3140.829, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3140.829, "sample_time_ms": 1287.585, "learn_time_ms": 1827.98, "learn_throughput": 560.181, "synch_weights_time_ms": 25.144}, "counters": {"num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "done": false, "training_iteration": 194, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-15", "timestamp": 1744127715, "time_this_iter_s": 3.0983986854553223, "time_total_s": 724.926078081131, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 724.926078081131, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 47.959999999999994, "ram_util_percent": 92.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.688937357440591, "cur_kl_coeff": 7.965459555662261e-60, "cur_lr": 1e-07, "total_loss": 2.1826025947928427, "policy_loss": -5.9476413298398256e-05, "vf_loss": 10.0, "vf_explained_var": -8.76113772392273e-06, "kl": 1.177116637274267e-06, "entropy": 3.1733791321516036, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "env_runners": {"episode_reward_max": 553.9262879471393, "episode_reward_min": 432.07622412334365, "episode_reward_mean": 491.2428380146683, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.07622412334365}, "policy_reward_max": {"tplp_policy": 553.9262879471393}, "policy_reward_mean": {"tplp_policy": 491.2428380146683}, "custom_metrics": {"mean_episode_reward_mean": 491.2428380146683, "mean_episode_reward_min": 432.07622412334365, "mean_episode_reward_max": 553.9262879471393}, "hist_stats": {"episode_reward": [499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.5764186252383, 481.47375918037795, 469.52948424756255, 467.786818314902, 529.1099885403387, 522.1774388025685, 470.5363332436319, 509.838955460169, 432.32514667919537, 516.2193127398355, 485.64300150076446, 483.67197979634204, 479.17668806107014, 450.69438472905284, 495.19678398157976, 522.9694407676097, 503.60589103321774, 480.1297622336718, 497.7666801612531, 481.19616107448905, 498.6968568895139, 487.4234455387782, 480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.124871598858113, "mean_inference_ms": 3.289336608850873, "mean_action_processing_ms": 0.6148385729641125, "mean_env_wait_ms": 3.432449360588125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013955116271972656, "StateBufferConnector_ms": 0.01516103744506836, "ViewRequirementAgentConnector_ms": 0.312863826751709}, "num_episodes": 20, "episode_return_max": 553.9262879471393, "episode_return_min": 432.07622412334365, "episode_return_mean": 491.2428380146683, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 338.952567508304, "num_env_steps_trained_throughput_per_sec": 338.952567508304, "timesteps_total": 199680, "num_env_steps_sampled_lifetime": 199680, "num_agent_steps_sampled_lifetime": 199680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 199680, "timers": {"training_iteration_time_ms": 3127.375, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3127.375, "sample_time_ms": 1288.309, "learn_time_ms": 1814.446, "learn_throughput": 564.36, "synch_weights_time_ms": 24.5}, "counters": {"num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "done": false, "training_iteration": 195, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-18", "timestamp": 1744127718, "time_this_iter_s": 3.0296783447265625, "time_total_s": 727.9557564258575, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 727.9557564258575, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 53.2, "ram_util_percent": 91.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3116976339370012, "cur_kl_coeff": 3.9827297778311304e-60, "cur_lr": 1e-07, "total_loss": 2.182509979605675, "policy_loss": -2.0062969997525216e-05, "vf_loss": 10.0, "vf_explained_var": -8.594617247581482e-06, "kl": 1.1391006324398822e-06, "entropy": 3.1746995225548744, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "env_runners": {"episode_reward_max": 553.9262879471393, "episode_reward_min": 421.9052082570854, "episode_reward_mean": 490.618730945368, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.9052082570854}, "policy_reward_max": {"tplp_policy": 553.9262879471393}, "policy_reward_mean": {"tplp_policy": 490.618730945368}, "custom_metrics": {"mean_episode_reward_mean": 490.618730945368, "mean_episode_reward_min": 421.9052082570854, "mean_episode_reward_max": 553.9262879471393}, "hist_stats": {"episode_reward": [480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.2382006348241, 533.2777334259439, 498.19403732795206, 478.7444355772782, 510.51143593121355, 511.0083862768803, 480.7365209868175, 500.59131919509565, 492.20186401118093, 504.3023896712547, 506.97024767422243, 496.79536859494453, 482.0393570414821, 447.4958081827187, 495.1249344311299, 494.2984885086908, 498.8695274827951, 497.79749124283984, 482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1239271642350628, "mean_inference_ms": 3.286552961826544, "mean_action_processing_ms": 0.6142945728834782, "mean_env_wait_ms": 3.4299272732211095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010589838027954102, "StateBufferConnector_ms": 0.012713193893432617, "ViewRequirementAgentConnector_ms": 0.31603217124938965}, "num_episodes": 22, "episode_return_max": 553.9262879471393, "episode_return_min": 421.9052082570854, "episode_return_mean": 490.618730945368, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 332.97094881937835, "num_env_steps_trained_throughput_per_sec": 332.97094881937835, "timesteps_total": 200704, "num_env_steps_sampled_lifetime": 200704, "num_agent_steps_sampled_lifetime": 200704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 200704, "timers": {"training_iteration_time_ms": 3118.151, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3118.151, "sample_time_ms": 1281.542, "learn_time_ms": 1811.661, "learn_throughput": 565.227, "synch_weights_time_ms": 24.828}, "counters": {"num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "done": false, "training_iteration": 196, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-21", "timestamp": 1744127721, "time_this_iter_s": 3.0851285457611084, "time_total_s": 731.0408849716187, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 731.0408849716187, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 48.925000000000004, "ram_util_percent": 91.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.529746402427554, "cur_kl_coeff": 1.9913648889155652e-60, "cur_lr": 1e-07, "total_loss": 2.178142249584198, "policy_loss": -0.00013389029772952198, "vf_loss": 9.984082078933715, "vf_explained_var": -8.345767855644227e-06, "kl": 3.272182006952562e-06, "entropy": 3.1774436488747595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "env_runners": {"episode_reward_max": 553.9262879471393, "episode_reward_min": 421.9052082570854, "episode_reward_mean": 489.829142306132, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.9052082570854}, "policy_reward_max": {"tplp_policy": 553.9262879471393}, "policy_reward_mean": {"tplp_policy": 489.829142306132}, "custom_metrics": {"mean_episode_reward_mean": 489.829142306132, "mean_episode_reward_min": 421.9052082570854, "mean_episode_reward_max": 553.9262879471393}, "hist_stats": {"episode_reward": [482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.1838409586636, 491.9769169243209, 481.522852647095, 496.1336475614122, 489.63365522980337, 505.9507275921637, 472.73705597170493, 483.8531752090905, 496.3673749558375, 503.55424216901935, 498.8170028433616, 473.86381966885585, 486.9104094206373, 451.8010164732992, 458.4039590383758, 509.36207392769984, 499.5785722681552, 483.5287612049727, 462.85883122509773, 491.37011639422605, 509.2530859065342, 477.3441027955457, 484.8793399091792, 522.8536704423867, 509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.123119679371791, "mean_inference_ms": 3.2841092230559523, "mean_action_processing_ms": 0.6138281853556006, "mean_env_wait_ms": 3.427953021006685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012597799301147461, "StateBufferConnector_ms": 0.007513523101806641, "ViewRequirementAgentConnector_ms": 0.31564831733703613}, "num_episodes": 18, "episode_return_max": 553.9262879471393, "episode_return_min": 421.9052082570854, "episode_return_mean": 489.829142306132, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.6427956168282, "num_env_steps_trained_throughput_per_sec": 328.6427956168282, "timesteps_total": 201728, "num_env_steps_sampled_lifetime": 201728, "num_agent_steps_sampled_lifetime": 201728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 201728, "timers": {"training_iteration_time_ms": 3100.246, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3100.246, "sample_time_ms": 1273.205, "learn_time_ms": 1801.732, "learn_throughput": 568.342, "synch_weights_time_ms": 25.308}, "counters": {"num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "done": false, "training_iteration": 197, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-24", "timestamp": 1744127724, "time_this_iter_s": 3.123866558074951, "time_total_s": 734.1647515296936, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 734.1647515296936, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 47.14, "ram_util_percent": 91.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6929925616830586, "cur_kl_coeff": 9.956824444577826e-61, "cur_lr": 1e-07, "total_loss": 2.1718692809343336, "policy_loss": -6.035567494109273e-05, "vf_loss": 9.960032230615615, "vf_explained_var": -5.682557821273804e-06, "kl": 2.5715488338740045e-06, "entropy": 3.180784261226654, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "env_runners": {"episode_reward_max": 553.9262879471393, "episode_reward_min": 421.9052082570854, "episode_reward_mean": 490.34179195627144, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.9052082570854}, "policy_reward_max": {"tplp_policy": 553.9262879471393}, "policy_reward_mean": {"tplp_policy": 490.34179195627144}, "custom_metrics": {"mean_episode_reward_mean": 490.34179195627144, "mean_episode_reward_min": 421.9052082570854, "mean_episode_reward_max": 553.9262879471393}, "hist_stats": {"episode_reward": [509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.3746750605661, 495.8181851868611, 432.07622412334365, 484.3303901769185, 477.44475115103415, 459.2647037681232, 485.49395297655326, 516.6795362949491, 482.430417627727, 553.9262879471393, 476.6476954270118, 521.0762457667956, 501.87973108147406, 516.3332969839698, 497.2892859230478, 497.16008971074234, 454.306815972759, 497.02459285108114, 487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1221819112976856, "mean_inference_ms": 3.28121614631192, "mean_action_processing_ms": 0.6132158465841588, "mean_env_wait_ms": 3.4255178636621917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010529756546020508, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.3252735137939453}, "num_episodes": 24, "episode_return_max": 553.9262879471393, "episode_return_min": 421.9052082570854, "episode_return_mean": 490.34179195627144, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 314.6398453264162, "num_env_steps_trained_throughput_per_sec": 314.6398453264162, "timesteps_total": 202752, "num_env_steps_sampled_lifetime": 202752, "num_agent_steps_sampled_lifetime": 202752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 202752, "timers": {"training_iteration_time_ms": 3112.85, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3112.85, "sample_time_ms": 1280.734, "learn_time_ms": 1806.808, "learn_throughput": 566.745, "synch_weights_time_ms": 25.308}, "counters": {"num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "done": false, "training_iteration": 198, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-27", "timestamp": 1744127727, "time_this_iter_s": 3.261064052581787, "time_total_s": 737.4258155822754, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 737.4258155822754, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 55.849999999999994, "ram_util_percent": 91.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9872871324419976, "cur_kl_coeff": 4.978412222288913e-61, "cur_lr": 1e-07, "total_loss": 2.1768726378679277, "policy_loss": -6.758683593943715e-05, "vf_loss": 9.980993229150773, "vf_explained_var": -7.288530468940735e-06, "kl": 9.268669598494483e-07, "entropy": 3.183080694079399, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "env_runners": {"episode_reward_max": 548.6127985257458, "episode_reward_min": 421.9052082570854, "episode_reward_mean": 490.6841454255923, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.9052082570854}, "policy_reward_max": {"tplp_policy": 548.6127985257458}, "policy_reward_mean": {"tplp_policy": 490.6841454255923}, "custom_metrics": {"mean_episode_reward_mean": 490.6841454255923, "mean_episode_reward_min": 421.9052082570854, "mean_episode_reward_max": 548.6127985257458}, "hist_stats": {"episode_reward": [487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.5040592641154, 473.08611996039946, 492.57995548582824, 520.5333954437848, 508.6629549428269, 491.9117083739356, 470.15388962247846, 492.8356208256749, 490.34940654586774, 502.2018910032789, 497.7011471115246, 474.5016115970587, 493.50996428347753, 482.5028769410868, 513.5109326559946, 508.88726604722797, 506.36213947638316, 470.25145531992194, 483.61668565494074, 519.151751267271, 474.63001323058535, 477.6755162543369, 439.3974747563784, 499.4043279128751, 478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1215636559730038, "mean_inference_ms": 3.27902843008864, "mean_action_processing_ms": 0.6127706632149964, "mean_env_wait_ms": 3.423671910504501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010529518127441406, "StateBufferConnector_ms": 0.01099085807800293, "ViewRequirementAgentConnector_ms": 0.33353209495544434}, "num_episodes": 18, "episode_return_max": 548.6127985257458, "episode_return_min": 421.9052082570854, "episode_return_mean": 490.6841454255923, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 349.247225902876, "num_env_steps_trained_throughput_per_sec": 349.247225902876, "timesteps_total": 203776, "num_env_steps_sampled_lifetime": 203776, "num_agent_steps_sampled_lifetime": 203776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 203776, "timers": {"training_iteration_time_ms": 3110.98, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3110.843, "sample_time_ms": 1283.512, "learn_time_ms": 1802.584, "learn_throughput": 568.073, "synch_weights_time_ms": 24.747}, "counters": {"num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "done": false, "training_iteration": 199, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-30", "timestamp": 1744127730, "time_this_iter_s": 2.940476417541504, "time_total_s": 740.3662919998169, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 740.3662919998169, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 47.949999999999996, "ram_util_percent": 91.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5591195207089186, "cur_kl_coeff": 2.4892061111444565e-61, "cur_lr": 1e-07, "total_loss": 2.1789483554661273, "policy_loss": -0.00015552998520433902, "vf_loss": 9.990376377105713, "vf_explained_var": -7.586181163787842e-06, "kl": 2.8096374618202803e-06, "entropy": 3.184902074933052, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "env_runners": {"episode_reward_max": 548.6127985257458, "episode_reward_min": 421.9052082570854, "episode_reward_mean": 489.72022176965066, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 421.9052082570854}, "policy_reward_max": {"tplp_policy": 548.6127985257458}, "policy_reward_mean": {"tplp_policy": 489.72022176965066}, "custom_metrics": {"mean_episode_reward_mean": 489.72022176965066, "mean_episode_reward_min": 421.9052082570854, "mean_episode_reward_max": 548.6127985257458}, "hist_stats": {"episode_reward": [478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.85641278590435, 508.4663576337067, 494.18074524819286, 421.9052082570854, 500.43272265163745, 494.9405470724585, 474.66362239251305, 517.6873513685392, 458.3958288313469, 503.21476436585453, 512.6113818195572, 482.7921965496473, 495.1793224488124, 492.07120889467336, 516.8471403014886, 456.2134449733258, 476.5588117547527, 494.10625475355374, 484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1209357710679233, "mean_inference_ms": 3.27607338631856, "mean_action_processing_ms": 0.6123133434232835, "mean_env_wait_ms": 3.4216609767862023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008131027221679688, "StateBufferConnector_ms": 0.009993553161621094, "ViewRequirementAgentConnector_ms": 0.32560181617736816}, "num_episodes": 24, "episode_return_max": 548.6127985257458, "episode_return_min": 421.9052082570854, "episode_return_mean": 489.72022176965066, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 308.8529134148174, "num_env_steps_trained_throughput_per_sec": 308.8529134148174, "timesteps_total": 204800, "num_env_steps_sampled_lifetime": 204800, "num_agent_steps_sampled_lifetime": 204800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 3124.671, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3124.535, "sample_time_ms": 1303.579, "learn_time_ms": 1795.33, "learn_throughput": 570.369, "synch_weights_time_ms": 25.626}, "counters": {"num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "training_iteration": 200, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-34", "timestamp": 1744127734, "time_this_iter_s": 3.3288462162017822, "time_total_s": 743.6951382160187, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1479C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 743.6951382160187, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 47.74, "ram_util_percent": 91.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.403066496178508, "cur_kl_coeff": 1.2446030555722282e-61, "cur_lr": 1e-07, "total_loss": 2.1749348774552346, "policy_loss": -6.411114009097219e-05, "vf_loss": 9.97475546002388, "vf_explained_var": -1.0068714618682862e-05, "kl": 1.3430071809095168e-06, "entropy": 3.186898763477802, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "env_runners": {"episode_reward_max": 548.6127985257458, "episode_reward_min": 430.28644131128544, "episode_reward_mean": 489.6628239583409, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.28644131128544}, "policy_reward_max": {"tplp_policy": 548.6127985257458}, "policy_reward_mean": {"tplp_policy": 489.6628239583409}, "custom_metrics": {"mean_episode_reward_mean": 489.6628239583409, "mean_episode_reward_min": 430.28644131128544, "mean_episode_reward_max": 548.6127985257458}, "hist_stats": {"episode_reward": [484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.3149337705261, 480.62594192609913, 548.6127985257458, 481.8232457324813, 482.8192579549154, 458.2256292229069, 476.41536852580117, 506.6773266670918, 462.9496470035959, 529.2347374411062, 484.5705483487183, 516.5152025867102, 445.9259097155835, 496.5232211471043, 497.1147908666436, 507.2250563303299, 486.9065918368996, 468.96241506351686, 495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.121532735109872, "mean_inference_ms": 3.2778059692572197, "mean_action_processing_ms": 0.6123671216631147, "mean_env_wait_ms": 3.4216017049981757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008644342422485352, "StateBufferConnector_ms": 0.014029979705810547, "ViewRequirementAgentConnector_ms": 0.34351420402526855}, "num_episodes": 18, "episode_return_max": 548.6127985257458, "episode_return_min": 430.28644131128544, "episode_return_mean": 489.6628239583409, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 187.46550667336456, "num_env_steps_trained_throughput_per_sec": 187.46550667336456, "timesteps_total": 205824, "num_env_steps_sampled_lifetime": 205824, "num_agent_steps_sampled_lifetime": 205824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 205824, "timers": {"training_iteration_time_ms": 3353.24, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3353.103, "sample_time_ms": 1446.231, "learn_time_ms": 1879.599, "learn_throughput": 544.797, "synch_weights_time_ms": 27.273}, "counters": {"num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "done": false, "training_iteration": 201, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-40", "timestamp": 1744127740, "time_this_iter_s": 5.478443384170532, "time_total_s": 749.1735816001892, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 749.1735816001892, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 70.30000000000001, "ram_util_percent": 93.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2616909369826317, "cur_kl_coeff": 6.223015277861141e-62, "cur_lr": 1e-07, "total_loss": 2.1787001602351665, "policy_loss": 1.994339982047677e-06, "vf_loss": 9.99037544131279, "vf_explained_var": -9.079650044441224e-06, "kl": 1.5876485641275196e-06, "entropy": 3.18895708322525, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "env_runners": {"episode_reward_max": 529.0852590534159, "episode_reward_min": 430.28644131128544, "episode_reward_mean": 489.3978523110101, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.28644131128544}, "policy_reward_max": {"tplp_policy": 529.0852590534159}, "policy_reward_mean": {"tplp_policy": 489.3978523110101}, "custom_metrics": {"mean_episode_reward_mean": 489.3978523110101, "mean_episode_reward_min": 430.28644131128544, "mean_episode_reward_max": 529.0852590534159}, "hist_stats": {"episode_reward": [495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.7423662513888, 498.74013587932063, 504.708748548852, 483.1908167191572, 511.8157959506552, 519.7209950769156, 430.28644131128544, 472.665531998456, 489.9700152642876, 493.4112637318871, 475.46197086209287, 487.9481693736238, 511.55041331323184, 499.4787470981662, 494.45177338916307, 468.22746178889497, 509.9229780156563, 453.01544529658145, 499.41990512087546, 505.88442542005254, 496.63386412263, 507.88694431779226, 484.7454819432107, 506.1156468917209, 456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.122495212342853, "mean_inference_ms": 3.2806450646379757, "mean_action_processing_ms": 0.6126530848757988, "mean_env_wait_ms": 3.4230469437322713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014228343963623047, "StateBufferConnector_ms": 0.017950057983398438, "ViewRequirementAgentConnector_ms": 0.3854033946990967}, "num_episodes": 18, "episode_return_max": 529.0852590534159, "episode_return_min": 430.28644131128544, "episode_return_mean": 489.3978523110101, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 235.2105668672589, "num_env_steps_trained_throughput_per_sec": 235.2105668672589, "timesteps_total": 206848, "num_env_steps_sampled_lifetime": 206848, "num_agent_steps_sampled_lifetime": 206848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 206848, "timers": {"training_iteration_time_ms": 3474.789, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3474.653, "sample_time_ms": 1510.229, "learn_time_ms": 1937.036, "learn_throughput": 528.643, "synch_weights_time_ms": 27.291}, "counters": {"num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "done": false, "training_iteration": 202, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-44", "timestamp": 1744127744, "time_this_iter_s": 4.361074447631836, "time_total_s": 753.534656047821, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 753.534656047821, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 67.55, "ram_util_percent": 93.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768514445796609, "cur_kl_coeff": 3.1115076389305706e-62, "cur_lr": 1e-07, "total_loss": 2.1759894944727423, "policy_loss": -4.3616007314994934e-05, "vf_loss": 9.980645424127578, "vf_explained_var": -7.1302056312561035e-06, "kl": 1.4428564729662696e-06, "entropy": 3.191282385587692, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "env_runners": {"episode_reward_max": 529.0852590534159, "episode_reward_min": 434.3182114918944, "episode_reward_mean": 489.5554827521706, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 434.3182114918944}, "policy_reward_max": {"tplp_policy": 529.0852590534159}, "policy_reward_mean": {"tplp_policy": 489.5554827521706}, "custom_metrics": {"mean_episode_reward_mean": 489.5554827521706, "mean_episode_reward_min": 434.3182114918944, "mean_episode_reward_max": 529.0852590534159}, "hist_stats": {"episode_reward": [456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [456.0185543204636, 485.3378529578466, 503.60845514986477, 524.2607255925246, 469.79650316668153, 465.2019693928186, 497.28757970691447, 529.0852590534159, 457.1145969912769, 480.8345904265914, 525.2161176096231, 512.6107052501329, 490.82473663070533, 512.3991839555262, 499.9403797994534, 492.3938861234237, 494.84994661095936, 480.966474361757, 499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1238311189236132, "mean_inference_ms": 3.2846656748784553, "mean_action_processing_ms": 0.6130864034805924, "mean_env_wait_ms": 3.425033324018001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016234159469604492, "StateBufferConnector_ms": 0.019732236862182617, "ViewRequirementAgentConnector_ms": 0.38077807426452637}, "num_episodes": 24, "episode_return_max": 529.0852590534159, "episode_return_min": 434.3182114918944, "episode_return_mean": 489.5554827521706, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 264.0599009229871, "num_env_steps_trained_throughput_per_sec": 264.0599009229871, "timesteps_total": 207872, "num_env_steps_sampled_lifetime": 207872, "num_agent_steps_sampled_lifetime": 207872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 207872, "timers": {"training_iteration_time_ms": 3549.767, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3549.631, "sample_time_ms": 1524.332, "learn_time_ms": 1997.695, "learn_throughput": 512.591, "synch_weights_time_ms": 27.507}, "counters": {"num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "done": false, "training_iteration": 203, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-48", "timestamp": 1744127748, "time_this_iter_s": 3.8880372047424316, "time_total_s": 757.4226932525635, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 757.4226932525635, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 49.73333333333333, "ram_util_percent": 93.51666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.311715915799141, "cur_kl_coeff": 1.5557538194652853e-62, "cur_lr": 1e-07, "total_loss": 2.1806748889386656, "policy_loss": 1.0373018449172378e-05, "vf_loss": 10.0, "vf_explained_var": -8.239597082138062e-06, "kl": 1.030853484751404e-06, "entropy": 3.193354870378971, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "env_runners": {"episode_reward_max": 527.5301196415387, "episode_reward_min": 434.3182114918944, "episode_reward_mean": 490.28019856482365, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 434.3182114918944}, "policy_reward_max": {"tplp_policy": 527.5301196415387}, "policy_reward_mean": {"tplp_policy": 490.28019856482365}, "custom_metrics": {"mean_episode_reward_mean": 490.28019856482365, "mean_episode_reward_min": 434.3182114918944, "mean_episode_reward_max": 527.5301196415387}, "hist_stats": {"episode_reward": [499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.5241751219351, 460.2591417541362, 493.9883986240315, 520.0958779593109, 456.47548262808976, 514.7673214069639, 485.5337891141453, 517.5343935339157, 512.9159558957368, 469.1963347186709, 492.88241222317464, 485.36764521794106, 496.9825752270322, 452.5858090879986, 475.9709728131911, 508.5506040231652, 477.86946073230916, 483.16768889882906, 477.302174258621, 474.51438273160016, 459.04030888028353, 484.1884725592844, 482.17496382083465, 503.84324598421904, 487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.124766705191384, "mean_inference_ms": 3.2876711301514003, "mean_action_processing_ms": 0.6134237790113054, "mean_env_wait_ms": 3.4265563156117342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01624131202697754, "StateBufferConnector_ms": 0.016266822814941406, "ViewRequirementAgentConnector_ms": 0.3934206962585449}, "num_episodes": 18, "episode_return_max": 527.5301196415387, "episode_return_min": 434.3182114918944, "episode_return_mean": 490.28019856482365, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 314.782911445286, "num_env_steps_trained_throughput_per_sec": 314.782911445286, "timesteps_total": 208896, "num_env_steps_sampled_lifetime": 208896, "num_agent_steps_sampled_lifetime": 208896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 208896, "timers": {"training_iteration_time_ms": 3566.248, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3566.112, "sample_time_ms": 1524.538, "learn_time_ms": 2013.441, "learn_throughput": 508.582, "synch_weights_time_ms": 27.937}, "counters": {"num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "done": false, "training_iteration": 204, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-51", "timestamp": 1744127751, "time_this_iter_s": 3.2606348991394043, "time_total_s": 760.6833281517029, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1467A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 760.6833281517029, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 56.775000000000006, "ram_util_percent": 93.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3085664603859186, "cur_kl_coeff": 7.778769097326426e-63, "cur_lr": 1e-07, "total_loss": 2.1803555585443974, "policy_loss": -7.412886479869485e-05, "vf_loss": 10.0, "vf_explained_var": -6.0409307479858395e-06, "kl": 2.106839679960615e-06, "entropy": 3.1957031592726706, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "env_runners": {"episode_reward_max": 527.5301196415387, "episode_reward_min": 429.23944297021325, "episode_reward_mean": 490.7353585812605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.23944297021325}, "policy_reward_max": {"tplp_policy": 527.5301196415387}, "policy_reward_mean": {"tplp_policy": 490.7353585812605}, "custom_metrics": {"mean_episode_reward_mean": 490.7353585812605, "mean_episode_reward_min": 429.23944297021325, "mean_episode_reward_max": 527.5301196415387}, "hist_stats": {"episode_reward": [487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.06977547294167, 498.15220544604955, 493.1667580360746, 466.5119513474929, 452.41901887701243, 496.95424870092285, 491.36758353007076, 494.47362368218074, 507.47635918251416, 515.1893427953046, 459.18897717242487, 491.6016586383805, 469.7377449287186, 468.2425135783827, 512.0831994914709, 483.73037028707535, 506.93762629367967, 491.8449419237823, 469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1259036326906844, "mean_inference_ms": 3.2912479635085434, "mean_action_processing_ms": 0.6138228583506583, "mean_env_wait_ms": 3.4284206287775962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018939495086669922, "StateBufferConnector_ms": 0.020496129989624023, "ViewRequirementAgentConnector_ms": 0.3978853225708008}, "num_episodes": 24, "episode_return_max": 527.5301196415387, "episode_return_min": 429.23944297021325, "episode_return_mean": 490.7353585812605, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 305.8414739292903, "num_env_steps_trained_throughput_per_sec": 305.8414739292903, "timesteps_total": 209920, "num_env_steps_sampled_lifetime": 209920, "num_agent_steps_sampled_lifetime": 209920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 209920, "timers": {"training_iteration_time_ms": 3598.955, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3598.818, "sample_time_ms": 1533.833, "learn_time_ms": 2036.685, "learn_throughput": 502.778, "synch_weights_time_ms": 28.103}, "counters": {"num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "done": false, "training_iteration": 205, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-55", "timestamp": 1744127755, "time_this_iter_s": 3.3590657711029053, "time_total_s": 764.0423939228058, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 764.0423939228058, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 49.88, "ram_util_percent": 93.47999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7058627020567654, "cur_kl_coeff": 3.889384548663213e-63, "cur_lr": 1e-07, "total_loss": 2.179030741006136, "policy_loss": -6.463474128395318e-05, "vf_loss": 9.995301842689514, "vf_explained_var": -8.681043982505799e-06, "kl": 7.336951468595032e-07, "entropy": 3.1973008498549462, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "env_runners": {"episode_reward_max": 527.5301196415387, "episode_reward_min": 429.23944297021325, "episode_reward_mean": 490.21601862635276, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.23944297021325}, "policy_reward_max": {"tplp_policy": 527.5301196415387}, "policy_reward_mean": {"tplp_policy": 490.21601862635276}, "custom_metrics": {"mean_episode_reward_mean": 490.21601862635276, "mean_episode_reward_min": 429.23944297021325, "mean_episode_reward_max": 527.5301196415387}, "hist_stats": {"episode_reward": [469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.562888740939, 477.70044010192686, 514.5650040380864, 476.202734182293, 498.08252365693886, 476.8899478091075, 482.2257765932942, 509.05776888867376, 463.7760467617958, 511.68867346924276, 508.2828480246227, 452.94981554155174, 444.56822106963676, 489.67728179240413, 503.1337930633518, 511.7991259813734, 515.6095039692872, 456.52627215290903, 494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1256815380375806, "mean_inference_ms": 3.290711868942603, "mean_action_processing_ms": 0.6137408229483353, "mean_env_wait_ms": 3.427915536053214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022236347198486328, "StateBufferConnector_ms": 0.015456199645996094, "ViewRequirementAgentConnector_ms": 0.36942481994628906}, "num_episodes": 18, "episode_return_max": 527.5301196415387, "episode_return_min": 429.23944297021325, "episode_return_mean": 490.21601862635276, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 308.22830856364516, "num_env_steps_trained_throughput_per_sec": 308.22830856364516, "timesteps_total": 210944, "num_env_steps_sampled_lifetime": 210944, "num_agent_steps_sampled_lifetime": 210944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 210944, "timers": {"training_iteration_time_ms": 3623.642, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3623.505, "sample_time_ms": 1533.194, "learn_time_ms": 2062.008, "learn_throughput": 496.603, "synch_weights_time_ms": 28.107}, "counters": {"num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "done": false, "training_iteration": 206, "trial_id": "f7884_00000", "date": "2025-04-08_23-55-58", "timestamp": 1744127758, "time_this_iter_s": 3.3305811882019043, "time_total_s": 767.3729751110077, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.3729751110077, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 46.54, "ram_util_percent": 93.36000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1129458256065847, "cur_kl_coeff": 1.9446922743316066e-63, "cur_lr": 1e-07, "total_loss": 2.1801563791930674, "policy_loss": -1.812244299799204e-05, "vf_loss": 10.0, "vf_explained_var": -8.226186037063598e-06, "kl": 9.983916035571916e-07, "entropy": 3.198254980146885, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "env_runners": {"episode_reward_max": 527.5301196415387, "episode_reward_min": 429.23944297021325, "episode_reward_mean": 489.3962493329385, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.23944297021325}, "policy_reward_max": {"tplp_policy": 527.5301196415387}, "policy_reward_mean": {"tplp_policy": 489.3962493329385}, "custom_metrics": {"mean_episode_reward_mean": 489.3962493329385, "mean_episode_reward_min": 429.23944297021325, "mean_episode_reward_max": 527.5301196415387}, "hist_stats": {"episode_reward": [494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [494.68633527104413, 498.2855743652835, 513.5542458133211, 455.521628807952, 499.38781186776816, 470.68572818932756, 482.29443886418284, 503.15127778948295, 479.14937933344925, 489.6331320415004, 502.52286515549633, 434.3182114918944, 483.9065200312389, 516.5050249471348, 477.4574569665153, 508.9348434596565, 497.51961061763774, 526.1250003951262, 526.5825563193587, 508.54676292207364, 448.3240813887626, 527.5301196415387, 498.9387699513421, 505.0256707834028, 485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1251352849951377, "mean_inference_ms": 3.2887724704549686, "mean_action_processing_ms": 0.6134399932941799, "mean_env_wait_ms": 3.42596478395093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01891922950744629, "StateBufferConnector_ms": 0.012840032577514648, "ViewRequirementAgentConnector_ms": 0.33742284774780273}, "num_episodes": 18, "episode_return_max": 527.5301196415387, "episode_return_min": 429.23944297021325, "episode_return_mean": 489.3962493329385, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 306.42820610710714, "num_env_steps_trained_throughput_per_sec": 306.42820610710714, "timesteps_total": 211968, "num_env_steps_sampled_lifetime": 211968, "num_agent_steps_sampled_lifetime": 211968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 211968, "timers": {"training_iteration_time_ms": 3646.23, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3646.094, "sample_time_ms": 1524.506, "learn_time_ms": 2093.685, "learn_throughput": 489.09, "synch_weights_time_ms": 27.706}, "counters": {"num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "done": false, "training_iteration": 207, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-02", "timestamp": 1744127762, "time_this_iter_s": 3.3536317348480225, "time_total_s": 770.7266068458557, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD146480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 770.7266068458557, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 45.760000000000005, "ram_util_percent": 93.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.875996833667159, "cur_kl_coeff": 9.723461371658033e-64, "cur_lr": 1e-07, "total_loss": 2.1771674707531927, "policy_loss": -0.00025730699417181313, "vf_loss": 9.990373301506043, "vf_explained_var": -8.269771933555603e-06, "kl": 5.558392651972e-06, "entropy": 3.201685535907745, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "env_runners": {"episode_reward_max": 526.0126356116607, "episode_reward_min": 429.23944297021325, "episode_reward_mean": 489.56039157024793, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.23944297021325}, "policy_reward_max": {"tplp_policy": 526.0126356116607}, "policy_reward_mean": {"tplp_policy": 489.56039157024793}, "custom_metrics": {"mean_episode_reward_mean": 489.56039157024793, "mean_episode_reward_min": 429.23944297021325, "mean_episode_reward_max": 526.0126356116607}, "hist_stats": {"episode_reward": [485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.5452338963603, 521.2046130701095, 508.55004036729684, 475.35597414461506, 516.3307535571274, 489.8496982147797, 501.17382840570576, 493.1812796248371, 507.24800604117655, 469.36560073239394, 482.9138521529919, 468.902318896396, 501.1011608394969, 502.8217744508004, 519.0508322509427, 503.65969098550363, 509.43015199255694, 429.23944297021325, 482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1243851493026926, "mean_inference_ms": 3.286176183902661, "mean_action_processing_ms": 0.6130557612715147, "mean_env_wait_ms": 3.423572060210608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022381067276000977, "StateBufferConnector_ms": 0.01239323616027832, "ViewRequirementAgentConnector_ms": 0.3354196548461914}, "num_episodes": 24, "episode_return_max": 526.0126356116607, "episode_return_min": 429.23944297021325, "episode_return_mean": 489.56039157024793, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 291.2149836572568, "num_env_steps_trained_throughput_per_sec": 291.2149836572568, "timesteps_total": 212992, "num_env_steps_sampled_lifetime": 212992, "num_agent_steps_sampled_lifetime": 212992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 212992, "timers": {"training_iteration_time_ms": 3672.409, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3672.273, "sample_time_ms": 1534.394, "learn_time_ms": 2109.347, "learn_throughput": 485.458, "synch_weights_time_ms": 28.335}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "done": false, "training_iteration": 208, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-05", "timestamp": 1744127765, "time_this_iter_s": 3.5278570652008057, "time_total_s": 774.2544639110565, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1454E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 774.2544639110565, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 52.68000000000001, "ram_util_percent": 93.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.697351215034723, "cur_kl_coeff": 4.8617306858290166e-64, "cur_lr": 1e-07, "total_loss": 2.179135382920504, "policy_loss": -0.00017757756286300718, "vf_loss": 10.0, "vf_explained_var": -7.6070427894592285e-06, "kl": 5.162120192636621e-06, "entropy": 3.2068702831864355, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "env_runners": {"episode_reward_max": 535.0677961992722, "episode_reward_min": 440.4854097188632, "episode_reward_mean": 490.52754621462054, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.4854097188632}, "policy_reward_max": {"tplp_policy": 535.0677961992722}, "policy_reward_mean": {"tplp_policy": 490.52754621462054}, "custom_metrics": {"mean_episode_reward_mean": 490.52754621462054, "mean_episode_reward_min": 440.4854097188632, "mean_episode_reward_max": 535.0677961992722}, "hist_stats": {"episode_reward": [482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.05217464170806, 499.8462617495874, 486.95009421242287, 526.0126356116607, 492.38955818949347, 469.2206847915348, 510.93813148453955, 492.68012806057754, 495.3066413894757, 449.8136190525826, 453.92752523410905, 511.3354143748264, 496.70933948316684, 479.81094709892113, 500.0263401163082, 484.10968278825595, 486.8358286774983, 522.3177451190361, 507.07617337585435, 464.01963166291426, 482.84036950939907, 497.3590672724704, 491.9733662194435, 489.03449605486554, 504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1237959370334005, "mean_inference_ms": 3.2843272794019582, "mean_action_processing_ms": 0.6127589239778535, "mean_env_wait_ms": 3.421810043247284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025435209274291992, "StateBufferConnector_ms": 0.011939764022827148, "ViewRequirementAgentConnector_ms": 0.3078441619873047}, "num_episodes": 18, "episode_return_max": 535.0677961992722, "episode_return_min": 440.4854097188632, "episode_return_mean": 490.52754621462054, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 328.8859972906326, "num_env_steps_trained_throughput_per_sec": 328.8859972906326, "timesteps_total": 214016, "num_env_steps_sampled_lifetime": 214016, "num_agent_steps_sampled_lifetime": 214016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 214016, "timers": {"training_iteration_time_ms": 3690.425, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3690.425, "sample_time_ms": 1536.337, "learn_time_ms": 2124.988, "learn_throughput": 481.885, "synch_weights_time_ms": 28.904}, "counters": {"num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "done": false, "training_iteration": 209, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-09", "timestamp": 1744127769, "time_this_iter_s": 3.123053550720215, "time_total_s": 777.3775174617767, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 777.3775174617767, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 53.87499999999999, "ram_util_percent": 93.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.385960387438536, "cur_kl_coeff": 2.4308653429145083e-64, "cur_lr": 1e-07, "total_loss": 2.1765064880251885, "policy_loss": -1.829566899687052e-05, "vf_loss": 9.99037316441536, "vf_explained_var": -8.595362305641175e-06, "kl": 2.108035549319709e-06, "entropy": 3.2106850683689117, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "env_runners": {"episode_reward_max": 535.0677961992722, "episode_reward_min": 439.264474459549, "episode_reward_mean": 490.58041463884626, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.264474459549}, "policy_reward_max": {"tplp_policy": 535.0677961992722}, "policy_reward_mean": {"tplp_policy": 490.58041463884626}, "custom_metrics": {"mean_episode_reward_mean": 490.58041463884626, "mean_episode_reward_min": 439.264474459549, "mean_episode_reward_max": 535.0677961992722}, "hist_stats": {"episode_reward": [504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [504.21584282746295, 477.6233489002582, 497.3835878910833, 506.43049295134307, 463.2910166802785, 472.0340915702302, 482.8527254247739, 462.02425124739545, 502.0463890292127, 484.3603148423208, 466.7811793760588, 507.4905471543249, 479.6123152722219, 489.3730666388438, 479.9425927643112, 477.744279049278, 450.55158218813193, 445.99933718257927, 486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1229693217973977, "mean_inference_ms": 3.2819594891086155, "mean_action_processing_ms": 0.612371194563634, "mean_env_wait_ms": 3.4193891689427307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02576136589050293, "StateBufferConnector_ms": 0.010709285736083984, "ViewRequirementAgentConnector_ms": 0.30822205543518066}, "num_episodes": 24, "episode_return_max": 535.0677961992722, "episode_return_min": 439.264474459549, "episode_return_mean": 490.58041463884626, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 305.23106032179203, "num_env_steps_trained_throughput_per_sec": 305.23106032179203, "timesteps_total": 215040, "num_env_steps_sampled_lifetime": 215040, "num_agent_steps_sampled_lifetime": 215040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 3694.359, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3694.359, "sample_time_ms": 1526.66, "learn_time_ms": 2138.964, "learn_throughput": 478.736, "synch_weights_time_ms": 28.538}, "counters": {"num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "done": false, "training_iteration": 210, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-12", "timestamp": 1744127772, "time_this_iter_s": 3.367377996444702, "time_total_s": 780.7448954582214, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD2591C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 780.7448954582214, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 93.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361891084909439, "cur_kl_coeff": 1.2154326714572541e-64, "cur_lr": 1e-07, "total_loss": 2.17629109993577, "policy_loss": -3.2904703402891755e-05, "vf_loss": 9.990373009443283, "vf_explained_var": -9.747222065925598e-06, "kl": 1.091203917535921e-06, "entropy": 3.2126921877264976, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "env_runners": {"episode_reward_max": 535.0677961992722, "episode_reward_min": 439.264474459549, "episode_reward_mean": 492.02860388000727, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.264474459549}, "policy_reward_max": {"tplp_policy": 535.0677961992722}, "policy_reward_mean": {"tplp_policy": 492.02860388000727}, "custom_metrics": {"mean_episode_reward_mean": 492.02860388000727, "mean_episode_reward_min": 439.264474459549, "mean_episode_reward_max": 535.0677961992722}, "hist_stats": {"episode_reward": [486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [486.4238022288244, 490.69453656178473, 485.9180959949076, 490.53138352919393, 496.4768595853388, 485.27632456953853, 483.56661147072884, 523.4420962079524, 476.384330479558, 502.7312460240866, 495.87617460955374, 484.3234167576596, 443.4296186022825, 484.598652735467, 469.86991425747607, 484.2277535109378, 492.30008002695934, 493.56063633823294, 523.603063648772, 518.0717431992814, 489.9976052347333, 505.51726370550074, 497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1226486936260058, "mean_inference_ms": 3.2808145813767995, "mean_action_processing_ms": 0.612152128397636, "mean_env_wait_ms": 3.4181213630810863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02094888687133789, "StateBufferConnector_ms": 0.010565757751464844, "ViewRequirementAgentConnector_ms": 0.31660962104797363}, "num_episodes": 18, "episode_return_max": 535.0677961992722, "episode_return_min": 439.264474459549, "episode_return_mean": 492.02860388000727, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 287.0185049823985, "num_env_steps_trained_throughput_per_sec": 287.0185049823985, "timesteps_total": 216064, "num_env_steps_sampled_lifetime": 216064, "num_agent_steps_sampled_lifetime": 216064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 216064, "timers": {"training_iteration_time_ms": 3504.896, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3504.896, "sample_time_ms": 1418.748, "learn_time_ms": 2059.038, "learn_throughput": 497.32, "synch_weights_time_ms": 26.81}, "counters": {"num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "done": false, "training_iteration": 211, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-16", "timestamp": 1744127776, "time_this_iter_s": 3.576200008392334, "time_total_s": 784.3210954666138, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 784.3210954666138, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 54.52, "ram_util_percent": 93.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.744500195607543, "cur_kl_coeff": 6.077163357286271e-65, "cur_lr": 1e-07, "total_loss": 2.178236063569784, "policy_loss": -0.00024880943819880483, "vf_loss": 9.999904906749725, "vf_explained_var": -2.8911978006362916e-06, "kl": 4.5740691890491795e-06, "entropy": 3.214913550019264, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "env_runners": {"episode_reward_max": 535.4033924006344, "episode_reward_min": 439.264474459549, "episode_reward_mean": 490.74611902315536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.264474459549}, "policy_reward_max": {"tplp_policy": 535.4033924006344}, "policy_reward_mean": {"tplp_policy": 490.74611902315536}, "custom_metrics": {"mean_episode_reward_mean": 490.74611902315536, "mean_episode_reward_min": 439.264474459549, "mean_episode_reward_max": 535.4033924006344}, "hist_stats": {"episode_reward": [497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.92897170268924, 477.7383824792089, 510.9617645649946, 475.9842871620919, 509.3827156255336, 458.54744279276395, 510.73324575210637, 476.2440556913669, 494.7177887636603, 518.5655925330084, 501.791715183698, 487.65717942513, 513.3171756819388, 441.14886278870375, 469.747364838123, 496.20680107147365, 492.39197686138215, 508.885555074086, 509.053115424122, 440.4854097188632, 448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1223904468142265, "mean_inference_ms": 3.2790762586308517, "mean_action_processing_ms": 0.6119855087705443, "mean_env_wait_ms": 3.4169655598487476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017667055130004883, "StateBufferConnector_ms": 0.010944843292236328, "ViewRequirementAgentConnector_ms": 0.30865478515625}, "num_episodes": 22, "episode_return_max": 535.4033924006344, "episode_return_min": 439.264474459549, "episode_return_mean": 490.74611902315536, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 303.31484306321084, "num_env_steps_trained_throughput_per_sec": 303.31484306321084, "timesteps_total": 217088, "num_env_steps_sampled_lifetime": 217088, "num_agent_steps_sampled_lifetime": 217088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 217088, "timers": {"training_iteration_time_ms": 3407.145, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3407.145, "sample_time_ms": 1349.633, "learn_time_ms": 2029.874, "learn_throughput": 504.465, "synch_weights_time_ms": 27.435}, "counters": {"num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "done": false, "training_iteration": 212, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-19", "timestamp": 1744127779, "time_this_iter_s": 3.3872499465942383, "time_total_s": 787.708345413208, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.708345413208, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 45.22, "ram_util_percent": 93.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6476264845579864, "cur_kl_coeff": 3.0385816786431353e-65, "cur_lr": 1e-07, "total_loss": 2.1779968976974486, "policy_loss": -0.00014719546597916633, "vf_loss": 10.0, "vf_explained_var": -7.154792547225952e-06, "kl": 3.484086179428303e-06, "entropy": 3.218559183180332, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "env_runners": {"episode_reward_max": 535.4033924006344, "episode_reward_min": 439.264474459549, "episode_reward_mean": 491.4726129882818, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.264474459549}, "policy_reward_max": {"tplp_policy": 535.4033924006344}, "policy_reward_mean": {"tplp_policy": 491.4726129882818}, "custom_metrics": {"mean_episode_reward_mean": 491.4726129882818, "mean_episode_reward_min": 439.264474459549, "mean_episode_reward_max": 535.4033924006344}, "hist_stats": {"episode_reward": [448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [448.42545706515193, 491.28039327144916, 501.56230760067206, 487.38324839326606, 526.7225580183507, 498.03691697466644, 498.9296082681696, 498.3333593001316, 517.8875439467877, 535.0677961992722, 496.2828768799425, 526.4327307115899, 491.00803728651516, 497.55922151740987, 519.1021879421914, 498.0869485120152, 484.87330645373834, 489.87041327713735, 483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1220469990069628, "mean_inference_ms": 3.2780433046074418, "mean_action_processing_ms": 0.6117005661815899, "mean_env_wait_ms": 3.4154855019451724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011202335357666016, "StateBufferConnector_ms": 0.011282920837402344, "ViewRequirementAgentConnector_ms": 0.3136589527130127}, "num_episodes": 20, "episode_return_max": 535.4033924006344, "episode_return_min": 439.264474459549, "episode_return_mean": 491.4726129882818, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 304.0053125952236, "num_env_steps_trained_throughput_per_sec": 304.0053125952236, "timesteps_total": 218112, "num_env_steps_sampled_lifetime": 218112, "num_agent_steps_sampled_lifetime": 218112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 218112, "timers": {"training_iteration_time_ms": 3356.19, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3356.19, "sample_time_ms": 1342.687, "learn_time_ms": 1985.981, "learn_throughput": 515.614, "synch_weights_time_ms": 27.119}, "counters": {"num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "done": false, "training_iteration": 213, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-23", "timestamp": 1744127783, "time_this_iter_s": 3.3758857250213623, "time_total_s": 791.0842311382294, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1454E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 791.0842311382294, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 56.324999999999996, "ram_util_percent": 92.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.284310319274664, "cur_kl_coeff": 1.5192908393215677e-65, "cur_lr": 1e-07, "total_loss": 2.175859875231981, "policy_loss": -5.345261888578534e-05, "vf_loss": 9.991895896196365, "vf_explained_var": -9.419769048690796e-06, "kl": 9.26725718652932e-07, "entropy": 3.2206062778830526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "env_runners": {"episode_reward_max": 535.4033924006344, "episode_reward_min": 439.264474459549, "episode_reward_mean": 489.72836226805003, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 439.264474459549}, "policy_reward_max": {"tplp_policy": 535.4033924006344}, "policy_reward_mean": {"tplp_policy": 489.72836226805003}, "custom_metrics": {"mean_episode_reward_mean": 489.72836226805003, "mean_episode_reward_min": 439.264474459549, "mean_episode_reward_max": 535.4033924006344}, "hist_stats": {"episode_reward": [483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.7126580547603, 481.1072755919691, 494.45098195876477, 494.62316600893655, 532.4302278993806, 439.264474459549, 494.65056636018744, 497.9556327674287, 480.06208759041806, 504.77508503035784, 502.932092575005, 488.3207790753563, 467.8709432180808, 475.87270169118, 489.9491554096056, 486.07934988063937, 496.672826360222, 515.4130386385825, 506.97117078616316, 494.8409675291262, 493.6405279841188, 481.5332699925135, 504.29240312866307, 466.57189776406426, 508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1218148137448691, "mean_inference_ms": 3.2767219013211455, "mean_action_processing_ms": 0.6114867954474428, "mean_env_wait_ms": 3.41433374334934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008208751678466797, "StateBufferConnector_ms": 0.013311624526977539, "ViewRequirementAgentConnector_ms": 0.31199169158935547}, "num_episodes": 18, "episode_return_max": 535.4033924006344, "episode_return_min": 439.264474459549, "episode_return_mean": 489.72836226805003, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 311.18087527913207, "num_env_steps_trained_throughput_per_sec": 311.18087527913207, "timesteps_total": 219136, "num_env_steps_sampled_lifetime": 219136, "num_agent_steps_sampled_lifetime": 219136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 219136, "timers": {"training_iteration_time_ms": 3359.956, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3359.956, "sample_time_ms": 1344.226, "learn_time_ms": 1988.459, "learn_throughput": 514.972, "synch_weights_time_ms": 26.97}, "counters": {"num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "done": false, "training_iteration": 214, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-26", "timestamp": 1744127786, "time_this_iter_s": 3.302027940750122, "time_total_s": 794.3862590789795, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 794.3862590789795, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 47.60000000000001, "ram_util_percent": 92.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4950504526495934, "cur_kl_coeff": 7.596454196607838e-66, "cur_lr": 1e-07, "total_loss": 2.1764727145433427, "policy_loss": -6.988504319451749e-05, "vf_loss": 9.99478713274002, "vf_explained_var": -8.637458086013794e-06, "kl": 1.3654623842285219e-06, "entropy": 3.2215418606996535, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "env_runners": {"episode_reward_max": 535.4033924006344, "episode_reward_min": 444.173862936406, "episode_reward_mean": 489.51003670098345, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.173862936406}, "policy_reward_max": {"tplp_policy": 535.4033924006344}, "policy_reward_mean": {"tplp_policy": 489.51003670098345}, "custom_metrics": {"mean_episode_reward_mean": 489.51003670098345, "mean_episode_reward_min": 444.173862936406, "mean_episode_reward_max": 535.4033924006344}, "hist_stats": {"episode_reward": [508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [508.14271031304787, 501.34124914111226, 500.5536746383791, 502.12542033465184, 486.98498345275584, 483.85981343773096, 475.6712509410579, 497.0089377202872, 468.45728159812757, 513.3961434844418, 505.0224743272521, 466.0264450300586, 471.0496177644149, 502.845750521879, 478.0036267558559, 463.222204752432, 498.34947420790417, 509.9851019533228, 488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1214952642405, "mean_inference_ms": 3.2750267977622434, "mean_action_processing_ms": 0.6111830042407135, "mean_env_wait_ms": 3.412965156114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020487070083618164, "StateBufferConnector_ms": 0.015856027603149414, "ViewRequirementAgentConnector_ms": 0.3048741817474365}, "num_episodes": 24, "episode_return_max": 535.4033924006344, "episode_return_min": 444.173862936406, "episode_return_mean": 489.51003670098345, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.7560182915387, "num_env_steps_trained_throughput_per_sec": 309.7560182915387, "timesteps_total": 220160, "num_env_steps_sampled_lifetime": 220160, "num_agent_steps_sampled_lifetime": 220160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 220160, "timers": {"training_iteration_time_ms": 3355.725, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3355.725, "sample_time_ms": 1348.231, "learn_time_ms": 1980.18, "learn_throughput": 517.125, "synch_weights_time_ms": 27.012}, "counters": {"num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "done": false, "training_iteration": 215, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-29", "timestamp": 1744127789, "time_this_iter_s": 3.3146095275878906, "time_total_s": 797.7008686065674, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 797.7008686065674, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 45.18, "ram_util_percent": 92.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4375977374613287, "cur_kl_coeff": 3.798227098303919e-66, "cur_lr": 1e-07, "total_loss": 2.177533308416605, "policy_loss": -5.865118582732975e-05, "vf_loss": 10.0, "vf_explained_var": -1.0554492473602294e-05, "kl": 2.6637682589258914e-06, "entropy": 3.2240804180502893, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "env_runners": {"episode_reward_max": 535.4033924006344, "episode_reward_min": 444.173862936406, "episode_reward_mean": 490.10190915668517, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.173862936406}, "policy_reward_max": {"tplp_policy": 535.4033924006344}, "policy_reward_mean": {"tplp_policy": 490.10190915668517}, "custom_metrics": {"mean_episode_reward_mean": 490.10190915668517, "mean_episode_reward_min": 444.173862936406, "mean_episode_reward_max": 535.4033924006344}, "hist_stats": {"episode_reward": [488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [488.67354376296583, 479.73550679793834, 488.08935854322135, 474.41430820228055, 511.87893843402765, 458.12223692510344, 475.25761502215994, 506.8303259289854, 482.042257232803, 479.20573863305395, 535.4033924006344, 506.82824419648125, 472.9311598647651, 499.5307264819905, 486.410477275191, 444.173862936406, 468.4557046734653, 457.9071365000116, 497.3087519829182, 457.0388616379498, 516.0836604117584, 493.2000215125088, 507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1210508453688393, "mean_inference_ms": 3.2734460132026055, "mean_action_processing_ms": 0.6108891710523868, "mean_env_wait_ms": 3.4116258145157876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301192283630371, "StateBufferConnector_ms": 0.01742243766784668, "ViewRequirementAgentConnector_ms": 0.3046226501464844}, "num_episodes": 18, "episode_return_max": 535.4033924006344, "episode_return_min": 444.173862936406, "episode_return_mean": 490.10190915668517, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 290.81119648559275, "num_env_steps_trained_throughput_per_sec": 290.81119648559275, "timesteps_total": 221184, "num_env_steps_sampled_lifetime": 221184, "num_agent_steps_sampled_lifetime": 221184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 221184, "timers": {"training_iteration_time_ms": 3375.622, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3375.622, "sample_time_ms": 1357.805, "learn_time_ms": 1989.989, "learn_throughput": 514.576, "synch_weights_time_ms": 27.526}, "counters": {"num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "done": false, "training_iteration": 216, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-33", "timestamp": 1744127793, "time_this_iter_s": 3.531385660171509, "time_total_s": 801.2322542667389, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD2594E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.2322542667389, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 50.12, "ram_util_percent": 92.93999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.583203790150583, "cur_kl_coeff": 1.8991135491519596e-66, "cur_lr": 1e-07, "total_loss": 2.17372295409441, "policy_loss": -5.063244025222957e-05, "vf_loss": 9.985614037513733, "vf_explained_var": -6.771832704544067e-06, "kl": 9.114912947083553e-07, "entropy": 3.226299250125885, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "env_runners": {"episode_reward_max": 526.8048364872704, "episode_reward_min": 449.0359388963698, "episode_reward_mean": 493.6768378134597, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 449.0359388963698}, "policy_reward_max": {"tplp_policy": 526.8048364872704}, "policy_reward_mean": {"tplp_policy": 493.6768378134597}, "custom_metrics": {"mean_episode_reward_mean": 493.6768378134597, "mean_episode_reward_min": 449.0359388963698, "mean_episode_reward_max": 526.8048364872704}, "hist_stats": {"episode_reward": [507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.5417835166555, 500.567460224362, 495.1634761934788, 476.9091758285414, 492.70525929090275, 478.71083423775013, 482.2311876594502, 500.98140222612204, 500.5682938793658, 485.12391457941163, 504.5331847805056, 475.5986231980996, 512.9907743659869, 493.23881809612584, 509.5939147464931, 464.9719822741243, 483.93916913548054, 489.48586349045934, 451.13324717008095, 514.3466012822632, 488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1207699349251106, "mean_inference_ms": 3.2721667108533574, "mean_action_processing_ms": 0.6106227655644844, "mean_env_wait_ms": 3.4104468616866206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02250218391418457, "StateBufferConnector_ms": 0.015880823135375977, "ViewRequirementAgentConnector_ms": 0.33132290840148926}, "num_episodes": 22, "episode_return_max": 526.8048364872704, "episode_return_min": 449.0359388963698, "episode_return_mean": 493.6768378134597, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 278.14058050809643, "num_env_steps_trained_throughput_per_sec": 278.14058050809643, "timesteps_total": 222208, "num_env_steps_sampled_lifetime": 222208, "num_agent_steps_sampled_lifetime": 222208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 222208, "timers": {"training_iteration_time_ms": 3409.608, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3409.608, "sample_time_ms": 1399.332, "learn_time_ms": 1982.563, "learn_throughput": 516.503, "synch_weights_time_ms": 27.412}, "counters": {"num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "done": false, "training_iteration": 217, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-37", "timestamp": 1744127797, "time_this_iter_s": 3.689544200897217, "time_total_s": 804.9217984676361, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 804.9217984676361, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 56.90000000000001, "ram_util_percent": 93.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.449072935432196, "cur_kl_coeff": 9.495567745759798e-67, "cur_lr": 1e-07, "total_loss": 2.1746969699859617, "policy_loss": -0.0001294965681154281, "vf_loss": 9.99036899805069, "vf_explained_var": -7.996335625648499e-06, "kl": 2.3852664642304287e-06, "entropy": 3.2276578336954116, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "env_runners": {"episode_reward_max": 526.8048364872704, "episode_reward_min": 441.01869244585487, "episode_reward_mean": 493.31849162058387, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.01869244585487}, "policy_reward_max": {"tplp_policy": 526.8048364872704}, "policy_reward_mean": {"tplp_policy": 493.31849162058387}, "custom_metrics": {"mean_episode_reward_mean": 493.31849162058387, "mean_episode_reward_min": 441.01869244585487, "mean_episode_reward_max": 526.8048364872704}, "hist_stats": {"episode_reward": [488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [488.9019927427241, 460.84768330043096, 461.70291779259503, 473.9268666963046, 495.8187357467845, 493.3744692951039, 525.1905277877983, 520.8404278773564, 495.26509029650157, 499.4071398292588, 481.46414981300484, 484.6318969963234, 500.31954646346986, 485.97738443446536, 513.5084704528639, 485.76269161795017, 512.5550616107586, 507.83676755533253, 493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1205371819873609, "mean_inference_ms": 3.2711815792121914, "mean_action_processing_ms": 0.6103966710245912, "mean_env_wait_ms": 3.409384519093484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02445077896118164, "StateBufferConnector_ms": 0.014219045639038086, "ViewRequirementAgentConnector_ms": 0.31285595893859863}, "num_episodes": 20, "episode_return_max": 526.8048364872704, "episode_return_min": 441.01869244585487, "episode_return_mean": 493.31849162058387, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 305.4394012858563, "num_env_steps_trained_throughput_per_sec": 305.4394012858563, "timesteps_total": 223232, "num_env_steps_sampled_lifetime": 223232, "num_agent_steps_sampled_lifetime": 223232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 223232, "timers": {"training_iteration_time_ms": 3393.232, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3393.232, "sample_time_ms": 1390.742, "learn_time_ms": 1975.05, "learn_throughput": 518.468, "synch_weights_time_ms": 27.139}, "counters": {"num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "done": false, "training_iteration": 218, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-40", "timestamp": 1744127800, "time_this_iter_s": 3.3607499599456787, "time_total_s": 808.2825484275818, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD2584A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 808.2825484275818, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 50.00000000000001, "ram_util_percent": 93.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.427328745648265, "cur_kl_coeff": 4.747783872879899e-67, "cur_lr": 1e-07, "total_loss": 2.176925402134657, "policy_loss": -0.00012245160178281367, "vf_loss": 10.0, "vf_explained_var": -9.646639227867126e-06, "kl": 1.910434280683049e-06, "entropy": 3.229521541297436, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "env_runners": {"episode_reward_max": 526.8048364872704, "episode_reward_min": 438.4514936386258, "episode_reward_mean": 492.84956610348, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.4514936386258}, "policy_reward_max": {"tplp_policy": 526.8048364872704}, "policy_reward_mean": {"tplp_policy": 492.84956610348}, "custom_metrics": {"mean_episode_reward_mean": 492.84956610348, "mean_episode_reward_min": 438.4514936386258, "mean_episode_reward_max": 526.8048364872704}, "hist_stats": {"episode_reward": [493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [493.6236363806281, 509.42451633530254, 496.91013970006975, 488.609159413619, 461.4226591013143, 517.7885198202188, 479.31969655597453, 506.3375793182875, 477.2344826887054, 502.40430442559347, 503.22810798408966, 502.9816449509615, 519.9560497727878, 480.00577544082785, 492.22522209028375, 506.7111769042964, 463.6599485624553, 449.0359388963698, 469.08263679144784, 477.0409624672587, 482.2708621671665, 452.4958741146711, 491.13592721384674, 487.4040482540361, 513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1203492384059497, "mean_inference_ms": 3.2704074324350176, "mean_action_processing_ms": 0.6101984988113756, "mean_env_wait_ms": 3.4085725011845707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028488636016845703, "StateBufferConnector_ms": 0.012612581253051758, "ViewRequirementAgentConnector_ms": 0.31020092964172363}, "num_episodes": 18, "episode_return_max": 526.8048364872704, "episode_return_min": 438.4514936386258, "episode_return_mean": 492.84956610348, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 298.0450383832193, "num_env_steps_trained_throughput_per_sec": 298.0450383832193, "timesteps_total": 224256, "num_env_steps_sampled_lifetime": 224256, "num_agent_steps_sampled_lifetime": 224256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 224256, "timers": {"training_iteration_time_ms": 3425.451, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3425.4, "sample_time_ms": 1402.094, "learn_time_ms": 1995.216, "learn_throughput": 513.228, "synch_weights_time_ms": 27.788}, "counters": {"num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "done": false, "training_iteration": 219, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-44", "timestamp": 1744127804, "time_this_iter_s": 3.446289300918579, "time_total_s": 811.7288377285004, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 811.7288377285004, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 47.52, "ram_util_percent": 93.05999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.935921137873083, "cur_kl_coeff": 2.3738919364399495e-67, "cur_lr": 1e-07, "total_loss": 2.169359966367483, "policy_loss": -0.00030135952401906253, "vf_loss": 9.970938408374787, "vf_explained_var": -1.0627880692481995e-05, "kl": 2.9771908474529598e-06, "entropy": 3.2307326555252076, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "env_runners": {"episode_reward_max": 526.8048364872704, "episode_reward_min": 430.5925125935766, "episode_reward_mean": 492.5147972411341, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.5925125935766}, "policy_reward_max": {"tplp_policy": 526.8048364872704}, "policy_reward_mean": {"tplp_policy": 492.5147972411341}, "custom_metrics": {"mean_episode_reward_mean": 492.5147972411341, "mean_episode_reward_min": 430.5925125935766, "mean_episode_reward_max": 526.8048364872704}, "hist_stats": {"episode_reward": [513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.7518410206795, 494.47702144642756, 513.5989868115005, 460.3664342916994, 492.93509781724026, 486.89956283076975, 510.44915305436035, 486.3421730990448, 508.11303597320614, 524.0449541602869, 492.30147096949673, 455.4685612739435, 489.56337144569903, 505.78534191131644, 495.09077240723974, 483.50565196408706, 505.41268853524826, 499.25551478847547, 490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1200667003938711, "mean_inference_ms": 3.269396182990962, "mean_action_processing_ms": 0.6099529882245439, "mean_env_wait_ms": 3.4076466813035036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013167619705200195, "StateBufferConnector_ms": 0.007575273513793945, "ViewRequirementAgentConnector_ms": 0.3211500644683838}, "num_episodes": 24, "episode_return_max": 526.8048364872704, "episode_return_min": 430.5925125935766, "episode_return_mean": 492.5147972411341, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 298.35750656530445, "num_env_steps_trained_throughput_per_sec": 298.35750656530445, "timesteps_total": 225280, "num_env_steps_sampled_lifetime": 225280, "num_agent_steps_sampled_lifetime": 225280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 225280, "timers": {"training_iteration_time_ms": 3433.179, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3433.129, "sample_time_ms": 1411.613, "learn_time_ms": 1993.858, "learn_throughput": 513.577, "synch_weights_time_ms": 27.357}, "counters": {"num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "done": false, "training_iteration": 220, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-47", "timestamp": 1744127807, "time_this_iter_s": 3.440107822418213, "time_total_s": 815.1689455509186, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 815.1689455509186, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 60.00000000000001, "ram_util_percent": 93.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8459385387599467, "cur_kl_coeff": 1.1869459682199747e-67, "cur_lr": 1e-07, "total_loss": 2.1740394704043866, "policy_loss": -0.00020608010818250476, "vf_loss": 9.990485769510268, "vf_explained_var": -8.855387568473816e-06, "kl": 5.200102739610913e-06, "entropy": 3.233758708834648, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "env_runners": {"episode_reward_max": 526.8048364872704, "episode_reward_min": 430.5925125935766, "episode_reward_mean": 490.7666344028372, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.5925125935766}, "policy_reward_max": {"tplp_policy": 526.8048364872704}, "policy_reward_mean": {"tplp_policy": 490.7666344028372}, "custom_metrics": {"mean_episode_reward_mean": 490.7666344028372, "mean_episode_reward_min": 430.5925125935766, "mean_episode_reward_max": 526.8048364872704}, "hist_stats": {"episode_reward": [490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [490.0799667399172, 486.06033313766306, 504.1645259329287, 488.853944455132, 513.6717029938096, 505.3779433887547, 502.42630573751916, 498.23519091108597, 518.13879440952, 491.20721004952844, 517.3638762503338, 496.24885784206515, 491.5893658638567, 506.00572946676664, 518.9290534293632, 504.74077052687454, 505.63229588231025, 526.8048364872704, 491.4761583863653, 475.3396298192891, 478.1123941144206, 479.52756948110476, 453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1199385979484593, "mean_inference_ms": 3.2689408573504606, "mean_action_processing_ms": 0.6097746332201811, "mean_env_wait_ms": 3.4073079010701317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010644674301147461, "StateBufferConnector_ms": 0.011987686157226562, "ViewRequirementAgentConnector_ms": 0.32536792755126953}, "num_episodes": 18, "episode_return_max": 526.8048364872704, "episode_return_min": 430.5925125935766, "episode_return_mean": 490.7666344028372, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 292.1523271385458, "num_env_steps_trained_throughput_per_sec": 292.1523271385458, "timesteps_total": 226304, "num_env_steps_sampled_lifetime": 226304, "num_agent_steps_sampled_lifetime": 226304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 226304, "timers": {"training_iteration_time_ms": 3426.91, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3426.86, "sample_time_ms": 1400.726, "learn_time_ms": 1997.419, "learn_throughput": 512.661, "synch_weights_time_ms": 28.399}, "counters": {"num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "done": false, "training_iteration": 221, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-51", "timestamp": 1744127811, "time_this_iter_s": 3.512427568435669, "time_total_s": 818.6813731193542, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 818.6813731193542, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 45.6, "ram_util_percent": 93.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444626896828413, "cur_kl_coeff": 5.934729841099874e-68, "cur_lr": 1e-07, "total_loss": 2.1762116365134716, "policy_loss": -4.5113789383322e-05, "vf_loss": 10.0, "vf_explained_var": -7.44648277759552e-06, "kl": 1.7891968053768137e-06, "entropy": 3.2374324277043343, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "env_runners": {"episode_reward_max": 522.2406825299146, "episode_reward_min": 430.5925125935766, "episode_reward_mean": 488.6167004656922, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.5925125935766}, "policy_reward_max": {"tplp_policy": 522.2406825299146}, "policy_reward_mean": {"tplp_policy": 488.6167004656922}, "custom_metrics": {"mean_episode_reward_mean": 488.6167004656922, "mean_episode_reward_min": 430.5925125935766, "mean_episode_reward_max": 522.2406825299146}, "hist_stats": {"episode_reward": [453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.05909384138215, 504.36949523138594, 498.7358689932804, 473.4964616311573, 511.9371353505268, 511.83585033081033, 512.1218236021032, 506.13282380307936, 477.9778584886982, 497.8372437440038, 463.0445917676146, 499.6931621912119, 506.9773784499572, 506.57704568462805, 441.01869244585487, 489.511227281357, 473.22264501605247, 499.3119854394443, 438.4514936386258, 468.1850979666885, 477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1195954275730793, "mean_inference_ms": 3.2681410542907003, "mean_action_processing_ms": 0.6095468964392788, "mean_env_wait_ms": 3.4069194732559804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014722824096679688, "StateBufferConnector_ms": 0.013025999069213867, "ViewRequirementAgentConnector_ms": 0.3160722255706787}, "num_episodes": 22, "episode_return_max": 522.2406825299146, "episode_return_min": 430.5925125935766, "episode_return_mean": 488.6167004656922, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 292.5607266351017, "num_env_steps_trained_throughput_per_sec": 292.5607266351017, "timesteps_total": 227328, "num_env_steps_sampled_lifetime": 227328, "num_agent_steps_sampled_lifetime": 227328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 227328, "timers": {"training_iteration_time_ms": 3439.32, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3439.269, "sample_time_ms": 1418.42, "learn_time_ms": 1992.265, "learn_throughput": 513.988, "synch_weights_time_ms": 28.268}, "counters": {"num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "done": false, "training_iteration": 222, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-55", "timestamp": 1744127815, "time_this_iter_s": 3.514101266860962, "time_total_s": 822.1954743862152, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD1454E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 822.1954743862152, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 52.3, "ram_util_percent": 93.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.524345685169101, "cur_kl_coeff": 2.967364920549937e-68, "cur_lr": 1e-07, "total_loss": 2.174288762360811, "policy_loss": -0.00016767948400229216, "vf_loss": 9.993873691558838, "vf_explained_var": -8.685141801834107e-06, "kl": 3.483592766695409e-06, "entropy": 3.240119697153568, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "env_runners": {"episode_reward_max": 523.9659755735136, "episode_reward_min": 430.5925125935766, "episode_reward_mean": 490.4791515321038, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.5925125935766}, "policy_reward_max": {"tplp_policy": 523.9659755735136}, "policy_reward_mean": {"tplp_policy": 490.4791515321038}, "custom_metrics": {"mean_episode_reward_mean": 490.4791515321038, "mean_episode_reward_min": 430.5925125935766, "mean_episode_reward_max": 523.9659755735136}, "hist_stats": {"episode_reward": [477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.04623043875813, 511.7811612638374, 485.96472769175926, 505.16976888766334, 503.4909775019877, 496.67595013430605, 481.3478638339639, 490.1412239301414, 486.1148882767439, 515.6157588682145, 484.8284884081244, 492.7677614186307, 505.20767884694766, 489.188340057489, 506.63084130016006, 501.8310161346038, 471.2074208798535, 511.52580179104365, 519.0230941864965, 506.6772975973845, 471.4861094332396, 430.5925125935766, 489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.119393984710245, "mean_inference_ms": 3.2676038630300486, "mean_action_processing_ms": 0.6093629210941544, "mean_env_wait_ms": 3.406743266545253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01523447036743164, "StateBufferConnector_ms": 0.01404714584350586, "ViewRequirementAgentConnector_ms": 0.3761105537414551}, "num_episodes": 20, "episode_return_max": 523.9659755735136, "episode_return_min": 430.5925125935766, "episode_return_mean": 490.4791515321038, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 301.95023344199876, "num_env_steps_trained_throughput_per_sec": 301.95023344199876, "timesteps_total": 228352, "num_env_steps_sampled_lifetime": 228352, "num_agent_steps_sampled_lifetime": 228352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 228352, "timers": {"training_iteration_time_ms": 3441.612, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3441.562, "sample_time_ms": 1433.034, "learn_time_ms": 1979.879, "learn_throughput": 517.203, "synch_weights_time_ms": 28.531}, "counters": {"num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "done": false, "training_iteration": 223, "trial_id": "f7884_00000", "date": "2025-04-08_23-56-58", "timestamp": 1744127818, "time_this_iter_s": 3.3997740745544434, "time_total_s": 825.5952484607697, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 825.5952484607697, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 54.525, "ram_util_percent": 93.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5249854411929844, "cur_kl_coeff": 1.4836824602749684e-68, "cur_lr": 1e-07, "total_loss": 2.173231530934572, "policy_loss": -7.218655082397163e-05, "vf_loss": 9.990366888046264, "vf_explained_var": -4.991143941879272e-06, "kl": 1.7450172471455971e-06, "entropy": 3.2428799882531165, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "env_runners": {"episode_reward_max": 544.0307160544762, "episode_reward_min": 436.1113354059562, "episode_reward_mean": 491.89551070993605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 436.1113354059562}, "policy_reward_max": {"tplp_policy": 544.0307160544762}, "policy_reward_mean": {"tplp_policy": 491.89551070993605}, "custom_metrics": {"mean_episode_reward_mean": 491.89551070993605, "mean_episode_reward_min": 436.1113354059562, "mean_episode_reward_max": 544.0307160544762}, "hist_stats": {"episode_reward": [489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.9660436030213, 479.82651274982294, 498.12201972266905, 502.7651164792735, 489.7313229690309, 477.21441955702676, 491.57262220487456, 501.53278013332584, 485.5890859612779, 512.5132801963107, 516.2756395073983, 493.1734395175212, 436.1113354059562, 479.263898398281, 476.9785557016908, 447.9456099313697, 479.7194441433297, 508.0186204518449, 469.7022452825846, 467.6164183113423, 483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1191892764455447, "mean_inference_ms": 3.266622945168061, "mean_action_processing_ms": 0.6092313231678473, "mean_env_wait_ms": 3.4066384686946005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013121604919433594, "StateBufferConnector_ms": 0.013034343719482422, "ViewRequirementAgentConnector_ms": 0.3904733657836914}, "num_episodes": 22, "episode_return_max": 544.0307160544762, "episode_return_min": 436.1113354059562, "episode_return_mean": 491.89551070993605, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 299.2951629561333, "num_env_steps_trained_throughput_per_sec": 299.2951629561333, "timesteps_total": 229376, "num_env_steps_sampled_lifetime": 229376, "num_agent_steps_sampled_lifetime": 229376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 229376, "timers": {"training_iteration_time_ms": 3454.681, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3454.63, "sample_time_ms": 1438.085, "learn_time_ms": 1987.18, "learn_throughput": 515.303, "synch_weights_time_ms": 29.247}, "counters": {"num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "done": false, "training_iteration": 224, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-01", "timestamp": 1744127821, "time_this_iter_s": 3.434882164001465, "time_total_s": 829.0301306247711, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 829.0301306247711, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 48.279999999999994, "ram_util_percent": 93.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.86277030184865, "cur_kl_coeff": 7.418412301374842e-69, "cur_lr": 1e-07, "total_loss": 2.175301268696785, "policy_loss": -0.0001335539447609335, "vf_loss": 10.0, "vf_explained_var": -1.0388344526290893e-05, "kl": 3.8141393739365982e-06, "entropy": 3.2456518396735192, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "env_runners": {"episode_reward_max": 544.0307160544762, "episode_reward_min": 440.580765390173, "episode_reward_mean": 492.33519533108165, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.580765390173}, "policy_reward_max": {"tplp_policy": 544.0307160544762}, "policy_reward_mean": {"tplp_policy": 492.33519533108165}, "custom_metrics": {"mean_episode_reward_mean": 492.33519533108165, "mean_episode_reward_min": 440.580765390173, "mean_episode_reward_max": 544.0307160544762}, "hist_stats": {"episode_reward": [483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.6633597585669, 489.96671543729315, 470.2297805882751, 504.44846266186505, 504.57009509011357, 498.7217781240107, 447.40713583978953, 493.05426479346, 503.8717238072047, 521.6206647245637, 447.2925702040621, 491.06064136520547, 500.94543457617453, 499.80666508832195, 465.982074194814, 482.5853201233842, 470.44763094881256, 464.3646074247561, 499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1190744100426542, "mean_inference_ms": 3.2665349906363796, "mean_action_processing_ms": 0.6091241451297431, "mean_env_wait_ms": 3.4061208393555766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013609647750854492, "StateBufferConnector_ms": 0.010885953903198242, "ViewRequirementAgentConnector_ms": 0.405853271484375}, "num_episodes": 20, "episode_return_max": 544.0307160544762, "episode_return_min": 440.580765390173, "episode_return_mean": 492.33519533108165, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 246.14959475845808, "num_env_steps_trained_throughput_per_sec": 246.14959475845808, "timesteps_total": 230400, "num_env_steps_sampled_lifetime": 230400, "num_agent_steps_sampled_lifetime": 230400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 230400, "timers": {"training_iteration_time_ms": 3540.105, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3540.054, "sample_time_ms": 1445.354, "learn_time_ms": 2064.326, "learn_throughput": 496.046, "synch_weights_time_ms": 30.156}, "counters": {"num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "done": false, "training_iteration": 225, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-06", "timestamp": 1744127826, "time_this_iter_s": 4.175509929656982, "time_total_s": 833.2056405544281, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD144860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 833.2056405544281, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 51.43333333333334, "ram_util_percent": 93.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5948300525546073, "cur_kl_coeff": 3.709206150687421e-69, "cur_lr": 1e-07, "total_loss": 2.172679980844259, "policy_loss": -0.00010765155893750488, "vf_loss": 9.99036676287651, "vf_explained_var": -8.86581838130951e-06, "kl": 1.2995742170396341e-06, "entropy": 3.248040774464607, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "env_runners": {"episode_reward_max": 544.243772103242, "episode_reward_min": 440.580765390173, "episode_reward_mean": 493.1807364264753, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.580765390173}, "policy_reward_max": {"tplp_policy": 544.243772103242}, "policy_reward_mean": {"tplp_policy": 493.1807364264753}, "custom_metrics": {"mean_episode_reward_mean": 493.1807364264753, "mean_episode_reward_min": 440.580765390173, "mean_episode_reward_max": 544.243772103242}, "hist_stats": {"episode_reward": [499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.7040417012463, 522.2406825299146, 479.1660698616792, 468.56916295818735, 495.4126912644107, 487.617492650944, 516.3581457575785, 487.28937528786884, 504.2930899766813, 497.1672708151285, 473.32764404992326, 505.92833952827056, 495.5073319625316, 497.85529182659553, 469.6954923488361, 476.3249429342169, 493.6345679544626, 484.4055599438488, 501.4786185835079, 484.20501128197253, 507.0384603217094, 517.4937618273526, 511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1193370508921705, "mean_inference_ms": 3.266841298559431, "mean_action_processing_ms": 0.6091810286683528, "mean_env_wait_ms": 3.4063155250939987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016110897064208984, "StateBufferConnector_ms": 0.011888742446899414, "ViewRequirementAgentConnector_ms": 0.41666674613952637}, "num_episodes": 18, "episode_return_max": 544.243772103242, "episode_return_min": 440.580765390173, "episode_return_mean": 493.1807364264753, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 230.24228942453465, "num_env_steps_trained_throughput_per_sec": 230.24228942453465, "timesteps_total": 231424, "num_env_steps_sampled_lifetime": 231424, "num_agent_steps_sampled_lifetime": 231424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 231424, "timers": {"training_iteration_time_ms": 3632.735, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3632.585, "sample_time_ms": 1502.08, "learn_time_ms": 2099.782, "learn_throughput": 487.67, "synch_weights_time_ms": 30.505}, "counters": {"num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "done": false, "training_iteration": 226, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-10", "timestamp": 1744127830, "time_this_iter_s": 4.458714246749878, "time_total_s": 837.664354801178, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 837.664354801178, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 63.800000000000004, "ram_util_percent": 94.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7166407741606236, "cur_kl_coeff": 1.8546030753437105e-69, "cur_lr": 1e-07, "total_loss": 2.174759951978922, "policy_loss": -0.00016813433612696826, "vf_loss": 10.0, "vf_explained_var": -9.644031524658204e-06, "kl": 4.719800770303096e-06, "entropy": 3.2507190883159636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "env_runners": {"episode_reward_max": 544.243772103242, "episode_reward_min": 440.580765390173, "episode_reward_mean": 492.1016328217935, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 440.580765390173}, "policy_reward_max": {"tplp_policy": 544.243772103242}, "policy_reward_mean": {"tplp_policy": 492.1016328217935}, "custom_metrics": {"mean_episode_reward_mean": 492.1016328217935, "mean_episode_reward_min": 440.580765390173, "mean_episode_reward_max": 544.243772103242}, "hist_stats": {"episode_reward": [511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [511.27443090308583, 440.580765390173, 514.9595614750943, 522.8046714417595, 504.1182296636955, 514.3427258844964, 497.12611883832255, 492.43809857020693, 523.9659755735136, 502.12801648782454, 469.4666896290665, 500.68906468167745, 454.96911693850046, 499.79927962649447, 466.1580577844025, 508.57835323903373, 483.7312355948888, 488.0794676677231, 504.8496369521865, 486.46348806314006, 519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1198567128839771, "mean_inference_ms": 3.267502235620335, "mean_action_processing_ms": 0.6092544341076583, "mean_env_wait_ms": 3.406602245017892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01302647590637207, "StateBufferConnector_ms": 0.01235818862915039, "ViewRequirementAgentConnector_ms": 0.37905335426330566}, "num_episodes": 22, "episode_return_max": 544.243772103242, "episode_return_min": 440.580765390173, "episode_return_mean": 492.1016328217935, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 272.5385753529211, "num_env_steps_trained_throughput_per_sec": 272.5385753529211, "timesteps_total": 232448, "num_env_steps_sampled_lifetime": 232448, "num_agent_steps_sampled_lifetime": 232448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 232448, "timers": {"training_iteration_time_ms": 3640.303, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3640.152, "sample_time_ms": 1499.559, "learn_time_ms": 2109.798, "learn_throughput": 485.355, "synch_weights_time_ms": 30.576}, "counters": {"num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "done": false, "training_iteration": 227, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-14", "timestamp": 1744127834, "time_this_iter_s": 3.7670633792877197, "time_total_s": 841.4314181804657, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 841.4314181804657, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 55.33999999999999, "ram_util_percent": 94.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7218477070331573, "cur_kl_coeff": 9.273015376718553e-70, "cur_lr": 1e-07, "total_loss": 2.1696128115057944, "policy_loss": -0.0001218923251144588, "vf_loss": 9.980733078718185, "vf_explained_var": -1.0158121585845948e-05, "kl": 2.1831717669229533e-06, "entropy": 3.254485513269901, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "env_runners": {"episode_reward_max": 544.243772103242, "episode_reward_min": 444.55628723498705, "episode_reward_mean": 491.39526269168607, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.55628723498705}, "policy_reward_max": {"tplp_policy": 544.243772103242}, "policy_reward_mean": {"tplp_policy": 491.39526269168607}, "custom_metrics": {"mean_episode_reward_mean": 491.39526269168607, "mean_episode_reward_min": 444.55628723498705, "mean_episode_reward_max": 544.243772103242}, "hist_stats": {"episode_reward": [519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [519.8320885644686, 497.0368276284363, 484.9588197819315, 503.51763487413507, 544.0307160544762, 497.471574406256, 527.1582488288589, 487.58889722756817, 494.08949487226084, 508.75044793361246, 496.3198316721593, 494.74935168780866, 509.6495667874993, 473.70270935871764, 487.93438568497345, 510.1265155951914, 487.7016427507096, 446.5070493208068, 484.9126884225068, 538.5992147904544, 461.0915802329622, 454.5142917939589, 483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1202842591456292, "mean_inference_ms": 3.26826716853393, "mean_action_processing_ms": 0.6093998419609342, "mean_env_wait_ms": 3.4069127646947037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010496854782104492, "StateBufferConnector_ms": 0.012338399887084961, "ViewRequirementAgentConnector_ms": 0.368175745010376}, "num_episodes": 20, "episode_return_max": 544.243772103242, "episode_return_min": 444.55628723498705, "episode_return_mean": 491.39526269168607, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 291.84402839422796, "num_env_steps_trained_throughput_per_sec": 291.84402839422796, "timesteps_total": 233472, "num_env_steps_sampled_lifetime": 233472, "num_agent_steps_sampled_lifetime": 233472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 233472, "timers": {"training_iteration_time_ms": 3655.92, "restore_workers_time_ms": 0.05, "training_step_time_ms": 3655.77, "sample_time_ms": 1512.852, "learn_time_ms": 2111.778, "learn_throughput": 484.899, "synch_weights_time_ms": 30.921}, "counters": {"num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "done": false, "training_iteration": 228, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-18", "timestamp": 1744127838, "time_this_iter_s": 3.532317638397217, "time_total_s": 844.9637358188629, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD145440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 844.9637358188629, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 52.279999999999994, "ram_util_percent": 94.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.612949148565531, "cur_kl_coeff": 4.6365076883592763e-70, "cur_lr": 1e-07, "total_loss": 2.17413469851017, "policy_loss": -0.00011956734233535826, "vf_loss": 10.0, "vf_explained_var": -7.5016170740127565e-06, "kl": 3.710141974314074e-06, "entropy": 3.25745732486248, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "env_runners": {"episode_reward_max": 544.243772103242, "episode_reward_min": 444.55628723498705, "episode_reward_mean": 492.2843810621499, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.55628723498705}, "policy_reward_max": {"tplp_policy": 544.243772103242}, "policy_reward_mean": {"tplp_policy": 492.2843810621499}, "custom_metrics": {"mean_episode_reward_mean": 492.2843810621499, "mean_episode_reward_min": 444.55628723498705, "mean_episode_reward_max": 544.243772103242}, "hist_stats": {"episode_reward": [483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.1404057852559, 482.05757282338334, 502.17229575368606, 484.8418257862612, 494.0977373648019, 444.55628723498705, 487.63459634906604, 508.98435120591574, 477.26590522990665, 511.6703865069452, 502.5005289228648, 502.80185165595134, 483.94405143591666, 518.3650762327186, 507.68459002111496, 482.14256757479825, 493.22791705006756, 464.9130533819399, 463.56945107954436, 480.75636640031024, 480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1209473957809666, "mean_inference_ms": 3.2697010716288215, "mean_action_processing_ms": 0.6095963480761442, "mean_env_wait_ms": 3.4077905576169263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011487007141113281, "StateBufferConnector_ms": 0.014840126037597656, "ViewRequirementAgentConnector_ms": 0.3706700801849365}, "num_episodes": 22, "episode_return_max": 544.243772103242, "episode_return_min": 444.55628723498705, "episode_return_mean": 492.2843810621499, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 272.8584921578792, "num_env_steps_trained_throughput_per_sec": 272.8584921578792, "timesteps_total": 234496, "num_env_steps_sampled_lifetime": 234496, "num_agent_steps_sampled_lifetime": 234496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 234496, "timers": {"training_iteration_time_ms": 3687.634, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3687.534, "sample_time_ms": 1537.541, "learn_time_ms": 2118.786, "learn_throughput": 483.296, "synch_weights_time_ms": 30.988}, "counters": {"num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "done": false, "training_iteration": 229, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-22", "timestamp": 1744127842, "time_this_iter_s": 3.763765335083008, "time_total_s": 848.7275011539459, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 848.7275011539459, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 63.14, "ram_util_percent": 94.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.870840774849057, "cur_kl_coeff": 2.3182538441796382e-70, "cur_lr": 1e-07, "total_loss": 2.1738032028079033, "policy_loss": -0.0001084215531591326, "vf_loss": 10.0, "vf_explained_var": -9.70885157585144e-06, "kl": 2.1443166933643456e-06, "entropy": 3.2608836248517035, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "env_runners": {"episode_reward_max": 544.243772103242, "episode_reward_min": 445.5441961883747, "episode_reward_mean": 494.49087997364745, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.5441961883747}, "policy_reward_max": {"tplp_policy": 544.243772103242}, "policy_reward_mean": {"tplp_policy": 494.49087997364745}, "custom_metrics": {"mean_episode_reward_mean": 494.49087997364745, "mean_episode_reward_min": 445.5441961883747, "mean_episode_reward_max": 544.243772103242}, "hist_stats": {"episode_reward": [480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.21526232403545, 501.8034092139985, 461.8318954509742, 469.94157709479344, 489.84179935471235, 512.7794007316876, 473.32454772100425, 475.6575833371812, 483.42723410875925, 500.4670745179228, 506.5894055373051, 497.54861496778005, 521.518007321147, 473.1565308960916, 487.92110212954697, 544.243772103242, 476.3356709697162, 517.0077007027718, 481.4273345319959, 497.7709450135602, 514.6177310726339, 492.4549041248731, 503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1215677682297585, "mean_inference_ms": 3.2709858958786153, "mean_action_processing_ms": 0.6097968870477475, "mean_env_wait_ms": 3.4090034664949336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491008758544922, "StateBufferConnector_ms": 0.01683354377746582, "ViewRequirementAgentConnector_ms": 0.3922548294067383}, "num_episodes": 20, "episode_return_max": 544.243772103242, "episode_return_min": 445.5441961883747, "episode_return_mean": 494.49087997364745, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 274.8951131789241, "num_env_steps_trained_throughput_per_sec": 274.8951131789241, "timesteps_total": 235520, "num_env_steps_sampled_lifetime": 235520, "num_agent_steps_sampled_lifetime": 235520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 235520, "timers": {"training_iteration_time_ms": 3716.928, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3716.827, "sample_time_ms": 1563.005, "learn_time_ms": 2122.354, "learn_throughput": 482.483, "synch_weights_time_ms": 31.25}, "counters": {"num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "done": false, "training_iteration": 230, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-25", "timestamp": 1744127845, "time_this_iter_s": 3.7334136962890625, "time_total_s": 852.460914850235, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 852.460914850235, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 56.28000000000001, "ram_util_percent": 94.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5767074402421715, "cur_kl_coeff": 1.1591269220898191e-70, "cur_lr": 1e-07, "total_loss": 2.1655467085540296, "policy_loss": -0.0001393131446093321, "vf_loss": 9.967942357063293, "vf_explained_var": -2.4836510419845583e-06, "kl": 2.3711846384499856e-06, "entropy": 3.2629954680800437, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "env_runners": {"episode_reward_max": 537.1611007874712, "episode_reward_min": 445.5441961883747, "episode_reward_mean": 495.36026555795297, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.5441961883747}, "policy_reward_max": {"tplp_policy": 537.1611007874712}, "policy_reward_mean": {"tplp_policy": 495.36026555795297}, "custom_metrics": {"mean_episode_reward_mean": 495.36026555795297, "mean_episode_reward_min": 445.5441961883747, "mean_episode_reward_max": 537.1611007874712}, "hist_stats": {"episode_reward": [503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [503.4513132115044, 484.84305790462116, 476.4542066641531, 468.78286289842003, 499.92154438517963, 473.398253608966, 495.207621848723, 495.6242709329486, 476.22983811945784, 462.5639051214866, 520.9307118272428, 457.6161663803536, 505.31062580126013, 516.012778729334, 482.39175051968994, 458.44949052979604, 497.01794395339704, 496.0035299148657, 496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1218556072409975, "mean_inference_ms": 3.2716464031660144, "mean_action_processing_ms": 0.6101469634535089, "mean_env_wait_ms": 3.4105107835867106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017538070678710938, "StateBufferConnector_ms": 0.013994932174682617, "ViewRequirementAgentConnector_ms": 0.3811500072479248}, "num_episodes": 22, "episode_return_max": 537.1611007874712, "episode_return_min": 445.5441961883747, "episode_return_mean": 495.36026555795297, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 241.60121657686102, "num_env_steps_trained_throughput_per_sec": 241.60121657686102, "timesteps_total": 236544, "num_env_steps_sampled_lifetime": 236544, "num_agent_steps_sampled_lifetime": 236544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 3790.264, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3790.164, "sample_time_ms": 1591.102, "learn_time_ms": 2166.816, "learn_throughput": 472.583, "synch_weights_time_ms": 32.146}, "counters": {"num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "done": false, "training_iteration": 231, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-30", "timestamp": 1744127850, "time_this_iter_s": 4.253849744796753, "time_total_s": 856.7147645950317, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 856.7147645950317, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 59.18333333333334, "ram_util_percent": 94.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3546300124377013, "cur_kl_coeff": 5.7956346104490954e-71, "cur_lr": 1e-07, "total_loss": 2.171000084280968, "policy_loss": -5.6232430506497624e-05, "vf_loss": 9.990485733747482, "vf_explained_var": -1.0138377547264099e-05, "kl": 2.0694211873450998e-06, "entropy": 3.2656512320041657, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "env_runners": {"episode_reward_max": 537.1611007874712, "episode_reward_min": 445.5441961883747, "episode_reward_mean": 494.3671239672541, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.5441961883747}, "policy_reward_max": {"tplp_policy": 537.1611007874712}, "policy_reward_mean": {"tplp_policy": 494.3671239672541}, "custom_metrics": {"mean_episode_reward_mean": 494.3671239672541, "mean_episode_reward_min": 445.5441961883747, "mean_episode_reward_max": 537.1611007874712}, "hist_stats": {"episode_reward": [496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [496.5103206443579, 492.8108737450571, 496.399738972713, 506.22119955907533, 479.9363222548185, 508.681590058541, 479.90726263166584, 451.45375689352653, 481.9634319927316, 489.3377179994865, 454.12639986108877, 501.7739283143473, 490.91892361966, 509.1229823220599, 503.49225981047675, 493.2313525113524, 485.55604277872595, 501.4203935566128, 515.5379843545152, 480.457258004639, 502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.122213039246994, "mean_inference_ms": 3.2734697172104545, "mean_action_processing_ms": 0.6103606402586351, "mean_env_wait_ms": 3.411903696061787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016544580459594727, "StateBufferConnector_ms": 0.013484001159667969, "ViewRequirementAgentConnector_ms": 0.42783403396606445}, "num_episodes": 18, "episode_return_max": 537.1611007874712, "episode_return_min": 445.5441961883747, "episode_return_mean": 494.3671239672541, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 191.51307027575461, "num_env_steps_trained_throughput_per_sec": 191.51307027575461, "timesteps_total": 237568, "num_env_steps_sampled_lifetime": 237568, "num_agent_steps_sampled_lifetime": 237568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 237568, "timers": {"training_iteration_time_ms": 3974.941, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3974.841, "sample_time_ms": 1657.574, "learn_time_ms": 2284.558, "learn_throughput": 448.227, "synch_weights_time_ms": 32.608}, "counters": {"num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "done": false, "training_iteration": 232, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-35", "timestamp": 1744127855, "time_this_iter_s": 5.359189748764038, "time_total_s": 862.0739543437958, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25ACA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 862.0739543437958, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 74.18333333333334, "ram_util_percent": 94.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4492327526211737, "cur_kl_coeff": 2.8978173052245477e-71, "cur_lr": 1e-07, "total_loss": 2.173150131851435, "policy_loss": -3.0366479768417777e-05, "vf_loss": 10.0, "vf_explained_var": -8.471682667732238e-06, "kl": 1.6815758024729678e-06, "entropy": 3.2681949228048324, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "env_runners": {"episode_reward_max": 537.1611007874712, "episode_reward_min": 445.5441961883747, "episode_reward_mean": 494.8872868854514, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 445.5441961883747}, "policy_reward_max": {"tplp_policy": 537.1611007874712}, "policy_reward_mean": {"tplp_policy": 494.8872868854514}, "custom_metrics": {"mean_episode_reward_mean": 494.8872868854514, "mean_episode_reward_min": 445.5441961883747, "mean_episode_reward_max": 537.1611007874712}, "hist_stats": {"episode_reward": [502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.05673069708376, 488.2042146541645, 471.1276718894336, 493.7569803144386, 515.3321830861336, 485.61168180503745, 529.2055306988113, 503.50095468265454, 471.32270822450164, 509.3496436822117, 524.9010276637729, 494.8658706742658, 531.2693637602905, 486.9785917747508, 513.2655266927384, 515.3573956292115, 489.1044650063748, 486.55461858770394, 477.55438062429977, 513.8406328090957, 445.5441961883747, 494.18071064773807, 527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.12271143277016, "mean_inference_ms": 3.2754287626623437, "mean_action_processing_ms": 0.6106391189819754, "mean_env_wait_ms": 3.413999058528425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01455068588256836, "StateBufferConnector_ms": 0.01447439193725586, "ViewRequirementAgentConnector_ms": 0.41557931900024414}, "num_episodes": 20, "episode_return_max": 537.1611007874712, "episode_return_min": 445.5441961883747, "episode_return_mean": 494.8872868854514, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 198.38681862673798, "num_env_steps_trained_throughput_per_sec": 198.38681862673798, "timesteps_total": 238592, "num_env_steps_sampled_lifetime": 238592, "num_agent_steps_sampled_lifetime": 238592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 238592, "timers": {"training_iteration_time_ms": 4151.976, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4151.875, "sample_time_ms": 1678.954, "learn_time_ms": 2438.85, "learn_throughput": 419.87, "synch_weights_time_ms": 33.97}, "counters": {"num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "done": false, "training_iteration": 233, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-41", "timestamp": 1744127861, "time_this_iter_s": 5.176303148269653, "time_total_s": 867.2502574920654, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 867.2502574920654, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 94.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5622807014733553, "cur_kl_coeff": 1.4489086526122739e-71, "cur_lr": 1e-07, "total_loss": 2.171986546367407, "policy_loss": -6.918312283232808e-06, "vf_loss": 9.99622141122818, "vf_explained_var": -8.68774950504303e-06, "kl": 1.35290003324684e-06, "entropy": 3.270618775486946, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "env_runners": {"episode_reward_max": 537.1611007874712, "episode_reward_min": 450.3563400481404, "episode_reward_mean": 494.7996448463813, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 450.3563400481404}, "policy_reward_max": {"tplp_policy": 537.1611007874712}, "policy_reward_mean": {"tplp_policy": 494.7996448463813}, "custom_metrics": {"mean_episode_reward_mean": 494.7996448463813, "mean_episode_reward_min": 450.3563400481404, "mean_episode_reward_max": 537.1611007874712}, "hist_stats": {"episode_reward": [527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [527.1240569061001, 537.1611007874712, 498.5604728746309, 485.05354966380435, 494.3709944059352, 508.848496930474, 505.46568140235263, 470.6732870376086, 485.46333455533255, 526.25389694759, 493.232602185508, 494.6773666996995, 472.1395524351291, 514.1287747351854, 504.20249529793415, 517.1457317509706, 511.7598539494894, 510.990553543856, 484.6456412222928, 512.0317331325258, 515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1232940751306755, "mean_inference_ms": 3.2777538297738587, "mean_action_processing_ms": 0.6110943611767815, "mean_env_wait_ms": 3.4165205240636847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015545129776000977, "StateBufferConnector_ms": 0.01346278190612793, "ViewRequirementAgentConnector_ms": 0.3976442813873291}, "num_episodes": 22, "episode_return_max": 537.1611007874712, "episode_return_min": 450.3563400481404, "episode_return_mean": 494.7996448463813, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 228.77323962312371, "num_env_steps_trained_throughput_per_sec": 228.77323962312371, "timesteps_total": 239616, "num_env_steps_sampled_lifetime": 239616, "num_agent_steps_sampled_lifetime": 239616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 239616, "timers": {"training_iteration_time_ms": 4257.443, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4257.343, "sample_time_ms": 1717.023, "learn_time_ms": 2505.828, "learn_throughput": 408.647, "synch_weights_time_ms": 34.392}, "counters": {"num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "done": false, "training_iteration": 234, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-45", "timestamp": 1744127865, "time_this_iter_s": 4.4967145919799805, "time_total_s": 871.7469720840454, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 871.7469720840454, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 70.11428571428573, "ram_util_percent": 94.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.226973541453481, "cur_kl_coeff": 7.244543263061369e-72, "cur_lr": 1e-07, "total_loss": 2.170874049514532, "policy_loss": -5.183547036722302e-05, "vf_loss": 9.992987895011902, "vf_explained_var": -9.256601333618165e-06, "kl": 2.044660056554903e-06, "entropy": 3.273210918903351, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "env_runners": {"episode_reward_max": 533.3605434887071, "episode_reward_min": 450.3563400481404, "episode_reward_mean": 493.06661628883757, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 450.3563400481404}, "policy_reward_max": {"tplp_policy": 533.3605434887071}, "policy_reward_mean": {"tplp_policy": 493.06661628883757}, "custom_metrics": {"mean_episode_reward_mean": 493.06661628883757, "mean_episode_reward_min": 450.3563400481404, "mean_episode_reward_max": 533.3605434887071}, "hist_stats": {"episode_reward": [515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [515.5351572787483, 491.993284030613, 494.8022177551542, 495.85931207086765, 450.3805900941456, 477.2075661078076, 491.0918875894924, 492.6572587831643, 491.25780318373603, 517.1853379532798, 497.64412406615554, 488.63159329400844, 526.5518500378928, 489.10546688616165, 494.0387593009548, 515.4801426117803, 504.8926165710216, 515.2555218860564, 485.7774419376904, 514.7947558627399, 453.23204105813574, 469.05328619393947, 499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1238491676025506, "mean_inference_ms": 3.279893691178936, "mean_action_processing_ms": 0.6114714948836358, "mean_env_wait_ms": 3.418498960338965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013059377670288086, "StateBufferConnector_ms": 0.013464212417602539, "ViewRequirementAgentConnector_ms": 0.3905785083770752}, "num_episodes": 20, "episode_return_max": 533.3605434887071, "episode_return_min": 450.3563400481404, "episode_return_mean": 493.06661628883757, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 267.57731881497796, "num_env_steps_trained_throughput_per_sec": 267.57731881497796, "timesteps_total": 240640, "num_env_steps_sampled_lifetime": 240640, "num_agent_steps_sampled_lifetime": 240640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 240640, "timers": {"training_iteration_time_ms": 4224.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4224.029, "sample_time_ms": 1725.524, "learn_time_ms": 2464.235, "learn_throughput": 415.545, "synch_weights_time_ms": 34.16}, "counters": {"num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "done": false, "training_iteration": 235, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-49", "timestamp": 1744127869, "time_this_iter_s": 3.8392562866210938, "time_total_s": 875.5862283706665, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 875.5862283706665, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 58.220000000000006, "ram_util_percent": 94.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6590105082839726, "cur_kl_coeff": 3.6222716315306846e-72, "cur_lr": 1e-07, "total_loss": 2.1675127178430555, "policy_loss": -0.00019105031969957054, "vf_loss": 9.98072527050972, "vf_explained_var": -5.568563938140869e-06, "kl": 1.644601133765633e-06, "entropy": 3.2747753992676736, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "env_runners": {"episode_reward_max": 533.3605434887071, "episode_reward_min": 430.80657168874853, "episode_reward_mean": 489.4505100810483, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.80657168874853}, "policy_reward_max": {"tplp_policy": 533.3605434887071}, "policy_reward_mean": {"tplp_policy": 489.4505100810483}, "custom_metrics": {"mean_episode_reward_mean": 489.4505100810483, "mean_episode_reward_min": 430.80657168874853, "mean_episode_reward_max": 533.3605434887071}, "hist_stats": {"episode_reward": [499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.7819081785769, 492.7944419948693, 510.17408245817785, 483.1506240376416, 460.81255840002444, 490.1147870629866, 464.3535147972388, 487.7466795007532, 484.7210755908167, 506.46971656299013, 462.799240909871, 507.8707885457948, 464.49538632299317, 450.3563400481404, 486.85415321819545, 496.11508840035924, 508.24640841083925, 517.1714307122688, 486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1246612344699967, "mean_inference_ms": 3.2824254102960158, "mean_action_processing_ms": 0.6119015330438735, "mean_env_wait_ms": 3.4204006245127077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010093450546264648, "StateBufferConnector_ms": 0.013987064361572266, "ViewRequirementAgentConnector_ms": 0.40729522705078125}, "num_episodes": 22, "episode_return_max": 533.3605434887071, "episode_return_min": 430.80657168874853, "episode_return_mean": 489.4505100810483, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 227.63640989154777, "num_env_steps_trained_throughput_per_sec": 227.63640989154777, "timesteps_total": 241664, "num_env_steps_sampled_lifetime": 241664, "num_agent_steps_sampled_lifetime": 241664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 241664, "timers": {"training_iteration_time_ms": 4229.22, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4229.22, "sample_time_ms": 1720.044, "learn_time_ms": 2473.847, "learn_throughput": 413.93, "synch_weights_time_ms": 35.22}, "counters": {"num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "done": false, "training_iteration": 236, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-54", "timestamp": 1744127874, "time_this_iter_s": 4.513913869857788, "time_total_s": 880.1001422405243, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD258720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.1001422405243, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 59.883333333333326, "ram_util_percent": 94.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.537996784970164, "cur_kl_coeff": 1.8111358157653423e-72, "cur_lr": 1e-07, "total_loss": 2.172320843487978, "policy_loss": -3.962997579947114e-05, "vf_loss": 10.0, "vf_explained_var": -9.42721962928772e-06, "kl": 1.9985056712218396e-06, "entropy": 3.2763952255249023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "env_runners": {"episode_reward_max": 533.3605434887071, "episode_reward_min": 430.80657168874853, "episode_reward_mean": 490.6863175456295, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.80657168874853}, "policy_reward_max": {"tplp_policy": 533.3605434887071}, "policy_reward_mean": {"tplp_policy": 490.6863175456295}, "custom_metrics": {"mean_episode_reward_mean": 490.6863175456295, "mean_episode_reward_min": 430.80657168874853, "mean_episode_reward_max": 533.3605434887071}, "hist_stats": {"episode_reward": [486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [486.7726938781819, 484.91635350255086, 499.59509579514287, 529.8111162052626, 512.2865243702195, 509.9882969613687, 465.78032831970074, 499.3790030954756, 465.46059199067565, 483.5158897729335, 460.93230316813685, 471.4604181964787, 507.2419979953642, 526.9623315363835, 476.4732826390159, 495.3292863245956, 486.15727235168737, 483.3954064789103, 465.96139636691623, 482.4832986439529, 506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1254281107081503, "mean_inference_ms": 3.2845436685603966, "mean_action_processing_ms": 0.6123489028317246, "mean_env_wait_ms": 3.422187482963315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013327598571777344, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.40184998512268066}, "num_episodes": 18, "episode_return_max": 533.3605434887071, "episode_return_min": 430.80657168874853, "episode_return_mean": 490.6863175456295, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 206.07433539321275, "num_env_steps_trained_throughput_per_sec": 206.07433539321275, "timesteps_total": 242688, "num_env_steps_sampled_lifetime": 242688, "num_agent_steps_sampled_lifetime": 242688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 242688, "timers": {"training_iteration_time_ms": 4350.402, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4350.402, "sample_time_ms": 1764.284, "learn_time_ms": 2549.535, "learn_throughput": 401.642, "synch_weights_time_ms": 36.473}, "counters": {"num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "done": false, "training_iteration": 237, "trial_id": "f7884_00000", "date": "2025-04-08_23-57-59", "timestamp": 1744127879, "time_this_iter_s": 4.980368137359619, "time_total_s": 885.0805103778839, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BC0547C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 885.0805103778839, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 72.88333333333333, "ram_util_percent": 94.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.988601150363684, "cur_kl_coeff": 9.055679078826712e-73, "cur_lr": 1e-07, "total_loss": 2.1695299871265887, "policy_loss": -8.118363912217319e-05, "vf_loss": 9.990362417697906, "vf_explained_var": -7.583200931549072e-06, "kl": 3.2417680047913676e-06, "entropy": 3.2797944232821465, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "env_runners": {"episode_reward_max": 536.3727118706204, "episode_reward_min": 430.80657168874853, "episode_reward_mean": 491.01136865181996, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.80657168874853}, "policy_reward_max": {"tplp_policy": 536.3727118706204}, "policy_reward_mean": {"tplp_policy": 491.01136865181996}, "custom_metrics": {"mean_episode_reward_mean": 491.01136865181996, "mean_episode_reward_min": 430.80657168874853, "mean_episode_reward_max": 536.3727118706204}, "hist_stats": {"episode_reward": [506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.4677323906475, 488.5831566198526, 504.23507534525646, 478.8253921388311, 496.74535487402545, 486.7315438313136, 516.1459166167551, 501.8183895796326, 520.2778244191139, 519.7589109823734, 496.0253040287441, 452.4131865097967, 501.82139524783105, 522.3473642172955, 512.1043246791664, 513.9006813539963, 474.7386543024666, 498.94391039953257, 502.7362757572644, 491.05578758130457, 497.9009608144694, 482.8097114380359, 481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1262321714056425, "mean_inference_ms": 3.2867750699295293, "mean_action_processing_ms": 0.6129006423521717, "mean_env_wait_ms": 3.4238649834123214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015863418579101562, "StateBufferConnector_ms": 0.013312578201293945, "ViewRequirementAgentConnector_ms": 0.42727065086364746}, "num_episodes": 20, "episode_return_max": 536.3727118706204, "episode_return_min": 430.80657168874853, "episode_return_mean": 491.01136865181996, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 225.0500888810524, "num_env_steps_trained_throughput_per_sec": 225.0500888810524, "timesteps_total": 243712, "num_env_steps_sampled_lifetime": 243712, "num_agent_steps_sampled_lifetime": 243712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 243712, "timers": {"training_iteration_time_ms": 4454.539, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4454.539, "sample_time_ms": 1780.456, "learn_time_ms": 2637.129, "learn_throughput": 388.301, "synch_weights_time_ms": 36.844}, "counters": {"num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "done": false, "training_iteration": 238, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-04", "timestamp": 1744127884, "time_this_iter_s": 4.570802927017212, "time_total_s": 889.6513133049011, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 889.6513133049011, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 78.2, "ram_util_percent": 94.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5477478325366976, "cur_kl_coeff": 4.527839539413356e-73, "cur_lr": 1e-07, "total_loss": 2.164435634762049, "policy_loss": -4.460921045392752e-05, "vf_loss": 9.971209698915482, "vf_explained_var": -9.377673268318177e-06, "kl": 2.1662610990347274e-06, "entropy": 3.283221697807312, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "env_runners": {"episode_reward_max": 536.3727118706204, "episode_reward_min": 430.80657168874853, "episode_reward_mean": 489.6415668424924, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.80657168874853}, "policy_reward_max": {"tplp_policy": 536.3727118706204}, "policy_reward_mean": {"tplp_policy": 489.6415668424924}, "custom_metrics": {"mean_episode_reward_mean": 489.6415668424924, "mean_episode_reward_min": 430.80657168874853, "mean_episode_reward_max": 536.3727118706204}, "hist_stats": {"episode_reward": [481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.2581765331635, 506.7618074153002, 533.3605434887071, 523.8193777210711, 480.58511190118924, 485.16630876525136, 486.93018690965863, 480.4167170780138, 514.2441935826627, 488.99677100926067, 468.54824366209243, 507.3535994942682, 500.5334293996496, 488.5084430069884, 498.12954276549107, 497.1706759177084, 485.20213121605514, 472.930388590471, 461.0863541544694, 434.4484462994876, 465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1274905998426656, "mean_inference_ms": 3.2900779492214878, "mean_action_processing_ms": 0.6137307832345329, "mean_env_wait_ms": 3.4268409683958323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014885425567626953, "StateBufferConnector_ms": 0.011918783187866211, "ViewRequirementAgentConnector_ms": 0.4291713237762451}, "num_episodes": 22, "episode_return_max": 536.3727118706204, "episode_return_min": 430.80657168874853, "episode_return_mean": 489.6415668424924, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 166.48926913251492, "num_env_steps_trained_throughput_per_sec": 166.48926913251492, "timesteps_total": 244736, "num_env_steps_sampled_lifetime": 244736, "num_agent_steps_sampled_lifetime": 244736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 244736, "timers": {"training_iteration_time_ms": 4694.308, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4694.308, "sample_time_ms": 1868.348, "learn_time_ms": 2788.448, "learn_throughput": 367.229, "synch_weights_time_ms": 37.402}, "counters": {"num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "done": false, "training_iteration": 239, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-10", "timestamp": 1744127890, "time_this_iter_s": 6.168039798736572, "time_total_s": 895.8193531036377, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25A020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 895.8193531036377, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 85.3125, "ram_util_percent": 94.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173705477640033, "cur_kl_coeff": 2.263919769706678e-73, "cur_lr": 1e-07, "total_loss": 2.1714026711881163, "policy_loss": -2.139289863407612e-05, "vf_loss": 10.0, "vf_explained_var": -1.152344048023224e-05, "kl": 1.3770582903332994e-06, "entropy": 3.2857593685388564, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "env_runners": {"episode_reward_max": 536.3727118706204, "episode_reward_min": 430.80657168874853, "episode_reward_mean": 490.10374785360614, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.80657168874853}, "policy_reward_max": {"tplp_policy": 536.3727118706204}, "policy_reward_mean": {"tplp_policy": 490.10374785360614}, "custom_metrics": {"mean_episode_reward_mean": 490.10374785360614, "mean_episode_reward_min": 430.80657168874853, "mean_episode_reward_max": 536.3727118706204}, "hist_stats": {"episode_reward": [465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.41792961574174, 487.29702118608304, 440.6207806463547, 481.30440594613196, 494.0901478979021, 493.98515041660386, 475.7974387366345, 500.8284100770542, 498.89782396341906, 487.370031188781, 485.0219877776821, 501.2489999074107, 430.80657168874853, 510.53903948221324, 461.23892926801943, 481.34685230162256, 496.0449150870009, 476.36811524766125, 465.8621316580931, 481.19591122752416, 511.93907400457294, 523.7231991680206, 501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1289524590264444, "mean_inference_ms": 3.2940996378427574, "mean_action_processing_ms": 0.6145143431244217, "mean_env_wait_ms": 3.430614753093695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01187276840209961, "StateBufferConnector_ms": 0.013793230056762695, "ViewRequirementAgentConnector_ms": 0.4363667964935303}, "num_episodes": 20, "episode_return_max": 536.3727118706204, "episode_return_min": 430.80657168874853, "episode_return_mean": 490.10374785360614, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 171.51980749380738, "num_env_steps_trained_throughput_per_sec": 171.51980749380738, "timesteps_total": 245760, "num_env_steps_sampled_lifetime": 245760, "num_agent_steps_sampled_lifetime": 245760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 4918.818, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4918.818, "sample_time_ms": 1918.987, "learn_time_ms": 2961.668, "learn_throughput": 345.751, "synch_weights_time_ms": 38.053}, "counters": {"num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "training_iteration": 240, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-16", "timestamp": 1744127896, "time_this_iter_s": 5.9873809814453125, "time_total_s": 901.806734085083, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.806734085083, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 84.35000000000001, "ram_util_percent": 94.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.746323334425688, "cur_kl_coeff": 1.131959884853339e-73, "cur_lr": 1e-07, "total_loss": 2.167433715611696, "policy_loss": -0.00012060570588801056, "vf_loss": 9.985637408494949, "vf_explained_var": -8.796900510787964e-06, "kl": 3.7248074747711635e-06, "entropy": 3.28855043053627, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "env_runners": {"episode_reward_max": 536.3727118706204, "episode_reward_min": 444.4161298676626, "episode_reward_mean": 492.5133125232944, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.4161298676626}, "policy_reward_max": {"tplp_policy": 536.3727118706204}, "policy_reward_mean": {"tplp_policy": 492.5133125232944}, "custom_metrics": {"mean_episode_reward_mean": 492.5133125232944, "mean_episode_reward_min": 444.4161298676626, "mean_episode_reward_max": 536.3727118706204}, "hist_stats": {"episode_reward": [501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [501.600151299469, 488.8586784146311, 508.66882461793534, 486.70732184945524, 482.69331136100845, 514.3384041813799, 488.3931030266814, 488.908748156901, 488.9076792356136, 468.6618592416541, 470.4462084145859, 492.2680938500338, 508.65492961714193, 487.1193922547729, 483.5788843478519, 502.14110856893996, 536.3727118706204, 478.6890874252201, 498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1310077457815666, "mean_inference_ms": 3.2999124408372, "mean_action_processing_ms": 0.6157075577312213, "mean_env_wait_ms": 3.436455676076124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00920248031616211, "StateBufferConnector_ms": 0.014796257019042969, "ViewRequirementAgentConnector_ms": 0.4682047367095947}, "num_episodes": 22, "episode_return_max": 536.3727118706204, "episode_return_min": 444.4161298676626, "episode_return_mean": 492.5133125232944, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 152.44974030991725, "num_env_steps_trained_throughput_per_sec": 152.44974030991725, "timesteps_total": 246784, "num_env_steps_sampled_lifetime": 246784, "num_agent_steps_sampled_lifetime": 246784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 246784, "timers": {"training_iteration_time_ms": 5166.676, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5166.676, "sample_time_ms": 2004.284, "learn_time_ms": 3124.188, "learn_throughput": 327.765, "synch_weights_time_ms": 38.094}, "counters": {"num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "done": false, "training_iteration": 241, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-23", "timestamp": 1744127903, "time_this_iter_s": 6.742631673812866, "time_total_s": 908.5493657588959, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD147880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 908.5493657588959, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 88.6625, "ram_util_percent": 95.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.634027925506234, "cur_kl_coeff": 5.659799424266695e-74, "cur_lr": 1e-07, "total_loss": 2.160459192842245, "policy_loss": -5.9705879539251325e-05, "vf_loss": 9.958753621578216, "vf_explained_var": -9.567290544509887e-06, "kl": 2.0731148865138493e-06, "entropy": 3.2916949704289435, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "env_runners": {"episode_reward_max": 526.7336908749149, "episode_reward_min": 444.4161298676626, "episode_reward_mean": 492.8362261743516, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 444.4161298676626}, "policy_reward_max": {"tplp_policy": 526.7336908749149}, "policy_reward_mean": {"tplp_policy": 492.8362261743516}, "custom_metrics": {"mean_episode_reward_mean": 492.8362261743516, "mean_episode_reward_min": 444.4161298676626, "mean_episode_reward_max": 526.7336908749149}, "hist_stats": {"episode_reward": [498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [498.23267526997415, 516.5314133559731, 493.28613309051866, 444.4161298676626, 456.92988902727535, 459.20195309002145, 485.6602316101791, 503.99991951439813, 498.22565051724234, 505.4199187341897, 495.1765592249113, 502.80175883761194, 457.3532484685455, 487.4304845868731, 493.97961490307625, 506.71776159880324, 483.6311229192594, 522.3517342996439, 519.4500410453386, 465.69555437075485, 467.6385096689294, 525.9088553494095, 469.2996329693703, 505.1922876234412, 506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1326968965224729, "mean_inference_ms": 3.3050554300723447, "mean_action_processing_ms": 0.6166972349205349, "mean_env_wait_ms": 3.4416082087872097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007185697555541992, "StateBufferConnector_ms": 0.01466226577758789, "ViewRequirementAgentConnector_ms": 0.45235657691955566}, "num_episodes": 18, "episode_return_max": 526.7336908749149, "episode_return_min": 444.4161298676626, "episode_return_mean": 492.8362261743516, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 141.27605637138484, "num_env_steps_trained_throughput_per_sec": 141.27605637138484, "timesteps_total": 247808, "num_env_steps_sampled_lifetime": 247808, "num_agent_steps_sampled_lifetime": 247808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 247808, "timers": {"training_iteration_time_ms": 5356.808, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5356.808, "sample_time_ms": 2017.99, "learn_time_ms": 3299.796, "learn_throughput": 310.322, "synch_weights_time_ms": 38.912}, "counters": {"num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "done": false, "training_iteration": 242, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-30", "timestamp": 1744127910, "time_this_iter_s": 7.266217231750488, "time_total_s": 915.8155829906464, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD2591C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 915.8155829906464, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 94.95, "ram_util_percent": 96.11000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5415500316768886, "cur_kl_coeff": 2.8298997121333474e-74, "cur_lr": 1e-07, "total_loss": 2.1707118913531303, "policy_loss": -1.4242390170693397e-05, "vf_loss": 10.0, "vf_explained_var": -4.343688488006592e-06, "kl": 5.513171958959617e-07, "entropy": 3.2927386969327928, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "env_runners": {"episode_reward_max": 526.7336908749149, "episode_reward_min": 429.5079020554252, "episode_reward_mean": 493.0433834637798, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.5079020554252}, "policy_reward_max": {"tplp_policy": 526.7336908749149}, "policy_reward_mean": {"tplp_policy": 493.0433834637798}, "custom_metrics": {"mean_episode_reward_mean": 493.0433834637798, "mean_episode_reward_min": 429.5079020554252, "mean_episode_reward_max": 526.7336908749149}, "hist_stats": {"episode_reward": [506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.7690300592736, 511.1997950772697, 493.6793550411069, 511.0512022254293, 450.64910206907757, 504.2544533311127, 464.87645686735505, 490.8873928867321, 465.88606467898285, 495.7238746271893, 500.74132063253313, 511.69416281540555, 507.4930738935349, 483.08023158656704, 494.2546330897056, 483.98164228644197, 488.0353435732786, 501.6155403868132, 485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.134970042017511, "mean_inference_ms": 3.3115539751086094, "mean_action_processing_ms": 0.6177544257821178, "mean_env_wait_ms": 3.4486493221890697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00840306282043457, "StateBufferConnector_ms": 0.012818336486816406, "ViewRequirementAgentConnector_ms": 0.4559752941131592}, "num_episodes": 24, "episode_return_max": 526.7336908749149, "episode_return_min": 429.5079020554252, "episode_return_mean": 493.0433834637798, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 168.47156047000274, "num_env_steps_trained_throughput_per_sec": 168.47156047000274, "timesteps_total": 248832, "num_env_steps_sampled_lifetime": 248832, "num_agent_steps_sampled_lifetime": 248832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 248832, "timers": {"training_iteration_time_ms": 5448.463, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5448.463, "sample_time_ms": 2027.659, "learn_time_ms": 3380.325, "learn_throughput": 302.929, "synch_weights_time_ms": 40.269}, "counters": {"num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "done": false, "training_iteration": 243, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-37", "timestamp": 1744127917, "time_this_iter_s": 6.121175050735474, "time_total_s": 921.9367580413818, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD259F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 921.9367580413818, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 88.19999999999999, "ram_util_percent": 96.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4512734077870846, "cur_kl_coeff": 1.4149498560666737e-74, "cur_lr": 1e-07, "total_loss": 2.165081065148115, "policy_loss": -7.471069984603673e-05, "vf_loss": 9.978412318229676, "vf_explained_var": -8.772686123847962e-06, "kl": 2.281275746029987e-06, "entropy": 3.2944730266928675, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "env_runners": {"episode_reward_max": 531.3662878803682, "episode_reward_min": 429.5079020554252, "episode_reward_mean": 494.36965120822896, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 429.5079020554252}, "policy_reward_max": {"tplp_policy": 531.3662878803682}, "policy_reward_mean": {"tplp_policy": 494.36965120822896}, "custom_metrics": {"mean_episode_reward_mean": 494.36965120822896, "mean_episode_reward_min": 429.5079020554252, "mean_episode_reward_max": 531.3662878803682}, "hist_stats": {"episode_reward": [485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617, 514.8416597346493, 492.3018265185893, 481.903557958824, 511.8242405229413, 502.39813712133594, 531.3662878803682, 489.3483023673986, 492.43415557828564, 500.2414896712686, 516.093480388282, 501.91004245648054, 491.60552937047765, 516.9870814075617, 498.90886962308366, 495.7006708099702, 482.63078232675605, 468.31311614133233, 509.690219695114], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.32158206544494, 489.1222639866556, 496.8221922195534, 462.5430611921306, 498.76924730874293, 471.37627624361164, 508.93638900334724, 474.4621088059836, 500.7604699311822, 494.403574148249, 500.254923805627, 516.2912255134162, 509.04271562981825, 485.79338955369496, 466.0101915054495, 513.9115310422884, 483.1961544937734, 495.0003696132605, 487.31279098469025, 496.771517858855, 505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617, 514.8416597346493, 492.3018265185893, 481.903557958824, 511.8242405229413, 502.39813712133594, 531.3662878803682, 489.3483023673986, 492.43415557828564, 500.2414896712686, 516.093480388282, 501.91004245648054, 491.60552937047765, 516.9870814075617, 498.90886962308366, 495.7006708099702, 482.63078232675605, 468.31311614133233, 509.690219695114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363632159541828, "mean_inference_ms": 3.316701952172398, "mean_action_processing_ms": 0.6185721084822001, "mean_env_wait_ms": 3.453064446517974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00901341438293457, "StateBufferConnector_ms": 0.011721611022949219, "ViewRequirementAgentConnector_ms": 0.4588449001312256}, "num_episodes": 18, "episode_return_max": 531.3662878803682, "episode_return_min": 429.5079020554252, "episode_return_mean": 494.36965120822896, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 128.98365588952717, "num_env_steps_trained_throughput_per_sec": 128.98365588952717, "timesteps_total": 249856, "num_env_steps_sampled_lifetime": 249856, "num_agent_steps_sampled_lifetime": 249856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 249856, "timers": {"training_iteration_time_ms": 5794.757, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5794.757, "sample_time_ms": 2048.09, "learn_time_ms": 3705.484, "learn_throughput": 276.347, "synch_weights_time_ms": 40.973}, "counters": {"num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "done": false, "training_iteration": 244, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-45", "timestamp": 1744127925, "time_this_iter_s": 7.9729955196380615, "time_total_s": 929.9097535610199, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25B4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 929.9097535610199, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 99.34545454545456, "ram_util_percent": 97.56363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5393932554870844, "cur_kl_coeff": 7.074749280333368e-75, "cur_lr": 1e-07, "total_loss": 2.1631481990218164, "policy_loss": -9.470884688198567e-05, "vf_loss": 9.97190368771553, "vf_explained_var": -9.232386946678162e-06, "kl": 2.559918807265582e-06, "entropy": 3.2973301455378534, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "env_runners": {"episode_reward_max": 531.3662878803682, "episode_reward_min": 427.86259361226155, "episode_reward_mean": 493.46746392355396, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.86259361226155}, "policy_reward_max": {"tplp_policy": 531.3662878803682}, "policy_reward_mean": {"tplp_policy": 493.46746392355396}, "custom_metrics": {"mean_episode_reward_mean": 493.46746392355396, "mean_episode_reward_min": 427.86259361226155, "mean_episode_reward_max": 531.3662878803682}, "hist_stats": {"episode_reward": [505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617, 514.8416597346493, 492.3018265185893, 481.903557958824, 511.8242405229413, 502.39813712133594, 531.3662878803682, 489.3483023673986, 492.43415557828564, 500.2414896712686, 516.093480388282, 501.91004245648054, 491.60552937047765, 516.9870814075617, 498.90886962308366, 495.7006708099702, 482.63078232675605, 468.31311614133233, 509.690219695114, 481.0195174507188, 487.1116325405025, 486.29772254776503, 485.55512920650915, 482.11776736068083, 519.1517672187586, 492.34247789606144, 500.23317096994805, 507.67646899974045, 478.6963328292759, 479.56985409531336, 462.76815928967005, 480.38365768633605, 499.82044598204317, 485.5511824429131, 427.86259361226155, 500.9608126716514, 499.8647474389155, 492.4855232665121, 496.41428293269433], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [505.147434643821, 501.29989296415994, 504.65862522789865, 461.78286864906624, 511.1186980264345, 497.12659459571165, 524.0471456217372, 470.3429392495896, 515.0575511677104, 482.7876451847682, 488.4657059735086, 496.55959947818036, 476.92123785208827, 520.4933414486154, 493.0087949564571, 477.2595030034837, 477.8152435271352, 475.5454013611797, 501.6451108121046, 526.7336908749149, 483.7899915713193, 504.82127893907864, 469.16919655697114, 524.514299844503, 489.72292910557036, 494.3334809195108, 486.49065014622465, 473.1047518389623, 493.359769965648, 495.54171563390264, 512.524686637973, 494.38037150467704, 482.3934502502318, 520.7386481584365, 484.5464353710441, 506.08650238323634, 494.706082413626, 499.07562159869696, 520.8277567974717, 506.01283836022253, 451.9989651847392, 516.8110176323403, 429.5079020554252, 485.46919044245806, 498.19277528924295, 506.2951066170591, 484.83070996493433, 500.9471832391153, 519.2558942449767, 468.6885374987457, 508.34407942088694, 454.14521049950173, 463.4529573764741, 493.1619398541353, 473.67917989052916, 474.9921020641974, 502.8877228275391, 465.5785213775026, 504.64599525355703, 521.5270184537833, 517.599571039422, 516.3946335019617, 514.8416597346493, 492.3018265185893, 481.903557958824, 511.8242405229413, 502.39813712133594, 531.3662878803682, 489.3483023673986, 492.43415557828564, 500.2414896712686, 516.093480388282, 501.91004245648054, 491.60552937047765, 516.9870814075617, 498.90886962308366, 495.7006708099702, 482.63078232675605, 468.31311614133233, 509.690219695114, 481.0195174507188, 487.1116325405025, 486.29772254776503, 485.55512920650915, 482.11776736068083, 519.1517672187586, 492.34247789606144, 500.23317096994805, 507.67646899974045, 478.6963328292759, 479.56985409531336, 462.76815928967005, 480.38365768633605, 499.82044598204317, 485.5511824429131, 427.86259361226155, 500.9608126716514, 499.8647474389155, 492.4855232665121, 496.41428293269433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137851768359169, "mean_inference_ms": 3.321564035156507, "mean_action_processing_ms": 0.6194200520060094, "mean_env_wait_ms": 3.4585545204054826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017645835876464844, "StateBufferConnector_ms": 0.01089167594909668, "ViewRequirementAgentConnector_ms": 0.44422197341918945}, "num_episodes": 20, "episode_return_max": 531.3662878803682, "episode_return_min": 427.86259361226155, "episode_return_mean": 493.46746392355396, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 159.0163177901073, "num_env_steps_trained_throughput_per_sec": 159.0163177901073, "timesteps_total": 250880, "num_env_steps_sampled_lifetime": 250880, "num_agent_steps_sampled_lifetime": 250880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 250880, "timers": {"training_iteration_time_ms": 6056.023, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6056.023, "sample_time_ms": 2128.47, "learn_time_ms": 3885.763, "learn_throughput": 263.526, "synch_weights_time_ms": 41.69}, "counters": {"num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "done": true, "training_iteration": 245, "trial_id": "f7884_00000", "date": "2025-04-08_23-58-51", "timestamp": 1744127931, "time_this_iter_s": 6.46628999710083, "time_total_s": 936.3760435581207, "pid": 8236, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x00000206BD25AC00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 936.3760435581207, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 81.96666666666665, "ram_util_percent": 98.18888888888888}}
